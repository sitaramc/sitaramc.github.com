<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<script type="text/javascript">
//<![CDATA[
var version = {title: "TiddlyWiki", major: 2, minor: 3, revision: 0, date: new Date("Dec 4, 2007"), extensions: {}};
//]]>
</script>
<!--
TiddlyWiki created by Jeremy Ruston, (jeremy [at] osmosoft [dot] com)

Copyright (c) UnaMesa Association 2004-2007

Redistribution and use in source and binary forms, with or without modification,
are permitted provided that the following conditions are met:

Redistributions of source code must retain the above copyright notice, this
list of conditions and the following disclaimer.

Redistributions in binary form must reproduce the above copyright notice, this
list of conditions and the following disclaimer in the documentation and/or other
materials provided with the distribution.

Neither the name of the UnaMesa Association nor the names of its contributors may be
used to endorse or promote products derived from this software without specific
prior written permission.

THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY
EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT
SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED
TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR
BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN
ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH
DAMAGE.
-->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<!--PRE-HEAD-START-->
<!--{{{-->
<link rel='alternate' type='application/rss+xml' title='RSS' href='index.xml'/>
<!--}}}-->
<!--PRE-HEAD-END-->
<title> My TiddlyWiki - a reusable non-linear personal web notebook </title>
<style type="text/css">
#saveTest {display:none;}
#messageArea {display:none;}
#copyright {display:none;}
#storeArea {display:none;}
#storeArea div {padding:0.5em; margin:1em 0em 0em 0em; border-color:#fff #666 #444 #ddd; border-style:solid; border-width:2px; overflow:auto;}
#shadowArea {display:none;}
#javascriptWarning {width:100%; text-align:center; font-weight:bold; background-color:#dd1100; color:#fff; padding:1em 0em;}
</style>
<!--POST-HEAD-START-->

<!--POST-HEAD-END-->
</head>
<body onload="main();" onunload="if(window.checkUnsavedChanges) checkUnsavedChanges(); if(window.scrubNodes) scrubNodes(document.body);">
<!--PRE-BODY-START-->

<!--PRE-BODY-END-->
<div id="copyright">
Welcome to TiddlyWiki created by Jeremy Ruston, Copyright &copy; 2007 UnaMesa Association
</div>
<noscript>
	<div id="javascriptWarning">This page requires JavaScript to function properly.<br /><br />If you are using Microsoft Internet Explorer you may need to click on the yellow bar above and select 'Allow Blocked Content'. You must then click 'Yes' on the following security warning.</div>
</noscript>
<div id="saveTest"></div>
<div id="backstageCloak"></div>
<div id="backstageButton"></div>
<div id="backstageArea"><div id="backstageToolbar"></div></div>
<div id="backstage">
	<div id="backstagePanel"></div>
</div>
<div id="contentWrapper"></div>
<div id="contentStash"></div>
<div id="shadowArea">
<div title="MarkupPreHead">
<pre>&lt;!--{{{--&gt;
&lt;link rel='alternate' type='application/rss+xml' title='RSS' href='index.xml'/&gt;
&lt;!--}}}--&gt;</pre>
</div>
<div title="ColorPalette">
<pre>Background: #fff
Foreground: #000
PrimaryPale: #8cf
PrimaryLight: #18f
PrimaryMid: #04b
PrimaryDark: #014
SecondaryPale: #ffc
SecondaryLight: #fe8
SecondaryMid: #db4
SecondaryDark: #841
TertiaryPale: #eee
TertiaryLight: #ccc
TertiaryMid: #999
TertiaryDark: #666
Error: #f88</pre>
</div>
<div title="StyleSheetColors">
<pre>/*{{{*/
body {background:[[ColorPalette::Background]]; color:[[ColorPalette::Foreground]];}

a {color:[[ColorPalette::PrimaryMid]];}
a:hover {background-color:[[ColorPalette::PrimaryMid]]; color:[[ColorPalette::Background]];}
a img {border:0;}

h1,h2,h3,h4,h5,h6 {color:[[ColorPalette::SecondaryDark]]; background:transparent;}
h1 {border-bottom:2px solid [[ColorPalette::TertiaryLight]];}
h2,h3 {border-bottom:1px solid [[ColorPalette::TertiaryLight]];}

.button {color:[[ColorPalette::PrimaryDark]]; border:1px solid [[ColorPalette::Background]];}
.button:hover {color:[[ColorPalette::PrimaryDark]]; background:[[ColorPalette::SecondaryLight]]; border-color:[[ColorPalette::SecondaryMid]];}
.button:active {color:[[ColorPalette::Background]]; background:[[ColorPalette::SecondaryMid]]; border:1px solid [[ColorPalette::SecondaryDark]];}

.header {background:[[ColorPalette::PrimaryMid]];}
.headerShadow {color:[[ColorPalette::Foreground]];}
.headerShadow a {font-weight:normal; color:[[ColorPalette::Foreground]];}
.headerForeground {color:[[ColorPalette::Background]];}
.headerForeground a {font-weight:normal; color:[[ColorPalette::PrimaryPale]];}

.tabSelected{color:[[ColorPalette::PrimaryDark]];
	background:[[ColorPalette::TertiaryPale]];
	border-left:1px solid [[ColorPalette::TertiaryLight]];
	border-top:1px solid [[ColorPalette::TertiaryLight]];
	border-right:1px solid [[ColorPalette::TertiaryLight]];
}
.tabUnselected {color:[[ColorPalette::Background]]; background:[[ColorPalette::TertiaryMid]];}
.tabContents {color:[[ColorPalette::PrimaryDark]]; background:[[ColorPalette::TertiaryPale]]; border:1px solid [[ColorPalette::TertiaryLight]];}
.tabContents .button {border:0;}

#sidebar {}
#sidebarOptions input {border:1px solid [[ColorPalette::PrimaryMid]];}
#sidebarOptions .sliderPanel {background:[[ColorPalette::PrimaryPale]];}
#sidebarOptions .sliderPanel a {border:none;color:[[ColorPalette::PrimaryMid]];}
#sidebarOptions .sliderPanel a:hover {color:[[ColorPalette::Background]]; background:[[ColorPalette::PrimaryMid]];}
#sidebarOptions .sliderPanel a:active {color:[[ColorPalette::PrimaryMid]]; background:[[ColorPalette::Background]];}

.wizard {background:[[ColorPalette::PrimaryPale]]; border:1px solid [[ColorPalette::PrimaryMid]];}
.wizard h1 {color:[[ColorPalette::PrimaryDark]]; border:none;}
.wizard h2 {color:[[ColorPalette::Foreground]]; border:none;}
.wizardStep {background:[[ColorPalette::Background]]; color:[[ColorPalette::Foreground]];
	border:1px solid [[ColorPalette::PrimaryMid]];}
.wizardStep.wizardStepDone {background:[[ColorPalette::TertiaryLight]];}
.wizardFooter {background:[[ColorPalette::PrimaryPale]];}
.wizardFooter .status {background:[[ColorPalette::PrimaryDark]]; color:[[ColorPalette::Background]];}
.wizard .button {color:[[ColorPalette::Foreground]]; background:[[ColorPalette::SecondaryLight]]; border: 1px solid;
	border-color:[[ColorPalette::SecondaryPale]] [[ColorPalette::SecondaryDark]] [[ColorPalette::SecondaryDark]] [[ColorPalette::SecondaryPale]];}
.wizard .button:hover {color:[[ColorPalette::Foreground]]; background:[[ColorPalette::Background]];}
.wizard .button:active {color:[[ColorPalette::Background]]; background:[[ColorPalette::Foreground]]; border: 1px solid;
	border-color:[[ColorPalette::PrimaryDark]] [[ColorPalette::PrimaryPale]] [[ColorPalette::PrimaryPale]] [[ColorPalette::PrimaryDark]];}

#messageArea {border:1px solid [[ColorPalette::SecondaryMid]]; background:[[ColorPalette::SecondaryLight]]; color:[[ColorPalette::Foreground]];}
#messageArea .button {color:[[ColorPalette::PrimaryMid]]; background:[[ColorPalette::SecondaryPale]]; border:none;}

.popupTiddler {background:[[ColorPalette::TertiaryPale]]; border:2px solid [[ColorPalette::TertiaryMid]];}

.popup {background:[[ColorPalette::TertiaryPale]]; color:[[ColorPalette::TertiaryDark]]; border-left:1px solid [[ColorPalette::TertiaryMid]]; border-top:1px solid [[ColorPalette::TertiaryMid]]; border-right:2px solid [[ColorPalette::TertiaryDark]]; border-bottom:2px solid [[ColorPalette::TertiaryDark]];}
.popup hr {color:[[ColorPalette::PrimaryDark]]; background:[[ColorPalette::PrimaryDark]]; border-bottom:1px;}
.popup li.disabled {color:[[ColorPalette::TertiaryMid]];}
.popup li a, .popup li a:visited {color:[[ColorPalette::Foreground]]; border: none;}
.popup li a:hover {background:[[ColorPalette::SecondaryLight]]; color:[[ColorPalette::Foreground]]; border: none;}
.popup li a:active {background:[[ColorPalette::SecondaryPale]]; color:[[ColorPalette::Foreground]]; border: none;}
.popupHighlight {background:[[ColorPalette::Background]]; color:[[ColorPalette::Foreground]];}
.listBreak div {border-bottom:1px solid [[ColorPalette::TertiaryDark]];}

.tiddler .defaultCommand {font-weight:bold;}

.shadow .title {color:[[ColorPalette::TertiaryDark]];}

.title {color:[[ColorPalette::SecondaryDark]];}
.subtitle {color:[[ColorPalette::TertiaryDark]];}

.toolbar {color:[[ColorPalette::PrimaryMid]];}
.toolbar a {color:[[ColorPalette::TertiaryLight]];}
.selected .toolbar a {color:[[ColorPalette::TertiaryMid]];}
.selected .toolbar a:hover {color:[[ColorPalette::Foreground]];}

.tagging, .tagged {border:1px solid [[ColorPalette::TertiaryPale]]; background-color:[[ColorPalette::TertiaryPale]];}
.selected .tagging, .selected .tagged {background-color:[[ColorPalette::TertiaryLight]]; border:1px solid [[ColorPalette::TertiaryMid]];}
.tagging .listTitle, .tagged .listTitle {color:[[ColorPalette::PrimaryDark]];}
.tagging .button, .tagged .button {border:none;}

.footer {color:[[ColorPalette::TertiaryLight]];}
.selected .footer {color:[[ColorPalette::TertiaryMid]];}

.sparkline {background:[[ColorPalette::PrimaryPale]]; border:0;}
.sparktick {background:[[ColorPalette::PrimaryDark]];}

.error, .errorButton {color:[[ColorPalette::Foreground]]; background:[[ColorPalette::Error]];}
.warning {color:[[ColorPalette::Foreground]]; background:[[ColorPalette::SecondaryPale]];}
.lowlight {background:[[ColorPalette::TertiaryLight]];}

.zoomer {background:none; color:[[ColorPalette::TertiaryMid]]; border:3px solid [[ColorPalette::TertiaryMid]];}

.imageLink, #displayArea .imageLink {background:transparent;}

.annotation {background:[[ColorPalette::SecondaryLight]]; color:[[ColorPalette::Foreground]]; border:2px solid [[ColorPalette::SecondaryMid]];}

.viewer .listTitle {list-style-type:none; margin-left:-2em;}
.viewer .button {border:1px solid [[ColorPalette::SecondaryMid]];}
.viewer blockquote {border-left:3px solid [[ColorPalette::TertiaryDark]];}

.viewer table, table.twtable {border:2px solid [[ColorPalette::TertiaryDark]];}
.viewer th, .viewer thead td, .twtable th, .twtable thead td {background:[[ColorPalette::SecondaryMid]]; border:1px solid [[ColorPalette::TertiaryDark]]; color:[[ColorPalette::Background]];}
.viewer td, .viewer tr, .twtable td, .twtable tr {border:1px solid [[ColorPalette::TertiaryDark]];}

.viewer pre {border:1px solid [[ColorPalette::SecondaryLight]]; background:[[ColorPalette::SecondaryPale]];}
.viewer code {color:[[ColorPalette::SecondaryDark]];}
.viewer hr {border:0; border-top:dashed 1px [[ColorPalette::TertiaryDark]]; color:[[ColorPalette::TertiaryDark]];}

.highlight, .marked {background:[[ColorPalette::SecondaryLight]];}

.editor input {border:1px solid [[ColorPalette::PrimaryMid]];}
.editor textarea {border:1px solid [[ColorPalette::PrimaryMid]]; width:100%;}
.editorFooter {color:[[ColorPalette::TertiaryMid]];}

#backstageArea {background:[[ColorPalette::Foreground]]; color:[[ColorPalette::TertiaryMid]];}
#backstageArea a {background:[[ColorPalette::Foreground]]; color:[[ColorPalette::Background]]; border:none;}
#backstageArea a:hover {background:[[ColorPalette::SecondaryLight]]; color:[[ColorPalette::Foreground]]; }
#backstageArea a.backstageSelTab {background:[[ColorPalette::Background]]; color:[[ColorPalette::Foreground]];}
#backstageButton a {background:none; color:[[ColorPalette::Background]]; border:none;}
#backstageButton a:hover {background:[[ColorPalette::Foreground]]; color:[[ColorPalette::Background]]; border:none;}
#backstagePanel {background:[[ColorPalette::Background]]; border-color: [[ColorPalette::Background]] [[ColorPalette::TertiaryDark]] [[ColorPalette::TertiaryDark]] [[ColorPalette::TertiaryDark]];}
.backstagePanelFooter .button {border:none; color:[[ColorPalette::Background]];}
.backstagePanelFooter .button:hover {color:[[ColorPalette::Foreground]];}
#backstageCloak {background:[[ColorPalette::Foreground]]; opacity:0.6; filter:'alpha(opacity:60)';}
/*}}}*/</pre>
</div>
<div title="StyleSheetLayout">
<pre>/*{{{*/
* html .tiddler {height:1%;}

body {font-size:.75em; font-family:arial,helvetica; margin:0; padding:0;}

h1,h2,h3,h4,h5,h6 {font-weight:bold; text-decoration:none;}
h1,h2,h3 {padding-bottom:1px; margin-top:1.2em;margin-bottom:0.3em;}
h4,h5,h6 {margin-top:1em;}
h1 {font-size:1.35em;}
h2 {font-size:1.25em;}
h3 {font-size:1.1em;}
h4 {font-size:1em;}
h5 {font-size:.9em;}

hr {height:1px;}

a {text-decoration:none;}

dt {font-weight:bold;}

ol {list-style-type:decimal;}
ol ol {list-style-type:lower-alpha;}
ol ol ol {list-style-type:lower-roman;}
ol ol ol ol {list-style-type:decimal;}
ol ol ol ol ol {list-style-type:lower-alpha;}
ol ol ol ol ol ol {list-style-type:lower-roman;}
ol ol ol ol ol ol ol {list-style-type:decimal;}

.txtOptionInput {width:11em;}

#contentWrapper .chkOptionInput {border:0;}

.externalLink {text-decoration:underline;}

.indent {margin-left:3em;}
.outdent {margin-left:3em; text-indent:-3em;}
code.escaped {white-space:nowrap;}

.tiddlyLinkExisting {font-weight:bold;}
.tiddlyLinkNonExisting {font-style:italic;}

/* the 'a' is required for IE, otherwise it renders the whole tiddler in bold */
a.tiddlyLinkNonExisting.shadow {font-weight:bold;}

#mainMenu .tiddlyLinkExisting,
	#mainMenu .tiddlyLinkNonExisting,
	#sidebarTabs .tiddlyLinkNonExisting {font-weight:normal; font-style:normal;}
#sidebarTabs .tiddlyLinkExisting {font-weight:bold; font-style:normal;}

.header {position:relative;}
.header a:hover {background:transparent;}
.headerShadow {position:relative; padding:4.5em 0em 1em 1em; left:-1px; top:-1px;}
.headerForeground {position:absolute; padding:4.5em 0em 1em 1em; left:0px; top:0px;}

.siteTitle {font-size:3em;}
.siteSubtitle {font-size:1.2em;}

#mainMenu {position:absolute; left:0; width:10em; text-align:right; line-height:1.6em; padding:1.5em 0.5em 0.5em 0.5em; font-size:1.1em;}

#sidebar {position:absolute; right:3px; width:16em; font-size:.9em;}
#sidebarOptions {padding-top:0.3em;}
#sidebarOptions a {margin:0em 0.2em; padding:0.2em 0.3em; display:block;}
#sidebarOptions input {margin:0.4em 0.5em;}
#sidebarOptions .sliderPanel {margin-left:1em; padding:0.5em; font-size:.85em;}
#sidebarOptions .sliderPanel a {font-weight:bold; display:inline; padding:0;}
#sidebarOptions .sliderPanel input {margin:0 0 .3em 0;}
#sidebarTabs .tabContents {width:15em; overflow:hidden;}

.wizard {padding:0.1em 1em 0em 2em;}
.wizard h1 {font-size:2em; font-weight:bold; background:none; padding:0em 0em 0em 0em; margin:0.4em 0em 0.2em 0em;}
.wizard h2 {font-size:1.2em; font-weight:bold; background:none; padding:0em 0em 0em 0em; margin:0.4em 0em 0.2em 0em;}
.wizardStep {padding:1em 1em 1em 1em;}
.wizard .button {margin:0.5em 0em 0em 0em; font-size:1.2em;}
.wizardFooter {padding:0.8em 0.4em 0.8em 0em;}
.wizardFooter .status {padding:0em 0.4em 0em 0.4em; margin-left:1em;}
.wizard .button {padding:0.1em 0.2em 0.1em 0.2em;}

#messageArea {position:fixed; top:2em; right:0em; margin:0.5em; padding:0.5em; z-index:2000; _position:absolute;}
.messageToolbar {display:block; text-align:right; padding:0.2em 0.2em 0.2em 0.2em;}
#messageArea a {text-decoration:underline;}

.tiddlerPopupButton {padding:0.2em 0.2em 0.2em 0.2em;}
.popupTiddler {position: absolute; z-index:300; padding:1em 1em 1em 1em; margin:0;}

.popup {position:absolute; z-index:300; font-size:.9em; padding:0; list-style:none; margin:0;}
.popup .popupMessage {padding:0.4em;}
.popup hr {display:block; height:1px; width:auto; padding:0; margin:0.2em 0em;}
.popup li.disabled {padding:0.4em;}
.popup li a {display:block; padding:0.4em; font-weight:normal; cursor:pointer;}
.listBreak {font-size:1px; line-height:1px;}
.listBreak div {margin:2px 0;}

.tabset {padding:1em 0em 0em 0.5em;}
.tab {margin:0em 0em 0em 0.25em; padding:2px;}
.tabContents {padding:0.5em;}
.tabContents ul, .tabContents ol {margin:0; padding:0;}
.txtMainTab .tabContents li {list-style:none;}
.tabContents li.listLink { margin-left:.75em;}

#contentWrapper {display:block;}
#splashScreen {display:none;}

#displayArea {margin:1em 17em 0em 14em;}

.toolbar {text-align:right; font-size:.9em;}

.tiddler {padding:1em 1em 0em 1em;}

.missing .viewer,.missing .title {font-style:italic;}

.title {font-size:1.6em; font-weight:bold;}

.missing .subtitle {display:none;}
.subtitle {font-size:1.1em;}

.tiddler .button {padding:0.2em 0.4em;}

.tagging {margin:0.5em 0.5em 0.5em 0; float:left; display:none;}
.isTag .tagging {display:block;}
.tagged {margin:0.5em; float:right;}
.tagging, .tagged {font-size:0.9em; padding:0.25em;}
.tagging ul, .tagged ul {list-style:none; margin:0.25em; padding:0;}
.tagClear {clear:both;}

.footer {font-size:.9em;}
.footer li {display:inline;}

.annotation {padding:0.5em; margin:0.5em;}

* html .viewer pre {width:99%; padding:0 0 1em 0;}
.viewer {line-height:1.4em; padding-top:0.5em;}
.viewer .button {margin:0em 0.25em; padding:0em 0.25em;}
.viewer blockquote {line-height:1.5em; padding-left:0.8em;margin-left:2.5em;}
.viewer ul, .viewer ol {margin-left:0.5em; padding-left:1.5em;}

.viewer table, table.twtable {border-collapse:collapse; margin:0.8em 1.0em;}
.viewer th, .viewer td, .viewer tr,.viewer caption,.twtable th, .twtable td, .twtable tr,.twtable caption {padding:3px;}
table.listView {font-size:0.85em; margin:0.8em 1.0em;}
table.listView th, table.listView td, table.listView tr {padding:0px 3px 0px 3px;}

.viewer pre {padding:0.5em; margin-left:0.5em; font-size:1.2em; line-height:1.4em; overflow:auto;}
.viewer code {font-size:1.2em; line-height:1.4em;}

.editor {font-size:1.1em;}
.editor input, .editor textarea {display:block; width:100%; font:inherit;}
.editorFooter {padding:0.25em 0em; font-size:.9em;}
.editorFooter .button {padding-top:0px; padding-bottom:0px;}

.fieldsetFix {border:0; padding:0; margin:1px 0px 1px 0px;}

.sparkline {line-height:1em;}
.sparktick {outline:0;}

.zoomer {font-size:1.1em; position:absolute; overflow:hidden;}
.zoomer div {padding:1em;}

* html #backstage {width:99%;}
* html #backstageArea {width:99%;}
#backstageArea {display:none; position:relative; overflow: hidden; z-index:150; padding:0.3em 0.5em 0.3em 0.5em;}
#backstageToolbar {position:relative;}
#backstageArea a {font-weight:bold; margin-left:0.5em; padding:0.3em 0.5em 0.3em 0.5em;}
#backstageButton {display:none; position:absolute; z-index:175; top:0em; right:0em;}
#backstageButton a {padding:0.1em 0.4em 0.1em 0.4em; margin:0.1em 0.1em 0.1em 0.1em;}
#backstage {position:relative; width:100%; z-index:50;}
#backstagePanel {display:none; z-index:100; position:absolute; margin:0em 3em 0em 3em; padding:1em 1em 1em 1em;}
.backstagePanelFooter {padding-top:0.2em; float:right;}
.backstagePanelFooter a {padding:0.2em 0.4em 0.2em 0.4em;}
#backstageCloak {display:none; z-index:20; position:absolute; width:100%; height:100px;}

.whenBackstage {display:none;}
.backstageVisible .whenBackstage {display:block;}
/*}}}*/</pre>
</div>
<div title="StyleSheetLocale">
<pre>/***
StyleSheet for use when a translation requires any css style changes.
This StyleSheet can be used directly by languages such as Chinese, Japanese and Korean which need larger font sizes.
***/
/*{{{*/
body {font-size:0.8em;}
#sidebarOptions {font-size:1.05em;}
#sidebarOptions a {font-style:normal;}
#sidebarOptions .sliderPanel {font-size:0.95em;}
.subtitle {font-size:0.8em;}
.viewer table.listView {font-size:0.95em;}
/*}}}*/</pre>
</div>
<div title="StyleSheetPrint">
<pre>/*{{{*/
@media print {
#mainMenu, #sidebar, #messageArea, .toolbar, #backstageButton, #backstageArea {display: none ! important;}
#displayArea {margin: 1em 1em 0em 1em;}
/* Fixes a feature in Firefox 1.5.0.2 where print preview displays the noscript content */
noscript {display:none;}
}
/*}}}*/</pre>
</div>
<div title="PageTemplate">
<pre>&lt;!--{{{--&gt;
&lt;div class='header' macro='gradient vert [[ColorPalette::PrimaryLight]] [[ColorPalette::PrimaryMid]]'&gt;
&lt;div class='headerShadow'&gt;
&lt;span class='siteTitle' refresh='content' tiddler='SiteTitle'&gt;&lt;/span&gt;&amp;nbsp;
&lt;span class='siteSubtitle' refresh='content' tiddler='SiteSubtitle'&gt;&lt;/span&gt;
&lt;/div&gt;
&lt;div class='headerForeground'&gt;
&lt;span class='siteTitle' refresh='content' tiddler='SiteTitle'&gt;&lt;/span&gt;&amp;nbsp;
&lt;span class='siteSubtitle' refresh='content' tiddler='SiteSubtitle'&gt;&lt;/span&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id='mainMenu' refresh='content' tiddler='MainMenu'&gt;&lt;/div&gt;
&lt;div id='sidebar'&gt;
&lt;div id='sidebarOptions' refresh='content' tiddler='SideBarOptions'&gt;&lt;/div&gt;
&lt;div id='sidebarTabs' refresh='content' force='true' tiddler='SideBarTabs'&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;div id='displayArea'&gt;
&lt;div id='messageArea'&gt;&lt;/div&gt;
&lt;div id='tiddlerDisplay'&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;!--}}}--&gt;</pre>
</div>
<div title="ViewTemplate">
<pre>&lt;!--{{{--&gt;
&lt;div class='toolbar' macro='toolbar closeTiddler closeOthers +editTiddler &gt; fields syncing permalink references jump'&gt;&lt;/div&gt;
&lt;div class='title' macro='view title'&gt;&lt;/div&gt;
&lt;div class='subtitle'&gt;&lt;span macro='view modifier link'&gt;&lt;/span&gt;, &lt;span macro='view modified date'&gt;&lt;/span&gt; (&lt;span macro='message views.wikified.createdPrompt'&gt;&lt;/span&gt; &lt;span macro='view created date'&gt;&lt;/span&gt;)&lt;/div&gt;
&lt;div class='tagging' macro='tagging'&gt;&lt;/div&gt;
&lt;div class='tagged' macro='tags'&gt;&lt;/div&gt;
&lt;div class='viewer' macro='view text wikified'&gt;&lt;/div&gt;
&lt;div class='tagClear'&gt;&lt;/div&gt;
&lt;!--}}}--&gt;</pre>
</div>
<div title="EditTemplate">
<pre>&lt;!--{{{--&gt;
&lt;div class='toolbar' macro='toolbar +saveTiddler -cancelTiddler deleteTiddler'&gt;&lt;/div&gt;
&lt;div class='title' macro='view title'&gt;&lt;/div&gt;
&lt;div class='editor' macro='edit title'&gt;&lt;/div&gt;
&lt;div macro='annotations'&gt;&lt;/div&gt;
&lt;div class='editor' macro='edit text'&gt;&lt;/div&gt;
&lt;div class='editor' macro='edit tags'&gt;&lt;/div&gt;&lt;div class='editorFooter'&gt;&lt;span macro='message views.editor.tagPrompt'&gt;&lt;/span&gt;&lt;span macro='tagChooser'&gt;&lt;/span&gt;&lt;/div&gt;
&lt;!--}}}--&gt;</pre>
</div>
<div title="GettingStarted">
<pre>To get started with this blank TiddlyWiki, you'll need to modify the following tiddlers:
* SiteTitle &amp; SiteSubtitle: The title and subtitle of the site, as shown above (after saving, they will also appear in the browser title bar)
* MainMenu: The menu (usually on the left)
* DefaultTiddlers: Contains the names of the tiddlers that you want to appear when the TiddlyWiki is opened
You'll also need to enter your username for signing your edits: &lt;&lt;option txtUserName&gt;&gt;</pre>
</div>
<div title="OptionsPanel">
<pre>These InterfaceOptions for customising TiddlyWiki are saved in your browser

Your username for signing your edits. Write it as a WikiWord (eg JoeBloggs)

&lt;&lt;option txtUserName&gt;&gt;
&lt;&lt;option chkSaveBackups&gt;&gt; SaveBackups
&lt;&lt;option chkAutoSave&gt;&gt; AutoSave
&lt;&lt;option chkRegExpSearch&gt;&gt; RegExpSearch
&lt;&lt;option chkCaseSensitiveSearch&gt;&gt; CaseSensitiveSearch
&lt;&lt;option chkAnimate&gt;&gt; EnableAnimations

----
Also see AdvancedOptions</pre>
</div>
<div title="ImportTiddlers">
<pre>&lt;&lt;importTiddlers&gt;&gt;</pre>
</div>
</div>
<!--POST-SHADOWAREA-->
<div id="storeArea">
<div title="CryptoFunctionsPlugin" created="200710131134" tags="systemConfig excludeLists excludeSearch">
<pre>/***
|''Name:''|CryptoFunctionsPlugin|
|''Description:''|Support for cryptographic functions|
***/
//{{{
if(!version.extensions.CryptoFunctionsPlugin) {
version.extensions.CryptoFunctionsPlugin = {installed:true};

//--
//-- Crypto functions and associated conversion routines
//--

// Crypto &quot;namespace&quot;
function Crypto() {}

// Convert a string to an array of big-endian 32-bit words
Crypto.strToBe32s = function(str)
{
	var be = Array();
	var len = Math.floor(str.length/4);
	var i, j;
	for(i=0, j=0; i&lt;len; i++, j+=4) {
		be[i] = ((str.charCodeAt(j)&amp;0xff) &lt;&lt; 24)|((str.charCodeAt(j+1)&amp;0xff) &lt;&lt; 16)|((str.charCodeAt(j+2)&amp;0xff) &lt;&lt; 8)|(str.charCodeAt(j+3)&amp;0xff);
	}
	while (j&lt;str.length) {
		be[j&gt;&gt;2] |= (str.charCodeAt(j)&amp;0xff)&lt;&lt;(24-(j*8)%32);
		j++;
	}
	return be;
};

// Convert an array of big-endian 32-bit words to a string
Crypto.be32sToStr = function(be)
{
	var str = &quot;&quot;;
	for(var i=0;i&lt;be.length*32;i+=8)
		str += String.fromCharCode((be[i&gt;&gt;5]&gt;&gt;&gt;(24-i%32)) &amp; 0xff);
	return str;
};

// Convert an array of big-endian 32-bit words to a hex string
Crypto.be32sToHex = function(be)
{
	var hex = &quot;0123456789ABCDEF&quot;;
	var str = &quot;&quot;;
	for(var i=0;i&lt;be.length*4;i++)
		str += hex.charAt((be[i&gt;&gt;2]&gt;&gt;((3-i%4)*8+4))&amp;0xF) + hex.charAt((be[i&gt;&gt;2]&gt;&gt;((3-i%4)*8))&amp;0xF);
	return str;
};

// Return, in hex, the SHA-1 hash of a string
Crypto.hexSha1Str = function(str)
{
	return Crypto.be32sToHex(Crypto.sha1Str(str));
};

// Return the SHA-1 hash of a string
Crypto.sha1Str = function(str)
{
	return Crypto.sha1(Crypto.strToBe32s(str),str.length);
};

// Calculate the SHA-1 hash of an array of blen bytes of big-endian 32-bit words
Crypto.sha1 = function(x,blen)
{
	// Add 32-bit integers, wrapping at 32 bits
	add32 = function(a,b)
	{
		var lsw = (a&amp;0xFFFF)+(b&amp;0xFFFF);
		var msw = (a&gt;&gt;16)+(b&gt;&gt;16)+(lsw&gt;&gt;16);
		return (msw&lt;&lt;16)|(lsw&amp;0xFFFF);
	};
	// Add five 32-bit integers, wrapping at 32 bits
	add32x5 = function(a,b,c,d,e)
	{
		var lsw = (a&amp;0xFFFF)+(b&amp;0xFFFF)+(c&amp;0xFFFF)+(d&amp;0xFFFF)+(e&amp;0xFFFF);
		var msw = (a&gt;&gt;16)+(b&gt;&gt;16)+(c&gt;&gt;16)+(d&gt;&gt;16)+(e&gt;&gt;16)+(lsw&gt;&gt;16);
		return (msw&lt;&lt;16)|(lsw&amp;0xFFFF);
	};
	// Bitwise rotate left a 32-bit integer by 1 bit
	rol32 = function(n)
	{
		return (n&gt;&gt;&gt;31)|(n&lt;&lt;1);
	};

	var len = blen*8;
	// Append padding so length in bits is 448 mod 512
	x[len&gt;&gt;5] |= 0x80 &lt;&lt; (24-len%32);
	// Append length
	x[((len+64&gt;&gt;9)&lt;&lt;4)+15] = len;
	var w = Array(80);

	var k1 = 0x5A827999;
	var k2 = 0x6ED9EBA1;
	var k3 = 0x8F1BBCDC;
	var k4 = 0xCA62C1D6;

	var h0 = 0x67452301;
	var h1 = 0xEFCDAB89;
	var h2 = 0x98BADCFE;
	var h3 = 0x10325476;
	var h4 = 0xC3D2E1F0;

	for(var i=0;i&lt;x.length;i+=16) {
		var j,t;
		var a = h0;
		var b = h1;
		var c = h2;
		var d = h3;
		var e = h4;
		for(j = 0;j&lt;16;j++) {
			w[j] = x[i+j];
			t = add32x5(e,(a&gt;&gt;&gt;27)|(a&lt;&lt;5),d^(b&amp;(c^d)),w[j],k1);
			e=d; d=c; c=(b&gt;&gt;&gt;2)|(b&lt;&lt;30); b=a; a = t;
		}
		for(j=16;j&lt;20;j++) {
			w[j] = rol32(w[j-3]^w[j-8]^w[j-14]^w[j-16]);
			t = add32x5(e,(a&gt;&gt;&gt;27)|(a&lt;&lt;5),d^(b&amp;(c^d)),w[j],k1);
			e=d; d=c; c=(b&gt;&gt;&gt;2)|(b&lt;&lt;30); b=a; a = t;
		}
		for(j=20;j&lt;40;j++) {
			w[j] = rol32(w[j-3]^w[j-8]^w[j-14]^w[j-16]);
			t = add32x5(e,(a&gt;&gt;&gt;27)|(a&lt;&lt;5),b^c^d,w[j],k2);
			e=d; d=c; c=(b&gt;&gt;&gt;2)|(b&lt;&lt;30); b=a; a = t;
		}
		for(j=40;j&lt;60;j++) {
			w[j] = rol32(w[j-3]^w[j-8]^w[j-14]^w[j-16]);
			t = add32x5(e,(a&gt;&gt;&gt;27)|(a&lt;&lt;5),(b&amp;c)|(d&amp;(b|c)),w[j],k3);
			e=d; d=c; c=(b&gt;&gt;&gt;2)|(b&lt;&lt;30); b=a; a = t;
		}
		for(j=60;j&lt;80;j++) {
			w[j] = rol32(w[j-3]^w[j-8]^w[j-14]^w[j-16]);
			t = add32x5(e,(a&gt;&gt;&gt;27)|(a&lt;&lt;5),b^c^d,w[j],k4);
			e=d; d=c; c=(b&gt;&gt;&gt;2)|(b&lt;&lt;30); b=a; a = t;
		}

		h0 = add32(h0,a);
		h1 = add32(h1,b);
		h2 = add32(h2,c);
		h3 = add32(h3,d);
		h4 = add32(h4,e);
	}
	return Array(h0,h1,h2,h3,h4);
};


}
//}}}</pre>
</div>
<div title="DeprecatedFunctionsPlugin" created="200710140259" tags="systemConfig excludeLists excludeSearch">
<pre>/***
|''Name:''|DeprecatedFunctionsPlugin|
|''Description:''|Support for deprecated functions removed from core|
***/
//{{{
if(!version.extensions.DeprecatedFunctionsPlugin) {
version.extensions.DeprecatedFunctionsPlugin = {installed:true};

//--
//-- Deprecated code
//--

// @Deprecated: Use createElementAndWikify and this.termRegExp instead
config.formatterHelpers.charFormatHelper = function(w)
{
	w.subWikify(createTiddlyElement(w.output,this.element),this.terminator);
};

// @Deprecated: Use enclosedTextHelper and this.lookaheadRegExp instead
config.formatterHelpers.monospacedByLineHelper = function(w)
{
	var lookaheadRegExp = new RegExp(this.lookahead,&quot;mg&quot;);
	lookaheadRegExp.lastIndex = w.matchStart;
	var lookaheadMatch = lookaheadRegExp.exec(w.source);
	if(lookaheadMatch &amp;&amp; lookaheadMatch.index == w.matchStart) {
		var text = lookaheadMatch[1];
		if(config.browser.isIE)
			text = text.replace(/\n/g,&quot;\r&quot;);
		createTiddlyElement(w.output,&quot;pre&quot;,null,null,text);
		w.nextMatch = lookaheadRegExp.lastIndex;
	}
};

// @Deprecated: Use &lt;br&gt; or &lt;br /&gt; instead of &lt;&lt;br&gt;&gt;
config.macros.br = {};
config.macros.br.handler = function(place)
{
	createTiddlyElement(place,&quot;br&quot;);
};

// Find an entry in an array. Returns the array index or null
// @Deprecated: Use indexOf instead
Array.prototype.find = function(item)
{
	var i = this.indexOf(item);
	return i == -1 ? null : i;
};

// Load a tiddler from an HTML DIV. The caller should make sure to later call Tiddler.changed()
// @Deprecated: Use store.getLoader().internalizeTiddler instead
Tiddler.prototype.loadFromDiv = function(divRef,title)
{
	return store.getLoader().internalizeTiddler(store,this,title,divRef);
};

// Format the text for storage in an HTML DIV
// @Deprecated Use store.getSaver().externalizeTiddler instead.
Tiddler.prototype.saveToDiv = function()
{
	return store.getSaver().externalizeTiddler(store,this);
};

// @Deprecated: Use store.allTiddlersAsHtml() instead
function allTiddlersAsHtml()
{
	return store.allTiddlersAsHtml();
}

// @Deprecated: Use refreshPageTemplate instead
function applyPageTemplate(title)
{
	refreshPageTemplate(title);
}

// @Deprecated: Use story.displayTiddlers instead
function displayTiddlers(srcElement,titles,template,unused1,unused2,animate,unused3)
{
	story.displayTiddlers(srcElement,titles,template,animate);
}

// @Deprecated: Use story.displayTiddler instead
function displayTiddler(srcElement,title,template,unused1,unused2,animate,unused3)
{
	story.displayTiddler(srcElement,title,template,animate);
}

// @Deprecated: Use functions on right hand side directly instead
var createTiddlerPopup = Popup.create;
var scrollToTiddlerPopup = Popup.show;
var hideTiddlerPopup = Popup.remove;

// @Deprecated: Use right hand side directly instead
var regexpBackSlashEn = new RegExp(&quot;\\\\n&quot;,&quot;mg&quot;);
var regexpBackSlash = new RegExp(&quot;\\\\&quot;,&quot;mg&quot;);
var regexpBackSlashEss = new RegExp(&quot;\\\\s&quot;,&quot;mg&quot;);
var regexpNewLine = new RegExp(&quot;\n&quot;,&quot;mg&quot;);
var regexpCarriageReturn = new RegExp(&quot;\r&quot;,&quot;mg&quot;);

}
//}}}</pre>
</div>
<div title="goto-considered-useful" modifier="Sitaram" created="200903241920">
<pre>
&lt;html&gt;
&lt;h1&gt;&lt;a name=&quot;_GOTO_considered_useful_&quot;&gt;&lt;code&gt;GOTO&lt;/code&gt; considered useful!!&lt;/a&gt;&lt;/h1&gt;

&lt;p&gt;&lt;sup&gt;(Far be it from me to go head to head against
&lt;a href=&quot;http://www.acm.org/classics/oct95/&quot;&gt;Prof. Dijkstra&lt;/a&gt; but when I sent this to
Stijn (who maintains &lt;a href=&quot;http://micans.org/apparix/&quot;&gt;apparix&lt;/a&gt;), he came up with
this very cute title, which I promptly stole!)&lt;/sup&gt;&lt;/p&gt;

&lt;p&gt;Despite the title, this is nothing to do with programming, structured or
otherwise :-)&lt;/p&gt;

&lt;p&gt;This is all about supplementing the lowly &lt;code&gt;cd&lt;/code&gt; command with some extra punch
for those of us who spend a lot of time at the Linux command line working with
files in various directories.  Even with &lt;em&gt;bash completion&lt;/em&gt;, typing out long
directory paths is a chore that kills productivity.&lt;/p&gt;

&lt;hr /&gt;

&lt;p&gt;&lt;sup&gt;This document has the following sections:&lt;/p&gt;

&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#_GOTO_considered_useful_&quot;&gt;&lt;code&gt;GOTO&lt;/code&gt; considered useful!!&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#First_a_word_about_apparix_&quot;&gt;First, a word about &lt;code&gt;apparix&lt;/code&gt;&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#What_is_goto_and_where_do_I_get_it_&quot;&gt;What is &lt;code&gt;goto&lt;/code&gt; and where do I get it?&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#Features_and_uses&quot;&gt;Features and uses&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#Dependencies_Caveats&quot;&gt;Dependencies/Caveats&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#Usage_messages&quot;&gt;Usage messages&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#Examples&quot;&gt;Examples&lt;/a&gt;&lt;br&gt;
&lt;/sup&gt;&lt;/p&gt;

&lt;h3&gt;&lt;a name=&quot;First_a_word_about_apparix_&quot;&gt;First, a word about &lt;code&gt;apparix&lt;/code&gt;&lt;/a&gt;&lt;/h3&gt;

&lt;p&gt;Like in almost all things in this world, the
&lt;a href=&quot;http://en.wikipedia.org/wiki/Pareto_principle&quot;&gt;80-20 rule&lt;/a&gt; applies.  For the
20% of directories in which you spend 80% of your time, use the
afore-mentioned &lt;a href=&quot;http://micans.org/apparix/&quot;&gt;apparix&lt;/a&gt;.  For those cases,
there&#39;s no substitute for the speed with which apparix works, the ability to
set short names as bookmarks and to just say&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;to wh
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;instead of&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;cd /var/www/homepages/sitaram
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;The fact that setting bookmarks is just as easy also helps:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;cd /home/sitaram/workdata/mindmaps
bm mm
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;code&gt;bm&lt;/code&gt; and &lt;code&gt;to&lt;/code&gt; are bash aliases that come with apparix.  &lt;code&gt;bm&lt;/code&gt; stands
for &lt;em&gt;bookmark&lt;/em&gt;.&lt;/p&gt;

&lt;h3&gt;&lt;a name=&quot;What_is_goto_and_where_do_I_get_it_&quot;&gt;What is &lt;code&gt;goto&lt;/code&gt; and where do I get it?&lt;/a&gt;&lt;/h3&gt;

&lt;p&gt;For the other 80% directories where you spend 20% of the time, (and very
cleverly, this can also be construed to mean &quot;directories on other machines
where you don&#39;t spend much time or you don&#39;t want to install &lt;em&gt;apparix&lt;/em&gt;&quot;!),
use &lt;code&gt;goto&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;Get it from &lt;a href=&quot;bashrc.goto&quot;&gt;here&lt;/a&gt; and include it in your normal &lt;code&gt;.bashrc&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;You get three bash functions: &lt;code&gt;goto&lt;/code&gt;, &lt;code&gt;fgoto&lt;/code&gt;, and &lt;code&gt;goto_range&lt;/code&gt;.
All of them will respond with a nice usage message if you give &lt;code&gt;-h&lt;/code&gt; as the
argument.  Note that &lt;code&gt;fgoto&lt;/code&gt; is really &lt;code&gt;goto&lt;/code&gt; in disguise, but the
argument is considered to be a file name pattern rather than a directory name
pattern.&lt;/p&gt;

&lt;h3&gt;&lt;a name=&quot;Features_and_uses&quot;&gt;Features and uses&lt;/a&gt;&lt;/h3&gt;

&lt;h5&gt;&quot;Bang for the buck&quot;&lt;/h5&gt;

&lt;p&gt;&lt;code&gt;goto&lt;/code&gt; allows you to get some pretty major productivity gains very
quickly, without having to install any software.&lt;/p&gt;

&lt;h5&gt;Exploring the file system made easy&lt;/h5&gt;

&lt;p&gt;&lt;code&gt;goto&lt;/code&gt; and &lt;code&gt;fgoto&lt;/code&gt; make it easy to explore the filesystem looking for
stuff whose location you only vaguely remember or guess.&lt;/p&gt;

&lt;p&gt;Also, &lt;code&gt;fgoto&lt;/code&gt;&#39;s ability to jump into a directory based on giving a
&lt;strong&gt;filename&lt;/strong&gt; (as opposed to a &lt;strong&gt;directory name&lt;/strong&gt;) is unique.  [If you know of
other tools which do this, please let me know and I will be happy to
acknowledge them; I haven&#39;t heard of any so far.]&lt;/p&gt;

&lt;p&gt;When you know a good part of the file name, but are not sure where it lives,
try fgoto.  You&#39;ll be surprised!&lt;/p&gt;

&lt;h5&gt;Quickly set a range for the searches&lt;/h5&gt;

&lt;p&gt;Sometimes &quot;goto&quot; returns results from directories you don&#39;t care about, and
you want to restrict the searches to a set of directories only.  And sometimes
it&#39;s the opposite -- you want the results coming from anywhere &lt;em&gt;except&lt;/em&gt; a
certain set of directories.&lt;/p&gt;

&lt;p&gt;Use the &lt;code&gt;goto_range&lt;/code&gt; command for all this.  The &lt;code&gt;-h&lt;/code&gt; option shows you
a pretty good help message.&lt;/p&gt;

&lt;p&gt;This can be very useful sometimes.  Ever inherited a whole bunch of files from
someone else?  Or downloaded a large-ish source tree with many directories and
wanted to quickly jump around &lt;strong&gt;just within&lt;/strong&gt; that, looking for files and
directories?&lt;/p&gt;

&lt;h5&gt;Even more quickly set a &lt;em&gt;temporary&lt;/em&gt; range&lt;/h5&gt;

&lt;p&gt;Use &lt;code&gt;goto . some_dir_pattern&lt;/code&gt; or &lt;code&gt;fgoto . some_file_pattern&lt;/code&gt; to
temporarily set the search range to the current directory before doing the
goto/fgoto.  When invoked this way, the current search range and all related
settings are ignored.&lt;/p&gt;

&lt;p&gt;In place of &lt;code&gt;.&lt;/code&gt; (dot) above, you can use &lt;code&gt;..&lt;/code&gt;, &lt;code&gt;~&lt;/code&gt;, or indeed any
valid directory name, and you&#39;ll get matches only within that directory.&lt;/p&gt;

&lt;h3&gt;&lt;a name=&quot;Dependencies_Caveats&quot;&gt;Dependencies/Caveats&lt;/a&gt;&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;All this is from a Linux perspective.  It &lt;em&gt;may&lt;/em&gt; work on other Unixes
also, but my DG-UX, HP-UX, AIX, DEC Ultrix, Solaris, days are long gone.
If your Unix has something like Linux&#39;s &lt;em&gt;locate database&lt;/em&gt;, and bash, it
should work with a small change here and there.  The &lt;em&gt;korn shell&lt;/em&gt; I knew
ten years ago certainly would not have been able to do this, but I know
&lt;em&gt;ksh&lt;/em&gt; has changed a lot, so maybe that&#39;ll work too.  I wouldn&#39;t know.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;I assume your locate database is uptodate.  If your Linux is reasonably
recent and it runs continuously, the system cron is probably running
&lt;code&gt;updatedb&lt;/code&gt; nightly, so you&#39;re OK.  Otherwise you may have to run it
manually once in a while.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;If you don&#39;t have a locate db at all, and you choose a range limited
search, &lt;code&gt;goto&lt;/code&gt; and friends will happily use &lt;code&gt;find&lt;/code&gt;.  When the
directory in your range limit is not huge, this is often fast enough.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;If you don&#39;t use &lt;em&gt;bash&lt;/em&gt;, sorry.  Translations to &lt;em&gt;zsh&lt;/em&gt;, &lt;em&gt;tcsh&lt;/em&gt; etc.,
are welcome.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h3&gt;&lt;a name=&quot;Usage_messages&quot;&gt;Usage messages&lt;/a&gt;&lt;/h3&gt;

&lt;p&gt;If you&#39;re curious, here&#39;re examples of the usage messages of the two functions
&lt;code&gt;goto&lt;/code&gt; and &lt;code&gt;goto_range&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;goto&lt;/strong&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;[sitaram@home ~]$ goto -h
Usage: goto dir_pattern
       fgoto file_pattern

Uses the locate database to find a directory (i) matching the dir_pattern OR
(ii) containing a file matching the file_pattern

The patterns use locate&#39;s &quot;-r&quot; option, except that we&#39;re only interested in
matching the last component of each candidate path.

argument        matches what part of last path component?
------------    -----------------------------------------
path            anywhere
/path           starts with
path$           ends with
/path$          exact

IMPORTANT: You can restrict the search to one or more directories.  Run
&quot;goto_range -h&quot; to learn how to use the search range effectively.

SHORTCUT: &quot;goto . pattern&quot; or &quot;fgoto . pattern&quot; TEMPORARILY sets the search
range to the current directory and then does the goto/fgoto, REGARDLESS of
what the current range settings are!  You can do this with any directory
instead of &quot;.&quot; -- I usually do this to &quot;.&quot;, &quot;..&quot;, &quot;~&quot;, &quot;/var&quot; etc., as needed.
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;strong&gt;goto_range&lt;/strong&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;[sitaram@home ~]$ goto_range -h
Usage: goto_range s|a|l|u|e|i

Sometimes &quot;goto&quot; returns results from directories you don&#39;t care about, and
you want to restrict the searches to a set of directories only

  s = SET the current directory as the search range
  a = ADD the current directory to the search range

  l = LIMIT searches to the search range
      the search range is set to the current directory if it is undefined
      using the &quot;s&quot; or the &quot;a&quot; option automatically sets this also
  u = UNlimited; use the entire locate database
      the search range is not used even if it is defined
      this is the default behaviour

Sometimes you want to say &quot;search everywhere except in these directories&quot;

  e = EXCLUDE directories; search everywhere EXCEPT in search range
  i = INCLUDE directories; search only in search range
      this is the default behaviour
&lt;/code&gt;&lt;/pre&gt;

&lt;h3&gt;&lt;a name=&quot;Examples&quot;&gt;Examples&lt;/a&gt;&lt;/h3&gt;

&lt;p&gt;Here&#39;s how a few typical interactions might look like:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;[sitaram@home ~]$ goto 6-misc-set2
/home/sitaram/save/pictures/mine/2006-misc-set2

[sitaram@home ~]$ fgoto img_2178
/home/sitaram/save/pictures/mine/2006-misc-set2

[sitaram@home ~]$ fgoto img_1878
 1) /home/sitaram/save/pictures/mine/2005-friends
 2) /home/sitaram/save/pictures/mine/2005-ganesh
#? 2
/home/sitaram/save/pictures/mine/2005-ganesh
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Here&#39;s an example where it found multiple matches:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;[sitaram@home ~]$ goto misc-set
1) /home/sitaram/save/pictures/mine/2006-misc-set1  5) /home/sitaram/save/pictures/mine/2005-misc-set2
2) /home/sitaram/save/pictures/mine/2006-misc-set2  6) /home/sitaram/save/pictures/mine/2005-misc-set3
3) /home/sitaram/save/pictures/mine/2006-misc-set3  7) /home/sitaram/save/pictures/mine/2005-misc-set4
4) /home/sitaram/save/pictures/mine/2005-misc-set1
#? 3
/home/sitaram/save/pictures/mine/2006-misc-set3
[sitaram@home 2006-misc-set3]$
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Here&#39;s another example where it found multiple matches:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;[sitaram@home ~]$ goto security
 1) /home/sitaram/imli/files-pers/blog/blosxom-stuff/blosxom/software/security
 2) /home/sitaram/.local/share/applications/Mandrakelinux/System/Configuration/KDE/Security
 3) /etc/security
 4) /var/lib/menu-xdg/applications/Mandrakelinux/System/Configuration/KDE/Security
 5) /var/lib/menu-xdg/simplified/applications/Mandrakelinux/AdministerYourSystem/UseMoreAdministrationTools/Configuration/KDE/Security
 6) /var/log/security
 7) /usr/share/doc/HOWTO/HTML/en/Security
 8) /usr/share/doc/HOWTO/HTML/en/Security-Quickstart
 9) /usr/share/doc/HOWTO/HTML/en/Security-Quickstart-Redhat
10) /usr/share/ri/1.8/system/SecurityError
11) /usr/lib/libDrakX/security
12) /usr/lib/nvu-1.0/chrome/en-US/locale/global/security
#? ^C
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Oops -- too many matches, and from too many different places.  I want to
restrict the match to just the home directory.  The long way is to use the
&lt;code&gt;goto_range&lt;/code&gt; command to set a range and then use the goto.  The quick way
is to just add a valid directory name (in this case just &lt;code&gt;~&lt;/code&gt;) as the first
argument.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;[sitaram@home ~]$ goto ~ security
range status: goto is currently limited
the range is defined to be
        ^/home/sitaram
run &quot;goto_range -h&quot; for usage

search range:   ^/home/sitaram
1) /home/sitaram/imli/files-pers/blog/blosxom-stuff/blosxom/software/security
2) /home/sitaram/.local/share/applications/Mandrakelinux/System/Configuration/KDE/Security
#? 1
/home/sitaram/imli/files-pers/blog/blosxom-stuff/blosxom/software/security
[sitaram@home security]$
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Remember: any valid directory is good for this trick, so the most common
examples are things like are &lt;code&gt;.&lt;/code&gt;, &lt;code&gt;..&lt;/code&gt;, &lt;code&gt;/etc&lt;/code&gt;, &lt;code&gt;/var/www&lt;/code&gt;,
etc.&lt;/p&gt;
&lt;/html&gt;
</pre>
</div>
<div title="map-as-xargs-replacement" modifier="Sitaram" created="200903241920">
<pre>
&lt;html&gt;
&lt;h1&gt;&lt;a name=&quot;_map_a_simpler_replacement_for_xargs&quot;&gt;&lt;code&gt;map&lt;/code&gt; -- a simpler replacement for xargs&lt;/a&gt;&lt;/h1&gt;

&lt;p&gt;&lt;code&gt;map&lt;/code&gt; can replace xargs for most purposes as well as replace many &lt;code&gt;for&lt;/code&gt;
loops in shell.  Download it &lt;a href=&quot;map&quot;&gt;here&lt;/a&gt;.&lt;/p&gt;

&lt;hr /&gt;

&lt;p&gt;&lt;sup&gt;This document has the following sections:&lt;/p&gt;

&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#_map_a_simpler_replacement_for_xargs&quot;&gt;&lt;code&gt;map&lt;/code&gt; -- a simpler replacement for xargs&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#A_gradual_build_up_of_map_s_features&quot;&gt;A gradual build up of &lt;code&gt;map&lt;/code&gt;&#39;s features&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#Simple_Example&quot;&gt;Simple Example&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#Argument_in_the_middle_not_at_the_end_&quot;&gt;Argument in the middle, not at the end!&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#4_types_of_placeholders_not_just_&quot;&gt;4 types of placeholders, not just &lt;code&gt;{&lt;/code&gt;}&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#Efficiency_the_x_flag&quot;&gt;Efficiency -- the &lt;code&gt;-x&lt;/code&gt; flag&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#Arguments_from_the_command_line_instead_of_STDIN&quot;&gt;Arguments from the command line instead of STDIN&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#Replace_for_loops_also&quot;&gt;Replace &lt;code&gt;for&lt;/code&gt; loops also&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#_Dry_run_a_complex_command_with_the_n_option&quot;&gt;&quot;Dry run&quot; a complex command with the &lt;code&gt;-n&lt;/code&gt; option&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#More_complex_examples&quot;&gt;More complex examples&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#Usage_message&quot;&gt;Usage message&lt;/a&gt;&lt;br&gt;
&lt;/sup&gt;&lt;/p&gt;

&lt;h2&gt;&lt;a name=&quot;A_gradual_build_up_of_map_s_features&quot;&gt;A gradual build up of &lt;code&gt;map&lt;/code&gt;&#39;s features&lt;/a&gt;&lt;/h2&gt;

&lt;h3&gt;&lt;a name=&quot;Simple_Example&quot;&gt;Simple Example&lt;/a&gt;&lt;/h3&gt;

&lt;p&gt;If you already know &lt;code&gt;xargs&lt;/code&gt;, and have often used &lt;code&gt;xargs&lt;/code&gt; to process
lists of files, especially with files containing spaces in their names, you
will appreciate &lt;code&gt;map&lt;/code&gt; for getting rid of the need to use &lt;code&gt;-print0&lt;/code&gt; on
the &lt;code&gt;find&lt;/code&gt; command followed by the &lt;code&gt;-0&lt;/code&gt; argument to xargs.  Each
filename is assumed to be on a separate line, as far as &lt;code&gt;map&lt;/code&gt; is
concerned.&lt;/p&gt;

&lt;p&gt;[Of course, if some pathological idiot embeds a new-line into a file name, he
should be taken out and shot.  Come to think of it, we should do that to
people who embed spaces in filenames also but that would be genocide!]&lt;/p&gt;

&lt;p&gt;So,&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;find . -type f -name &quot;*somepattern*&quot; -print0 | xargs -0 some.command
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;becomes&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;find . -type f -name &quot;*somepattern*&quot;         | map some.command
&lt;/code&gt;&lt;/pre&gt;

&lt;h3&gt;&lt;a name=&quot;Argument_in_the_middle_not_at_the_end_&quot;&gt;Argument in the middle, not at the end!&lt;/a&gt;&lt;/h3&gt;

&lt;p&gt;&lt;code&gt;xargs&lt;/code&gt; is horrible at commands where the argument should be in the
middle, like say a copy command:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;find ..blah-blah.. | xargs cp &#39;{}&#39; destination  # DOESNT WORK!
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;With &lt;code&gt;map&lt;/code&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;find ..blah-blah.. | map cp %F destination
&lt;/code&gt;&lt;/pre&gt;

&lt;h3&gt;&lt;a name=&quot;4_types_of_placeholders_not_just_&quot;&gt;4 types of placeholders, not just &lt;code&gt;{&lt;/code&gt;}&lt;/a&gt;&lt;/h3&gt;

&lt;p&gt;See that &lt;code&gt;%F&lt;/code&gt;?  That stands for the full file name.  See the usage message at
the bottom of this help file for the other 3 varieties!&lt;/p&gt;

&lt;h3&gt;&lt;a name=&quot;Efficiency_the_x_flag&quot;&gt;Efficiency -- the &lt;code&gt;-x&lt;/code&gt; flag&lt;/a&gt;&lt;/h3&gt;

&lt;p&gt;You may have noticed that the above commands run slower than the xargs
equivalents.  This is because &lt;code&gt;map&lt;/code&gt; is running each instance separately --
forking a process (or more) once for each input argument/line.&lt;/p&gt;

&lt;p&gt;To make it efficient, like xargs, use the &lt;code&gt;-x&lt;/code&gt; option.  Here&#39;s a demo:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;$ (echo a; echo b; echo c) | map echo
a
b
c
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;and&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;$ (echo a; echo b; echo c) | map -x echo
a b c
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;It is clear that with &lt;code&gt;-x&lt;/code&gt; it only ran the &lt;code&gt;echo&lt;/code&gt; command once, giving
it all input arguments in one shot.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Please note&lt;/strong&gt; that &lt;code&gt;-x&lt;/code&gt; essentially replaces each occurrence of &lt;code&gt;%F&lt;/code&gt;
(or any of the other 3 sequences listed below) with a list of all the
arguments involved.  See below for an example where this will not work
properly.&lt;/p&gt;

&lt;h3&gt;&lt;a name=&quot;Arguments_from_the_command_line_instead_of_STDIN&quot;&gt;Arguments from the command line instead of STDIN&lt;/a&gt;&lt;/h3&gt;

&lt;p&gt;What&#39;s all that &lt;code&gt;echo&lt;/code&gt; stuff about?&lt;/p&gt;

&lt;p&gt;Well we used a sequence of echos to give &lt;code&gt;map&lt;/code&gt; 3 lines of input:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;a
b
c
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;But input doesn&#39;t have to come from standard input.  In fact, if the input is
a TTY (which is true if you have &lt;strong&gt;not&lt;/strong&gt; redirected it using the shell&#39;s
redirection facilities), map will treat the first argument as the command, and
all subsequent arguments as, well, arguments to that command.&lt;/p&gt;

&lt;p&gt;So&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;$map echo a b c
a
b
c

$map -x echo a b c
a b c
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;What if your command is not just one simple word?&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;$map echo your input was a b c
your
input
was
a
b
c
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;That didn&#39;t work...  How about now:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;$map &quot;echo your input was&quot; a b c
your input was a
your input was b
your input was c
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Aah, much better!&lt;/p&gt;

&lt;h3&gt;&lt;a name=&quot;Replace_for_loops_also&quot;&gt;Replace &lt;code&gt;for&lt;/code&gt; loops also&lt;/a&gt;&lt;/h3&gt;

&lt;p&gt;Consider how often you might do something like:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;for i in a b c d e f
do
    mkdir subdir.$i
done
# makes 6 subdirectories called subdir.a, subdir.b, etc
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Now try:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;map &quot;mkdir subdir.%F&quot; a b c d e f
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;strong&gt;WARNING: DO NOT USE &lt;code&gt;-x&lt;/code&gt; IN THE ABOVE COMMAND!&lt;/strong&gt;&lt;/p&gt;

&lt;h3&gt;&lt;a name=&quot;_Dry_run_a_complex_command_with_the_n_option&quot;&gt;&quot;Dry run&quot; a complex command with the &lt;code&gt;-n&lt;/code&gt; option&lt;/a&gt;&lt;/h3&gt;

&lt;p&gt;To see what &lt;code&gt;-x&lt;/code&gt; would do above, use the &lt;code&gt;-n&lt;/code&gt; (dry run) option:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;$ map -n -x &quot;mkdir subdir.%F&quot; a b c d e f
++ mkdir subdir.%F
mkdir subdir.&quot;a&quot; &quot;b&quot; &quot;c&quot; &quot;d&quot; &quot;e&quot; &quot;f&quot;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;See what happened?  Only the first argument got the &lt;code&gt;subdir.&lt;/code&gt; prefix which
you intended for all of them.&lt;/p&gt;

&lt;p&gt;Now try without the &lt;code&gt;-x&lt;/code&gt;:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;$map -n &quot;mkdir subdir.%F&quot; a b c d e f
++ mkdir subdir.%F
mkdir subdir.&quot;a&quot;
mkdir subdir.&quot;b&quot;
mkdir subdir.&quot;c&quot;
mkdir subdir.&quot;d&quot;
mkdir subdir.&quot;e&quot;
mkdir subdir.&quot;f&quot;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;And this is what we want.&lt;/p&gt;

&lt;h3&gt;&lt;a name=&quot;More_complex_examples&quot;&gt;More complex examples&lt;/a&gt;&lt;/h3&gt;

&lt;p&gt;Convert all JPEG files in this directory to thumbnails in GIF format with a
size of 128x128 pixels and put them in the &quot;thumbnails&quot; directory:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;map &quot;convert %F -geometry 128x128 thumbnails/%B.gif&quot; *.jpg
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Print the name of every directory that contains photographs from my
camera.  (My camera produces files that look like &lt;code&gt;IMG_1234.JPG&lt;/code&gt;, although
sometimes I make them lowercase)&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;find . -type f -iname &quot;img*.jpg&quot; | map echo %D | sort -u
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;In fact, &lt;code&gt;%B&lt;/code&gt; and &lt;code&gt;%E&lt;/code&gt; can trim complex extensions from file names
using the &lt;code&gt;-e=regexp&lt;/code&gt; option.  But that&#39;s a topic for another day, because
&quot;pcre&quot; means &quot;perl compatible regular expression&quot; :-)&lt;/p&gt;

&lt;h2&gt;&lt;a name=&quot;Usage_message&quot;&gt;Usage message&lt;/a&gt;&lt;/h2&gt;

&lt;p&gt;This is what you get if you run &lt;code&gt;map&lt;/code&gt; with no arguments.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;Usage: /home/sitaram/hobbits/._s/bin/map [-n] [-p] [-ts] [-x] [-t] [-e=ext-pcre] &quot;cmd args %(F|D|B|E)&quot; list
F is for the full filename, including the directory part
D is just the directory name
B is like basename (no dir, no ext; also see -e below)
E is just the extension (including the &quot;.&quot;)
    %F = %D/%B%E

List can be from STDIN, like xargs. Works like -I.  If STDIN is not a tty, you
don&#39;t have to worry about quoting the command.

-n  is a dry-run; as a side-effect it can be used as a way to &quot;generate&quot; the
    commands to use elsewhere if that&#39;s what you need!
-p  shows you a &quot;.&quot; for each command run so you get some idea of the progress
-ts shows you the time each command started, which is useful for long running
    jobs sometimes
Using -n with -p or -ts doesn&#39;t make any sense, but is allowed.
-x  xargs type optimisation -- reduce forking
-t  trim leading and trailing blanks; this is not the default because
    eliminating the constant need to do &quot;-print0 ... | xargs -0 ...&quot; is one of
    our selling points!
-e  use &quot;ext-pcre&quot; instead of the builtin-default &quot;\.[^.]*&quot;.


TIPS:
1.  multiple streams: use paste to feed a pasted stream to map instead of trying
    to do it internally...
2.  splitting spaces (treating a single input argument as multiple,
    defeating the quoting that map does), prefix and suffix the %F with
    \&quot;, like this:
        \&quot;%F\&quot;
&lt;/code&gt;&lt;/pre&gt;
&lt;/html&gt;
</pre>
</div>
<div title="mirror-sync-backup-tools-3" modifier="Sitaram" created="201007101556">
<pre>
&lt;html&gt;
&lt;h1&gt;Beyond rsync&lt;/h1&gt;

&lt;p&gt;&lt;code&gt;rdiff-backup&lt;/code&gt; is almost a superset of rsync in many ways.  It claims to
combine the &quot;best features of a mirror and an incremental backup&quot;, and if you
are forced to pick &lt;em&gt;only one&lt;/em&gt; tool to do your backups, this is probably the
best one.&lt;/p&gt;

&lt;p&gt;The features that make rdiff-backup really stand out are:&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;Much saner logic for file inclusions and exclusions compared to rsync,
while still using the same wonderful
&lt;a href=&quot;mirror-sync-backup-tools-2.html#algo&quot;&gt;difference algorithm&lt;/a&gt; to reduce
network traffic.&lt;/li&gt;
&lt;li&gt;Keeps the latest version just like rsync does (like a mirror), but &lt;em&gt;also
keeps older versions&lt;/em&gt; as compressed (and reversed) rsync-style diffs
within a new directory tree called &lt;code&gt;rdiff-backup-data&lt;/code&gt; on the target
disk.  What rsync does only for network bandwidth, rdiff-backup extends to
disk space also!  &lt;strong&gt;Very cool...&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;Very easy to retrieve older versions.&lt;/li&gt;
&lt;li&gt;Just as easy to purge &lt;em&gt;really old&lt;/em&gt; versions that you no longer care about!&lt;/li&gt;
&lt;/ol&gt;

&lt;h4&gt;How is it used?&lt;/h4&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;An excellent and easy to follow introduction to this powerful tool is the
&quot;examples&quot; page at
http://www.nongnu.org/rdiff-backup/examples.html&lt;br/&gt;&lt;br/&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;This is a tool that is just &lt;strong&gt;begging&lt;/strong&gt; to be run from cron, so one way to
take a backup is:&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;&lt;p&gt;create a list of files, say &lt;code&gt;/root/rd-b.lst&lt;/code&gt;.  Some illustrative parts
of my list are given below:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;/var/spool/cron
- /usr/local/share/vim
/usr/local
- /home/sitaram/.mozilla/firefox/44kffhfm.default/Cache
/home/sitaram/.mozilla
/home/sitaram/.jpilot
/home/sitaram/.freemind
/home/sitaram/.darrc
/home/sitaram/bin
/home/sitaram/.bashrc
/etc
- **
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;IMPORTANT: Paths in the include/exclude list should start with either
&lt;code&gt;**/&lt;/code&gt; or the source directory name.  Using &lt;code&gt;./&lt;/code&gt; won&#39;t work unless the
source directory was given as &quot;&lt;code&gt;.&lt;/code&gt;&quot;.&lt;/p&gt;

&lt;p&gt;Each candidate file/dir in the source tree is tested against the list
above.  Checking stops as soon as a match is found.  If the matched
pattern is prefixed with a &quot;&lt;code&gt;-&lt;/code&gt;&quot; sign, the file/dir and all its
subdirectories/files are excluded.  Otherwise, they are included.&lt;/p&gt;

&lt;p&gt;This is why exclusions at a deeper level are listed &lt;strong&gt;before&lt;/strong&gt; any
parent that must be included.  Notice, for example, how the &lt;code&gt;cache&lt;/code&gt;
directory is excluded first, and then the &lt;code&gt;mozilla&lt;/code&gt; directory is
included.  This is because I want to back up the whole of the
&lt;code&gt;mozilla&lt;/code&gt; directory except the &lt;code&gt;cache&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;If a file does not match &lt;strong&gt;any&lt;/strong&gt; pattern, the default is to include it.
Since we don&#39;t (normally) want that, the last line lists &quot;&lt;code&gt;**&lt;/code&gt;&quot; as
an exclusion pattern.  &quot;&lt;code&gt;**&lt;/code&gt;&quot; is a special pattern that matches any
character, including a &quot;&lt;code&gt;/&lt;/code&gt;&quot;, so think of it as an ultra-wildcard.&lt;br/&gt;&lt;br/&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;run this command or put it in cron:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;rdiff-backup --include-globbing-filelist /root/rd-b.lst / /bigfs/rd-b.data
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;If you want, you can use a &lt;code&gt;user@host::path&lt;/code&gt; syntax (note the
&lt;em&gt;double&lt;/em&gt; colon) to put it on another machine.&lt;br/&gt;&lt;br/&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Restoring it is just as simple.  You can use plain &lt;code&gt;cp&lt;/code&gt; or &lt;code&gt;scp&lt;/code&gt; to
get the latest version (remember this is a &lt;em&gt;mirror&lt;/em&gt;).  Or you can do
this:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;rdiff-backup -r now user@host::/bigfs/rd-b.data/home/sitaram/bin bin
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;will restore the bin directory.  As you can see, you can restore a
sub-tree of the full backup set if you need to.&lt;br/&gt;&lt;br/&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;You can get older versions too.  Replace the &lt;code&gt;now&lt;/code&gt; in the above command
with something like &lt;code&gt;3M&lt;/code&gt; which means &quot;3 months&quot;, or &lt;code&gt;5D&lt;/code&gt; for 5 days,
or &lt;code&gt;6W&lt;/code&gt; for 6 weeks, or combinations of these, or specify an exact date
in several possible ways.  Clearly plain &lt;code&gt;cp&lt;/code&gt; will not get you older
versions. Read the manual for details.&lt;br/&gt;&lt;br/&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Finally, the one feature that makes it all worthwhile is the
&lt;code&gt;--remove-older-than&lt;/code&gt; option.  I have an extra command in my cron job
that cleans out versions older than 3 weeks:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;rdiff-backup --remove-older-than 3W /bigfs/rd-b.data
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;This makes the whole thing pretty much zero-maintenance as long as you are
directing the backups to some other machine with enough disk space.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h4&gt;When is it useful?&lt;/h4&gt;

&lt;p&gt;When you have enough space on another machine you trust, or, failing that, on
a second hard disk on your own machine, this is the best way to backup your
stuff.  Pretty much fire-and-forget!!&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;If you have enough free disk, even backing up to the same hard disk may be
worthwhile, because you&#39;re at least protected from human error or software
bugs causing lost data.&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;It is so efficient in both time and space that you can probably take a backup
as often as you like.  Let cron do it once a day, but by all means take
another one manually at the end of a long hard day&#39;s work!&lt;/p&gt;

&lt;p&gt;You still need to do the following:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;check the &lt;code&gt;/root/rd-b.lst&lt;/code&gt; file periodically to ensure that everything
you want really &lt;strong&gt;is&lt;/strong&gt; being backed up.  This is not necessary if you have
asked rdiff-backup to backup the entire machine, of course!&lt;br/&gt;&lt;br/&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;if the &quot;remote&quot; machine you&#39;re backing up to is not that &quot;remote&quot;,
(example, same building, so a fire or a flood could wipe out both!), maybe
you should find some other means to do an offsite backup :-)  &lt;code&gt;dar&lt;/code&gt;
(next article!) with a DVD writer is a good solution for most people.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h4&gt;What are the downsides?&lt;/h4&gt;

&lt;p&gt;Nothing major really, but you need to remember that this is a &lt;em&gt;mirror&lt;/em&gt;, not a
backup in the normal sense.  For instance, you can&#39;t encrypt a mirror, so you
should only use machines you trust as the targets.&lt;/p&gt;

&lt;p&gt;&lt;code&gt;dar&lt;/code&gt;, the subject of the next article, allows encryption, offsite/offline
backups, and other features besides, but then of course it&#39;s not a mirror, and
it can&#39;t use the rsync algorithm so it&#39;s not as efficient!  You can&#39;t have
everything in one software, as I said in the first article!&lt;/p&gt;

&lt;h1&gt;What next?&lt;/h1&gt;

&lt;p&gt;Well, the next chapter: &lt;a href=&quot;mirror-sync-backup-tools-4.html&quot;&gt;A true backup
solution -- &lt;code&gt;dar&lt;/code&gt;&lt;/a&gt;&lt;/p&gt;
&lt;/html&gt;
</pre>
</div>
<div title="ew" modifier="Sitaram" created="201110212004">
<pre>
&lt;html&gt;
&lt;h1&gt;&lt;a name=&quot;_ew_an_egrep_wrapper&quot;&gt;&lt;code&gt;ew&lt;/code&gt; -- an egrep wrapper&lt;/a&gt;&lt;/h1&gt;

&lt;p&gt;&lt;sup&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#_ew_an_egrep_wrapper&quot;&gt;&lt;code&gt;ew&lt;/code&gt; -- an egrep wrapper&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#basic_features&quot;&gt;basic features&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#a_tale_of_inertia_or_ack_thooo_&quot;&gt;a tale of inertia (or ack-thooo!)&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#update_2009_02_17_passthru_mode_is_so_easy_&quot;&gt;update 2009-02-17: passthru mode is so easy!&lt;/a&gt;&lt;br&gt;
&lt;/sup&gt;&lt;/p&gt;

&lt;hr /&gt;

&lt;h3&gt;&lt;a name=&quot;basic_features&quot;&gt;basic features&lt;/a&gt;&lt;/h3&gt;

&lt;p&gt;&lt;code&gt;ew&lt;/code&gt; is a simple shell script that eventually invokes &lt;code&gt;grep -E&lt;/code&gt;.  It&#39;s about
125 lines, but the actual code is about 60 lines.  You can download it
&lt;a href=&quot;ew&quot;&gt;here&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;The usage message you see when you invoke it is this:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;Usage:
  ew [-G glob-to-search]* [other egrep options] egrep-pattern

ew is an &#39;egrep wrapper&#39;

Features:
  1.  forces egrep syntax (-E).  When input is a terminal, also forces
      recursion (-r), and ignores binary files (-I).  Exclusions are handled
      by setting the environment variable GREP_OPTIONS.  For example:
          export GREP_OPTIONS=&quot;--exclude-dir=.git&quot;
  2.  &#39;smartcase&#39; emulation: if the pattern does not have any uppercase
      letters, adds the &#39;-i&#39; flag
  3.  you can restrict the search to specific glob(s) -- use as many &#39;-G&#39;
      options as you want.  Be sure to escape meta-characters.  Examples:
          ew pattern -G \*.c -G \*.h
  4.  any other options will be passed on to grep so you&#39;re not losing any
      grep functionality
  5.  if the environment variable &#39;D&#39; exists, ew will show you the generated
      egrep command before executing.  For example:
          D=1 ew pattern -G \*.pl

Caveats:
  1.  if using as a pipe, put the pattern at the end to get smartcase
  2.  standard grep options that need arguments must have the arguments
      &#39;stuck&#39; to them (like &#39;-C4&#39; instead of &#39;-C 4&#39;).  In practice the only
      ones affected are -m, -A, -B, and -C.  If you need -f, use the
      &#39;--file=&#39; form.
  Both these caveats are because I&#39;m too lazy to use shopts :-)  I&#39;ll fix it
  someday, or if anyone asks.

Tip: to get ack&#39;s passthru mode, just prefix your pattern with &#39;$|&#39; (or
&#39;$\|&#39; to protect it from the shell).  Grep will do the rest ;-)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;There&#39;s nothing more to add as far as using &lt;code&gt;ew&lt;/code&gt; goes.  It leaves all the
heavy lifting to grep anyway, and the debug mode helps you figure out what
it&#39;s actually doing in the unlikely event that you&#39;re surprised.&lt;/p&gt;

&lt;h3&gt;&lt;a name=&quot;a_tale_of_inertia_or_ack_thooo_&quot;&gt;a tale of inertia (or ack-thooo!)&lt;/a&gt;&lt;/h3&gt;

&lt;p&gt;The &#39;smartcase&#39; and the &#39;-G&#39; features were inspired by
&lt;a href=&quot;http://petdance.com/ack/&quot;&gt;ack&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;I started using ack about 2 years ago, and it&#39;s a very nice program.  It&#39;s
main aim is cut the fluff when you&#39;re searching for something -- really cool
if your files are all neatly laid out with proper extensions and you want to
search &lt;em&gt;only&lt;/em&gt; those files.&lt;/p&gt;

&lt;p&gt;The problem with ack is that it grows on you, replacing grep in your mind.
And then one day you use it where it &lt;em&gt;doesn&#39;t&lt;/em&gt; do the same thing as grep.&lt;/p&gt;

&lt;p&gt;At that point, you &lt;em&gt;might&lt;/em&gt; (if you&#39;re lucky) realise that finding no matches
doesn&#39;t mean there really weren&#39;t any to be found, and you then switch your
brain from whatever problem you&#39;re trying to solve, to figuring out why ack
missed some.  The argument is often made that ack has a &#39;-f&#39; flag to show you
what files are being searched, but it&#39;s still a distraction from your real
work.&lt;/p&gt;

&lt;p&gt;In short, ack is the wrong tool for people with unstructured needs; it cuts
out &lt;em&gt;too much&lt;/em&gt;, and I gradually grew more and more frustrated with this
impedance mismatch.&lt;/p&gt;

&lt;p&gt;It&#39;s a testament to what a nice program it otherwise was that -- despite many
similar (unresolved) problems, and one really bizarre bug that almost caused
me data loss (fixed very quickly by a user called Bill Riker) -- I stuck with
ack for two years!  The tipping point finally came when the author said
&lt;a href=&quot;http://groups.google.com/group/ack-users/browse_thread/thread/ae646df76cc15259&quot;&gt;&quot;There&#39;s really no English that explains how it
works&quot;&lt;/a&gt;
when someone asked him for a description of the file selection logic!&lt;/p&gt;

&lt;p&gt;When you really like a program, it&#39;s disconcerting to hear the primary author
say something like that!  So -- still unwilling to let go -- I took it on
myself to go through the code and write up a &lt;a href=&quot;http://groups.google.com/group/ack-users/browse_thread/thread/91d95a012be2905a&quot;&gt;description of the default file
choice logic for
ack&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;And &lt;em&gt;that&lt;/em&gt; finally did the trick!  Reading over all the special cases and
exceptions, many of which were undocumented, I realised that I was not the
target audience for ack.&lt;/p&gt;

&lt;p&gt;It was ironic that something I did for love of the program made me stop
using it and write my own instead.&lt;/p&gt;

&lt;h4&gt;&lt;a name=&quot;update_2009_02_17_passthru_mode_is_so_easy_&quot;&gt;update 2009-02-17: passthru mode is so easy!&lt;/a&gt;&lt;/h4&gt;

&lt;p&gt;Getting ack&#39;s passthru mode -- which is the &lt;em&gt;only&lt;/em&gt; thing I missed about ack,
is so freaking easy:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;tail -f /var/log/messages | ew $\|pattern
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;The first part of the alternation matches every line, but there&#39;s nothing to
highlight.  When the pattern matches, it is highlighted.  Result: passthru
mode!&lt;/p&gt;

&lt;p&gt;:-)&lt;/p&gt;
&lt;/html&gt;
</pre>
</div>
<div title=".mk" modifier="Sitaram" created="200903241920">
<pre>
&lt;html&gt;
&lt;h1&gt;!/bin/bash&lt;/h1&gt;

&lt;h1&gt;arguments: usually one or more directory names (default is $PWD)&lt;/h1&gt;

&lt;h1&gt;input: all the *.notes files within those directories&lt;/h1&gt;

&lt;h1&gt;output: $PWD/notes.html&lt;/h1&gt;

&lt;h1&gt;some hardcoding here&lt;/h1&gt;

&lt;p&gt;blank=/home/sitaram/hobbits/info/notes/notes-blank.html&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;notes.html&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h1&gt;prolog&lt;/h1&gt;

&lt;p&gt;export n
n=$(grep -n &#39;^&lt;div title=&quot;GettingStarted&quot; modifier=&quot;Sitaram&quot;&#39; $blank | cut -f1 -d:)
(( n-- ))
sed -ne &quot;1,${n}p&quot; &amp;lt; $blank &gt;&gt; notes.html&lt;/p&gt;

&lt;h1&gt;for i in *.notes&lt;/h1&gt;

&lt;p&gt;for i in $(find ${&lt;em&gt;:-.} -name &quot;&lt;/em&gt;.notes&quot;)
do
    # ignore files which do not have a H1 on line 1, they may be &quot;secret&quot;
    # files
    grep -q &#39;^# &#39; &amp;lt; $i ||
        {
            echo skipping $i &gt;&amp;amp;2
            continue
        }
    j=$(basename $i .notes)
    ts=$(stat -c %y $i |cut -c1-16|sed -e &#39;s/[ :-]//g&#39;)
    echo &quot;&lt;div title=\&quot;$j\&quot; modifier=\&quot;Sitaram\&quot; created=\&quot;$ts\&quot;&gt;&quot;
    echo &quot;&lt;pre&gt;&quot;
    (echo &quot;&lt;html&gt;&quot;; md.pl &amp;lt; $i | Markdown.pl; echo &quot;&lt;/html&gt;&quot;) |
        perl -MHTML::Entities -pe &#39;$_ = encode&lt;em&gt;entities($&lt;/em&gt;)&#39;
    echo &quot;&lt;/pre&gt;&quot;
    echo &quot;&lt;/div&gt;&quot;
done    &gt;&gt; notes.html&lt;/p&gt;

&lt;h1&gt;epilog&lt;/h1&gt;

&lt;p&gt;(( n++ ))
sed -ne &quot;$n,\$p&quot; &amp;lt; $blank &gt;&gt; notes.html&lt;/p&gt;

&lt;h1&gt;and copy to a publicly visible place&lt;/h1&gt;

&lt;h1&gt;/bin/mv -v notes.html /home/sitaram/atcmail&lt;/h1&gt;
&lt;/html&gt;
</pre>
</div>
<div title="openssl-gpg-speed" modifier="Sitaram" created="200903241920">
<pre>
&lt;html&gt;
&lt;h1&gt;openssl versus GPG speed test&lt;/h1&gt;

&lt;p&gt;Ratios by which openssl is better:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;                Ratio Enc       Ratio Dec       Ratio enc+dec
Bf-cbc          9.39            6.95            8.2
aes-256-cbc     6.09            4.05            5.08
cast5-cbc       4.87            2.67            3.7
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Absolute times (user+system time per MB, averaged over 10, 20, 100, and 200 MB
chunks of urandom data):&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;                        ENC             Dec
openssl Bf-cbc          0.0231          0.0218
openssl aes-256-cbc     0.0336          0.0334
openssl cast5-cbc       0.0383          0.0432
GPG     BLOWFISH        0.2168          0.1516
GPG     AES256          0.2047          0.1354
GPG     CAST5           0.1864          0.1153
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;openssl commands used:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;cat $file | time openssl enc -$i -k this_is_my_password &amp;gt; $file.enc
cat $file.enc | time openssl enc -d -$i -k this_is_my_password &amp;gt; $file.dec
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;GPG commands used:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;(echo this_is_my_password; cat $file) |
   time gpg -q -c --cipher-algo $i --passphrase-fd 0 &amp;gt; $file.enc
(echo this_is_my_password; cat $file.enc) |
   time gpg -q -d --cipher-algo $i --passphrase-fd 0 &amp;gt; $file.dec
&lt;/code&gt;&lt;/pre&gt;
&lt;/html&gt;
</pre>
</div>
<div title="make-your-pictures-pop" modifier="Sitaram" created="200903241920">
<pre>
&lt;html&gt;
&lt;h1&gt;make your pictures pop!&lt;/h1&gt;

&lt;p&gt;&lt;sup&gt;from
http://digital-photography-school.com/blog/4-easy-photoshop-techniques-to-make-your-pictures-pop/&lt;/sup&gt;&lt;/p&gt;

&lt;h3&gt;blur/overlay&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;Duplicate your picture layer by dragging the layer to the &#39;new&#39; icon in
the layers palette (ctrl+j).&lt;/li&gt;
&lt;li&gt;Apply a gaussian blur (Filter &gt; Blur &gt; Gaussian Blur...). Blur it enough
that the detail disappears but the shapes mostly keep their form.&lt;/li&gt;
&lt;li&gt;In the layers palette, change the blending mode from &#39;Normal&#39; to
&#39;Overlay.&#39;&lt;/li&gt;
&lt;li&gt;If you look at the before and after, you can see that this method makes
the light tones lighter and the dark tones darker while softening it a
touch. Basically, it softly boosts the contrast. If you want a more
dramatic effect, try changing the blending mode to &#39;Vivid Light&#39; instead
of &#39;Overlay.&#39; [this mode may have a different name in GIMP; everything
else works great]&lt;/li&gt;
&lt;li&gt;Try it on all kinds of shots: portraits, nature shots, you name it. I use
this method ALL the time. It works so well with everything!&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;My notes: blur radius should be small, maybe less than 5?  experiment on real photos to find out...&lt;/p&gt;
&lt;/html&gt;
</pre>
</div>
<div title="Canon-S3-IS" modifier="Sitaram" created="200903241920">
<pre>
&lt;html&gt;
&lt;h1&gt;photo - Canon S3 IS&lt;/h1&gt;

&lt;p&gt;&lt;sup&gt;TODO: Try sound recording playback mode, menu, sound recording, set&lt;/sup&gt;&lt;/p&gt;

&lt;h4&gt;Manual focus&lt;/h4&gt;

&lt;p&gt;Manual focus is quite usable if you have enough time for it.  The trick is to
focus using autofocus (shutter half-depressed) then click MF.  Now focus is
locked.  Hold MF and up/down will change the focus.  Yo get a magnified image
in the screen to help.  &lt;strong&gt;Get it about right, then hit SET&lt;/strong&gt; and it will
perfect your manual focus.  It stays in MF mode across shots too.&lt;/p&gt;

&lt;p&gt;The manual is unclear on AFL -- auto focus lock.  If you assign MF to the
shortcut button then it doesn&#39;t do the same thing.  It becomes an automatic
focus lock.  It locks autofocus for you without the inconvenience of holding
the shutter halfway.  But it forgets the setting between shots.&lt;/p&gt;

&lt;h4&gt;AE LOCK (flash off)&lt;/h4&gt;

&lt;ul&gt;
&lt;li&gt;half-press shutter, then ISO button&lt;/li&gt;
&lt;li&gt;stays only for 1 shot, unlike AF Lock above (TODO: confirm this please!)&lt;/li&gt;
&lt;li&gt;Cool: can change combo of shutter/aperture by Left/Right while AEL (in P,
Tv, Av modes only)!&lt;/li&gt;
&lt;/ul&gt;

&lt;h4&gt;FE LOCK (flash on, not just auto)&lt;/h4&gt;

&lt;p&gt;same as above :-)&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Super macro&lt;/strong&gt;: Warning: use the super macro mode very carefully; you may
damage the lens!&lt;/p&gt;

&lt;h4&gt;Taking Good Portraits&lt;/h4&gt;

&lt;ul&gt;
&lt;li&gt;use Av mode, widest aperture&lt;/li&gt;
&lt;li&gt;choose a low ISO (100 is best)&lt;/li&gt;
&lt;li&gt;use manual WB unless this is broad daylight&lt;/li&gt;
&lt;li&gt;use spot focus and spot exposure&lt;/li&gt;
&lt;/ul&gt;

&lt;hr /&gt;

&lt;h4&gt;General rules&lt;/h4&gt;

&lt;ul&gt;
&lt;li&gt;keep ISO at 100&lt;/li&gt;
&lt;li&gt;keep OIS at &quot;shooting&quot;, unless you really need &quot;continuous&quot;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;using the tele setting is better than macro!  see
&lt;a href=&quot;http://www.dpreview.com/reviews/CanonS3IS/page5.asp&quot;&gt;http://www.dpreview.com/reviews/CanonS3IS/page5.asp&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;safety shift only works without flash&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;hr /&gt;

&lt;h4&gt;Decisions, decisions, decisions!&lt;/h4&gt;

&lt;p&gt;Shortcut -- what function to assign to it?  Best is either display off or
maybe image stabiliser&lt;/p&gt;
&lt;/html&gt;
</pre>
</div>
<div title="net-conn-mon-tools" modifier="Sitaram" created="200906060050">
<pre>
&lt;html&gt;
&lt;h1&gt;&lt;a name=&quot;Network_connnectivity_and_monitoring_tools&quot;&gt;Network connnectivity and monitoring tools&lt;/a&gt;&lt;/h1&gt;

&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#Network_connnectivity_and_monitoring_tools&quot;&gt;Network connnectivity and monitoring tools&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#fping_find_which_hosts_are_up_on_a_network&quot;&gt;fping -- find which hosts are up on a network&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#mtr_my_traceroute_&quot;&gt;mtr -- &quot;my traceroute&quot;&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#lft_layer_four_trace_gets_you_ASNs_and_network_names_also_&quot;&gt;lft -- &quot;layer four trace&quot; (gets you ASNs and network names also)&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#iftop_display_bandwidth_usage_on_an_interface&quot;&gt;iftop -- display bandwidth usage on an interface&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#iptraf_color_curses_GUI_IP_traffic_monitor&quot;&gt;iptraf -- color curses GUI IP traffic monitor&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#iperf_optimise_troubleshoot_connection_speed&quot;&gt;iperf -- optimise/troubleshoot connection speed&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#TCP&quot;&gt;TCP&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#UDP&quot;&gt;UDP&lt;/a&gt;&lt;br&gt;&lt;/p&gt;

&lt;hr /&gt;

&lt;p&gt;best choices:
  * fping: quick &quot;what hosts are up&quot;?
  * mtr: end-to-end connectivity (ping/traceroute type)
  * iftop: traffic measurement
  * iperf: network throughput measurement tool&lt;/p&gt;

&lt;hr /&gt;

&lt;h2&gt;&lt;a name=&quot;fping_find_which_hosts_are_up_on_a_network&quot;&gt;fping -- find which hosts are up on a network&lt;/a&gt;&lt;/h2&gt;

&lt;pre&gt;&lt;code&gt;fping -a -r1 -g 10.0.0.0/28     # -a = alive; use &quot;-u&quot; for unreachable
&lt;/code&gt;&lt;/pre&gt;

&lt;ul&gt;
&lt;li&gt;output is not necessarily sorted&lt;/li&gt;
&lt;li&gt;&lt;p&gt;the &lt;code&gt;-r1&lt;/code&gt; prevents retries and ends the command faster&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;wait times for retry increase geometrically; by default you have to wait
for about 5 seconds to get back the command prompt&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;-e&lt;/code&gt; shows round trip time&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;-s&lt;/code&gt; prints cumulative stats on exit&lt;/li&gt;
&lt;li&gt;Other stuff you can do
&lt;ul&gt;
&lt;li&gt;ping data size&lt;/li&gt;
&lt;li&gt;number of packets&lt;/li&gt;
&lt;li&gt;timeouts and waiting parameters&lt;/li&gt;
&lt;li&gt;statistics formats&lt;/li&gt;
&lt;li&gt;retry limits&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;hr /&gt;

&lt;h2&gt;&lt;a name=&quot;mtr_my_traceroute_&quot;&gt;mtr -- &quot;my traceroute&quot;&lt;/a&gt;&lt;/h2&gt;

&lt;ul&gt;
&lt;li&gt;like a continuous traceroute, uses only ping packets&lt;/li&gt;
&lt;li&gt;&lt;code&gt;-n&lt;/code&gt; is &quot;no DNS&quot;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;-c count&lt;/code&gt; to limit to so many counts (seconds)&lt;/li&gt;
&lt;li&gt;use &lt;code&gt;j&lt;/code&gt; to toggle between two types of stats&lt;/li&gt;
&lt;li&gt;or use the undocumented &lt;code&gt;-o&lt;/code&gt; option to set the field order from the
 command line&lt;/li&gt;
&lt;li&gt;(warning) the interactive version does not remember the fields you
 specified between runs&lt;/li&gt;
&lt;li&gt;&lt;p&gt;it has two display modes that show much better what is happening.  The
 following is mostly guesswork.&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;In the first mode
&lt;ul&gt;
&lt;li&gt;a &quot;.&quot; means the reply was received&lt;/li&gt;
&lt;li&gt;a &quot;&gt;&quot; means it was received but took a really long time&lt;/li&gt;
&lt;li&gt;a &quot;?&quot; means it was not received yet&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;the second mode introduces 6 levels of granularity and shows a scale at
the bottom to show what these levels mean&lt;/p&gt;

&lt;p&gt;Real advantage: it shows where the packet loss is happening, in realtime.
Also, since it uses ICMP ECHO requests, it may work when traceroute (using
UDP) is blocked.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;hr /&gt;

&lt;h2&gt;&lt;a name=&quot;lft_layer_four_trace_gets_you_ASNs_and_network_names_also_&quot;&gt;lft -- &quot;layer four trace&quot; (gets you ASNs and network names also)&lt;/a&gt;&lt;/h2&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;doesn&#39;t seem to work consistently on my home box, due to port scan
detection?&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;defaults are port 53 -&gt; port 80 -- WATCH OUT&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;-n&lt;/code&gt; is &quot;no DNS&quot;&lt;/li&gt;
&lt;li&gt;lft -AN is very useful sometimes; ASNs and network names&lt;/li&gt;
&lt;li&gt;&lt;code&gt;-E&lt;/code&gt; enables a &quot;smart&quot; engine to detect firewalls etc more
intelligently&lt;/li&gt;
&lt;li&gt;&lt;code&gt;-i&lt;/code&gt; disables stop on ICMP other than TTL Expired; not sure how useful
this is (hopefully &lt;code&gt;-E&lt;/code&gt; already uses this information!)&lt;/li&gt;
&lt;/ul&gt;

&lt;hr /&gt;

&lt;h2&gt;&lt;a name=&quot;iftop_display_bandwidth_usage_on_an_interface&quot;&gt;iftop -- display bandwidth usage on an interface&lt;/a&gt;&lt;/h2&gt;

&lt;pre&gt;&lt;code&gt;iftop -nP
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Note on UDP: iftop has no way of separating out UDP traffic in the display,
unless you filter it out using &lt;code&gt;-f&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;Interactive use:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;code&gt;h&lt;/code&gt; for help -- there are quite a few useful options here, esp.
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;t&lt;/code&gt; and &lt;code&gt;B&lt;/code&gt; cycle the lines and the bar graph&lt;/li&gt;
&lt;li&gt;&lt;code&gt;T&lt;/code&gt; shows cumulative totals&lt;/li&gt;
&lt;li&gt;&lt;code&gt;n/s/d&lt;/code&gt; toggle hostname resolution/source host/dest host displays&lt;/li&gt;
&lt;li&gt;&lt;code&gt;N/S/D&lt;/code&gt; toggle service resolution/source port/dest port displays
&lt;ul&gt;
&lt;li&gt;aggregation happens whenever you ask for less detail, and is often
useful&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;f&lt;/code&gt; allows you to edit the filter code while running (but note that
filtered out data will still appear to be present for upto 40seconds&lt;/li&gt;
&lt;li&gt;&lt;code&gt;l&lt;/code&gt; allows you to set a posix-regex as a screen filter (does not
affect totals)&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Command line:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;code&gt;-n&lt;/code&gt; is &quot;no DNS&quot;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;-P&lt;/code&gt; turns on port display&lt;/li&gt;
&lt;li&gt;&lt;code&gt;-B&lt;/code&gt; uses Bps instead of bps, except the bar graph seems to always be
bps&lt;/li&gt;
&lt;li&gt;&lt;code&gt;-N&lt;/code&gt; is &quot;no service name lookup&quot;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;-i eth1&lt;/code&gt; specifies the interface; default is eth0&lt;/li&gt;
&lt;li&gt;&lt;code&gt;-f &quot;port 22&quot;&lt;/code&gt; is an example of filtering; it uses the same syntax as
tcpdump, but restricts everything to IP only&lt;/li&gt;
&lt;li&gt;&lt;code&gt;-p&lt;/code&gt; uses promiscuous mode&lt;/li&gt;
&lt;li&gt;different type of curses GUI; b/w not colour&lt;/li&gt;
&lt;li&gt;shows avg over 2/10/40s&lt;/li&gt;
&lt;li&gt;much better for filtering, both &quot;bpf&quot; style as well as on screen!
&lt;ul&gt;
&lt;li&gt;you can filter on screen, right there&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;the &quot;display filter&quot; (l command) is different from the filter code&lt;/li&gt;
&lt;li&gt;display very configurable while running; press h for help&lt;/li&gt;
&lt;li&gt;has much better ability to aggregate also&lt;/li&gt;
&lt;li&gt;can use -B for Bps instead of bps but the cum bar remains bps :-(&lt;/li&gt;
&lt;/ul&gt;

&lt;hr /&gt;

&lt;h2&gt;&lt;a name=&quot;iptraf_color_curses_GUI_IP_traffic_monitor&quot;&gt;iptraf -- color curses GUI IP traffic monitor&lt;/a&gt;&lt;/h2&gt;

&lt;p&gt;Most of the time, &lt;code&gt;iftop&lt;/code&gt; (see above) is better.  The situations where
&lt;code&gt;iptraf&lt;/code&gt; is preferable are:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;see UDP traffic separated from TCP cleanly&lt;/li&gt;
&lt;li&gt;see TCP flags&lt;/li&gt;
&lt;li&gt;monitor more than one interface simultaneously in one window&lt;/li&gt;
&lt;li&gt;see statistical breakdowns and some other esoteric types of reports that
may (who knows) come in useful someday&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;However, note that&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;filtering is sticky from run to run&lt;/strong&gt; (stored in /var/lib/iptraf!!!)&lt;/li&gt;
&lt;li&gt;filtering is not as easy to specify -- hey maybe that&#39;s why it is sticky
:-)&lt;/li&gt;
&lt;/ul&gt;

&lt;hr /&gt;

&lt;h2&gt;&lt;a name=&quot;iperf_optimise_troubleshoot_connection_speed&quot;&gt;iperf -- optimise/troubleshoot connection speed&lt;/a&gt;&lt;/h2&gt;

&lt;p&gt;&lt;sup&gt;source: The iperf tarball comes with a nice HTML page explaining many things.
The man page is quite sparse, omitting many details (like what &quot;-w&quot; means for
UDP!) so be sure to read that HTML!  Additional info:
&lt;a href=&quot;http://www.psc.edu/networking/projects/tcptune/&quot;&gt;http://www.psc.edu/networking/projects/tcptune/&lt;/a&gt; &lt;/sup&gt;&lt;/p&gt;

&lt;h4&gt;&lt;a name=&quot;TCP&quot;&gt;TCP&lt;/a&gt;&lt;/h4&gt;

&lt;ul&gt;
&lt;li&gt;find RTT (round trip time) using ping&lt;/li&gt;
&lt;li&gt;figure out what is the bottleneck link speed (how?)&lt;/li&gt;
&lt;li&gt;BDP (bandwidth delay product) = product of these two&lt;/li&gt;
&lt;li&gt;start iperf on both sides with this speed as &quot;-w&quot; (TCP window size) and
see what you get&lt;/li&gt;
&lt;li&gt;If the results are far lower than the theoretical maximum, try window
sizes a little higher or lower than what you used so far.&lt;/li&gt;
&lt;li&gt;also try -P (like lftp!!) to see if parallelism helps.  If it seems to
help, then it means (quote) &quot;either the TCP window size is too small, or
the OS&#39;s TCP implementation has bugs, or the network itself has
deficiencies&quot;&lt;/li&gt;
&lt;li&gt;make sure you check the MSS (-m) also; it shouldn&#39;t be too small&lt;/li&gt;
&lt;/ul&gt;

&lt;h4&gt;&lt;a name=&quot;UDP&quot;&gt;UDP&lt;/a&gt;&lt;/h4&gt;

&lt;ul&gt;
&lt;li&gt;use to find packet loss&lt;/li&gt;
&lt;li&gt;the jitter is also useful&lt;/li&gt;
&lt;li&gt;NOTE that the default &quot;-b&quot; is too small (1Mbps!); increase it&lt;/li&gt;
&lt;/ul&gt;
&lt;/html&gt;
</pre>
</div>
<div title="ruby-for-japhs" modifier="Sitaram" created="200903241920">
<pre>
&lt;html&gt;
&lt;h1&gt;&lt;a name=&quot;Ruby_for_perl_programmers&quot;&gt;Ruby for perl programmers&lt;/a&gt;&lt;/h1&gt;

&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#Ruby_for_perl_programmers&quot;&gt;Ruby for perl programmers&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#References_and_links&quot;&gt;References and links&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#Cons&quot;&gt;Cons&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#Minor_stuff_you_just_have_to_remember&quot;&gt;Minor stuff you just have to remember&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#_Major_gotchas_&quot;&gt;&lt;strong&gt;Major gotchas&lt;/strong&gt;&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#Other_gotchas&quot;&gt;Other gotchas&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#Other_coolness&quot;&gt;Other coolness&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#Open_questions_so_far_&quot;&gt;Open questions (so far)&lt;/a&gt;&lt;br&gt;&lt;/p&gt;

&lt;hr /&gt;

&lt;p&gt;This is a quick ref for perl programmers.&lt;/p&gt;

&lt;p&gt;There are some nice things about ruby; it&#39;s mostly consistent, with very few
&quot;surprises&quot; (but see below for some real doozies, some seemingly quite
gratuitous).  Certainly there are fewer special characters in Ruby programs
than in perl, so for people who find that disturbing this may be a better bet.
I&#39;m not one of them, and I&#39;m not defining cleanliness by that measure.&lt;/p&gt;

&lt;p&gt;But if I had to teach someone OO I would do it with Ruby, not Perl -- I mean
all that &quot;bless&quot; stuff was fine to learn, but probably not to teach :-)  Since
most of my code is very small, mini-tools, I am not much of an OO-guy (merely
&lt;strong&gt;using&lt;/strong&gt; CPAN modules doesn&#39;t count in this context), so this never hurt me
yet, but if I had to do serious OO I&#39;d probably use Ruby!&lt;/p&gt;

&lt;p&gt;The most obvious down side is that you have to forget there&#39;s this comforting
monstrosity called CPAN ready to bail you out -- I mean, come on, I doubt if
there&#39;ll ever be, say,
http://search.cpan.org/~djpadz/Finance-YahooQuote-0.17/YahooQuote.pm for Ruby :-)&lt;/p&gt;

&lt;p&gt;Larry Wall once said it&#39;s easier to port a shell than to port a shell script!
Who knows -- it may be easier to create a shim to make Perl libraries be
called from Ruby than port all of CPAN :-)&lt;/p&gt;

&lt;p&gt;Some minor plus points from a &quot;learning&quot; point of view:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;code&gt;irb&lt;/code&gt; is a nice tool, far better than perl&#39;s &lt;code&gt;perl -de 0&lt;/code&gt; for
interactively trying stuff out&lt;/li&gt;
&lt;li&gt;&lt;code&gt;irb&lt;/code&gt; with &lt;code&gt;-r irb/completion&lt;/code&gt; is even neater :-)&lt;/li&gt;
&lt;li&gt;the &lt;code&gt;p&lt;/code&gt; function is very convenient and I find I use it a lot&lt;/li&gt;
&lt;/ul&gt;

&lt;h3&gt;&lt;a name=&quot;References_and_links&quot;&gt;References and links&lt;/a&gt;&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;http://raa.ruby-lang.org/&quot;&gt;http://raa.ruby-lang.org/&lt;/a&gt; (their eqvt of CPAN?)&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://rubyforge.org/&quot;&gt;http://rubyforge.org/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://docs.rubygems.org/&quot;&gt;http://docs.rubygems.org/&lt;/a&gt; (like apt-get + CPAN, says wikipedia)&lt;/li&gt;
&lt;/ul&gt;

&lt;h3&gt;&lt;a name=&quot;Cons&quot;&gt;Cons&lt;/a&gt;&lt;/h3&gt;

&lt;p&gt;2.0 is expected to fix these two issues:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;Ruby is currently not very efficient; for now, use only where programmer
efficiency is more important&lt;/li&gt;
&lt;li&gt;threading is only green right now&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;But my biggest problem is with the scoping rules (see below under &quot;Major
Gotchas&quot;) and the lack of something like &lt;code&gt;use strict&lt;/code&gt;.  Since there&#39;s also no
way to force yourself to declare variables, this effectively means that you
have to be very careful not to stomp on other variables accidentally.&lt;/p&gt;

&lt;p&gt;This can be mitigated somewhat by keeping functions as small as possible and
avoiding globals ($var) as much as possible, but that&#39;s true in any language.
More specific to Ruby, using iterators instead of for/while/until loops would
help limit scope (see below for how/why).  But even then, you have to be
careful you don&#39;t accidentally reuse function-scope locals inside the iterated
blocks and clobber them.&lt;/p&gt;

&lt;h3&gt;&lt;a name=&quot;Minor_stuff_you_just_have_to_remember&quot;&gt;Minor stuff you just have to remember&lt;/a&gt;&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;Hash lookup is by &lt;code&gt;[&#39;key&#39;]&lt;/code&gt;, not &lt;code&gt;{&#39;key&#39;&lt;/code&gt;}&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;The quoting constructs are similar to perl, with 2 differences:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;perl&#39;s &lt;code&gt;qX{...&lt;/code&gt;} becomes ruby&#39;s &lt;code&gt;%X{...&lt;/code&gt;}, where X is w, r, and x
(words, regex, and execution a.k.a backticks, respectively)&lt;/li&gt;
&lt;li&gt;perl&#39;s &lt;code&gt;qq{...&lt;/code&gt;} (doubt quoted string) becomes &lt;code&gt;%Q{...&lt;/code&gt;}, and perl&#39;s
&lt;code&gt;q{...&lt;/code&gt;} (single quoted string) becomes &lt;code&gt;%q{...&lt;/code&gt;}&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Naming conventions&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;:symbol
Constant (but see below!)
instance.method
Class::method
$global
@instancevar
@@classvar
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Predefined &lt;code&gt;$&lt;/code&gt; variables&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;Of the predefined &quot;$&lt;special char&gt;&quot; variables, &lt;code&gt;$~&lt;/code&gt; (the matchdata
object) and &lt;code&gt;$_&lt;/code&gt; are locally scoped; the rest are global&lt;/li&gt;
&lt;li&gt;new (not in perl) are:
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;$=&lt;/code&gt; (causes implicit &lt;code&gt;/i&lt;/code&gt; for all regexes)&lt;/li&gt;
&lt;li&gt;&lt;code&gt;$;&lt;/code&gt; (the default separator for &lt;code&gt;String#split&lt;/code&gt;)&lt;/li&gt;
&lt;li&gt;&lt;code&gt;$stderr&lt;/code&gt;, &lt;code&gt;$stdin&lt;/code&gt;, &lt;code&gt;$stdout&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;$DEBUG&lt;/code&gt; and &lt;code&gt;$VERBOSE&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;... and lots more; see
&lt;a href=&quot;http://en.wikibooks.org/wiki/Ruby_Programming/Syntax/Variables_and_Constants&quot;&gt;http://en.wikibooks.org/wiki/Ruby_Programming/Syntax/Variables_and_Constants&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;gets&lt;/code&gt; is the closest to perl&#39;s &lt;code&gt;&amp;lt;&amp;gt;&lt;/code&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;#{expression&lt;/code&gt;} is how you interpolate in a double-quoted string.  This is
more verbose then perl for simple variables, but less verbose for complex
expressions, where in perl you had to resort to a somewhat weird trick
that you couldn&#39;t remember when you really needed it (but you knew exactly
where to look it up because you did it so many times!)&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;str.scan(re)&lt;/code&gt; (without a block) produces an array of &lt;code&gt;$&amp;amp;&lt;/code&gt;.  If there are
groups in the regex, you get a nested array.  This is almost exactly like
&lt;code&gt;m*g&lt;/code&gt; (except that perl flattens the array in the case when you have
groups in the regex).&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;The match method is interesting.  In &lt;code&gt;x.match(y)&lt;/code&gt;, if either one is a
regex, the obvious happens.  If both are strings, then &quot;y&quot; is converted to
a regexp.  (If both are regexes, it&#39;s an error)&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;the &lt;code&gt;=~&lt;/code&gt; operator doesn&#39;t like it if both are strings, but otherwise
it&#39;s the same as &lt;code&gt;.match&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;the &lt;code&gt;===&lt;/code&gt; operator is even more rigid: the regex must be on the left
side&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;a &lt;code&gt;break&lt;/code&gt; in a block can have an argument, which is then returned as the
result of the block&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h3&gt;&lt;a name=&quot;_Major_gotchas_&quot;&gt;&lt;strong&gt;Major gotchas&lt;/strong&gt;&lt;/a&gt;&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;Scoping is different.  The following 3 paras are from the Programming Ruby
book (Pragmatic Programmer&#39;s Guide):
&lt;ul&gt;
&lt;li&gt;&lt;em&gt;The while, until, and for loops are built into the language and do not
introduce new scope; previously existing locals can be used in the loop,
and any new locals created will be available afterward.&lt;/em&gt;&lt;/li&gt;
&lt;li&gt;&lt;em&gt;The blocks used by iterators (such as loop and each) are a little
different. Normally, the local variables created in these blocks are not
accessible outside the block.&lt;/em&gt;&lt;/li&gt;
&lt;li&gt;&lt;em&gt;However, if at the time the block executes a local variable already
exists with the same name as that of a variable in the block, the
existing local variable will be used in the block. Its value will
therefore be available after the block finishes.&lt;/em&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;All this has the following (&lt;strong&gt;bad&lt;/strong&gt;, IMO) implications, compared to
explicitly declaring scope using &lt;code&gt;my&lt;/code&gt; etc.&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;you have to keep track of which construct you use and its scoping rules.
And while the &lt;code&gt;for&lt;/code&gt; loop on an array is supposed to be the same as using
&lt;code&gt;each&lt;/code&gt; and passing it a block, they have different effects on variable
scope, so if you switch from one to the other for any reason you risk
introducing scoping differences for the variables being used&lt;/li&gt;
&lt;li&gt;you might clobber a function-scoped local variable by mistake if you
forgetfully use the same name in a for-loop.  In perl you&#39;d just &lt;code&gt;my&lt;/code&gt; it
out by default (and habit), but here you have to check and be sure :-(&lt;/li&gt;
&lt;li&gt;if you want the effects of something done inside a loop to be available
outside the loop you have to explicitly use it &lt;strong&gt;before&lt;/strong&gt; the loop, even
if you just assign &quot;nil&quot; to it.  (I guess one could consider this as a
sort of declaration though...)&lt;/li&gt;
&lt;li&gt;overall it looks like a kludge compared to perl&#39;s model (when &lt;code&gt;use
strict&lt;/code&gt; is in effect, of course), and Larry has a nice explanation of
this in terms of &quot;least surprise for whom?&quot; :-)&lt;/li&gt;
&lt;li&gt;&lt;p&gt;this applies to &lt;code&gt;lambda&lt;/code&gt; also:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;x = 3
lambda{|x| &quot;x still refers to the outer variable&quot;}.call(4)
puts x  # x is now 4, not 3
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;The filename given to &lt;code&gt;open&lt;/code&gt; must begin with a pipe character regardless
of the direction of the IO; the direction is then given by the mode
argument being &lt;code&gt;&quot;r&quot;&lt;/code&gt; or &lt;code&gt;&quot;w&quot;&lt;/code&gt; etc.  This takes some getting used to;
example:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;perl&#39;s &lt;code&gt;open(FH, &quot;date|&quot;)&lt;/code&gt; is ruby&#39;s &lt;code&gt;open(&quot;|date&quot;)&lt;/code&gt; (because &lt;code&gt;&quot;r&quot;&lt;/code&gt; is
the default); notice how it looks exactly the opposite of what it is
actually doing if you think in perl terms...&lt;/li&gt;
&lt;li&gt;similarly, perl&#39;s &lt;code&gt;open(FH, &quot;|wc&quot;)&lt;/code&gt; is ruby&#39;s &lt;code&gt;open(&quot;|wc&quot;, &quot;w&quot;)&lt;/code&gt; --
don&#39;t forget the mode or it becomes a read from &quot;wc&quot;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;This is a major gotcha for perlies: implicit regex does not work.  See
&lt;a href=&quot;http://blade.nagaokaut.ac.jp/cgi-bin/scat.rb/ruby/ruby-talk/176285&quot;&gt;http://blade.nagaokaut.ac.jp/cgi-bin/scat.rb/ruby/ruby-talk/176285&lt;/a&gt;&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;Summary: &lt;code&gt;if /ff/&lt;/code&gt; is essentially &lt;code&gt;if some-regex-object&lt;/code&gt;, and since
everything except false or nil is true, this becomes true!  You need to
use the match method explicitly (or the eqvt =~ operator)&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h3&gt;&lt;a name=&quot;Other_gotchas&quot;&gt;Other gotchas&lt;/a&gt;&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;It&#39;s all pass-by-reference, so watch out.  You could destroy data from the
caller accidentally.  In perl you&#39;d have to explicitly pass a reference to
get this effect&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;The Ruby compiler does a single, top-down, parse; when top-level code (not
inside some &lt;code&gt;def&lt;/code&gt;) is encountered, all the functions it refers to must
already have been defined.  This usually means the main body of your
program is forced to be at the bottom of the file, which is not how I
always think.&lt;/p&gt;

&lt;p&gt;Only top-level code has this constraint; code &lt;em&gt;inside&lt;/em&gt; a function does
not.  So you can mitigate this by putting all of your &quot;main&quot; in a function
called &lt;code&gt;main&lt;/code&gt; right at the top, and making a call to main the only
top-level statement, which you can put right at the bottom.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;There is no automatic string&lt;em&gt;to&lt;/em&gt;int conversion; use &lt;code&gt;to_i&lt;/code&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Constructors should be called &lt;code&gt;initalize&lt;/code&gt; but they are invoked using
&lt;code&gt;Class.new&lt;/code&gt;!&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;and&lt;/code&gt; and &lt;code&gt;or&lt;/code&gt; have the same precedence!!!  (why oh why??? ...and they
talk of POLS...)&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Constants... aren&#39;t!  They can be reassigned, and you only get a warning.
This is probably because constants are references to objects.  You can&#39;t
change the reference (and make it point somewhere else) but you &lt;strong&gt;can&lt;/strong&gt;
change the object being pointed to!  So you can keep Kansas happy:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;include Math
PI = 3.0
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Only &lt;code&gt;nil&lt;/code&gt; and &lt;code&gt;false&lt;/code&gt; evaluate to false; &lt;code&gt;0&lt;/code&gt;, &lt;code&gt;&quot;&quot;&lt;/code&gt;, &lt;code&gt;[]&lt;/code&gt; are all true!&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;good: avoids the &quot;0 but true&quot; kludge&lt;/li&gt;
&lt;li&gt;bad: makes checking for empty string, empty array etc., a bit more wordy&lt;/li&gt;
&lt;li&gt;worse: see &quot;implicit regex&quot; in Major gotchas, above&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;/m&lt;/code&gt; in regex does what &lt;code&gt;/s&lt;/code&gt; does in perl (makes &lt;code&gt;.&lt;/code&gt; match a newline).
Why this gratuitous incompatibility?  And how do you achieve &lt;code&gt;/m&lt;/code&gt; at all
(make &lt;code&gt;^&lt;/code&gt; and &lt;code&gt;$&lt;/code&gt; match embedded newlines)?&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;catch&lt;/code&gt; and &lt;code&gt;throw&lt;/code&gt; are control-flow tools; they allow you to go to the
end of any block -- sort of like a &quot;goto&quot; (gasp!).  Meanwhile, what Java
calls try/catch/throw/finally is actually done by begin/rescue/raise(or
fail)/ensure.  Another gratuitous change?&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h3&gt;&lt;a name=&quot;Other_coolness&quot;&gt;Other coolness&lt;/a&gt;&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;being able to eval a string in a context (or one of any number of
contexts) captured and bound at earlier points in the run, could have some
nifty uses.  (Think of it like capturing various states of your execution
and asking for the eval to run in one or more of those states and return
results to you).  See &lt;code&gt;ri Binding&lt;/code&gt; or &lt;code&gt;ri Proc&lt;/code&gt; for details&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;retry&lt;/code&gt; is nice -- think of it as being one level higher than &lt;code&gt;redo&lt;/code&gt; --
this will be useful somewhere, I&#39;m sure&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;sort_by&lt;/code&gt; implements the Schwartzian Transform directly (but see below)&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h3&gt;&lt;a name=&quot;Open_questions_so_far_&quot;&gt;Open questions (so far)&lt;/a&gt;&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;how do you make &lt;code&gt;sort_by&lt;/code&gt; sort descendingly?  It allows you to define the
&quot;expensive key computation&quot; that is the raison d&#39;etre of the Schwartzian
Transform, but fails to say how to specify a reverse ordering, for
instance.&lt;/li&gt;
&lt;li&gt;what is the eqvt of &lt;code&gt;tr*/&lt;/code&gt;?&lt;/li&gt;
&lt;li&gt;where does the method called &quot;defined?(var)&quot; come from?&lt;/li&gt;
&lt;/ul&gt;
&lt;/html&gt;
</pre>
</div>
<div title="vcd-read-write-with-cdrdao" modifier="Sitaram" created="200903241920">
<pre>
&lt;html&gt;
&lt;h1&gt;read/write VCDs with cdrdao&lt;/h1&gt;

&lt;p&gt;Had to urgently copy VCDs, and xcdroast just wouldn&#39;t allow me. So
google&#39;d around and found the following :&lt;/p&gt;

&lt;p&gt;To read the VCD and create data.bin &amp;amp; vcd.toc files on the HDD&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;cdrdao read-cd --device 0,0,0 --driver generic-mmc -v 3 vcd.toc
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;To write the image onto a blank CD&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;cdrdao write --device 0,0,0 --driver generic-mmc vcd.toc
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Works beautifully. Only take care with the &lt;code&gt;--device 0,0,0&lt;/code&gt;, should
reflect the actual postion of the CDR-W device, I took mine from what
xcdroast showed me.&lt;/p&gt;
&lt;/html&gt;
</pre>
</div>
<div title="mp3-downres" modifier="Sitaram" created="200903241920">
<pre>
&lt;html&gt;
&lt;h1&gt;Down-res an mp3 to 128kbps&lt;/h1&gt;

&lt;p&gt;lame created mp3 files better (larger) than 128kbps? want to reduce them?&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;run the following on each mp3&lt;/li&gt;
&lt;li&gt;&lt;p&gt;manually review the output (all lines starting with LOG and with LOG
ACTION)&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;#!/bin/bash
# $1 is one MP3 file

# get bitrate
br=$(mp3info -p %r &quot;$1&quot;)
# assume &quot;Variable&quot; means &amp;gt; 128; du -sk check later will catch exceptions and
# all you lose is some CPU time
[ &quot;$br&quot; == &quot;Variable&quot; ] &amp;amp;&amp;amp; br=256

# br &amp;lt;= 128kbps, no action needed
[[ $br -le 128 ]] &amp;amp;&amp;amp; exit 0

lame -h &quot;$1&quot; &quot;$1.new.mp3&quot;

# ensure new br is 128 (superfluous check?)
brnew=$(mp3info -p %r &quot;$1.new.mp3&quot;)
[ &quot;$brnew&quot; == &quot;128&quot; ] || { echo LOG EXPECTED 128 GOT $brnew FOR &quot;$1.new.mp3&quot;; exit 1; }

# check du old and new, log &quot;mv&quot; action if new is smaller
duold=`du -sk &quot;$1&quot; | cut -f1`
dunew=`du -sk &quot;$1.new.mp3&quot; | cut -f1`
[[ $dunew -lt $duold ]] &amp;amp;&amp;amp; { echo LOG ACTION mv \&quot;$1.new.mp3\&quot; \&quot;$1\&quot;; }
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/html&gt;
</pre>
</div>
<div title="ext3-resize" modifier="Sitaram" created="200903241920">
<pre>
&lt;html&gt;
&lt;h1&gt;How To Resize ext3 Partitions Without Losing Data&lt;/h1&gt;

&lt;p&gt;In brief: fs must be umounted, reboot after fdisk, &lt;strong&gt;fsck liberally&lt;/strong&gt;!  But if
it&#39;s really critical, please go through the source URL once again in case I
missed something here :-)&lt;/p&gt;

&lt;h2&gt;reducing the size&lt;/h2&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;convert ext3 to ext2&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;tune2fs -O ^has_journal /dev/sda1
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;resize the file system (two numbers from this output are needed later: the
blocks and the blocksize)&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;resize2fs /dev/sda1 6000M
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;delete/recreate the partition&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;for the new end-point:  multiply the #blocks from the resize2fs output
(1536000) by the size of a block from the same output, and add 3 to 5%
to it:&lt;/li&gt;
&lt;li&gt;&lt;code&gt;1536000 * 4 * 1.03 = 6328320K&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;make it bootable again if it was bootable when you started&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;convert to ext3 again&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;tune2fs -j /dev/sda1
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h2&gt;increasing the size&lt;/h2&gt;

&lt;ul&gt;
&lt;li&gt;almost the same except resize2fs happens &lt;strong&gt;after&lt;/strong&gt; fdisk&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Source: &lt;a href=&quot;http://www.howtoforge.com/linux_resizing_ext3_partitions&quot;&gt;http://www.howtoforge.com/linux_resizing_ext3_partitions&lt;/a&gt;&lt;/p&gt;
&lt;/html&gt;
</pre>
</div>
<div title="socket-performance-on-Linux" modifier="Sitaram" created="200903241920">
<pre>
&lt;html&gt;
&lt;h1&gt;networking - socket performance on Linux&lt;/h1&gt;

&lt;h3&gt;Bandwidth delay product&lt;/h3&gt;

&lt;pre&gt;&lt;code&gt;BDP = link_bandwidth * RTT
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Say 100 Mbps, and a 50 ms RTT, the BDP is:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;100MBps * 0.050 sec / 8 = 0.625MB = 625KB
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;But the default window for TCP on Linux 2.6 is 110KB, which limits your
bandwidth for the connection to 2.2MBps:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;throughput = window_size / RTT = 110KB / 0.050 = 2.2MBps
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;If instead you use the window size calculated above, you get a whopping 12.5MBps:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;625KB / 0.050 = 12.5MBps
&lt;/code&gt;&lt;/pre&gt;

&lt;h3&gt;Table 1. Kernel tunable parameters for TCP/IP stack performance&lt;/h3&gt;

&lt;p&gt;&lt;strong&gt;for a large BDP, these 4 should be larger&lt;/strong&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;/proc/sys/net/core/rmem_default (default receive window size)
/proc/sys/net/core/rmem_max (max ...)
/proc/sys/net/core/wmem_default (default send window size)
/proc/sys/net/core/wmem_max (max ...)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;sup&gt;Source: &lt;a href=&quot;http://www-128.ibm.com/developerworks/linux/library/l-hisock.html?ca=dgr-lnxw01BoostSocket&quot;&gt;http://www-128.ibm.com/developerworks/linux/library/l-hisock.html?ca=dgr-lnxw01BoostSocket&lt;/a&gt;&lt;/sup&gt;&lt;/p&gt;
&lt;/html&gt;
</pre>
</div>
<div title="harddisk-reliability" modifier="Sitaram" created="200903241920">
<pre>
&lt;html&gt;
&lt;h1&gt;hard disk reliability&lt;/h1&gt;

&lt;h2&gt;hard disk load cycle count, attribute 193&lt;/h2&gt;

&lt;h3&gt;Problem&lt;/h3&gt;

&lt;p&gt;&lt;code&gt;smartctl -A /dev/sda&lt;/code&gt; shows attribute # 193 increasing too fast.
This is a problem with the default setting of the disk, nothing to do with
Linux, but if we don&#39;t set it right, the hard disk will need replacement
too soon, often in a year or less.&lt;/p&gt;

&lt;h3&gt;Changes made on my laptop&lt;/h3&gt;

&lt;p&gt;In &lt;code&gt;/usr/share/pm-utils/sleep.d/92disk&lt;/code&gt;, added a line inside function resume_disk&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;/sbin/hdparm -B 254 -S 241 /dev/sda
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Note that the file doesn&#39;t recognise SATA so the &quot;proper&quot; way (setting
&quot;RESUME_DISK&quot; at the top of the function) also doesnt work&lt;/p&gt;

&lt;p&gt;In &lt;code&gt;/etc/laptop-mode/laptop-mode.conf&lt;/code&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;# Idle timeout values. (hdparm -S)
# Default is 2 hours on AC (NOLM_HD_IDLE_TIMEOUT_SECONDS=7200) and 20 seconds
# for battery and for AC with laptop mode on.
LM_AC_HD_IDLE_TIMEOUT_SECONDS=5400
LM_BATT_HD_IDLE_TIMEOUT_SECONDS=3600
NOLM_HD_IDLE_TIMEOUT_SECONDS=7200

# Should laptop mode tools control the hard drive power management settings?
CONTROL_HD_POWERMGMT=1

# Power management for HD (hdparm -B values)
# sita, next 3 values were 1, 255, and 255
BATT_HD_POWERMGMT=254
LM_AC_HD_POWERMGMT=254
NOLM_AC_HD_POWERMGMT=254
&lt;/code&gt;&lt;/pre&gt;
&lt;/html&gt;
</pre>
</div>
<div title="ack" modifier="Sitaram" created="201008011132">
<pre>
&lt;html&gt;
&lt;h1&gt;&lt;a name=&quot;ack&quot;&gt;ack&lt;/a&gt;&lt;/h1&gt;

&lt;p&gt;Ack is a great replacement for &lt;code&gt;grep&lt;/code&gt;, written as a standalone perl
program and loaded with lots of convenient features.  The most visible plus
points are:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;recursive by default, but knows to ignore certain files&lt;/li&gt;
&lt;li&gt;uses perl regex syntax all through&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;The downsides are:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;when raw speed is very important, use grep&lt;/li&gt;
&lt;li&gt;it can&#39;t replace &lt;code&gt;grep -f&lt;/code&gt;, which takes a list of patterns&lt;/li&gt;
&lt;li&gt;it has a few corner cases, especially when input is a pipe, where it
behaves weirdly&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Until you understand its file include/exclude logic, you might be missing
matches that you were expecting it to catch.  However, this is part of the
utility value of the tool, so it&#39;s worth learning, and anyway you can always
use the &lt;code&gt;-f&lt;/code&gt; option to see what files it &lt;em&gt;does&lt;/em&gt; include.&lt;/p&gt;

&lt;hr /&gt;

&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#ack&quot;&gt;ack&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#file_selection&quot;&gt;file selection&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#tricks_and_tips&quot;&gt;tricks and tips&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#the_ACKRC_file&quot;&gt;the ACKRC file&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#trouble_shooting&quot;&gt;trouble-shooting&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#option_comparision_with_grep&quot;&gt;option comparision with grep&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#options_missing_in_ack&quot;&gt;options missing in ack&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#options_different_in_ack&quot;&gt;options different in ack&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#options_identical_in_both&quot;&gt;options identical in both&lt;/a&gt;&lt;br&gt;&lt;/p&gt;

&lt;hr /&gt;

&lt;h3&gt;&lt;a name=&quot;file_selection&quot;&gt;file selection&lt;/a&gt;&lt;/h3&gt;

&lt;p&gt;Ack&#39;s most visible feature is that it is recursive by default.  This isn&#39;t
about just saving a few keystrokes to type &lt;code&gt;grep -r&lt;/code&gt; -- ack by default
ignores most build/version control meta files, binary files, and any files
whose type it does not know anything about.  As a result, it often searches a
much smaller set of files.&lt;/p&gt;

&lt;p&gt;In increasing order of files included, the options are:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;(default) -- no unknown file types&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;--text&lt;/code&gt; -- any file that looks like &quot;text&quot; to perl&#39;s &lt;code&gt;-T&lt;/code&gt;
operator.  However, the following one-line patch is often needed to
reconcile this statement with the actual truth:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;@@ -1713,7 +1713,7 @@



 sub is_interesting {
-    return if /^\./;
+    # sita return if /^\./;

&lt;pre&gt;&lt;code&gt; my $include;
&lt;/code&gt;&lt;/pre&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;-a&lt;/code&gt; -- search all files, even binary files&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;-u&lt;/code&gt; -- search even the directories it normally ignores, like
&lt;code&gt;.git&lt;/code&gt;, &lt;code&gt;CVS&lt;/code&gt;, etc.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Other things that influence the selection are:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;code&gt;-n&lt;/code&gt; -- no descending into subdirs&lt;/li&gt;
&lt;li&gt;&lt;code&gt;-G regex&lt;/code&gt; -- only paths matching regex are included&lt;/li&gt;
&lt;li&gt;&lt;code&gt;--perl&lt;/code&gt;, &lt;code&gt;--noperl&lt;/code&gt; and many other similar options -- see &lt;code&gt;ack
--help type&lt;/code&gt; for details&lt;/li&gt;
&lt;li&gt;&lt;code&gt;--type-set&lt;/code&gt; and &lt;code&gt;--type-add&lt;/code&gt; -- see below&lt;/li&gt;
&lt;li&gt;&lt;code&gt;--ignore-dir=DIR&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;--follow&lt;/code&gt; -- follow symlinks; off by default&lt;/li&gt;
&lt;/ul&gt;

&lt;h3&gt;&lt;a name=&quot;tricks_and_tips&quot;&gt;tricks and tips&lt;/a&gt;&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;&lt;code&gt;-g REGEX&lt;/code&gt; -- combination of &lt;code&gt;-f -G REGEX&lt;/code&gt; to quickly see what
files match a regex in the current tree; can be faster to type than
find|grep&lt;/li&gt;
&lt;li&gt;&lt;code&gt;--passthru&lt;/code&gt; -- colors matches but does not discard non-matching
lines; great for simple cases of log watching&lt;/li&gt;
&lt;li&gt;&lt;code&gt;--line=1,3,6-9&lt;/code&gt; can be more convenient than telling sed or awk to
print only lines with a certain line number&lt;/li&gt;
&lt;li&gt;grep ignores &lt;code&gt;-c&lt;/code&gt; (count) when &lt;code&gt;-l&lt;/code&gt; or &lt;code&gt;-L&lt;/code&gt; are also used.
Ack gives you meaningful output in both cases&lt;/li&gt;
&lt;li&gt;&lt;p&gt;to search files with an extension that ack does not know about (say
&quot;lfy&quot;), try&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;ack --noenv --type-set abc=.lfy --abc pattern
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h3&gt;&lt;a name=&quot;the_ACKRC_file&quot;&gt;the ACKRC file&lt;/a&gt;&lt;/h3&gt;

&lt;p&gt;You can set options permanently in an &lt;code&gt;~/.ackrc&lt;/code&gt; file.  Here&#39;s mine.  I
prefer to search all &quot;text&quot; files (though I patch it as shown above because I
prefer not to exclude &quot;dot-files&quot;).  Smart-case is a neat way of never having
to worry about specifying the case-ignore setting: if the regex has only lower
case characters, it behaves like &quot;ignore case&quot; is set.  I like to see the
files sorted, and I specify what pager I want to use and its options.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;--text
--smart-case
--sort-files
--pager=less -rF
&lt;/code&gt;&lt;/pre&gt;

&lt;h3&gt;&lt;a name=&quot;trouble_shooting&quot;&gt;trouble-shooting&lt;/a&gt;&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;&lt;code&gt;-f&lt;/code&gt; allows you to see what files are being included by its internal
logic for the set of options in effect&lt;/li&gt;
&lt;li&gt;&lt;code&gt;--noenv&lt;/code&gt; -- turn off all environment and ackrc settings if things
don&#39;t seem to work right&lt;/li&gt;
&lt;li&gt;&lt;code&gt;-Q&lt;/code&gt; -- turn off regex meta characters if needed&lt;/li&gt;
&lt;li&gt;&lt;code&gt;--flush&lt;/code&gt; -- if you&#39;re piping to a command and there are timing issues&lt;/li&gt;
&lt;/ul&gt;

&lt;h3&gt;&lt;a name=&quot;option_comparision_with_grep&quot;&gt;option comparision with grep&lt;/a&gt;&lt;/h3&gt;

&lt;h4&gt;&lt;a name=&quot;options_missing_in_ack&quot;&gt;options missing in ack&lt;/a&gt;&lt;/h4&gt;

&lt;ul&gt;
&lt;li&gt;&lt;code&gt;-n&lt;/code&gt; -- prefix line number (this seems like a big omission!)&lt;/li&gt;
&lt;li&gt;&lt;code&gt;-q&lt;/code&gt; and &lt;code&gt;-s&lt;/code&gt; -- quiet/silent/no-messages options&lt;/li&gt;
&lt;li&gt;&lt;code&gt;-z&lt;/code&gt; -- input terminated by null bytes&lt;/li&gt;
&lt;/ul&gt;

&lt;h4&gt;&lt;a name=&quot;options_different_in_ack&quot;&gt;options different in ack&lt;/a&gt;&lt;/h4&gt;

&lt;ul&gt;
&lt;li&gt;&lt;code&gt;-Z&lt;/code&gt; in grep is &lt;code&gt;--print0&lt;/code&gt; here&lt;/li&gt;
&lt;li&gt;&lt;code&gt;-NUM&lt;/code&gt; is &lt;code&gt;-C NUM&lt;/code&gt; here; the -C is mandatory&lt;/li&gt;
&lt;li&gt;&lt;code&gt;-e&lt;/code&gt; is &lt;code&gt;--match&lt;/code&gt; here&lt;/li&gt;
&lt;li&gt;&lt;code&gt;-F&lt;/code&gt; is &lt;code&gt;-Q&lt;/code&gt; here; treat patterns as fixed strings&lt;/li&gt;
&lt;/ul&gt;

&lt;h4&gt;&lt;a name=&quot;options_identical_in_both&quot;&gt;options identical in both&lt;/a&gt;&lt;/h4&gt;

&lt;ul&gt;
&lt;li&gt;&lt;code&gt;-i&lt;/code&gt; -- ignore case (but I prefer smart-case; see above)&lt;/li&gt;
&lt;li&gt;&lt;code&gt;-v&lt;/code&gt; -- invert match&lt;/li&gt;
&lt;li&gt;&lt;code&gt;-w&lt;/code&gt; -- word match&lt;/li&gt;
&lt;li&gt;&lt;code&gt;-l&lt;/code&gt; -- names of files with matches&lt;/li&gt;
&lt;li&gt;&lt;code&gt;-L&lt;/code&gt; -- names of files without matches&lt;/li&gt;
&lt;li&gt;&lt;code&gt;-o&lt;/code&gt; -- print only matching part&lt;/li&gt;
&lt;li&gt;&lt;code&gt;-mNUM&lt;/code&gt; -- stop reading a file after NUM matches&lt;/li&gt;
&lt;li&gt;&lt;code&gt;-A/-B&lt;/code&gt; -- after and before context (but see note on -C above)&lt;/li&gt;
&lt;/ul&gt;
&lt;/html&gt;
</pre>
</div>
<div title="squidguard" modifier="Sitaram" created="200903241920">
<pre>
&lt;html&gt;
&lt;h1&gt;Using squidGuard for content filtering&lt;/h1&gt;

&lt;p&gt;To make squid aware of squidguard:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;redirect_program /usr/local/bin/squidGuard -c /usr/local/squidGuard/squidGuard.conf
redirect_children 8
redirector_bypass on
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;The redirector_bypass option tells squid to ignore the redirector if it
becomes unavailable for some reason.&lt;/p&gt;

&lt;p&gt;&lt;sup&gt;Source: &lt;a href=&quot;http://www.linux.com/article.pl?sid=07/02/06/1752220&quot;&gt;http://www.linux.com/article.pl?sid=07/02/06/1752220&lt;/a&gt;&lt;/sup&gt;&lt;/p&gt;
&lt;/html&gt;
</pre>
</div>
<div title="ncat" modifier="Sitaram" created="200908221511">
<pre>
&lt;html&gt;
&lt;h1&gt;ncat&lt;/h1&gt;

&lt;p&gt;(aka: oh God please not yet another netcat clone!)&lt;/p&gt;

&lt;p&gt;ncat ships with the new nmap 5.  In general, &lt;a href=&quot;socat.html&quot;&gt;socat&lt;/a&gt; cleans its
clock, except for these points:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;can act as a proxy &lt;em&gt;server&lt;/em&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;broker mode; see &lt;a href=&quot;http://nmap.org/ncat/guide/ncat-file-transfer.html&quot;&gt;http://nmap.org/ncat/guide/ncat-file-transfer.html&lt;/a&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;host3$ ncat -l --broker
host2$ ncat host3 &amp;gt; outputfile
host1$ ncat --send-only host3 &amp;lt; inputfile
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Note that it&#39;s important for host2 (the receiving host) to connect to the
broker before host1 (the sending host) does. The broker does not buffer
received data to send to hosts that connect later. After the file is
transferred, it is necessary to forcible disconnect the Ncat on host2 with
ctrl+C. The broker never disconnects any of its clients.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;chat mode: &lt;code&gt;ncat -l --chat&lt;/code&gt; on the server and everyone else just does
&lt;code&gt;ncat server&lt;/code&gt;.  (Chat mode is a special case of broker mode where the
server adds a connection ID to each output line so you sorta know who said
what)&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/html&gt;
</pre>
</div>
<div title="flatfield-images" modifier="Sitaram" created="200903241920">
<pre>
&lt;html&gt;
&lt;h1&gt;Flatfield images&lt;/h1&gt;

&lt;p&gt;So, the theory of &quot;flatfields&quot; goes like this:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;Before the night starts ...
&lt;ul&gt;
&lt;li&gt;take a picture of a uniform, bright scene: a &quot;flatfield image&quot;&lt;/li&gt;
&lt;li&gt;use the pixel values of this &quot;flatfield&quot; to define the relative
sensitivity of each pixel &lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;During the night ....
&lt;ul&gt;
&lt;li&gt;take pictures of stars, galaxies, etc. &lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;Afterwards ...
&lt;ul&gt;
&lt;li&gt;divide the pictures of stars by the &quot;flatfield&quot; image to correct for
differences in sensitivity&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Source: &lt;a href=&quot;http://spiff.rit.edu/classes/phys445/lectures/flats/flats.html&quot;&gt;http://spiff.rit.edu/classes/phys445/lectures/flats/flats.html&lt;/a&gt;&lt;/p&gt;
&lt;/html&gt;
</pre>
</div>
<div title="par2" modifier="Sitaram" created="200903241920">
<pre>
&lt;html&gt;
&lt;h1&gt;parchive2/par2 notes&lt;/h1&gt;

&lt;p&gt;Note: I have no idea what the &quot;-l&quot; does.  Limit to what???&lt;/p&gt;

&lt;p&gt;Here&#39;s some explanation of the various options; the documentation is not very
clear on some of these points and I experimented to find some of this.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;-b&amp;lt;n&amp;gt;  : Set the Block-Count
-s&amp;lt;n&amp;gt;  : Set the Block-Size (Don&#39;t use both -b and -s)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;These options control how the input is divided for processing.  &quot;-b&quot; is the
number of blocks to divide the input into.  Alternatively, &quot;-s&quot; is the block
size to use for processing.  Clearly b * s = file-size, which is why you can&#39;t
specify both.  The default appears to be &quot;-b2000&quot;; I can&#39;t think of a major
reason to mess with this.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;-r&amp;lt;n&amp;gt;  : Level of Redundancy (%%)
-c&amp;lt;n&amp;gt;  : Recovery block count (Don&#39;t use both -r and -c)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;These options control the amount of recovery data created.  The less your
trust your medium, the more you need to increase this.&lt;/p&gt;

&lt;p&gt;The default seems to be &quot;-r5&quot; (5%), and the computed &quot;-c&quot; will thus be
file-size*r%/s, where s is the blocksize given/computed above.  If you
take all the defaults this reduces to 100 (5% of 2000) regardless of file
size.&lt;/p&gt;

&lt;p&gt;In practice, supplying &quot;-r&quot; seems easier then supplying &quot;-c&quot;.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;-u     : Uniform recovery file sizes
-l     : Limit size of recovery files (Don&#39;t use both -u and -l)
-n&amp;lt;n&amp;gt;  : Number of recovery files (Don&#39;t use both -n and -l)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;These options determine how many recovery files are made and how the recovery
blocks are distributed among them.&lt;/p&gt;

&lt;p&gt;Without &quot;-u&quot;, the par2 files are created with 1, 2, 4, 8, ... blocks.  So you
can easily compute &quot;n&quot; (# of recovery files created) when &quot;c&quot; recovery blocks
are needed.  Again, if you take all the defaults, &quot;n&quot; turns out to be 7.&lt;/p&gt;

&lt;p&gt;With &quot;-u&quot;, instead of a GP starting with 1, it just divides them equally.
(With all other settings at default, you get 2 15s, then 5 14s, total 100).&lt;/p&gt;

&lt;p&gt;The &quot;-n&quot; takes a little explaining.  Let&#39;s say the computed &quot;n&quot; is 9, and you
override it by saying &quot;-n4&quot;.  Then, instead of par2 files going 1, 2, 4, 8...,
they go 32, 64, 128, etc., until the number of blocks needed are created.  Of
course, 32 is 2^(9-4) -- essentially scale up in powers of two to compensate
for the lesser number of files.&lt;/p&gt;
&lt;/html&gt;
</pre>
</div>
<div title="funny-quotes" modifier="Sitaram" created="200903241920">
<pre>
&lt;html&gt;
&lt;h1&gt;Funny Quotes&lt;/h1&gt;

&lt;ul&gt;
&lt;li&gt;I&#39;m a consultant - I convert gibberish into cash-flow.&lt;/li&gt;
&lt;li&gt;When you&#39;re too old to think, you reminisce -- from a talk by van Jacobsen&lt;/li&gt;
&lt;li&gt;Doug Carlin: I&#39;ll speak slowly so that those of you in the room who have PhDs can understand me. 
&lt;ul&gt;
&lt;li&gt;from the movie Deja Vu (2006)&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/html&gt;
</pre>
</div>
<div title="info-browser" modifier="Sitaram" created="200903241920">
<pre>
&lt;html&gt;
&lt;h1&gt;info browser cheatsheet&lt;/h1&gt;

&lt;ul&gt;
&lt;li&gt;&lt;code&gt;[&lt;/code&gt; and &lt;code&gt;]&lt;/code&gt; are the faster eqvts of &lt;code&gt;space&lt;/code&gt; and
&lt;code&gt;backspace&lt;/code&gt; for paging through an entire info tree; they only show the
first page of each node before moving to the next one&lt;/li&gt;
&lt;li&gt;&lt;code&gt;m&lt;/code&gt; for menus and &lt;code&gt;f&lt;/code&gt; for xrefs can use &lt;code&gt;TAB&lt;/code&gt; for completion&lt;/li&gt;
&lt;li&gt;&lt;code&gt;l&lt;/code&gt; is very important, esp when you have used xrefs to jump out of the
chain&lt;/li&gt;
&lt;li&gt;&lt;code&gt;u&lt;/code&gt; moves &quot;up&quot;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;d&lt;/code&gt; directory node&lt;br&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;t&lt;/code&gt; top node&lt;br&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;i&lt;/code&gt; index node, searchable&lt;br&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;,&lt;/code&gt; search for next index match entry (not tried yet)&lt;/li&gt;
&lt;/ul&gt;
&lt;/html&gt;
</pre>
</div>
<div title="nc-netcat" modifier="Sitaram" created="200903241920">
<pre>
&lt;html&gt;
&lt;h1&gt;&lt;a name=&quot;netcat_cheat_sheet&quot;&gt;netcat cheat sheet&lt;/a&gt;&lt;/h1&gt;

&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#netcat_cheat_sheet&quot;&gt;netcat cheat sheet&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#Usage&quot;&gt;Usage&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#Cheat_Sheet&quot;&gt;Cheat Sheet&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#major_features&quot;&gt;major features&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#Example_uses_the_light_side&quot;&gt;Example uses -- the light side&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#Example_uses_the_dark_side&quot;&gt;Example uses -- the dark side&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#Notes&quot;&gt;Notes&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#NT_version&quot;&gt;NT version&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#NT_only_features&quot;&gt;NT-only features&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#Examples&quot;&gt;Examples&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#PROBLEMS_with_Netcat_1_1_for_NT&quot;&gt;PROBLEMS with Netcat 1.1 for NT&lt;/a&gt;&lt;br&gt;&lt;/p&gt;

&lt;hr /&gt;

&lt;h3&gt;&lt;a name=&quot;Usage&quot;&gt;Usage&lt;/a&gt;&lt;/h3&gt;

&lt;pre&gt;&lt;code&gt;[v1.10]
connect:    nc            [-options] hostname port[s] [ports] ... 
listen :    nc -l -p port [-options] [hostname] [port]
options:
        -e prog     program to exec after connect [dangerous!!]
        -b          allow broadcasts
        -g gateway  source-routing hop point[s], up to 8
        -G num      source-routing pointer: 4, 8, 12, ...
        -h          this cruft
        -i secs     delay interval for lines sent, ports scanned
        -l          listen mode, for inbound connects
        -n          numeric-only IP addresses, no DNS
        -o file     hex dump of traffic
        -p port     local port number
        -r          randomize local and remote ports
        -q secs     quit after EOF on stdin and delay of secs
        -s addr     local source address
        -t          answer TELNET negotiation
        -u          UDP mode
        -v          verbose [use twice to be more verbose]
        -w secs     timeout for connects and final net reads
        -z          zero-I/O mode [used for scanning]
port numbers can be individual or ranges: lo-hi [inclusive]
&lt;/code&gt;&lt;/pre&gt;

&lt;h3&gt;&lt;a name=&quot;Cheat_Sheet&quot;&gt;Cheat Sheet&lt;/a&gt;&lt;/h3&gt;

&lt;p&gt;Recommended options: &lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;author recommends &lt;code&gt;-v -w 3&lt;/code&gt; all the time.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Closing a connection:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;Waits for network side to close before exiting.  When using the &lt;code&gt;-w&lt;/code&gt;
timeout, it waits for that long after stdin is closed, does a &quot;final net
read&quot;, then closes the socket and exits.&lt;/li&gt;
&lt;/ul&gt;

&lt;h4&gt;&lt;a name=&quot;major_features&quot;&gt;major features&lt;/a&gt;&lt;/h4&gt;

&lt;ul&gt;
&lt;li&gt;Outbound or inbound connections, TCP or UDP, to or from any ports&lt;/li&gt;
&lt;li&gt;Full DNS forward/reverse checking, with appropriate warnings&lt;/li&gt;
&lt;li&gt;Ability to use any local source port&lt;/li&gt;
&lt;li&gt;Ability to use any locally-configured network source address&lt;/li&gt;
&lt;li&gt;Built-in port-scanning capabilities, with randomizer&lt;/li&gt;
&lt;li&gt;Built-in loose source-routing capability&lt;/li&gt;
&lt;li&gt;Can read command line arguments from standard input&lt;/li&gt;
&lt;li&gt;Slow-send mode, one line every N seconds&lt;/li&gt;
&lt;li&gt;Hex dump of transmitted and received data&lt;/li&gt;
&lt;li&gt;Optional ability to let another program service established connections&lt;/li&gt;
&lt;li&gt;Optional telnet-options responder&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Arguments from stdin:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;If no command arguments are given at all, netcat asks for them, reads a
line from standard input, and breaks it up into arguments internally.
This can be useful when driving netcat from certain types of scripts, with
the side effect of hiding your command line arguments from &quot;ps&quot; displays.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;(&lt;code&gt;-v&lt;/code&gt; without &lt;code&gt;-n&lt;/code&gt;) full DNS check:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;Do a full forward and reverse name and address lookup for the host, and
warn about the all-too-common problem of mismatched names in the DNS.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;UDP stuff:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;please read the README again for caveats etc.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;(&lt;code&gt;-l&lt;/code&gt;) Restricting who connects to a listening nc:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;If you specify a target host and optional port in listen mode, netcat will
accept an inbound connection only from that host and if you specify one,
only from that foreign source port.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;(&lt;code&gt;-e&lt;/code&gt;) exec mode:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;Command name only; cannot take arguments!  If you want to launch something
with an argument list, write a two-line wrapper script or just use inetd
like always.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;port-scanning:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;See first syntax in &lt;em&gt;Usage&lt;/em&gt; above.  If more than one port is thus
specified, netcat connects to &lt;strong&gt;all&lt;/strong&gt; of them, sending the same batch of
data from standard input [up to 8K worth] to each one that is successfully
connected to.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;(&lt;code&gt;-r&lt;/code&gt;) random local and scanned ports:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;Scanning is normally done downward in the range given unless &lt;code&gt;-r&lt;/code&gt; is
given.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;(&lt;code&gt;-v -v&lt;/code&gt;) verbosity in port scanning:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;Specifying multiple ports also suppresses diagnostic messages about
refused connections, unless &lt;code&gt;-v&lt;/code&gt; is specified twice for &quot;more
verbosity&quot;.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;(&lt;code&gt;-z&lt;/code&gt;) for scanning:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;Prevents sending any data to a TCP connection and very limited probe data
to a UDP connection, and is thus useful as a fast scanning mode just to
see what ports the target is listening on.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;source-routing:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;Please first learn how this works in general, then hit the README again!
(&lt;code&gt;traceroute -g&lt;/code&gt; may be a good start)&lt;/li&gt;
&lt;/ul&gt;

&lt;h3&gt;&lt;a name=&quot;Example_uses_the_light_side&quot;&gt;Example uses -- the light side&lt;/a&gt;&lt;/h3&gt;

&lt;p&gt;scripts:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;plenty in the distribution; please read!&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;replacement for telnet:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;must use this more often... esp on windows&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;better scanning example:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;typing&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;echo QUIT | nc -v -w 5 target 20-250 500-600 5990-7000
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Sending in QUIT and using the timeout will almost guarantee that you see
some kind of greeting or error from each service, which usually indicates
what it is and what version.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Beware of the &lt;em&gt;chargen&lt;/em&gt; port, though...&lt;/strong&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;more intrusive example:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;is in scripts/probe&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;minimal web server:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;For shipping things to a PC that doesn&#39;t have any network applications
except a TCP stack and a web browser.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;run this on some handy server&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;(echo HTTP/1.0 200 OK; \
    echo Content-type: application/octet-stream; \
    echo; cat WomenAreComplicated_1.jpg ) |
nc -v -l -p 3333
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;point the browser at &lt;a href=&quot;http://somehost:3333/whatever&quot;&gt;http://somehost:3333/whatever&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Since it&#39;s cumbersome to add content-length and keepalive headers to
enable the browser to detect when the transmission is complete, you need
to make the netcat side close when done.  Best way is to add a &lt;code&gt;-w 10&lt;/code&gt; or
something.&lt;/p&gt;

&lt;p&gt;However, remember that in that case you must either (1) start the browser
download within the 10 seconds (since the &lt;code&gt;-w&lt;/code&gt; applies to both the initial
connect as well as &quot;final net read&quot;) or (2) put the netcat in a shell loop
until it &quot;succeeds&quot; (exit code 0).&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;avoiding &quot;address in use&quot; error:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;By binding to a specific address.  This lets you place netcat &quot;in the way&quot;
of a standard service (assuming the standard service is bound to &quot;any&quot;)&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;simple TCP redirector under inetd:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;for inbound services.  Example :&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;www stream tcp nowait nobody /etc/tcpd /bin/nc -w 3 realwww 80
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;and you have a simple and effective &quot;application relay&quot; with access
control and logging.  Note use of the wait time as a &quot;safety&quot; in case
realwww isn&#39;t reachable or the calling user aborts the connection --
otherwise the relay may hang there forever.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;stress test networks:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;generate huge amounts of useless network data for various performance
testing.  For example, doing&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;yes AAAAAAAAAAAAAAAAAAAAAA | nc -v -v -l -p 2222 &amp;gt; /dev/null
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;on one side and then hitting it with&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;yes BBBBBBBBBBBBBBBBBBBBBB | nc othermachine 2222 &amp;gt; /dev/null
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;from another host will saturate your wires with A&#39;s and B&#39;s.  The &quot;very
verbose&quot; switch usage will tell you how many of each were sent and
received after you interrupt either side.  Using UDP mode produces
tremendously MORE trash per unit time in the form of fragmented 8 Kbyte
mobygrams -- enough to stress-test kernels and network interfaces.&lt;/p&gt;

&lt;p&gt;Firing random binary data into various network servers may help expose
bugs in their input handling.  example in data/data.c (src pkg?) includes
ability to generate random dataat well-chosen points in a data stream!&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;debugging network protocols using the hex dump:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;Bind a listening netcat to a local port, and have it run a script which in
turn runs another netcat to the real service and captures the hex dump to
a log file.  This sets up a transparent relay between your local port and
wherever the real service is.&lt;/p&gt;

&lt;p&gt;Be sure that the script-run netcat does &lt;strong&gt;not&lt;/strong&gt; use &lt;code&gt;-v&lt;/code&gt;, or the extra
info it sends to standard error may confuse the protocol.  Note also that
you cannot have the &quot;listen/exec&quot; netcat do the data capture, since once
the connection arrives it is no longer netcat that is running.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;test remote sysloggers:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;Make a UDP connection to port 514 and type in &lt;code&gt;&amp;lt;0&amp;gt;message&lt;/code&gt;, which
should correspond to &quot;kern.emerg&quot; and cause syslogd to scream into every
file it has open [and possibly all over users&#39; terminals].  Look in
sysog.h for other numbers (example, &lt;code&gt;&amp;lt;38&amp;gt;&lt;/code&gt; could be auth.notice).&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;protect X against outside access:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;X is stupid enough to listen for connections on &quot;any&quot; and never tell you
when new connections arrive, which is one reason it is so vulnerable.
Once you have all your various X windows up and running you can use netcat
to bind just to your ethernet address and listen to port 6000.  Any new
connections from outside the machine will hit netcat instead your X
server, and you get a log of who&#39;s trying.&lt;/p&gt;

&lt;p&gt;Since netcat only handles one listening connection per run, make sure that
whatever way you rig it causes another one to run and listen on 6000 soon
afterward, or your real X server will be reachable once again.  A very
minimal script just to protect yourself could be
    while true ; do
        nc -v -l -s &lt;your-addr&gt; -p 6000 localhost 2
    done
which causes netcat to accept and then close any inbound connection to
your workstation&#39;s normal ethernet address, and another copy is
immediately run by the script.  Send standard error to a file for a log of
connection attempts.&lt;/p&gt;

&lt;p&gt;If your system can&#39;t do the &quot;specific bind&quot; thing all is not lost; run
your X server on display &quot;:1&quot; or port 6001, and netcat can still function
as a probe alarm by listening on 6000.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h3&gt;&lt;a name=&quot;Example_uses_the_dark_side&quot;&gt;Example uses -- the dark side&lt;/a&gt;&lt;/h3&gt;

&lt;p&gt;hijack listeners:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;code&gt;-e&lt;/code&gt; in conjunction with binding to a specific address can enable
&quot;server takeover&quot; by getting in ahead of the real ones, whereupon you can
snarf data sent in and feed your own back out.  At the very least you can
log a hex dump of someone else&#39;s session.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;backdoor shell:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;code&gt;-e&lt;/code&gt; to start a remote backdoor shell is easier than constructing a
file for inetd, and you can access-control it against other people by
specifying a client host and port.  Example is in scripts/bsh.&lt;/li&gt;
&lt;/ul&gt;

&lt;h3&gt;&lt;a name=&quot;Notes&quot;&gt;Notes&lt;/a&gt;&lt;/h3&gt;

&lt;p&gt;A discussion of various caveats, subtleties, and the design of the innards:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;If you want to use a normal full-blown telnet to get to something but also
want some of netcat&#39;s features involved like settable ports or timeouts,
construct a tiny &quot;foo&quot; script :&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;#! /bin/sh
exec nc -otheroptions targethost 23
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;and then do&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;nc -l -p someport -e foo localhost &amp;amp;
telnet localhost someport
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;and your telnet should connect transparently through the exec&#39;ed netcat to
the target, using whatever options you supplied in the &quot;foo&quot; script.
Don&#39;t use &lt;code&gt;-t&lt;/code&gt; inside the script, or you&#39;ll wind up sending &lt;strong&gt;two&lt;/strong&gt;
option responses.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h3&gt;&lt;a name=&quot;NT_version&quot;&gt;NT version&lt;/a&gt;&lt;/h3&gt;

&lt;h4&gt;&lt;a name=&quot;NT_only_features&quot;&gt;NT-only features&lt;/a&gt;&lt;/h4&gt;

&lt;p&gt;Ability to run in the background without a console window&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;-d
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Ability to restart as a single-threaded server to handle a new connection&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;-L
&lt;/code&gt;&lt;/pre&gt;

&lt;h4&gt;&lt;a name=&quot;Examples&quot;&gt;Examples&lt;/a&gt;&lt;/h4&gt;

&lt;ul&gt;
&lt;li&gt;get a quick shell going
    nc -l -p 23 -t -e cmd.exe
Using AT to schedule Netcat would run it with user &lt;code&gt;NT
AUTHORITY\SYSTEM&lt;/code&gt;.&lt;/li&gt;
&lt;li&gt;Do a little exploring and see if the firewall you may be behind lets port
53 through.  Then,
    nc -L -p 53 -e cmd.exe&lt;/li&gt;
&lt;li&gt;The &lt;code&gt;-L&lt;/code&gt; (note the capital L) option will restart Netcat with the same
command line when the connection is terminated.  This way you can connect
over and over to the same Netcat process.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;-d&lt;/code&gt; (detach from console) will let Netcat run without an ugly console
window cluttering up the screen or showing up in the task list.&lt;/li&gt;
&lt;li&gt;You can even get Netcat to listen on the NETBIOS ports that are probably
running on most NT machines.  This way you can get a connection to a
machine that may have port filtering enabled in the TCP/IP Security
Network control panel.  Unlike Unix, NT does not seem to have any security
around which ports that user programs are allowed to bind to.  This means
any user can run a program that will bind to the NETBIOS ports.&lt;/li&gt;
&lt;li&gt;You will need to bind &quot;in front of&quot; some services that may already be
listening on those ports by binding to a specific IP address :
    nc -v -L -e cmd.exe -p 139 -s xxx.xxx.xxx.xxx
Now you can connect to the machine on port 139 and Netcat will field the
connection before NETBIOS does.  You have effectively shut off file
sharing on this machine by the way.  You have done this with just user
privileges to boot.&lt;/li&gt;
&lt;/ul&gt;

&lt;h4&gt;&lt;a name=&quot;PROBLEMS_with_Netcat_1_1_for_NT&quot;&gt;PROBLEMS with Netcat 1.1 for NT&lt;/a&gt;&lt;/h4&gt;

&lt;ul&gt;
&lt;li&gt;&lt;code&gt;-w&lt;/code&gt; works for final net reads but not for connections.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;-e&lt;/code&gt; in UDP mode has problems.&lt;/li&gt;
&lt;/ul&gt;
&lt;/html&gt;
</pre>
</div>
<div title="vimperator6" modifier="Sitaram" created="200903241920">
<pre>
&lt;html&gt;
&lt;h1&gt;&lt;a name=&quot;Vimperator_6&quot;&gt;Vimperator 6&lt;/a&gt;&lt;/h1&gt;

&lt;p&gt;&lt;sup&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#Vimperator_6&quot;&gt;Vimperator 6&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#Emergency_stuff&quot;&gt;Emergency stuff&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#Browsing_1&quot;&gt;Browsing 1&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#Browsing_2&quot;&gt;Browsing 2&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#Zooming&quot;&gt;Zooming&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#Other_stuff&quot;&gt;Other stuff&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#Concerns&quot;&gt;Concerns&lt;/a&gt;&lt;br&gt;
&lt;/sup&gt;&lt;/p&gt;

&lt;hr /&gt;

&lt;h3&gt;&lt;a name=&quot;Emergency_stuff&quot;&gt;Emergency stuff&lt;/a&gt;&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;disable all, good for gmail text box etc; Escape to get out&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;&amp;lt;c-q&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;disable only next key&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;&amp;lt;c-v&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;get back menu/toolbars etc&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;set go=mbT
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h3&gt;&lt;a name=&quot;Browsing_1&quot;&gt;Browsing 1&lt;/a&gt;&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;vim-like keybindings&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;h, j, k, l, &amp;lt;c-d&amp;gt;, &amp;lt;c-u&amp;gt;, gg, G, 0, $...
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;caret mode start&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;i
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;reload, skip cache&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;r, R
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;close tab, undo&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;d, u
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;focus on next/previous frame&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;]f, [f
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;view web page name, info&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;&amp;lt;c-g&amp;gt;, g&amp;lt;c-g&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;view source, with external editor (VIM, what else?)&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;gf, gF
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;focus last used input field or first one on page&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;gi
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;open a prompt to switch buffers (tabs)&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;TAB-completion works great; any part of the title or url&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;b&amp;lt;number or pattern&amp;gt;&amp;lt;enter&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;go to the first tab, last tab, switch to last used tab&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;g0, g$, &amp;lt;c-^&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;set buffer-local mark at the current position, across-buffers mark&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;m{a-z}, m{A-Z}
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;jump to mark above&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;&#39;{a-z}, &#39;{A-Z}
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;search for text&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;\c anywhere in pattern == force ignorecase&lt;/li&gt;
&lt;li&gt;&lt;p&gt;\C == noic, \l == linksonly, \L == fulltext&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;/pattern, ?pattern, n, N, etc
*, #    just like in vim
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h3&gt;&lt;a name=&quot;Browsing_2&quot;&gt;Browsing 2&lt;/a&gt;&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;strong&gt;open &quot;next&quot;/&quot;previous&quot; link&lt;/strong&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;]], [[
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;open a link by typing the number or the link text, new tab&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;f, F
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;other actions on links:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;;;              hover
;s/;a           save its destination/save as
;o/;t/;O/;T     as for o/t/O/T
;v              view source!  (WOW!)
;y/;Y           yank url/text
;f/;F           like f/F but in AlwaysHint mode
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;open, in new tab, based on current url&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;can open multiple, separated by &lt;code&gt;comma-space&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;TAB-completion is excellent -- urls and titles too&lt;/li&gt;
&lt;li&gt;&lt;p&gt;firefox keywords and search engines work great&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;o, t, O, T
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;yank current location to clipboard, current text&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;y, Y
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;paste (put) a URL into the current tab, new tab&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;p, P
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;go up to parent URL, website root&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;gu, gU
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;increment last number in URL, decrement&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;&amp;lt;c-a&amp;gt;, &amp;lt;c-x&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;add a quickmark&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;M{a-zA-Z0-9}
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;open a quickmark, in a new tab&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;go{a-zA-Z0-9}, gn{a-zA-Z0-9}
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;add a bookmark&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;a -t title -T tag1,tag2 -k keyword [url]
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h3&gt;&lt;a name=&quot;Zooming&quot;&gt;Zooming&lt;/a&gt;&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;zoom in, zoom in more, zoom out, zoom out more, set % (default 100)&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;zi (+), zm, zo (-), zr, [n]zz
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;same, but including non-text elements&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;zI, zM, zO, zR, [n]zZ
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h3&gt;&lt;a name=&quot;Other_stuff&quot;&gt;Other stuff&lt;/a&gt;&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;record macros (uppercase to append), play macros&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;q{0-9a-zA-Z}, [count]@{0-9a-z}
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h3&gt;&lt;a name=&quot;Concerns&quot;&gt;Concerns&lt;/a&gt;&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;&lt;code&gt;b &amp;lt;search string&amp;gt;&lt;/code&gt; seems to be case-sensitive...!&lt;/li&gt;
&lt;li&gt;the &lt;code&gt;set inv&amp;lt;option&amp;gt;&lt;/code&gt; doesn&#39;t seem to be documented&lt;/li&gt;
&lt;/ul&gt;
&lt;/html&gt;
</pre>
</div>
<div title="lirc" modifier="Sitaram" created="200903241920">
<pre>
&lt;html&gt;
&lt;h1&gt;&lt;a name=&quot;LIRC_linux_infrared_remote_control&quot;&gt;LIRC -- linux infrared remote control&lt;/a&gt;&lt;/h1&gt;

&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#LIRC_linux_infrared_remote_control&quot;&gt;LIRC -- linux infrared remote control&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#_usr_local_bin_lirc_start_&quot;&gt;&lt;code&gt;/usr/local/bin/lirc.start&lt;/code&gt;&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#_etc_sysconfig_lircd_&quot;&gt;&lt;code&gt;/etc/sysconfig/lircd&lt;/code&gt;&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#_etc_lircrc_&quot;&gt;&lt;code&gt;/etc/lircrc&lt;/code&gt;&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#_etc_lircd_conf_&quot;&gt;&lt;code&gt;/etc/lircd.conf&lt;/code&gt;&lt;/a&gt;&lt;br&gt;&lt;/p&gt;

&lt;hr /&gt;

&lt;p&gt;This is my short howto on this topic, based solely on managing to control
&lt;code&gt;mplayer&lt;/code&gt; and &lt;code&gt;xine&lt;/code&gt; using the remote control for a small boombox I
have.  This may not be sufficient for other hardware scenarios.&lt;/p&gt;

&lt;p&gt;First, make sure the BIOS settings show IR enabled, and assigned to (in our
example) &lt;code&gt;COM2&lt;/code&gt;.  This corresponds to &lt;code&gt;/dev/ttyS1&lt;/code&gt; on Linux.  For
other COMs adjust accordingly.&lt;/p&gt;

&lt;p&gt;Install whatever RPMs you can find regarding lirc, including dkms-lirc.  Then
create the files shown below.  &lt;strong&gt;Warning&lt;/strong&gt;: the last file
&lt;code&gt;/etc/lircd.conf&lt;/code&gt; is almost certainly not what &lt;em&gt;you&lt;/em&gt; want -- be sure to
run &lt;code&gt;irrecord&lt;/code&gt; and create your own for &lt;em&gt;your&lt;/em&gt; remote, or use one of the
hundreds of pre-built ones.&lt;/p&gt;

&lt;hr /&gt;

&lt;h3&gt;&lt;a name=&quot;_usr_local_bin_lirc_start_&quot;&gt;&lt;code&gt;/usr/local/bin/lirc.start&lt;/code&gt;&lt;/a&gt;&lt;/h3&gt;

&lt;pre&gt;&lt;code&gt;#!/bin/bash

# best if started from /etc/rc.local
# does not work automatically after suspend/resume; module needs to be
# unloaded and reloaded

set -x
service lircd stop
setserial /dev/ttyS0 uart none
setserial /dev/ttyS1 uart none

depmod -a
modprobe lirc_sir irq=3 io=0x02f8

service lircd start
chmod a+rw /dev/lirc/0              # I can&#39;t be bothered to fine-grain this!

# quick ref of trouble-shooting commands
# mode2 -d /dev/lirc/0              # to test if stuff is coming through
# irrecord -d /dev/lirc/0 stereo    # produces /etc/lircd.conf
# irw                               # see if your buttons are recognised properly
# mplayer -input cmdlist    or xine --keymap=lirc
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Notes on the above:&lt;/p&gt;

&lt;h4&gt;setserial&lt;/h4&gt;

&lt;p&gt;The &lt;code&gt;setserial&lt;/code&gt; command makes the serial port driver, which has by default
grabbed all serial ports, give it back to the lirc driver.  This is necessary.&lt;/p&gt;

&lt;p&gt;Why did I put in a &lt;code&gt;setserial&lt;/code&gt; for &lt;code&gt;/dev/ttyS0&lt;/code&gt; also?  I don&#39;t remember!  I
will have to try without it and see what happens...  TODO&lt;/p&gt;

&lt;h4&gt;chmod&lt;/h4&gt;

&lt;p&gt;If you are paranoid about this, use groups and fix it.&lt;/p&gt;

&lt;hr /&gt;

&lt;h3&gt;&lt;a name=&quot;_etc_sysconfig_lircd_&quot;&gt;&lt;code&gt;/etc/sysconfig/lircd&lt;/code&gt;&lt;/a&gt;&lt;/h3&gt;

&lt;pre&gt;&lt;code&gt;# Customized setings for lirc daemon

# The hardware driver to use, run lircd --driver=? for a list

DRIVER=default

# Hardware driver module to load
HWMOD=lirc_sir

# The device node that communicates with the IR device.
# if you are using lirc_serial, set DEVICE to /dev/ttyS[0-9]
# where 0-9 is the serial port your IR receiver is plugged

# with devfs enabled
DEVICE=/dev/lirc/0
#DEVICE=/dev/lirc/serial

# without devfs
#DEVICE=/dev/lirc

# Serial port for the receiver (for serial driver)
# COM1 (/dev/ttyS0)
#COM_PORT=/dev/ttyS0
#DRIVER_OPTS=&quot;irq=4 io=0x3f8&quot;

# COM2 (/dev/ttyS1)
COM_PORT=/dev/ttyS1
DRIVER_OPTS=&quot;irq=3 io=0x2f8&quot;

# COM3 (/dev/ttyS2)
#COM_PORT=/dev/ttyS2
#DRIVER_OPTS=&quot;irq=4 io=0x3e8

# COM4 (/dev/ttyS3)
#COM_PORT=/dev/ttyS3
#DRIVER_OPTS=&quot;irq=3 io=0x2e8&quot;
&lt;/code&gt;&lt;/pre&gt;

&lt;hr /&gt;

&lt;h3&gt;&lt;a name=&quot;_etc_lircrc_&quot;&gt;&lt;code&gt;/etc/lircrc&lt;/code&gt;&lt;/a&gt;&lt;/h3&gt;

&lt;pre&gt;&lt;code&gt;begin
    button = OSD
    prog = mplayer
    config = osd
end

begin
    button = MUTE
    prog = mplayer
    config = mute
end

begin
    button = PAUSE
    prog = mplayer
    config = pause
end

begin
    button = FFSHORT
    prog = mplayer
    config = seek +10 0
end

begin
    button = BKSHORT
    prog = mplayer
    config = seek -10 0
end

begin
    button = FFLONG
    prog = mplayer
    config = seek +60 0
    repeat = 1
end

begin
    button = BKLONG
    prog = mplayer
    config = seek -60 0
    repeat = 1
end

begin
     button = VOLUP
     prog = mplayer
     config = volume 1
     repeat = 1
end

begin
    button = VOLDN
    prog = mplayer
    config = volume -1
    repeat = 1
end





# visibility toggle of UI windows
begin
    remote = stereo
    button = OSD
    prog   = xine
    repeat = 0
    config = ToggleVisibility
end

# audio muting toggle
begin
    remote = stereo
    button = MUTE
    prog   = xine
    config = Mute
end

# playback pause toggle
begin
    remote = stereo
    button = PAUSE
    prog   = xine
    config = Pause
end

# set position to -7 seconds in current stream
begin
    remote = stereo
    button = BKSHORT
    prog   = xine
    config = SeekRelative-7
end

# set position to +7 seconds in current stream
begin
    remote = stereo
    button = FFSHORT
    prog   = xine
    config = SeekRelative+7
end

# set position to -60 seconds in current stream
begin
    remote = stereo
    button = BKLONG
    prog   = xine
    repeat = 1
    config = SeekRelative-60
end

# set position to +60 seconds in current stream
begin
    remote = stereo
    button = FFLONG
    prog   = xine
    repeat = 1
    config = SeekRelative+60
end

# increment audio volume
begin
    remote = stereo
    button = VOLUP
    prog   = xine
    repeat = 1
    config = Volume+
end

# decrement audio volume
begin
    remote = stereo
    button = VOLDN
    prog   = xine
    repeat = 1
    config = Volume-
end
&lt;/code&gt;&lt;/pre&gt;

&lt;hr /&gt;

&lt;h3&gt;&lt;a name=&quot;_etc_lircd_conf_&quot;&gt;&lt;code&gt;/etc/lircd.conf&lt;/code&gt;&lt;/a&gt;&lt;/h3&gt;

&lt;pre&gt;&lt;code&gt;# this config file was automatically generated
# using lirc-0.8.3-CVS(default) on Sun Feb  3 00:17:00 2008
#
# contributed by
#
# brand:                       stereo
# model no. of remote control:
# devices being controlled by this remote:

begin remote

  name  stereo
  bits           15
  flags SPACE_ENC|CONST_LENGTH
  eps            30
  aeps          100

  header       2363   636
  one          1164   637
  zero          563   637
  gap          45187
  min_repeat      9
  toggle_bit_mask 0x0

      begin codes
          QUIT                     0x5422
          OSD                      0x7122
          MUTE                     0x7B26
          PAUSE                    0x6626
          FFSHORT                  0x1126
          BKSHORT                  0x6126
          FFLONG                   0x6E26
          BKLONG                   0x2E26
          VOLUP                    0x2422
          VOLDN                    0x6422
      end codes

end remote
&lt;/code&gt;&lt;/pre&gt;

&lt;hr /&gt;
&lt;/html&gt;
</pre>
</div>
<div title="bridging" modifier="Sitaram" created="200903241920">
<pre>
&lt;html&gt;
&lt;h1&gt;networking - bridging&lt;/h1&gt;

&lt;p&gt;&lt;sup&gt;&lt;strong&gt;Warning&lt;/strong&gt;: this is from a 2002 document; check &lt;code&gt;man brctl&lt;/code&gt; etc before
committing.  Also, the new &quot;ip&quot; command set may have a different idea of how
to do this, more current!&lt;/sup&gt;&lt;/p&gt;

&lt;p&gt;create a bridge&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;brctl addbr br0
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;switch off /spanning tree protocol/ because we have a simple, non-looping setup&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;brctl stp br0 off
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;attach the ethernet interfaces to the bridge&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;brctl addif br0 eth0
brctl addif br0 eth1
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;now these two devices -- &lt;em&gt;eth0&lt;/em&gt; and &lt;em&gt;eth1&lt;/em&gt; do NOT need an IP address of their
own&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;ifconfig eth0 down
ifconfig eth1 down
?? why is this needed?
ifconfig eth0 0.0.0.0 up
ifconfig eth1 0.0.0.0 up
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;(optionally), give the interface one single IP&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;ifconfig br0 10.2.3.4 up
&lt;/code&gt;&lt;/pre&gt;
&lt;/html&gt;
</pre>
</div>
<div title="ssh-tun" modifier="Sitaram" created="200903241920">
<pre>
&lt;html&gt;
&lt;h1&gt;notes on using SSH for tunnels&lt;/h1&gt;

&lt;h3&gt;layer 3 VPN/tunnels using ssh&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;&lt;code&gt;sshd_config&lt;/code&gt; on the server must specify &lt;code&gt;PermitTunnel yes&lt;/code&gt; or no dice&lt;/li&gt;
&lt;li&gt;&lt;p&gt;create the two tun devices beforehand, as root, and tie them to your
userid; the names have to be tunN (ssh expects them that way)&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;tunctl -u sitaram -t tun0   # on both machines
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;connect; note we just give the two 0&#39;s -- the &quot;tun&quot; prefix is assumed.
Also note you can&#39;t use the &quot;any&quot; syntax (which causes the ssh
client/server to attempt to create the tun device, which requires root
privileges)&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;ssh -w 0:0 sitaram@server
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;give IP addresses to each side; type&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;ifconfig tun0 10.1.1.1 10.1.1.2 netmask 255.255.255.252
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;on one machine, and&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;ifconfig tun0 10.1.1.2 10.1.1.1 netmask 255.255.255.252
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;on the other&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;make sure the firewall isn&#39;t blocking stuff; type this on &lt;strong&gt;both&lt;/strong&gt;
machines (or use other means to ensure this)&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;iptables -I INPUT -i tun+ -j ACCEPT
iptables -I OUTPUT -o tun+ -j ACCEPT
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Now check &lt;code&gt;ip addr&lt;/code&gt; and try pinging the other guy.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;hr /&gt;

&lt;p&gt;(Optional) When done, don&#39;t forget to &lt;code&gt;service shorewall restart&lt;/code&gt; on both
machines, and, on the server, comment out the &lt;code&gt;PermitTunnel&lt;/code&gt; directive and
restart sshd.&lt;/p&gt;

&lt;h3&gt;layer 2 tunnels&lt;/h3&gt;

&lt;p&gt;It is possible that setting &quot;Tunnel ethernet&quot; specifically in &lt;code&gt;ssh_config&lt;/code&gt; may
make the above work similarly for layer 2.  Perhaps it will default to
expecting &lt;code&gt;tapN&lt;/code&gt; instead of &lt;code&gt;tunN&lt;/code&gt; etc., too.  I haven&#39;t felt the need to try
it yet.&lt;/p&gt;
&lt;/html&gt;
</pre>
</div>
<div title="thunderbird-mime-fix" modifier="Sitaram" created="200903241920">
<pre>
&lt;html&gt;
&lt;h1&gt;How to handle bad mime-types in emails&lt;/h1&gt;

&lt;h3&gt;Problem&lt;/h3&gt;

&lt;p&gt;You get an email from someone using a crap mail client which doesn&#39;t put in
the proper mime-type for files, instead using a generic
&lt;code&gt;application/octet-stream&lt;/code&gt; for all files.&lt;/p&gt;

&lt;p&gt;TB now goes by the extension, but the OS-default application for the extension
is something you don&#39;t like.&lt;/p&gt;

&lt;p&gt;And as a result of the generic mimetype, the &quot;always use this...&quot; box is
greyed out in TB&#39;s attachment handler dialog, and you&#39;re tired of constantly
telling TB what application to use.&lt;/p&gt;

&lt;p&gt;You are unable or unwilling to change the OS-default application, and would
like to fix it within TB only.&lt;/p&gt;

&lt;h3&gt;Non-solution&lt;/h3&gt;

&lt;p&gt;You may be tempted to read
http://kb.mozillazine.org/Actions&lt;em&gt;for&lt;/em&gt;attachment&lt;em&gt;file&lt;/em&gt;types and hope for
salvation.  Forget it.  Not in this case (on FF3B3 anyway) :-)&lt;/p&gt;

&lt;h3&gt;Solution&lt;/h3&gt;

&lt;p&gt;So you read &lt;a href=&quot;http://kb.mozillazine.org/MimeTypes.rdf&quot;&gt;http://kb.mozillazine.org/MimeTypes.rdf&lt;/a&gt; and decide to do the
following:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;if feeling adventurous, delete &lt;code&gt;mimeTypes.rdf&lt;/code&gt; from the profile directory&lt;/li&gt;
&lt;li&gt;run TB, open an email &lt;strong&gt;sent correctly&lt;/strong&gt; (with proper mime-type), choose
your application, tell TB to &quot;always use this...&quot; blah blah&lt;/li&gt;
&lt;li&gt;&lt;p&gt;close TB, open the &lt;code&gt;mimeTypes.rdf&lt;/code&gt; file and make the following change
in it.  (There&#39;s only one line to add; the rest is to give you context!)&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;--- mimeTypes.rdf   2008-03-03 13:40:00.000000000 +0530
+++ -   2008-03-03 13:45:43.498568201 +0530
@@ -1,26 +1,27 @@
 &amp;lt;?xml version=&quot;1.0&quot;?&amp;gt;
 &amp;lt;RDF:RDF xmlns:NC=&quot;http://home.netscape.com/NC-rdf#&quot;
          xmlns:RDF=&quot;http://www.w3.org/1999/02/22-rdf-syntax-ns#&quot;&amp;gt;
   &amp;lt;RDF:Seq RDF:about=&quot;urn:mimetypes:root&quot;&amp;gt;
     &amp;lt;RDF:li RDF:resource=&quot;urn:mimetype:application/pdf&quot;/&amp;gt;
   &amp;lt;/RDF:Seq&amp;gt;
   &amp;lt;RDF:Description RDF:about=&quot;urn:mimetypes&quot;&amp;gt;
     &amp;lt;NC:MIME-types RDF:resource=&quot;urn:mimetypes:root&quot;/&amp;gt;
   &amp;lt;/RDF:Description&amp;gt;
   &amp;lt;RDF:Description RDF:about=&quot;urn:mimetype:application/pdf&quot;
+                   NC:fileExtensions=&quot;pdf&quot;
                    NC:value=&quot;application/pdf&quot;
                    NC:editable=&quot;true&quot;
                    NC:description=&quot;PDF document&quot;&amp;gt;
     &amp;lt;NC:handlerProp RDF:resource=&quot;urn:mimetype:handler:application/pdf&quot;/&amp;gt;
   &amp;lt;/RDF:Description&amp;gt;
   &amp;lt;RDF:Description RDF:about=&quot;urn:mimetype:externalApplication:application/pdf&quot;
                    NC:path=&quot;/usr/bin/kpdf&quot;
                    NC:prettyName=&quot;kpdf&quot; /&amp;gt;
   &amp;lt;RDF:Description RDF:about=&quot;urn:mimetype:handler:application/pdf&quot;
                    NC:alwaysAsk=&quot;false&quot;
                    NC:saveToDisk=&quot;false&quot;
                    NC:useSystemDefault=&quot;false&quot;
                    NC:handleInternal=&quot;false&quot;&amp;gt;
     &amp;lt;NC:externalApplication RDF:resource=&quot;urn:mimetype:externalApplication:application/pdf&quot;/&amp;gt;
   &amp;lt;/RDF:Description&amp;gt;
 &amp;lt;/RDF:RDF&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/html&gt;
</pre>
</div>
<div title="proxy-bypass" modifier="Sitaram" created="200903241920">
<pre>
&lt;html&gt;
&lt;h1&gt;Proxy bypass&lt;/h1&gt;

&lt;p&gt;&lt;a href=&quot;http://www.google.com/gwt/n&quot;&gt;http://www.google.com/gwt/n&lt;/a&gt; -- start with a known URL&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;seems to proxy inline images also&lt;/li&gt;
&lt;li&gt;just type a URL&lt;/li&gt;
&lt;li&gt;much cleaner URLs resulting from browsing; you&#39;ll feel like actually using
them :-)&lt;/li&gt;
&lt;li&gt;wont do gmail&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;a href=&quot;http://www.google.com/xhtml&quot;&gt;http://www.google.com/xhtml&lt;/a&gt; -- start with a search&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;search interface to the above; morphs into the &quot;/gwt/n?n=&quot; style URL on
the first link you click but the URL is much more complicated&lt;/li&gt;
&lt;li&gt;does gmail, sort of, but most work proxies will catch it anyway&lt;/li&gt;
&lt;/ul&gt;
&lt;/html&gt;
</pre>
</div>
<div title="opendns" modifier="Sitaram" created="200903241920">
<pre>
&lt;html&gt;
&lt;h1&gt;openDNS IP numbers&lt;/h1&gt;

&lt;pre&gt;&lt;code&gt;nameserver 208.67.222.222
nameserver 208.67.220.220
&lt;/code&gt;&lt;/pre&gt;
&lt;/html&gt;
</pre>
</div>
<div title="graphviz" modifier="Sitaram" created="201110271925">
<pre>
&lt;html&gt;
&lt;h1&gt;graphviz notes for the &#39;dot&#39; program&lt;/h1&gt;

&lt;p&gt;links&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;http://www.graphviz.org/Gallery.php             # limited use but still...
http://www.graphviz.org/content/dot-language    # called &#39;lang&#39; in this doc
http://www.graphviz.org/content/attrs           # &#39;attrs&#39; (reference; complex/long)
http://www.graphviz.org/content/node-shapes     # &#39;nshp&#39; (reference; but see notes below)
http://www.graphviz.org/content/color-names     # &#39;clrs&#39;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Qs:
  - what is &#39;a -- b [type=s]&#39;?
  - examples or better docs required for
      - &#39;pos&#39; to specify a position?
      - &#39;group&#39;
      - &#39;concentrate&#39;
      - &#39;ordering&#39;
      - &#39;ranksep&#39;
      - &#39;ratio&#39;
      - &#39;orientation&#39; (portrait/landscape not mentioned in docs!)
  - all features marked DW either don&#39;t work or don&#39;t work predictably; expect
    to take time to learn if you need those features&lt;/p&gt;

&lt;p&gt;general concepts and notes&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;attributes defined in &#39;node&#39;, &#39;edge&#39; or &#39;graph&#39; statements are inherited
by objects defined later&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;general attributes&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;color=red
    use http://www.graphviz.org/content/color-names or #FFDD00 style
fillcolor=blue
    node and cluster only; requires &#39;style=filled&#39;
    &#39;color&#39; is used for fill if fillcolor is not defined
fontcolor=green
label=&quot;string&quot;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;graph attributes&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;&#39;aspect=1.3&#39;
    (DW) control runaway width/height for large fan-in/fan-out
bgcolor = red
    background color for entire canvas
    it is also the initial fill color (can be &quot;transparent&quot;)
rankdir = TB            // or LR, BT, RL
splines = true          // or false or ortho

size = &quot;4,4&quot;            // inches
splines = false         // makes them all straight lines
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;node attributes&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;image=&quot;foo.png&quot;         // also see imagescale (DW)
    seems to have trouble with jpg and ps; only png works predictably right now
label=&quot;string&quot; shape=&quot;record&quot;
    then &#39;string&#39; can be special; see &#39;record-based shapes&#39; later
shape (see below)
style = dashed, dotted, solid, invis, bold, filled, diagonals, rounded
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;(additional notes on node attributes)&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;&#39;nshp&#39; says: The geometry and style of all node shapes are affected by the node
attributes fixedsize, fontname, fontsize, height, label, style and width.
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;edge attributes&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;arrowhead=normal        // also arrowtail
    http://www.graphviz.org/content/attrs#karrowType has more, like dot,
    odot, none, vee, inv, crow, and so on
a -&amp;gt; b [dir=both color=&quot;red:blue&quot;]
    edge is drawn using parallel splines, one per color in list
dir=both
    (direction of arrow) or forward, or back, or none
style = dashed, dotted, solid, invis, bold
minlen=2
    seems to be similar in effect to &#39;rank=same&#39; but some shortening of
    the arrows seems to happen; TODO experiment
weight=50
    integer cost of stretching an edge; the heavier the weight, the
    shorter, straighter and more vertical the edge is
arrowType = normal/none/dot/odot/empty/diamond/...
    # lots more; see http://www.graphviz.org/content/attrs#karrowType
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;node shapes:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;polygon based:

    (&#39;rect&#39;, &#39;rectagle&#39;, &#39;box&#39; are synonyms.  So are &#39;none&#39; and &#39;plaintext&#39;)

    shape = ellipse         // or box, circle, doublecircle, plaintext
        // point -- reduces to minimum
        // [shape = polygon, sides=5]
        // [shape = box, style = rounded]
        // [shape = circle, width = 0.2, fixedsize = true, label = &quot;&quot;]

record based:

    record-based shapes are awesome!  Example:

        digraph structs {
            node [shape=record];
            struct1 [label=&quot;&amp;lt;f0&amp;gt; left|&amp;lt;f1&amp;gt; mid\ndle|&amp;lt;f2&amp;gt; right&quot;];
            struct2 [label=&quot;&amp;lt;f0&amp;gt; one|&amp;lt;f1&amp;gt; two&quot;];
            struct3 [label=&quot;hello\nworld |{ b |{c|&amp;lt;here&amp;gt; d|e}| f}| g | h&quot;];
            struct1:f1 -&amp;gt; struct2:f0;
            struct1:f2 -&amp;gt; struct3:here;
        }

    &#39;nshp&#39; says use shape=none and an HTML-like label instead of a
    record-based shape.  However, while that is certainly more flexible,
    it is *much* more cumbersome!  And user-defined shapes are not really
    any use at all!

    TODO: do explore the html-like junk when something really complex
    turns up...
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;useless stuff&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&#39;digraph&#39; is commonly used.  &#39;graph&#39; seems useless, especially since you
can simulate that with dir=none&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;tricks to constrain layout&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;nodesep = 1.0           // (at graph level)
    // minimum space between two adjacent nodes in the same rank, in inches
A -&amp;gt; B [weight=50]      // makes it straighter
C -&amp;gt; D [minlen=2]       // pretend there&#39;re empty nodes in between

C -&amp;gt; D [constraint=false]
    // the edge is not used in ranking nodes

{ rank=same; A; D; }
    // probably better than &#39;constraint=false&#39;, since you don&#39;t even need
    // an actual edge between A and D for this to work (think A-&amp;gt;B-&amp;gt;C-&amp;gt;D
    // combined with this statement)

TODO: play with this/these
    Rank constraints on the nodes in a subgraph. If rank=&quot;same&quot;, all nodes
    are placed on the same rank. If rank=&quot;min&quot;, all nodes are placed on
    the minimum rank. If rank=&quot;source&quot;, all nodes are placed on the
    minimum rank, and the only nodes on the minimum rank belong to some
    subgraph whose rank attribute is &quot;source&quot; or &quot;min&quot;. Analogous criteria
    hold for rank=&quot;max&quot; and rank=&quot;sink&quot;. (Note: the minimum rank is
    topmost or leftmost, and the maximum rank is bottommost or rightmost.)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;other tips&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;// make 2 lines in one shot
A -&amp;gt; { B; C }

joining or merging certain edge routes.  this is nicer/easier than the
method in the FAQ http://www.graphviz.org/doc/FAQ.html
    digraph G {
      yourvirtualnode [shape=point,width=.01,height=.01]
      a -&amp;gt; yourvirtualnode [arrowhead=none]
      yourvirtualnode -&amp;gt; {b;c}
    }
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;subgraphs&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;`subgraph cluster0` etc -- pretty cool too; see examples in
git-notes/images.  A subgraph whose name starts with &quot;cluster&quot; has a
special meaning to dot.

&#39;lang&#39; says: If supported, the layout engine will do the layout so that
the nodes belonging to the cluster are drawn together, with the entire
drawing of the cluster contained within a bounding rectangle. Note that,
for good and bad, cluster subgraphs are not part of the DOT language, but
solely a syntactic convention adhered to by certain of the layout engines.

compound = true
    allow edges between clusters; use with lhead/ltail
&lt;/code&gt;&lt;/pre&gt;
&lt;/html&gt;
</pre>
</div>
<div title="ip-command" modifier="Sitaram" created="200903241920">
<pre>
&lt;html&gt;
&lt;h1&gt;ip command quickref&lt;/h1&gt;

&lt;p&gt;FIXME: the source formatting is screwed up by having to fit inside
wiki_creole; markdown will make it simpler with a little effort&lt;/p&gt;

&lt;p&gt;&lt;sup&gt;from &lt;a href=&quot;http://www.policyrouting.org/iproute2.doc.html&quot;&gt;http://www.policyrouting.org/iproute2.doc.html&lt;/a&gt;&lt;/sup&gt;&lt;/p&gt;

&lt;h4&gt;ip link&lt;/h4&gt;

&lt;ul&gt;
&lt;li&gt;&lt;code&gt;ip link [ show [ dev ] eth0 ]&lt;/code&gt; &lt;br /&gt;
&lt;code&gt;ip link [ show up ]&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;ip link set [ dev ] eth0&lt;/code&gt; &lt;br /&gt;
...&lt;code&gt;up | down&lt;/code&gt; &lt;br /&gt;
...&lt;code&gt;addr MAC-ADDR&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;if &lt;code&gt;qdisc&lt;/code&gt; is listed as &lt;code&gt;noop&lt;/code&gt; it is a blackhole&lt;/li&gt;
&lt;li&gt;&lt;code&gt;qlen&lt;/code&gt; is TX queue length in packets&lt;/li&gt;
&lt;/ul&gt;

&lt;h4&gt;ip addr&lt;/h4&gt;

&lt;ul&gt;
&lt;li&gt;&lt;code&gt;ip addr add|delete|flush|[show|list]&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;ip addr add [local] 172.19.58.2/24 dev eth0&lt;/code&gt; &lt;br /&gt;
...&lt;code&gt;peer 1.2.3.4/16&lt;/code&gt; &lt;br /&gt;
...&lt;code&gt;label eth0:1&lt;/code&gt;
&lt;ul&gt;
&lt;li&gt;you can add multiple addresses to the same interface; just run the
same commands with another address&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;then there&#39;s also &lt;code&gt;scope global|site|link|host&lt;/code&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;site&lt;/code&gt; is for IPv6 only; valid only inside this site; &lt;code&gt;link&lt;/code&gt;
valid only on this device&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;ip addr del [127.0.0.1/8] dev lo&lt;/code&gt; if no argument given the first
address listed is deleted&lt;/li&gt;
&lt;li&gt;&lt;code&gt;ip addr [show|list|lst|sh|ls|l] [dev] eth0&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h4&gt;ip neigh&lt;/h4&gt;

&lt;ul&gt;
&lt;li&gt;&lt;code&gt;ip neigh [ show | help ] [ nud all ]&lt;/code&gt;
&lt;ul&gt;
&lt;li&gt;statistics &lt;code&gt;ip -s neigh show&lt;/code&gt; gives you a &quot;ref&quot; (number of users of
the entry), and the number of seconds since the entry was last
used/confirmed/updated&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;ip neigh add 172.19.58.9 lladdr 00:0e:7f:3d:e6:a4 dev eth0&lt;/code&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;nud perm&lt;/code&gt; seems to be implied, &lt;code&gt;noarp&lt;/code&gt; seems to act weird
(won&#39;t show up in &lt;code&gt;ip neigh show&lt;/code&gt; unless you add &lt;code&gt;nud noarp&lt;/code&gt; or
&lt;code&gt;nud all&lt;/code&gt; to the command; see help for others.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;perm&lt;/code&gt; is like &lt;code&gt;noarp&lt;/code&gt; except it cannot expire automatically&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;ip neigh flush&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h4&gt;ip route&lt;/h4&gt;

&lt;ul&gt;
&lt;li&gt;&lt;code&gt;ip route show&lt;/code&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;ip route list match 1.2.3.4&lt;/code&gt; shows which route would be taken for
1.2.3.4
&lt;strong&gt;* &lt;code&gt;ip route get 1.2.3.4&lt;/code&gt; is &lt;em&gt;*even better&lt;/strong&gt;!&lt;/li&gt;
&lt;li&gt;can subset by &quot;dev&quot;, &quot;via&quot;
&lt;em&gt;&lt;/em&gt;&lt;/em&gt; &lt;em&gt;rare&lt;/em&gt; also by &quot;proto&quot;, &quot;scope&quot;, &quot;type&quot; (unicast, local,
blackhole, etc.)&lt;/li&gt;
&lt;li&gt;meanings of &quot;proto&quot; and &quot;scope&quot; in output of &lt;code&gt;ip route show&lt;/code&gt;: look
for rt&lt;em&gt;protos and rt&lt;/em&gt;scopes in
&lt;a href=&quot;http://www.policyrouting.org/iproute2.doc.html&quot;&gt;http://www.policyrouting.org/iproute2.doc.html&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;ip route [ add | del | chg | repl | etc ] to [ unicast ] 1.2.3.4/20 dev
eth0&lt;/code&gt;
&lt;ul&gt;
&lt;li&gt;in place of &lt;code&gt;unicast&lt;/code&gt; you can also have &lt;code&gt;local&lt;/code&gt;,
&lt;code&gt;unreachable&lt;/code&gt;, &lt;code&gt;blackhole&lt;/code&gt; etc.; see help&lt;/li&gt;
&lt;li&gt;&lt;code&gt;via g.at.ew.ay&lt;/code&gt;
&lt;em&gt;&lt;em&gt;&lt;/em&gt; &lt;em&gt;rare&lt;/em&gt; &lt;code&gt;add nat 10.1.1.1 via 203.1.1.1&lt;/code&gt; may be useful
sometimes but until we know more we should stick to iptables natting!
For example this is one-to-one natting so the 203.x had better be a
free IP!&lt;/li&gt;
&lt;li&gt;&lt;code&gt;tos &amp;lt;value&amp;gt;&lt;/code&gt;; values are:
&lt;strong&gt;&lt;/em&gt; 0x80 -- flash-override
&lt;em&gt;&lt;/strong&gt; 0x40 -- immediate
&lt;strong&gt;&lt;/em&gt; 0x20 -- priority
&lt;em&gt;&lt;/strong&gt; 0x10 -- lowdelay
&lt;strong&gt;&lt;/em&gt; 0x08 -- throughput
&lt;em&gt;&lt;/strong&gt; 0x04 -- reliability
&lt;em&gt;&lt;/em&gt;&lt;/em&gt; 0x02 -- mincost&lt;/li&gt;
&lt;li&gt;&lt;code&gt;metric | pref 10&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;scope &amp;lt;scope val&amp;gt;&lt;/code&gt; see /etc/iproute2/rt_scopes&lt;/li&gt;
&lt;li&gt;&lt;em&gt;rare&lt;/em&gt; &lt;code&gt;proto static&lt;/code&gt; to protect manually-added route from being purged if a route daemon starts&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/html&gt;
</pre>
</div>
<div title="my-creole" modifier="Sitaram" created="200903241920">
<pre>
&lt;html&gt;
&lt;h1&gt;&lt;a name=&quot;Notes_on_my_Creole_format&quot;&gt;Notes on my Creole format&lt;/a&gt;&lt;/h1&gt;

&lt;p&gt;&lt;strong&gt;OBSOLETE -- I no longer use creole.  Markdown is much better at DWIMming by
indentation&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#Notes_on_my_Creole_format&quot;&gt;Notes on my Creole format&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#My_extensions&quot;&gt;My extensions&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#Basic_Creole_as_implemented_by_Text_WikiCreole&quot;&gt;Basic Creole as implemented by Text::WikiCreole&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#OFFICIAL_MARKUP&quot;&gt;OFFICIAL MARKUP&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#EXTENDED_MARKUP&quot;&gt;EXTENDED MARKUP&lt;/a&gt;&lt;br&gt;&lt;/p&gt;

&lt;hr /&gt;

&lt;h3&gt;&lt;a name=&quot;My_extensions&quot;&gt;My extensions&lt;/a&gt;&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;a rudimentary TOC is created from the first 4 levels if you use
&lt;code&gt;[[TOC]]&lt;/code&gt; on a line by itself.  You can change that to some other
depth by saying &lt;code&gt;[[TOC 3]]&lt;/code&gt; for instance&lt;/li&gt;
&lt;li&gt;explicit triple curlies (TCs) are created based on indentation.  Each
block of lines indented 8 or more spaces is one TCS block&lt;/li&gt;
&lt;li&gt;explicit first-level blocks are created as needed: the first 4-space
indented line that is not inside a bullet list gets a &quot;:&quot; at the start
(see Creole syntax below for what that means)&lt;/li&gt;
&lt;/ul&gt;

&lt;h3&gt;&lt;a name=&quot;Basic_Creole_as_implemented_by_Text_WikiCreole&quot;&gt;Basic Creole as implemented by Text::WikiCreole&lt;/a&gt;&lt;/h3&gt;

&lt;p&gt;The following is culled straight from &lt;code&gt;perldoc Text::WikiCreole&lt;/code&gt;&lt;/p&gt;

&lt;h4&gt;&lt;a name=&quot;OFFICIAL_MARKUP&quot;&gt;OFFICIAL MARKUP&lt;/a&gt;&lt;/h4&gt;

&lt;pre&gt;&lt;code&gt;    Here is a summary of the official Creole 1.0 markup
    elements.  See &amp;lt;http://www.wikicreole.org&amp;gt; for the full
    details.

    Headings:
    = heading 1   -&amp;gt;    &amp;lt;h1&amp;gt;heading 1&amp;lt;/h1&amp;gt;
    == heading 2      -&amp;gt;    &amp;lt;h2&amp;gt;heading 2&amp;lt;/h2&amp;gt;
    ...
    ====== heading 6  -&amp;gt;    &amp;lt;h6&amp;gt;heading 6&amp;lt;/h6&amp;gt;
&lt;/code&gt;&lt;/pre&gt;

&lt;h5&gt;Various inline markup&lt;/h5&gt;

&lt;pre&gt;&lt;code&gt;    ** bold **    -&amp;gt;    &amp;lt;strong&amp;gt; bold &amp;lt;/strong&amp;gt;
    * italics *   -&amp;gt;    &amp;lt;em&amp;gt; italics &amp;lt;/em&amp;gt;
    *** both ***      -&amp;gt;    &amp;lt;strong&amp;gt;&amp;lt;em&amp;gt; both &amp;lt;/em&amp;gt;&amp;lt;/strong&amp;gt;
    [[ link ]]    -&amp;gt;    &amp;lt;a href=&quot;link&quot;&amp;gt;link&amp;lt;/a&amp;gt;
    [text](link) -&amp;gt; &amp;lt;a href=&quot;link&quot;&amp;gt;text&amp;lt;/a&amp;gt;
    &amp;lt;http://cpan.org&amp;gt;     -&amp;gt;    &amp;lt;a href=&quot;http://cpan.org&quot;&amp;gt;http://cpan.org&amp;lt;/a&amp;gt;
    line \\ break     -&amp;gt;    line &amp;lt;br /&amp;gt; break
    {{img.jpg|alt}}   -&amp;gt;    &amp;lt;img src=&quot;img.jpg&quot; alt=&quot;alt&quot;&amp;gt;

    Lists:
    * unordered list    &amp;lt;ul&amp;gt;&amp;lt;li&amp;gt;unordered list&amp;lt;/li&amp;gt;
    * second item           &amp;lt;li&amp;gt;second item&amp;lt;/li&amp;gt;
    ## nested ordered  -&amp;gt;       &amp;lt;ol&amp;gt;&amp;lt;li&amp;gt;nested ordered&amp;lt;/li&amp;gt;
    *** uber-nested         &amp;lt;ul&amp;gt;&amp;lt;li&amp;gt;uber-nested&amp;lt;/li&amp;gt;&amp;lt;/ul&amp;gt;
    * back to level 1       &amp;lt;/ol&amp;gt;&amp;lt;li&amp;gt;back to level 1&amp;lt;/li&amp;gt;&amp;lt;/ul&amp;gt;

    Tables:
    |= h1 |= h2   -&amp;gt;    &amp;lt;table&amp;gt;&amp;lt;tr&amp;gt;&amp;lt;th&amp;gt;h1&amp;lt;/th&amp;gt;&amp;lt;th&amp;gt;h2&amp;lt;/th&amp;gt;&amp;lt;/tr&amp;gt;
    |  c1 |  c2     &amp;lt;tr&amp;gt;&amp;lt;td&amp;gt;c1&amp;lt;/td&amp;gt;&amp;lt;td&amp;gt;c2&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&amp;lt;/table&amp;gt;

    Nowiki (Preformatted):
    {{{         &amp;lt;pre&amp;gt;
      ** not bold **      ** not bold **
      escaped HTML:   -&amp;gt;      escaped HTML:
      &amp;lt;i&amp;gt; test &amp;lt;/i&amp;gt;       &amp;amp;lt;i&amp;amp;gt; test &amp;amp;lt;/i&amp;amp;gt;
    }}}         &amp;lt;pre&amp;gt;

    {{{ inline\\also }}} -&amp;gt; &amp;lt;tt&amp;gt;inline\\also&amp;lt;/tt&amp;gt;

    Escape Character:
    ~** not bold **    -&amp;gt;    ** not bold **
    tilde: ~~      -&amp;gt;    tilde: ~

    Paragraphs are separated by other blocks and blank lines.
    Inline markup can usually be combined, overlapped, etc.  List
    items and plugin text can span lines.
&lt;/code&gt;&lt;/pre&gt;

&lt;h4&gt;&lt;a name=&quot;EXTENDED_MARKUP&quot;&gt;EXTENDED MARKUP&lt;/a&gt;&lt;/h4&gt;

&lt;pre&gt;&lt;code&gt;    In addition to OFFICIAL MARKUP, Text::WikiCreole also supports
    the following markup:

    Plugins:
    &amp;lt;&amp;lt; plugin &amp;gt;&amp;gt;        -&amp;gt;    whatever you want (see creole_plugin above)
    &amp;lt;&amp;lt;&amp;lt; plugin &amp;gt;&amp;gt;&amp;gt;      -&amp;gt;    whatever you want (see creole_plugin above)
        Triple-bracket syntax has priority, in order to allow you to embed
        double-brackets in plugins, such as to embed Perl code.

    Inline:
    ## monospace ##     -&amp;gt;    &amp;lt;tt&amp;gt; monospace &amp;lt;/tt&amp;gt;
    ^^ superscript ^^   -&amp;gt;    &amp;lt;sup&amp;gt; superscript &amp;lt;/sup&amp;gt;
    ,, subscript ,,     -&amp;gt;    &amp;lt;sub&amp;gt; subscript &amp;lt;/sub&amp;gt;
    __ underline __     -&amp;gt;    &amp;lt;u&amp;gt; underline &amp;lt;/u&amp;gt;
    (TM)            -&amp;gt;    &amp;amp;trade;
    (R)         -&amp;gt;    &amp;amp;reg;
    (C)         -&amp;gt;    &amp;amp;copy;
    ...         -&amp;gt;    &amp;amp;hellip;
    --          -&amp;gt;    &amp;amp;ndash;

    Indented Paragraphs:
    :this           -&amp;gt;    &amp;lt;div style=&quot;margin-left:2em&quot;&amp;gt;&amp;lt;p&amp;gt;this
    is indented       is indented&amp;lt;/p&amp;gt;
    :: more indented      &amp;lt;div style=&quot;margin-left:2em&quot;&amp;gt;&amp;lt;p&amp;gt; more
                              indented&amp;lt;/div&amp;gt;&amp;lt;/div&amp;gt;

    Definition Lists:
    ; Title         -&amp;gt;    &amp;lt;dl&amp;gt;&amp;lt;dt&amp;gt;Title&amp;lt;/dt&amp;gt;
    : item 1 : item 2     &amp;lt;dd&amp;gt;item 1&amp;lt;/dd&amp;gt;&amp;lt;dd&amp;gt;item 2&amp;lt;/dd&amp;gt;
    ; Title 2 : item2a    &amp;lt;dt&amp;gt;Title 2&amp;lt;/dt&amp;gt;&amp;lt;dd&amp;gt;item 2a&amp;lt;/dd&amp;gt;&amp;lt;/dl&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/html&gt;
</pre>
</div>
<div title="nat-with-iptables" modifier="Sitaram" created="200903241920">
<pre>
&lt;html&gt;
&lt;h1&gt;MASQ with iptables&lt;/h1&gt;

&lt;p&gt;Assume:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;eth0 has xx.xx.xx.xx as your WAN IP
eth1 has yy.yy.yy.yy as your LAN IP
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Then, this is how you MASQ&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;# Delete and flush. Default table is &quot;filter&quot;. Others like &quot;nat&quot; must be explicitly stated.
iptables --flush
iptables --table nat --flush

# Delete all chains that are not in default filter and nat table
iptables --delete-chain
iptables --table nat --delete-chain

# Set up IP FORWARDing and Masquerading
iptables --table nat -A POSTROUTING --out-interface eth0 -j MASQUERADE
iptables -A FORWARD --in-interface eth1 -j ACCEPT

# Enables packet forwarding by kernel 
echo 1 &amp;gt; /proc/sys/net/ipv4/ip_forward
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;sup&gt;Source: &lt;a href=&quot;http://www.howtoforge.com/nat_iptables&quot;&gt;http://www.howtoforge.com/nat_iptables&lt;/a&gt; (article has misleading
title: it&#39;s actually masq, not NAT)&lt;/sup&gt;&lt;/p&gt;
&lt;/html&gt;
</pre>
</div>
<div title="fix-scratched-CDs" modifier="Sitaram" created="200903241920">
<pre>
&lt;html&gt;
&lt;h1&gt;Scratched CDs?&lt;/h1&gt;

&lt;p&gt;&lt;sup&gt;from &lt;a href=&quot;http://www.om3ga.co.uk/2006/07/27/scratched-cds-no-problem&quot;&gt;http://www.om3ga.co.uk/2006/07/27/scratched-cds-no-problem&lt;/a&gt;&lt;/sup&gt;&lt;/p&gt;

&lt;p&gt;&quot;&lt;em&gt;To apply the toothpaste take the tiniest bit on the tip of your finger,
and without touching the CD with your finger its self, apply the
toothpaste to only the scratched area (and just around it). Now put it
under the tap and dribble water on it, so that the toothpaste goes sort of
mushy. Now tilt the CD over a sink very gently so that the water runs off,
but the toothpaste stays. Now, like all the other methods, rub it in with
a lint free cloth, but this time you really need to go to town, as you are
actually trying to round off the scratches.&lt;/em&gt;&quot;&lt;/p&gt;

&lt;p&gt;[well that didn&#39;t work...]&lt;/p&gt;

&lt;p&gt;&quot;&lt;em&gt;Yes, hair gel, and guess what? It worked!&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;&lt;em&gt;I applied it in much the same way as the toothpaste, except I didn&#39;t
dribble water on it. I rubbed it first. Even though I applied it to one
area, it ended up evenly spread around the whole disc. I then dribbled
water on to loosen it up so I could rub the excess off.&lt;/em&gt;&quot;&lt;/p&gt;
&lt;/html&gt;
</pre>
</div>
<div title="deep" modifier="Sitaram" created="200903241920">
<pre>
&lt;html&gt;
&lt;h1&gt;&lt;a name=&quot;deep_stuff&quot;&gt;deep stuff&lt;/a&gt;&lt;/h1&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;sup&gt;&lt;strong&gt;Caveat&lt;/strong&gt; I am not sure how all this works when the filenames have
    spaces in them.  In an ideal world, people who put spaces in filenames
    would be shot, but this isn&#39;t an ideal world.&lt;/sup&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;The &lt;code&gt;hashdeep&lt;/code&gt; program is part of the badly-named &lt;code&gt;md5deep&lt;/code&gt; suite.  &lt;code&gt;ssdeep&lt;/code&gt;
is similar, but uses fuzzy matching to find similar files, using an algorithm
that is a &quot;second cousin twice removed&quot; of the magic that drives rsync.&lt;/p&gt;

&lt;p&gt;&lt;code&gt;dcfldd&lt;/code&gt; is in a completely different domain (it&#39;s more like a &quot;superdd&quot;), but
I&#39;ve lumped it in here because of the Kornblum connection.&lt;/p&gt;

&lt;hr /&gt;

&lt;p&gt;This document has the following sections&lt;/p&gt;

&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#deep_stuff&quot;&gt;deep stuff&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#Comparing_two_directories&quot;&gt;Comparing two directories&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#Finding_duplicates_and_similar_files&quot;&gt;Finding duplicates and similar files&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#hashdeep_details&quot;&gt;hashdeep details&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#dcfldd_details&quot;&gt;dcfldd details&lt;/a&gt;&lt;br&gt;&lt;/p&gt;

&lt;hr /&gt;

&lt;h3&gt;&lt;a name=&quot;Comparing_two_directories&quot;&gt;Comparing two directories&lt;/a&gt;&lt;/h3&gt;

&lt;p&gt;There are 2 ways of doing this.&lt;/p&gt;

&lt;p&gt;If you don&#39;t have to pre-compute both sets of hashes (that is, you can
efficiently access one directory &quot;live&quot;), you should do the following:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;cd old
hashdeep -elr . &amp;gt; /tmp/dir.hdout
cd new
hashdeep -k /tmp/dir.hdout -elr . -avv
# for extra speed, use &quot;-c md5&quot; on both commands above
# note that hashdeep has a problem with filenames containing commas
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;The output is interpreted like so:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;newfile: Moved from oldfile (easy)
newfile: No match (no eqvt in old)
oldfile: Known file not used (no eqvt in new)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;If you have to pre-compute both of them, (like they are not &quot;local&quot; to the
node on which your software is running) you can do a &quot;content match&quot; like
this:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;cd old
md5deep -elr . |sort &amp;gt; /tmp/old.mdout
cd new
md5deep -elr . |sort &amp;gt; /tmp/new.mdout
cd /tmp
# see files extra in old
join -v1 old.mdout new.mdout
# see files extra in new
join -v2 old.mdout new.mdout
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;You can use the &#39;-o&#39; syntax of join to suppress printing the hash itself,
or various other combinations of the left and the right side.  This can
help you detect renames and moves, although you may have to do some
post-processing of lines containing two files names in order to do so.&lt;/p&gt;

&lt;h3&gt;&lt;a name=&quot;Finding_duplicates_and_similar_files&quot;&gt;Finding duplicates and similar files&lt;/a&gt;&lt;/h3&gt;

&lt;p&gt;Fastest way to find &lt;strong&gt;exact&lt;/strong&gt; duplicates:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;md5deep -elr -of . dir1 ... | sort | uniq -w32 --all-repeated=separate
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;The &lt;code&gt;-of&lt;/code&gt; to md5deep is to prevent symlinks from showing up, otherwise you&#39;ll
&lt;strong&gt;&lt;em&gt;lose data!!&lt;/em&gt;&lt;/strong&gt; You can use &lt;code&gt;-D&lt;/code&gt; instead of &lt;code&gt;--all-repeated=separate&lt;/code&gt; for
automated processing.&lt;/p&gt;

&lt;p&gt;To find &lt;strong&gt;similar&lt;/strong&gt; files, &lt;code&gt;ssdeep&lt;/code&gt; is a pretty cool program, and
works great for all but the smallest files (though I haven&#39;t really tested
it with GB-size files).  Though it takes over 8 times more CPU than MD5,
and doesn&#39;t have a good progress indicator, it&#39;s useful because it&#39;s
unique -- I&#39;m not aware of any other program that even attempts to do this
sort of matching.&lt;/p&gt;

&lt;p&gt;To find similar files within on one or more local directories:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;ssdeep -vlr -d dir1 [dir2 ...]
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;When all the directories aren&#39;t local to the same machine:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;ssdeep -vlr dir1 &amp;gt; dir1.ssdeepout
# now copy that file from machine 1 to machine 2
ssdeep -m dir1.ssdeepout -vlr -d dir2
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;There&#39;s a subtle difference between these two methods though.  The stuff
coming from the &lt;code&gt;-m&lt;/code&gt; argument is only a reference, so those names will
never appear on the left side of the &quot;dir1/file1 matched dir2/file2...&quot;
output.  In the first method, dir1 and dir2 can both appear on the left
side.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;WARNING&lt;/strong&gt;: ssdeep isn&#39;t a good way to find exact duplicates -- it&#39;s not only
slow, it misses really small (and maybe really large also?) files.  &lt;em&gt;Use it
only for finding approximate matches.&lt;/em&gt;&lt;/p&gt;

&lt;h3&gt;&lt;a name=&quot;hashdeep_details&quot;&gt;hashdeep details&lt;/a&gt;&lt;/h3&gt;

&lt;p&gt;Hashdeep&#39;s &lt;em&gt;audit&lt;/em&gt; mode is what you used above, and the &lt;code&gt;-k&lt;/code&gt; refers
to a file containing &quot;k&quot;nown hashes.  The &lt;code&gt;-vv&lt;/code&gt; is required to see the
right amount of detail on what files mismatched etc.&lt;/p&gt;

&lt;p&gt;Apart from audit mode, you can also do the following when you specify &lt;code&gt;-k
known-list&lt;/code&gt;:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;code&gt;-m&lt;/code&gt;: positive match -- list each file in the argument list that matches
some file in the known list.  You can add &lt;code&gt;-w&lt;/code&gt; to see both the filenames&lt;/li&gt;
&lt;li&gt;&lt;code&gt;-x&lt;/code&gt;: negative match -- list files in arglist that did not match anything
in the known list&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;If you&#39;re in a hurry (and your accuracy needs aren&#39;t forensic-level), use
&lt;code&gt;-c md5&lt;/code&gt;; the default does both md5 and sha1, which takes about 4-5
times longer.&lt;/p&gt;

&lt;h3&gt;&lt;a name=&quot;dcfldd_details&quot;&gt;dcfldd details&lt;/a&gt;&lt;/h3&gt;

&lt;p&gt;This is an awesome command.  For most purposes the old &lt;code&gt;dd&lt;/code&gt; command is
as good, but here&#39;s what makes dcfldd a real life-saver:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;multiple outputs (ever felt handicapped by what &lt;code&gt;tee&lt;/code&gt; can do?) including
executable programs!&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;dcfldd of=a of=b of:=&#39;md5sum &amp;gt;c&#39; of:=&#39;sha1sum &amp;gt;d&#39;
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;better progress indicator (&lt;code&gt;status=on&lt;/code&gt;)&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;file splitting like &lt;code&gt;split&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;partial hashing (example, &lt;code&gt;hashwindow=2M&lt;/code&gt;)&lt;/li&gt;
&lt;/ul&gt;
&lt;/html&gt;
</pre>
</div>
<div title="ddrescue" modifier="Sitaram" created="200903241920">
<pre>
&lt;html&gt;
&lt;h1&gt;GNU ddrescue or dd_rescue&lt;/h1&gt;

&lt;h3&gt;Tips&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;always use a logfile; it helps you make multiple runs optimally&lt;/li&gt;
&lt;li&gt;on subsequent runs, use &lt;code&gt;-r&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Really bad media: be sure to make the first run &lt;code&gt;-r 1 -n&lt;/code&gt; then later
perhaps &lt;code&gt;-r 3&lt;/code&gt;!&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;strong&gt;cool feature&lt;/strong&gt;: you can use multiple copies of a backup, with the same
logfile across all sessions, to merge the good parts of each and get a
whole good copy!  Very useful for CD-based backups of really important
stuff.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h3&gt;Some flags&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;to retry error areas detected on a previous run of ddrescue, you must give&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;-r 3    # or some non-zero value
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;for CD-ROMs, you must give&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;-b 2048
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;to stop after copying so much data&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;-s
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;do not try to split error areas into smaller ones&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;-n
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h3&gt;Extra stuff&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;raw devices may be useful in some cases; see info for more, but the summary is:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;ddrescue -n /dev/hdb /dev/hdc logfile
raw /dev/raw/raw1 /dev/hdb
ddrescue -r3 -C /dev/raw/raw1 /dev/hdc logfile
raw /dev/raw/raw1 0 0
e2fsck -v -f /dev/hdc
mount -t ext2 -o ro /dev/hdc /mnt
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/html&gt;
</pre>
</div>
<div title="xinetd" modifier="Sitaram" created="200903241920">
<pre>
&lt;html&gt;
&lt;h1&gt;starting a program from xinetd&lt;/h1&gt;

&lt;p&gt;The &lt;code&gt;wait = no&lt;/code&gt; is important.  Most of the other gotchas can be found
by checking syslog after &lt;code&gt;service xinetd start&lt;/code&gt;, but this one needs
some serious RTFM :-)&lt;/p&gt;

&lt;p&gt;The program being called is just a filter -- take some input, return some
output!&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;service dss
{
    id = dss
    type = UNLISTED
    flags = NODELAY NORETRY
    disable = no
    socket_type = stream
    protocol = tcp
    wait = no
    instances = 1
    server = /tmp/dss
    port = 8421
    user = sitaram
}
&lt;/code&gt;&lt;/pre&gt;
&lt;/html&gt;
</pre>
</div>
<div title="encrypt-swap" modifier="Sitaram" created="200903241920">
<pre>
&lt;html&gt;
&lt;h1&gt;Encrypting swap&lt;/h1&gt;

&lt;p&gt;from &lt;a href=&quot;http://loop-aes.sourceforge.net/loop-AES.README&quot;&gt;http://loop-aes.sourceforge.net/loop-AES.README&lt;/a&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;swapoff -a

# change the fstab line to something like:
/dev/hda666 none swap sw,loop=/dev/loop6,encryption=AES128 0 0
# [I ignored the &quot;sw,&quot; and it still worked... sita]

dd if=/dev/zero of=/dev/hda666 bs=64k conv=notrunc # paranoid
mkswap /dev/hda666

swapon -a

rm -rf /var/log/ksymoops
# avoid some errors at boot time; see source URL
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Running &lt;code&gt;swapon -a&lt;/code&gt; will set up loop devices using random keys, run
mkswap on them, and enable encrypted swap on specified loop devices.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Note&lt;/strong&gt;: If you are using encrypted swap and you wish to upgrade your
kernel, you may need to use a matching loop.o.  Please see source URL.&lt;/p&gt;

&lt;h3&gt;other examples in the source URL:&lt;/h3&gt;

&lt;pre&gt;&lt;code&gt;7.2. Example 2 - Partition backed loop with gpg encrypted key file
7.3. Example 3 - Encrypted partition that multiple users can mount
7.4. Example 4 - Encrypting /tmp partition with random keys
7.5. Example 5 - Encrypting root partition
7.6. Example 6 - Boot from CD-ROM + encrypted root partition
7.7. Example 7 - Boot from USB-stick + encrypted root partition
&lt;/code&gt;&lt;/pre&gt;
&lt;/html&gt;
</pre>
</div>
<div title="mutt" modifier="Sitaram" created="200903241920">
<pre>
&lt;html&gt;
&lt;h1&gt;mutt&lt;/h1&gt;

&lt;p&gt;&lt;a href=&quot;http://applications.linux.com/article.pl?sid=06/11/30/1227239&amp;amp;tid=37&amp;amp;tid=85&amp;amp;tid=70&amp;amp;pagenum=1&quot;&gt;http://applications.linux.com/article.pl?sid=06/11/30/1227239&amp;amp;tid=37&amp;amp;tid=85&amp;amp;tid=70&amp;amp;pagenum=1&lt;/a&gt;
contains lots of tips on mutt, but the &quot;must have&quot; ones are:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;local mailbox
    set spoolfile=/path/to/spool
pop3 mailbox
    set pop_user = &quot;username&quot;
    set pop_delete = no
    set pop_pass = &quot;password&quot; # best not to put it in muttrc
    set pop_host = &quot;pop.myserver.com&quot; # default is pop3 on port 110
(or)
    set pop_host = &quot;pops://pop.gmail.com:995&quot;  # note the popS
imap mailbox
    set spoolfile=imaps://imap.server.com/INBOX
    set imap_user=username
    set imap_pass=password # see above
&lt;/code&gt;&lt;/pre&gt;
&lt;/html&gt;
</pre>
</div>
<div title="miscellaneous" modifier="Sitaram" created="201110201912">
<pre>
&lt;html&gt;
&lt;h1&gt;all sorts of stuff&lt;/h1&gt;

&lt;p&gt;These tips are too small to have their own files.  They are in approximately
reverse chron order.&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;type /msg nickserv register &lt;your-password&gt; &lt;your-email&gt; in irssi to
register the nickname&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;mounting a samba share with spaces in the name.  (Please be kind to the
environment and shoot the bastard who used spaces in directory names after
you&#39;ve gotten his files off his fscking share)&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;# cat &amp;gt; /root/.smbcredentials
username=India\129633
password=whatever
# cat &amp;gt;&amp;gt; /etc/fstab
//1.2.3.4/Shyam\040-\040Laptop\040Backup    /tmp/shyam        cifs    credentials=/root/.smbcredentials,iocharset=utf8,file_mode=0777,dir_mode=0777 0 0
# mount /tmp/shyam
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;and then later, this also worked:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;mount -t cifs &quot;//1.2.3.4/Shyam - Laptop Backup&quot; /tmp/shyam -o ip=1.2.3.4,noperm,uid=500,user=India\\327367,password=Deepu~Guru2610
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;flushing the disk cache&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;sync
echo 3 &amp;gt; /proc/sys/vm/drop_caches
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;changing the scheduler&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;echo cfq &amp;gt; /sys/block/sdb/queue/scheduler
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;oooh nice one for tattoo talk!  Note: remote is 1440x900, local is
smaller, so must chop (chopping top left here)&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;ssh deskr \
    ffmpeg -f x11grab -r 1 \
    -s 1280x800 -i :0.0+160,100 \
    -an -f avi -y - |
ffplay -f m4v -
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;ssh-agent stuff&lt;/p&gt;

&lt;p&gt;when SSH&lt;em&gt;AGENT&lt;/em&gt;PID is not set, the standard file (&lt;code&gt;id_rsa&lt;/code&gt;) works fine.  A
non-standard id file needs either the &lt;code&gt;-i&lt;/code&gt; parameter to ssh, or a host
para in &lt;code&gt;~/.ssh/config&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;if &quot;ssh-add -l&quot; shows some key(s), then only those keys will be used;
everything else will be ignored&lt;/p&gt;

&lt;p&gt;if you use passphrases for all your keys, you will use the agent anyway,
so it all works&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;converting something to 3gpp, to play on a mobile phone; this seems to be
a good set of parameters, but if you really care, test various
combinations.  The audio is tricky -- most websites will tell you mp3 or
faac, but &lt;code&gt;ffmpeg -formats | grep E.*aac&lt;/code&gt; will tell you what library you
actually have; in plf systems it&#39;s libfaac, not just faac&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;ffmpeg -i $1 -s 176x144 -vcodec h263 -r 25 -b 96k -ab 64 -acodec libfaac -ac 1 -ar 44100 $1.3gp
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;highlighting STDERR&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;first, create a file that looks like this.  Call it &quot;red&quot; and put it in
the path&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;#!/bin/bash

while read line
do
    echo -e &#39;\e[91m&#39;$line&#39;\e[0m&#39;
done
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;when running a program that produces mixed STDOUT and STDERR, do this&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;pgm opts 2&amp;gt; &amp;gt;(red) [...]
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;where the ellipses represent whatever else you would have done with
pgm&#39;s STDOUT normally, if any&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;optimising ext4 -- mostly from
&lt;a href=&quot;http://www.linux-mag.com/id/7272/2/&quot;&gt;tytso&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;normal optimisations:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;mount with &lt;code&gt;noatime&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;if you can, make a fresh ext4 image rather than just convert from ext3&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&quot;my machine is quite reliable, thank you!&quot;&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;mount with &lt;code&gt;commit=600&lt;/code&gt; (my laptop running MDV seemed to acquire this by
default, and you can pick some other value for a desktop if you like)&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&quot;reliability?  who cares!&quot;&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;disable journal (&lt;code&gt;noload&lt;/code&gt;??)&lt;/li&gt;
&lt;li&gt;mount with &lt;code&gt;barrier=0&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&quot;security?  I&#39;ve got nothing to hide...!&quot;&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;code&gt;data=writeback&lt;/code&gt;; you can make this the default using &lt;code&gt;tune2fs&lt;/code&gt;, which
is actually the only way to set this for the root filesystem&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;using virtual hosts in lighttpd
(&lt;a href=&quot;http://www.ibm.com/developerworks/aix/library/au-spunix_greattools/index.html&quot;&gt;source&lt;/a&gt;)&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;$HTTP[&quot;host&quot;] == &quot;www2.example.org&quot; {
  server.document-root = &quot;/var/www/lighttpd/host2
}
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;recording from a builtin mic:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;rec -t aiff - | lame - out.mp3
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;ogg2mp3 puts out static?  Try the following command (the 44.1 in the &quot;-s&quot;
option to lame comes from checking the &quot;Rate:&quot; reported by ogginfo):&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;oggdec &amp;lt; file.ogg -b 16 -e 0 -R -s 1 -o - - |
    lame -r -s 44.1 --bitwidth 16 --signed --little-endian - - &amp;gt; file.mp3
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;permissions problems on smbmount?  try &lt;code&gt;noperm&lt;/code&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;mount *1.2.4.8/share /mp -o uid=500,noperm
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;wifi used to work fine but suddenly does not?  Check if wpa_cli status
shows everything is OK, and your real problem is a DHCPNAK followed by the
interface going down.  In that case,&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;try deleting all the stale dhcp leases (look for files names something
like /var/lib/dh&lt;em&gt;/&lt;/em&gt;lease*)&lt;/li&gt;
&lt;li&gt;if that doesn&#39;t work, and if &lt;code&gt;lsmod | grep mac80211&lt;/code&gt; is true, then try
removing the word &quot;down&quot; from all &lt;code&gt;ifconfig&lt;/code&gt; lines in
&lt;code&gt;/sbin/dhclient-script&lt;/code&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;http://www.ces.clemson.edu/linux/f7_setup.shtml&quot;&gt;http://www.ces.clemson.edu/linux/f7_setup.shtml&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://www.intellinuxwireless.org/bugzilla/show_bug.cgi?id=1468#c12&quot;&gt;http://www.intellinuxwireless.org/bugzilla/show_bug.cgi?id=1468#c12&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;suspend to disk (s2disk) on mdv 2009&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;created a new file called &lt;code&gt;pm-fallback-hibernate&lt;/code&gt; in
&lt;code&gt;/etc/acpi/actions&lt;/code&gt;, modelled after existing &lt;code&gt;pm-fallback-suspend&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;s/shutdown/hibernate/&lt;/code&gt; in &lt;code&gt;/etc/acpi/events/power&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;I don&#39;t remember what the default values were, but change them to these
in &lt;code&gt;/etc/sysconfig/powersave/events&lt;/code&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;EVENT_BUTTON_POWER=&quot;suspend_to_disk&quot;
EVENT_BUTTON_SLEEP=&quot;suspend_to_disk&quot;
EVENT_BUTTON_LID_OPEN=&quot;ignore&quot;
EVENT_BUTTON_LID_CLOSED=&quot;suspend_to_ram&quot;
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;kde4&#39;s kpowersave is crap; don&#39;t rely on it, not even to run the
screensaver -- test it or do it manually before hitting the power
button or closing the lid!&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;quick tip for postfix in &quot;relay&quot; mode; add something like this to
&lt;code&gt;/etc/postfix/main.cf&lt;/code&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;myhostname = sitaram.atc.tcs.com
mydestination = $myhostname, localhost.$mydomain
mydomain = atc.tcs.com
relayhost = 172.25.149.2
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;manual mirror selection for MDV 2009:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;GET &amp;lt;http://api.mandriva.com/mirrors/basic.2009.0.i586.list&amp;gt; | egrep -i -o http.*586
# pick one of them, say klid.dk, and
urpmi.addmedia --distrib --mirrorlist &amp;lt;http://klid.dk/ftp/mandriva/official/2009.0/i586&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;mkdosfs on the RCA emusic mp3 player requires &quot;-S 2048&quot;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;man pages and col -b
&lt;ul&gt;
&lt;li&gt;append &lt;code&gt;-c&lt;/code&gt; to the line &lt;code&gt;NROFF /usr/bin/nroff -Tutf8 -mandoc&lt;/code&gt; in
&lt;code&gt;/etc/man.config&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;midnight commander looks ugly on konsole
&lt;ul&gt;
&lt;li&gt;&lt;em&gt;either&lt;/em&gt; use mc&#39;s &lt;code&gt;-a&lt;/code&gt; argument,&lt;/li&gt;
&lt;li&gt;&lt;em&gt;or&lt;/em&gt; unset &lt;code&gt;LANG&lt;/code&gt; and &lt;code&gt;LC_CTYPE&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;for palm sync: add &lt;code&gt;modprobe visor vendor=0x54c product=0x66&lt;/code&gt; to &lt;code&gt;/etc/rc.modules&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;using sshfs&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;RPMs needed: &lt;code&gt;libfuse&lt;/code&gt;, &lt;code&gt;fuse&lt;/code&gt;, &lt;code&gt;sshfs-fuse&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;setup needed: &lt;code&gt;mknod -m 666 /dev/fuse c 10 229&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Manually controlled, absolutely low-level, internet access through various
modems; see &lt;code&gt;usbmodem.sh&lt;/code&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;plug-and-play: see ../code/&lt;em&gt;.rules and ../code/wvdial.&lt;/em&gt;.conf&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;if it doesn&#39;t work, try ttyUSB0 instead of ttyACM0 (below) before
digging deeper!  If that also doesn&#39;t work try running &lt;code&gt;modprobe
usbserial vendor=0x1b7d product=0x070a&lt;/code&gt; (or similar) first&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;to strip out the VirtualBox stuff from IE screenshots to send to morons
like Tata Indicom:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;mkdir t; map &quot;convert __F__ -crop 1026x769+0+29 t/__F__&quot;
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;lots of tips on killing the annoying, loud, PC speaker beeps, from
&lt;a href=&quot;http://fixunix.com/debian/532303-pc-speaker-cannot-disabled.html&quot;&gt;http://fixunix.com/debian/532303-pc-speaker-cannot-disabled.html&lt;/a&gt; and
elsewhere&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;code&gt;rmmod pcspkr&lt;/code&gt; and/or blacklist it in some file in /etc/modules.d.  Also
try &lt;code&gt;rmmod snd-pcsp&lt;/code&gt; and blacklisting that too&lt;/li&gt;
&lt;li&gt;check if &lt;code&gt;cat /proc/asound/cards&lt;/code&gt; lists it as a card (it apparently
starts doing that when it finds pcspkr blacklisted!); if so, disable it
using &lt;code&gt;alsamixer -c&amp;lt;card number listed in above output&amp;gt;&lt;/code&gt; (M to mute)&lt;/li&gt;
&lt;li&gt;&lt;code&gt;setterm -bfreq 0&lt;/code&gt; prevents bell sound at console, and &lt;code&gt;xset b off&lt;/code&gt; does
the same in X&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;mkinitrd&lt;/code&gt; within a chroot environment requires that proc and sys also be
mounted, otherwise it doesn&#39;t do all the right things.  You&#39;ll need to do
something like this first (and make sure you umount/Ctrl-D in the reverse
order when done!)&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;mkdir j; mount ... j
mount -t proc proc j/proc
mount -t sysfs sys j/sys
chroot $PWD/j
mount /boot     # if /boot was on its own partition
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;the &lt;code&gt;mkinitrd&lt;/code&gt; itself needs to be checked carefully to make sure it is
picking up the right modules; use &lt;code&gt;-v&lt;/code&gt;.  For example, it takes the root
fstype from &lt;code&gt;/etc/fstab&lt;/code&gt; so keep that in mind if you&#39;re upgrading from
ext3 to ext4!&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/html&gt;
</pre>
</div>
<div title="encfs" modifier="Sitaram" created="201011081855">
<pre>
&lt;html&gt;
&lt;h1&gt;Installing and mounting using EncFS&lt;/h1&gt;

&lt;p&gt;&lt;strong&gt;Using encrypted filesystems is RISKY. Your filesystem becomes even more fragile than before. TAKE REGULAR BACKUPS!&lt;/strong&gt;&lt;/p&gt;

&lt;h3&gt;How does EncFS work?&lt;/h3&gt;

&lt;p&gt;EncFS works on files and directories, not an entire block device. This means
that it does not encrypt your hard drive. It modifies file names and contents.
The data is stored on the underlying filesystem and metadata is preserved.
File attributes such as ownership, modification date and permission bits are
not encrypted.&lt;/p&gt;

&lt;h3&gt;What are EncFS&#39;s benefits?&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;easy to use; requires no special setup&lt;/li&gt;
&lt;li&gt;makes it easy to perform backups while not mounted. You can use &#39;rsync&#39; or
any other tool that you would use on an ext3 filesystem&lt;/li&gt;
&lt;li&gt;can be used with secondary passwords.  &lt;strong&gt;USE WITH CARE&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;option to read passwords from an external program or stdin (standard
input) for flexible custom scripting&lt;/li&gt;
&lt;li&gt;FUSE based filesystems are visible only to the user who mounted them; not
even root can see them!&lt;/li&gt;
&lt;/ul&gt;

&lt;h3&gt;Installing EncFS&lt;/h3&gt;

&lt;p&gt;urpmi got the following files when I installed it:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;kernel-source-stripped-2.6.17.5mdv-1-1mdv2007.0.i586.rpm
kernel-2.6.17.5mdv-1-1mdv2007.0.i586.rpm
dkms-2.0.13-3mdv2007.0.noarch.rpm
dkms-fuse-2.5.3-3mdk.i586.rpm
libencfs1-1.3.1-1mdv2007.0.i586.rpm
librlog1-1.3.7-2mdv2007.0.i586.rpm
encfs-1.3.1-1mdv2007.0.i586.rpm
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Load the FUSE module&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;/sbin/modprobe fuse
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;(this was not needed on Mandriva)&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;usermod -Gfuse sitaram
&lt;/code&gt;&lt;/pre&gt;

&lt;h3&gt;Using EncFS&lt;/h3&gt;

&lt;p&gt;:&lt;strong&gt;WARNING&lt;/strong&gt;: Use only absolute path names with EncFS!&lt;/p&gt;

&lt;p&gt;Create working directories:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;mkdir -p ~/encrypted ~/plain
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Now you can mount the new EncFS volume for the first time. This assumes a
default configuration:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;encfs /home/sitaram/encrypted /home/sitaram/plain
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;(Go with the defaults for now and remember the password well!  The
password can be changed later using encfsctl)&lt;/p&gt;

&lt;p&gt;Now start using &lt;code&gt;~/plain&lt;/code&gt; normally.  Check what&#39;s in &lt;code&gt;encrypted/&lt;/code&gt;:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;ls -al ~/encrypted/
drwxr-xr-x 2 jdoe jdoe 4096 2007-05-15 20:26 .
drwxr-xr-x 4 jdoe jdoe 4096 2007-05-15 20:25 ..
-rw-r--r-- 1 jdoe jdoe   22 2007-05-15 20:26 2JkbGxSVzUCZoj9ggUxT9Sou
-rw-r----- 1 jdoe jdoe  224 2007-05-15 20:25 .encfs5
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;strong&gt;WARNING&lt;/strong&gt;: &lt;code&gt;.encfs5&lt;/code&gt; is a special file. When performing backups or
restoring data, make sure to keep this file. If you lose it, you will not
be able to recover your data.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;NOTE&lt;/strong&gt;: Meta information is not encrypted. Permissions, ownership, and
modification date are the same.&lt;/p&gt;

&lt;h3&gt;TIPS&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;For the primary password, choose a strong password containing lowercase
and capital letters, numbers, and punctuation marks. Make it easy to
remember but hard to guess. Do not use your dog&#39;s name, date of birth, or
phone number.&lt;/li&gt;
&lt;li&gt;It may be hard to detect that you use two passwords because encrypted
files are stored in the same folder. If you have a large number of files
encrypted with your primary password and only a few files encrypted with
the secondary one, it is very likely that your secondary files may go
unnoticed.&lt;/li&gt;
&lt;li&gt;Using multiple passwords may be very frustrating for somebody examining
your system. They will probably give up. Keep in mind that using multiple
passwords is not easy and you may forget them. Keep in mind that the
chances of restoring your data if this happens are almost zero.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;sup&gt;Source: &lt;a href=&quot;http://www.redhatmagazine.com/2007/06/13/dual-password-encryption-with-encfs/&quot;&gt;http://www.redhatmagazine.com/2007/06/13/dual-password-encryption-with-encfs/&lt;/a&gt;&lt;/sup&gt;&lt;/p&gt;
&lt;/html&gt;
</pre>
</div>
<div title="screen" modifier="Sitaram" created="200903241920">
<pre>
&lt;html&gt;
&lt;h1&gt;ths screen program&lt;/h1&gt;

&lt;p&gt;You know, this was probably the very &lt;strong&gt;first&lt;/strong&gt; open source program I ever used
in my life!  We had these horribly long compiles (MF COBOL with an Oracle
pre-compiler stage that seemed to bloat the COBOL &lt;em&gt;source&lt;/em&gt; by about a
hundred times!), and our network was very flaky.  Without putting &quot;&lt;code&gt;screen
-DR&lt;/code&gt;&quot; at the bottom of each of our &quot;&lt;code&gt;.profile&lt;/code&gt;&quot; files we would never
have managed.&lt;/p&gt;

&lt;p&gt;But this program can do so much more, like replace kibitz!&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;screen -S foo   # on your friend&#39;s terminal
screen -x foo   # on your terminal
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;This requires both of you to log in as the same user, so you may want to
create a dummy one for that purpose, and then move to the real environment.&lt;/p&gt;
&lt;/html&gt;
</pre>
</div>
<div title="ubuntu" modifier="Sitaram" created="200903241920">
<pre>
&lt;html&gt;
&lt;h1&gt;Ubuntu&lt;/h1&gt;

&lt;h3&gt;Ubuntu -- user/group mappings to capabilities&lt;/h3&gt;

&lt;p&gt;users and groups --&gt; user privileges mapping to groups&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;plugdev     : access external storage devices automatically
admin       : administer the system
fuse        : allow use of fuse file systems like...
dip         : connect to internet using a modem
adm         : monitor system logs
fax         : send and recieve faxes
audio       : use audio devices
cdrom       : use CD-ROM drives
floppy      : use floppy drives
dialout     : use modems
scanner     : use scanners
tape        : use tape drives
&lt;/code&gt;&lt;/pre&gt;
&lt;/html&gt;
</pre>
</div>
<div title="recoll" modifier="Sitaram" created="200903241920">
<pre>
&lt;html&gt;
&lt;h1&gt;recoll&lt;/h1&gt;

&lt;h4&gt;searching&lt;/h4&gt;

&lt;ul&gt;
&lt;li&gt;in simple search, wildcards are &lt;code&gt;*&lt;/code&gt;, &lt;code&gt;?&lt;/code&gt;, and &lt;code&gt;[]&lt;/code&gt;
&lt;ul&gt;
&lt;li&gt;wildcards not anchored at the start are slooooooow!&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;Initial Caps will disable stem expansion&lt;/li&gt;
&lt;li&gt;&quot;words inside phrases&quot; are not stem expanded&lt;/li&gt;
&lt;li&gt;double-click on any word adds it to the search bar&lt;/li&gt;
&lt;li&gt;advanced search
&lt;ul&gt;
&lt;li&gt;can be restricted to a doctype, subtree, etc.&lt;/li&gt;
&lt;li&gt;&quot;this phrase&quot; and &quot;terms in proximity&quot; are very useful&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;be sure to use caps&lt;/strong&gt; to disable stemming when using &quot;terms in
proximity&quot;, otherwise the resulting query gets too long and complex.
Not that it really matters most of the time; it&#39;s still quite fast!&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;term explorer&lt;/strong&gt; is very useful when you don&#39;t even know what you&#39;re
searching for!&lt;/li&gt;
&lt;/ul&gt;

&lt;h4&gt;browse results&lt;/h4&gt;

&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;right-click to open parent email when result found in an attachment!&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;you can browse successive results in a single preview window by typing
Shift+ArrowUp/Down in the window&lt;/li&gt;
&lt;li&gt;close a preview tab by Ctrl-W&lt;/li&gt;
&lt;li&gt;search &lt;strong&gt;inside&lt;/strong&gt; a preview tab by &lt;code&gt;/&lt;/code&gt; and &lt;code&gt;F3&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;shift+preview opens a new preview window instead of a new tab in an
existing preview window&lt;/li&gt;
&lt;/ul&gt;

&lt;h4&gt;query language&lt;/h4&gt;

&lt;ul&gt;
&lt;li&gt;fields
&lt;ul&gt;
&lt;li&gt;title &lt;code&gt;==&lt;/code&gt; subject &lt;code&gt;==&lt;/code&gt; caption; meaning based on context&lt;/li&gt;
&lt;li&gt;from &lt;code&gt;==&lt;/code&gt; author&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;OR&lt;/code&gt; must be in caps&lt;/li&gt;
&lt;li&gt;prefix &lt;code&gt;-&lt;/code&gt; to negate&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;OR has precedence over AND!!!&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;no parens supported&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/html&gt;
</pre>
</div>
<div title="getting-stuff" modifier="Sitaram" created="200903241920">
<pre>
&lt;html&gt;
&lt;h1&gt;rsync, lftp, aria2, curl, wget, mc -- when to use what&lt;/h1&gt;

&lt;p&gt;Note: &#39;simultaneous&#39; means multiple, different, URLs, &#39;segmented&#39; means
multiple connections opened to the same URL (hammers the server),
&#39;distributed&#39; means multiple connections opened to different (mirror) URLs
hosting the same file (like metalink)&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;                                rsync   mc      lftp    curl    aria2   wget

    simultaneous downloads                      y               y (*)
    segmented downloads                         y               y (*)
    distributed downloads                                       y
    metalink                                                    y

    sftp using ssh-agent        y       y       Y
    http, ftp                                   y       y       y       y
    metalink, bittorrent                                        y

    interactive/batch           b       i       i       b       b       b
    mirroring                                   y                       y
    recursion (web)                                                     y
    job control etc                             Y
    lists/sequences                             y (*)   y       y (*)
    cookies, forms, etc                                 y
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Notes:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;rsync is very efficient for changed files&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;lftp is the overall best tool&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;has better completion than mc&lt;/li&gt;
&lt;li&gt;goes to &lt;code&gt;$HOME&lt;/code&gt; of the remote user instead of &lt;code&gt;/&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;can start downloads and continue to explore, or exit while they&#39;re all
running!&lt;/li&gt;
&lt;li&gt;can do lists and sequences neatly; see my .lftprc for a very cool alias
that does the job except numbers don&#39;t 0-pad&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;aria2&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;does segmented downloads &lt;strong&gt;by default&lt;/strong&gt;!&lt;/li&gt;
&lt;li&gt;needs the &lt;code&gt;-Z&lt;/code&gt; option to do simultaneous downloads&lt;/li&gt;
&lt;li&gt;does not seem to follow redirects&lt;/li&gt;
&lt;li&gt;can do lists and sequences (it doesn&#39;t have placeholders for output
names like curl does, but that&#39;s OK)&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;only &lt;code&gt;wget&lt;/code&gt; does &lt;em&gt;recursion&lt;/em&gt; of a website&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;common usage is:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;wget -c -w 5 --random-wait -r -l 0 -k -np
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;you can use, e.g., &#39;-l 2 -p&#39; to limit to 2 levels but get all the
prerequisites of the pages obtained&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;curl is left with pretty much nothing but forms and cookies now!&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/html&gt;
</pre>
</div>
<div title="fun-upside-down-ternet" modifier="Sitaram" created="200903241920">
<pre>
&lt;html&gt;
&lt;h1&gt;Upside-Down-Ternet&lt;/h1&gt;

&lt;p&gt;&lt;sup&gt;from &lt;a href=&quot;http://www.ex-parrot.com/peter/upside-down-ternet.html&quot;&gt;http://www.ex-parrot.com/peter/upside-down-ternet.html&lt;/a&gt;&lt;/sup&gt;&lt;/p&gt;

&lt;p&gt;squid redirector script&lt;/p&gt;

&lt;p&gt;some other options from
&lt;a href=&quot;http://www.enterprisenetworkingplanet.com/netsecur/article.php/3653006&quot;&gt;http://www.enterprisenetworkingplanet.com/netsecur/article.php/3653006&lt;/a&gt;
(which sets up squid as a transparent proxy and also, weirdly, tells you
exactly what you should look for on the kismet pages to get your wifi
cracking sessions started!)&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;&quot;/usr/bin/mogrify&quot;, &quot;-swirl 30&quot;
&quot;/usr/bin/mogrify&quot;, &quot;-charcoal 10&quot;
&quot;/usr/bin/mogrify&quot;, &quot;-paint 10&quot;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;but they take up too much CPU time.  Here are my choices (sorted by CPU time taken for an 800x600 image):&lt;/p&gt;

&lt;p&gt;TODO: make WikiCreole give us some table borders&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;        seconds     mogrify option      optional argument       

        0.17        flip        
        0.18        negate      
        0.19        solarize        10      
        0.22        transpose       
        0.22        transverse      
        0.29        spread              4       
        0.32        shade               45      
        1.24        swirl               30      
        1.56        monochrome      
        1.59        implode             4       
        1.80        shear               10x10       
        2.38        edge                4       
        2.59        rotate              15      
        4.10        paint               4
&lt;/code&gt;&lt;/pre&gt;
&lt;/html&gt;
</pre>
</div>
<div title="beamer" modifier="Sitaram" created="200910191847">
<pre>
&lt;html&gt;
&lt;h1&gt;beamer&lt;/h1&gt;

&lt;h2&gt;what theme to use&lt;/h2&gt;

&lt;p&gt;S = section, SS = subsection, nav = navigation, authinfo = cool stuff at the
bottom of the slide, ooo = mini-bullets for navigation (very, very, cool!)&lt;/p&gt;

&lt;p&gt;The default properties are shown below, but keep in mind that I have made
changes that (1) eliminate the stupid navigational symbols, and (2) insert
authinfo regardless.&lt;/p&gt;

&lt;p&gt;This makes Darmstadt the best for logo-needing shows (like for $DAYJOB), and
Hannover the best for personal stuff.&lt;/p&gt;

&lt;p&gt;Warsaw is very impressive, but useful only when there are 4 or less sections
(and subsections in each section), &lt;em&gt;and&lt;/em&gt; none of the slides are really packed.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;(+) space, (-) no beamer specials
        default/boxes is POP (plain old PPT)
        Pittsburgh = POP, with slide title right-justified

(+) space, (+) authinfo, (-) no S/SS, (-) no nav
        Madrid

(+) full S/SS text nav (-) less horizontal space (-) no logo
        Hannover is LHS, light blue
        Goettingen is RHS, light blue
        Marburg is RHS, dark blue

(+) S/SS text, (+) cool 1-row ooo nav, (-) no authinfo
        Frankfurt shows only S, not SS
        Darmstadt adds one line for current SS also

(+) S text, (+) multi-row ooo nav, (-) no SS text, (-) no authinfo
        Singapore

(+) authinfo, (+) S|SS text (-) no nav
        AnnArbor is yellow
        CambridgeUS is maroon

(+) S|SS nav, (+/-) some authinfo, (-) no ooo so takes space
        Warsaw
        the authinfo is not as cool as AnnArbor etc
&lt;/code&gt;&lt;/pre&gt;
&lt;/html&gt;
</pre>
</div>
<div title="ajax-security" modifier="Sitaram" created="200903241920">
<pre>
&lt;html&gt;
&lt;h1&gt;Ajax security notes&lt;/h1&gt;

&lt;p&gt;non ajax model&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;calls to server are coarse: a whole bunch of info gets sent in one large
&quot;form&quot; and a whole page comes back fully assembled&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ajax model&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;calls to server are much more granular; queries and responses more
numerous and correspondingly smaller&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;lot of logic gets done in browser; final page assembled in browser, for
all preactical purposes&lt;/p&gt;

&lt;p&gt;So Ajax ends up with a lot more functions in the API exposed, a lot more
entry points into the backend, if you will.&lt;/p&gt;

&lt;p&gt;Stuff which typically gets done once per request (authentication,
authorisation, input validation/sanitisation) must still get done once per
request, except it may now have to be done by much lower level functions
in the API than by something at a higher level.&lt;/p&gt;

&lt;p&gt;Both these issues are much more likely to be present if you blindly
ajaxify a traditional website, although they can also happen to a freshly
designed ajax site if you&#39;re careless enough!&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/html&gt;
</pre>
</div>
<div title="backup-and-compare-only-metadata" modifier="Sitaram" created="200903241920">
<pre>
&lt;html&gt;
&lt;h1&gt;Compare directory metadata without storing the full archive!&lt;/h1&gt;

&lt;pre&gt;&lt;code&gt;Record the state of a directory:

        dar -c - -G startstate -R /home/sitaram &amp;gt;/dev/null

later:

        dar -c - -G newstate -A startstate -R /home/sitaram &amp;gt;/dev/null
        dar -as -l newstate

will give you what changed between then and now!
&lt;/code&gt;&lt;/pre&gt;
&lt;/html&gt;
</pre>
</div>
<div title="gimp-blending-modes" modifier="Sitaram" created="200903241920">
<pre>
&lt;html&gt;
&lt;h1&gt;gimp photo blending modes&lt;/h1&gt;

&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Dissolve&lt;/strong&gt;: allow a % of BG to show through the FG.  Random parts of FG
are made partially transparent and the rest fully transparent.  FG must
have an alpha channel &amp;lt; 255, or it doesn&#39;t work&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Addition&lt;/strong&gt;: min(F+B, W)&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Subtraction&lt;/strong&gt;: max(B-F, 0) -- this is &lt;em&gt;not&lt;/em&gt; symmetrical&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Difference&lt;/strong&gt;: |B-F| -- this &lt;em&gt;is&lt;/em&gt; symmetrical; same as |F-B|&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Multiply&lt;/strong&gt;: F*B/255 -- always darker than both F and B&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Divide&lt;/strong&gt;: nominally the reverse of Multiply (i.e., B*255/F), but
actually B*256/(F+1) to avoid div-by-0&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Screen&lt;/strong&gt;: lightens exactly like Multiply darkens; same formula, but uses
(255,255,255) as the origin instead of (0,0,0).  Always lighter than both
F and B.  Actual formula is W - (W-F)*(W-B)/255&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Overlay&lt;/strong&gt;: combination of Multiply and Screen.  (B*S + (1-B)*M)/255,
where M and S are the results from the Multiply and Screen formulae.  The
mix is controlled by BG: if BG is dark, M dominates, else S dominates.
Overall, it tends to make an image darker where BG is already dark and
lighter where BG is already light.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Hue&lt;/strong&gt;: Take H from FG, and S and V from BG&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Saturation, Value&lt;/strong&gt;: analogous to above&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Color&lt;/strong&gt;: take H and S from FG, and &#39;lightness&#39; from BG.  (Lightness is a
bit less bright than value and closer to perceived brightness.)&lt;/li&gt;
&lt;/ul&gt;
&lt;/html&gt;
</pre>
</div>
<div title="knoppix-usb" modifier="Sitaram" created="200903241920">
<pre>
&lt;html&gt;
&lt;h1&gt;&lt;a name=&quot;Knoppix_and_USB&quot;&gt;Knoppix and USB&lt;/a&gt;&lt;/h1&gt;

&lt;p&gt;This helps you get a portable Linux environment to take with you wherever you
go:
  * a USB stick that boots into Knoppix
  * your choice of software on the stick, apart from what came with the
    Knoppix CD/DVD
  * your settings and home directory retained across sessions
  * you can also continue to use the remaining space on the stick for more
    typical purposes (transporting files)&lt;/p&gt;

&lt;p&gt;The following is from actually doing this with a Knoppix DVD (not a CD) and an
8 GB stick for my nephew, who&#39;s away at a college where the general level of
cluefulness in the computer lab does not extend to a choice of operating
systems :-(&lt;/p&gt;

&lt;hr /&gt;

&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#Knoppix_and_USB&quot;&gt;Knoppix and USB&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#size_and_prep_USB&quot;&gt;size and prep USB&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#copy_stuff&quot;&gt;copy stuff&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#copy_boot_directory&quot;&gt;copy &lt;code&gt;boot&lt;/code&gt; directory&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#install_extlinux&quot;&gt;install extlinux&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#copy_the_rest_of_the_DVD&quot;&gt;copy the rest of the DVD&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#usage&quot;&gt;usage&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#first_use&quot;&gt;first use&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#important&quot;&gt;important&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#other_hints_and_tips&quot;&gt;other hints and tips&lt;/a&gt;&lt;br&gt;&lt;/p&gt;

&lt;hr /&gt;

&lt;p&gt;http://www.knoppix.net/wiki/Bootable&lt;em&gt;USB&lt;/em&gt;Key is a good starting point but
that&#39;s all it is.  Most of it is cruft and the rest I have not actually
followed :-)  You don&#39;t have to do most of the stuff in there, especially the
bit about doing this from within knoppix -- any recent/decent Linux can be
used to create this USB if you have the Knoppix DVD handy.  There&#39;s one
section on making the BIOS actually recognise and boot from USB that&#39;s useful
though.&lt;/p&gt;

&lt;h3&gt;&lt;a name=&quot;size_and_prep_USB&quot;&gt;size and prep USB&lt;/a&gt;&lt;/h3&gt;

&lt;p&gt;The stick has to be able to hold the entire CD/DVD&#39;s contents, plus whatever
extra software you want to install.&lt;/p&gt;

&lt;p&gt;The extra software and customisation you do is stored in a &quot;persistent knoppix
image&quot; -- basically a file called &lt;code&gt;knoppix.img&lt;/code&gt;.  You have to decide in
advance how big this should be, and it &lt;em&gt;cannot&lt;/em&gt; be stored on the same
partition as the DVD itself (I have no idea why).  So you need at least 2
partitions.&lt;/p&gt;

&lt;p&gt;Further, I prefer that both those partitions be &lt;code&gt;ext3&lt;/code&gt;, and create a third
one with FAT32 with the rest of the space for temporary file transfer
purposes -- you never know what sort of idiot will want to borrow your USB
stick for a few minutes and accidentally delete some crucial file on it, so
it&#39;s better they don&#39;t even see those partitions!&lt;/p&gt;

&lt;p&gt;So here&#39;s what my stick looks like:
  * partition 1, EXT3, bootable, about 5 GB
    * this should be the size of the CD/DVD plus a bit extra
  * partition 2, EXT3, about 2 GB
    * contains &lt;code&gt;knoppix.img&lt;/code&gt;, presized to about 1 GB
    * the rest is lean (non-FAT, get it?) free space just in case I need some
  * partition 3, FAT32, the rest of the disk, for general use&lt;/p&gt;

&lt;h3&gt;&lt;a name=&quot;copy_stuff&quot;&gt;copy stuff&lt;/a&gt;&lt;/h3&gt;

&lt;p&gt;You need to do 2 things: copy the contents of the DVD, and run &lt;code&gt;extlinux&lt;/code&gt;.
This is the sequence in which I did them; other sequences may also work&lt;/p&gt;

&lt;h4&gt;&lt;a name=&quot;copy_boot_directory&quot;&gt;copy &lt;code&gt;boot&lt;/code&gt; directory&lt;/a&gt;&lt;/h4&gt;

&lt;p&gt;Mount the future boot disk&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;mount /dev/sdz1 /j
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;There&#39;s an interesting point in the URL above about buggy CHS handling of USB
sticks, so long story short, I copied the boot files first (note &lt;strong&gt;no&lt;/strong&gt;
trailing slash after the word &lt;code&gt;boot&lt;/code&gt; below)&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;rsync -av /media/cdrom/boot /j
&lt;/code&gt;&lt;/pre&gt;

&lt;h4&gt;&lt;a name=&quot;install_extlinux&quot;&gt;install extlinux&lt;/a&gt;&lt;/h4&gt;

&lt;p&gt;Let&#39;s keep things the way &lt;code&gt;extlinux&lt;/code&gt; wants them (as opposed to how
&lt;code&gt;isolinux&lt;/code&gt; wants them!):&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;mv /j/boot/isolinux /j/boot/extlinux
mv /j/boot/extlinux/isolinux.cfg /j/boot/extlinux/extlinux.conf
/bin/rm /j/boot/extlinux/isolinux.bin
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;code&gt;extlinux&lt;/code&gt;, unlike &lt;code&gt;isolinux&lt;/code&gt;, runs on a &lt;em&gt;mounted&lt;/em&gt; file system, so&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;extlinux --install /j/boot/extlinux
&lt;/code&gt;&lt;/pre&gt;

&lt;h4&gt;&lt;a name=&quot;copy_the_rest_of_the_DVD&quot;&gt;copy the rest of the DVD&lt;/a&gt;&lt;/h4&gt;

&lt;p&gt;This is the part that takes time:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;rsync -avP /media/cdrom/ /j --exclude boot
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;sync/unmount/sync again, then reboot.  Your USB stick is ready!&lt;/p&gt;

&lt;h3&gt;&lt;a name=&quot;usage&quot;&gt;usage&lt;/a&gt;&lt;/h3&gt;

&lt;h4&gt;&lt;a name=&quot;first_use&quot;&gt;first use&lt;/a&gt;&lt;/h4&gt;

&lt;p&gt;The very first time you use it, before doing anything else, create a
persistent Knoppix image (Knoppix menu, Utilities).  Choose /dev/sdz2 for it,
and give it some suitable size (I gave it 1.1 GB).  Then reboot.&lt;/p&gt;

&lt;p&gt;On the next reboot, use the package manager, setup repositories (you only need
2 of them - stable/updates and stable; unselect the rest), and install
whatever you want.&lt;/p&gt;

&lt;h4&gt;&lt;a name=&quot;important&quot;&gt;important&lt;/a&gt;&lt;/h4&gt;

&lt;p&gt;On each reboot after the first, you will need to make sure you watch the boot
and hit &quot;OK&quot; on the prompt to mount the persistent knoppix image.  Just hit
the left arrow key then hit enter at that prompt.  If you walk away from the
computer, you will find that this prompt times out and knoppix boots without
mounting the persistent image.  This is a security feature.&lt;/p&gt;

&lt;h3&gt;&lt;a name=&quot;other_hints_and_tips&quot;&gt;other hints and tips&lt;/a&gt;&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;It may be a good idea to upgrade the whole thing every time a new version
comes out, because upgrading packages essentially wastes the space in the
DVD image (5 GB) partition.&lt;/li&gt;
&lt;li&gt;&lt;p&gt;For the same reason, it might be even better to do this whole thing with a
Knoppix &lt;strong&gt;CD&lt;/strong&gt; rather than a DVD, and manually install what you need.
You&#39;ll have to install a lot more, but correspondingly you&#39;re wasting a
lot less space on the first partition.&lt;/p&gt;

&lt;p&gt;It&#39;s a trade-off, really.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/html&gt;
</pre>
</div>
<div title="filesync-include-exclude" modifier="Sitaram" created="200903241920">
<pre>
&lt;html&gt;
&lt;h1&gt;File sync -- include/exclude rules and order&lt;/h1&gt;

&lt;h4&gt;rsync&lt;/h4&gt;

&lt;ul&gt;
&lt;li&gt;order matters, first matching pattern acts&lt;/li&gt;
&lt;li&gt;no pattern matches the candidate: default is include (use an ultra
wildcard at the end if needed, like: &lt;code&gt;- **&lt;/code&gt;)&lt;/li&gt;
&lt;/ul&gt;

&lt;h4&gt;rdiff-backup&lt;/h4&gt;

&lt;ul&gt;
&lt;li&gt;(same as rsync)&lt;/li&gt;
&lt;/ul&gt;

&lt;h4&gt;dar&lt;/h4&gt;

&lt;ul&gt;
&lt;li&gt;order doesn&#39;t matter&lt;/li&gt;
&lt;li&gt;no match: default is include if no &lt;code&gt;-P&lt;/code&gt; (prune) matches the candidate&lt;/li&gt;
&lt;/ul&gt;

&lt;h4&gt;unison&lt;/h4&gt;

&lt;ul&gt;
&lt;li&gt;order doesn&#39;t matter&lt;/li&gt;
&lt;li&gt;no match: ignore/not status is inherited from the parent&lt;/li&gt;
&lt;li&gt;ignorenot overrides ignore if both match&lt;/li&gt;
&lt;/ul&gt;
&lt;/html&gt;
</pre>
</div>
<div title="aptitude-and-friends" modifier="Sitaram" created="200903241920">
<pre>
&lt;html&gt;
&lt;h1&gt;&lt;a name=&quot;aptitude_and_friends&quot;&gt;aptitude and friends&lt;/a&gt;&lt;/h1&gt;

&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#aptitude_and_friends&quot;&gt;aptitude and friends&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#Command_line_Package_Management_with_Aptitude&quot;&gt;Command-line Package Management with Aptitude&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#Important_note_on_using_multiple_package_managers&quot;&gt;Important note on using multiple package managers&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#The_feature_that_gets_all_the_press_&quot;&gt;The feature that gets all the press...&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#The_choices&quot;&gt;The choices&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#Configuring_aptitude&quot;&gt;Configuring aptitude&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#Common_operations&quot;&gt;Common operations&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#Package_Selection&quot;&gt;Package Selection&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#Working_on_a_specific_package_or_packages_&quot;&gt;Working on a specific package (or packages)&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#Using_dpkg&quot;&gt;Using dpkg&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#Cheat_sheet&quot;&gt;Cheat sheet&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#Search_patterns&quot;&gt;Search patterns&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#Search_output_formatting_in_aptitude&quot;&gt;Search output formatting in aptitude&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#Sort_rules_on_output&quot;&gt;Sort rules on output&lt;/a&gt;&lt;br&gt;&lt;/p&gt;

&lt;hr /&gt;

&lt;h3&gt;&lt;a name=&quot;Command_line_Package_Management_with_Aptitude&quot;&gt;Command-line Package Management with Aptitude&lt;/a&gt;&lt;/h3&gt;

&lt;p&gt;This article is meant to serve as a quick reference for package management at
the command line using &lt;code&gt;aptitude&lt;/code&gt; and similar tools.  Where more than one tool
does the job, we will describe only the &lt;code&gt;aptitude&lt;/code&gt; way.&lt;/p&gt;

&lt;h3&gt;&lt;a name=&quot;Important_note_on_using_multiple_package_managers&quot;&gt;Important note on using multiple package managers&lt;/a&gt;&lt;/h3&gt;

&lt;p&gt;Before we dig into the article, there is one caveat.  For various reasons (see
later), it is considered inadvisable to mix package managers, as far as the
actual install/remove/upgrade operations are concerned.  However, querying and
exploring the package repository using a mix of tools is perfectly fine.&lt;/p&gt;

&lt;p&gt;This article describes the ways in which aptitude is superior to apt-get, as
well as the situations in which you will still need apt-get, apt-cache, etc.
(There are even situations in which you have to use &quot;&lt;code&gt;dpkg&lt;/code&gt;&quot;!  For example,
the &lt;code&gt;recoll&lt;/code&gt; package, which I tend to use heavily, has to be downloaded as a
&lt;code&gt;.deb&lt;/code&gt; and installed manually via &lt;code&gt;dpkg -i&lt;/code&gt;.)&lt;/p&gt;

&lt;p&gt;The article assumes you know some of the basic terminology of package
management.&lt;/p&gt;

&lt;h3&gt;&lt;a name=&quot;The_feature_that_gets_all_the_press_&quot;&gt;The feature that gets all the press...&lt;/a&gt;&lt;/h3&gt;

&lt;p&gt;The one feature of aptitude that gets all the attention (or used to, until
apt-get acquired the &quot;autoremove&quot; option) is that &lt;code&gt;aptitude&lt;/code&gt; keeps track of
whether a package was manually installed by the administrator, or it was
installed to satisfy a dependency.  As a result, when a package is removed,
packages that were installed as its dependencies can also get removed, as long
as &lt;em&gt;no other installed package&lt;/em&gt; is using them.&lt;/p&gt;

&lt;p&gt;This is also the reason why mixing package managers can cause trouble.  To be
fair, you can tell aptitude (using the &lt;code&gt;markauto&lt;/code&gt; and &lt;code&gt;unmarkauto&lt;/code&gt; options)
which packages were explicitly installed and which ones were installed as
dependencies, so even if you do mix tools and find that &lt;code&gt;aptitude&lt;/code&gt; seems to
want to do the wrong thing, running these commands will tell it who&#39;s the boss
:-)&lt;/p&gt;

&lt;h3&gt;&lt;a name=&quot;The_choices&quot;&gt;The choices&lt;/a&gt;&lt;/h3&gt;

&lt;p&gt;These are the choices.&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;for the command line
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;apt-get&lt;/code&gt; (and its cousins &lt;code&gt;apt-cache&lt;/code&gt;, etc)&lt;/li&gt;
&lt;li&gt;&lt;code&gt;aptitude&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;for a text-based (ncurses) GUI
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;aptitude&lt;/code&gt;: You might notice that aptitude is the only one with
both a CLI and a GUI, even if it is just an ncurses GUI.  However, in
this article we will only be talking about the command line interface.&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;for a GUI
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;synaptic&lt;/code&gt; (on Ubuntu)&lt;/li&gt;
&lt;li&gt;&lt;code&gt;adept&lt;/code&gt; (on kubuntu)&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;All of them are equally good at the basics, but there are some important
differences in capabilities.  The most important ones are listed here :&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;code&gt;apt-cache&lt;/code&gt; has a &lt;code&gt;policy&lt;/code&gt; command which tells you how many versions of
the package exist, in which repository they are found, and which one it
will choose to install if you ask it to install the package&lt;/li&gt;
&lt;li&gt;&lt;code&gt;apt-get&lt;/code&gt; has a &lt;code&gt;--print-uris&lt;/code&gt; option, which prints out all the
URIs it would download.  This is &lt;em&gt;invaluable for a system with a slow
internet connection&lt;/em&gt;.  Just use some offline mechanism (like a USB stick)
to get the files from some other machine with a faster connection, put
them all in &lt;code&gt;/var/cache/apt/archives&lt;/code&gt;, and run &lt;code&gt;aptitude install
...&lt;/code&gt;; it&#39;ll notice the files already exist and won&#39;t attempt to download
them.  I have even upgraded from Ubuntu Feisty (7.04) to Gutsy (7.10)
using this method; about 40 megabytes were eventually downloaded directly
by the machine being upgraded, while the rest (about 600 MB) were obtained
in this manner.&lt;/li&gt;
&lt;li&gt;As I said, none of the &quot;aptitude versus apt-get&quot; articles on the web seem
to mention aptitude&#39;s excellent query capabilities.  For example, you can
ask: give me the download size and installed size of all installed
packages that depend on any package whose name contains &quot;perl&quot; or
&quot;python&quot;.\ \
What&#39;s more, you can use the same query patterns in commands - in the
above example, once you have seen the list, you can simply replace the
command (&quot;search&quot;) with another command (say, &quot;install&quot;) to upgrade all
those packages.  Nothing in apt-get comes close.  For example, I like to
stay uptodate on perl stuff, so I can run
    aptitude install &quot;~i ~U ~n^perl&quot;
to upgrade all installed (&lt;code&gt;~i&lt;/code&gt;) and upgradable (&lt;code&gt;~U&lt;/code&gt;) packages
whose name (&lt;code&gt;~n&lt;/code&gt;) starts with (&lt;code&gt;^&lt;/code&gt;) the word &lt;code&gt;perl&lt;/code&gt;.
&lt;em&gt;Note&lt;/em&gt;* : search patterns can match more than you intended unless you
anchor the regex with &lt;code&gt;^&lt;/code&gt; and &lt;code&gt;$&lt;/code&gt;, especially if the package has a
short name that could be a substring of other package names&lt;/li&gt;
&lt;li&gt;&lt;code&gt;aptitude&lt;/code&gt; can be made to pause for confirmation using the &lt;code&gt;-P&lt;/code&gt;
flag.  When it pauses, you can get &lt;strong&gt;detailed dependency information&lt;/strong&gt;
that tells you clearly why each install/remove choice was made, &lt;strong&gt;version
information&lt;/strong&gt;, or information about the &lt;strong&gt;extra space&lt;/strong&gt; taken by each
package as a result of this action.  Just type a &quot;?&quot; at the prompt for
these and many more powerful things that are possible!&lt;/li&gt;
&lt;li&gt;&lt;code&gt;aptitude&lt;/code&gt;&#39;s output when searching for packages can be &lt;strong&gt;sorted&lt;/strong&gt; as
well as &lt;strong&gt;formatted&lt;/strong&gt; to your taste/needs; see below for details.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;[Side note: The 2 complaints I have against APT are (i) that it doesn&#39;t store
&quot;time of install&quot; anywhere, like RPM does, and (ii) there&#39;s nothing like &lt;code&gt;rpm
-V&lt;/code&gt; to verify all the files of a package and find out which ones have changed.
The first issue can be worked around by trawling the log files, but the second
one can&#39;t.]&lt;/p&gt;

&lt;h3&gt;&lt;a name=&quot;Configuring_aptitude&quot;&gt;Configuring aptitude&lt;/a&gt;&lt;/h3&gt;

&lt;p&gt;Make sure you add a line saying&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;aptitude::Recommends-Important &quot;false&quot;;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;in &lt;code&gt;/root/.aptitude/config&lt;/code&gt;.  This says &quot;just because a package is
&lt;em&gt;recommended&lt;/em&gt; doesn&#39;t mean you should go and install it&quot; ;-) Apart from making
things a little faster and leaner, this option is also consistent with the
behaviour of &lt;code&gt;apt-get install&lt;/code&gt;.&lt;/p&gt;

&lt;h3&gt;&lt;a name=&quot;Common_operations&quot;&gt;Common operations&lt;/a&gt;&lt;/h3&gt;

&lt;p&gt;&lt;em&gt;Note&lt;/em&gt;*: Even though there is a cron job that updates the package database
every day, it&#39;s best to do an&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;aptitude update
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;before any installations, upgrades, or removals.&lt;/p&gt;

&lt;h4&gt;&lt;a name=&quot;Package_Selection&quot;&gt;Package Selection&lt;/a&gt;&lt;/h4&gt;

&lt;p&gt;This is, as I said before, where &lt;code&gt;aptitude&lt;/code&gt; really shines, and it seems better
to describe this with examples than by any other method.  The examples will
demonstrate the power as well as serve as a tutorial or a quick reference to
this feature.  Also, remember that although most of the examples use &lt;code&gt;search&lt;/code&gt;
as the command, you can just as easily substitute any other command (like
&lt;code&gt;install&lt;/code&gt;, &lt;code&gt;remove&lt;/code&gt;, &lt;code&gt;purge&lt;/code&gt;, etc.) to perform that action on the packages
that would be selected by the selection expression.&lt;/p&gt;

&lt;p&gt;&lt;em&gt;Note&lt;/em&gt;* : search patterns can match more than you intended unless you anchor
the regex with &lt;code&gt;^&lt;/code&gt; and &lt;code&gt;$&lt;/code&gt;, especially if the package has a short name that
could be a substring of other package names&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;all packages known to the system&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;aptitude search .   # about 25,000 results, on my machine
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;all installed pkgs&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;aptitude search ~i
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;all packages having perl in the name somewhere&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;aptitude search perl
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;all packages starting with the word perl&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;aptitude search ~n^perl
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;all installed pkgs starting with the word perl&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;aptitude search &#39;~i ~n^perl&#39;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Note the quotes above; if a search pattern has multiple terms they are
AND-ed together.  Without the quotes they would be treated as 2 separate,
unrelated, search patterns, and aptitude would process them separately and
simply combine the output, so you get many, many, more results.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;packages removed but whose config files still remain&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;aptitude search ~c
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;purge (remove config files of) all such packages&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;aptitude purge ~c
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Notice how the same package selection operator can be used for real
actions also.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;packages that aptitude marks as &quot;automatically installed as dependencies&quot;&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;aptitude search ~M
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;packages that were automatically installed but are no longer needed&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;aptitude search ~g
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;new packages&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;aptitude search ~N
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;You should look at these once in a while to see what sort of new packages&lt;/p&gt;

&lt;p&gt;are getting into the repos, and when you&#39;ve seen them, you should tell
aptitude you&#39;re done seeing them by saying&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;aptitude forget-new
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;so the next time you use &lt;code&gt;~N&lt;/code&gt; it won&#39;t show you these packages again.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;packages ready to be upgraded&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;aptitude search ~U
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Let&#39;s say there are plenty of packages with upgrades available, but
(perhaps due to lack of time or bandwidth), I wish to upgrade only perl :&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;aptitude install &quot;~U ~i ~nperl&quot;
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;packages that depend on the package called perl&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;aptitude search ~D^perl$    # note the ^ and the $
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;packages that depend on any package containing the string perl&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;aptitude search ~Dperl      # note no ^ and $ to anchor the regex
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;packages that are depended on by perl&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;aptitude search ~R^perl$    # R means reverse depends
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;packages that recommend perl&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;aptitude search ~Drecommends:^perl$
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;packages that are recommended by perl&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;aptitude search ~Rrecommends:^perl$
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;packages with someword in the description&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;aptitude search ~dsomeword
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;packages with &lt;strong&gt;both&lt;/strong&gt; words in the description&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;aptitude search &#39;~dword1 ~dword2&#39;   # note the quotes
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;packages with &lt;strong&gt;either&lt;/strong&gt; word in the description&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;aptitude search ~dword1 ~dword2     # will return many more results!
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h4&gt;&lt;a name=&quot;Working_on_a_specific_package_or_packages_&quot;&gt;Working on a specific package (or packages)&lt;/a&gt;&lt;/h4&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;get detailed information about a package&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;aptitude show -v pkg
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;install a package&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;aptitude install pkg          # you can add suffixes to the packagename
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;you can add the following suffixes to a packagename to perform multiple
actions (install package A, remove package B, etc) in the same command&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;+       install
-       remove
_       purge
=       hold
:       cancel changes (??)
+M      marked as auto-installed
+m      ...manual...
&amp;amp;M      mark already installed pkg as auto-installed
&amp;amp;m      mark already installed pkg as manually installed
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h4&gt;&lt;a name=&quot;Using_dpkg&quot;&gt;Using dpkg&lt;/a&gt;&lt;/h4&gt;

&lt;p&gt;Finally, note that you do sometimes have to use &lt;code&gt;dpkg&lt;/code&gt;; nothing else will do!
So here&#39;s how you want to work directly on a &lt;code&gt;.deb&lt;/code&gt; package file :&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;get information about the package&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;dpkg -I pkg.deb
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;list files within the package&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;dpkg -c pkg.deb
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;extract files from the package&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;dpkg -x pkg.deb     # -X for verbose extract
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;install the package&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;dpkg -i somepkg.deb
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;For an already installed package :&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;get information about the package&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;dpkg -s pkg         # also lists files marked config files!
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;list files within the package&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;dpkg -L pkg
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;find out which installed pkg a file belongs to; note that no other command
does this, unless you install the optional &lt;code&gt;apt-file&lt;/code&gt; package&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;dpkg -S file        # dont need full path
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h3&gt;&lt;a name=&quot;Cheat_sheet&quot;&gt;Cheat sheet&lt;/a&gt;&lt;/h3&gt;

&lt;p&gt;The rest of this should be seen as a cheat sheet for using &lt;code&gt;aptitude&lt;/code&gt;
effectively.  The man page and the README tend to be much larger, and not very
optimised for a quick check of some feature.&lt;/p&gt;

&lt;h4&gt;&lt;a name=&quot;Search_patterns&quot;&gt;Search patterns&lt;/a&gt;&lt;/h4&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;The search patterns use regular expressions, whose meta-characters need
escaping, e.g., &lt;code&gt;g\+\+&lt;/code&gt;.  This again needs to be escaped from the
shell of course, so in practice it&#39;s usually either&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;aptitude search &#39;g\+\+&#39;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;or&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;aptitude search g\\+\\+
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;When you specify multiple patterns, they are processed separately and the
results combined.  This is not quite the same as OR-ing them; if a package
satisfies more than one search pattern, it &lt;em&gt;will appear multiple times&lt;/em&gt;
in the output.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;!&lt;/code&gt; negates; eg, &lt;code&gt;!~b&lt;/code&gt; means pkgs that are not broken&lt;/li&gt;
&lt;li&gt;&lt;code&gt;(grouping|alternation)&lt;/code&gt; are available&lt;/li&gt;
&lt;li&gt;&lt;p&gt;The following special patterns exist (see manual for more)&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;    ~b                  packages that are broken
    ~c                  packages that have been removed but their config
                        files are still present in the system
    ~i                  installed pkgs (~c packages do not appear here)
    ~M                  automatically installed packages
    ~N                  new packages
    ~U                  any installed pkg ready to be upgraded
    ~Aarchive           which archive? eg ~Atesting; from testing archive
    ~aaction            what action is pending? eg ~ainstall (or upgrade,
                        downgrade, remove, purge, hold, keep) -- action
                        must be actually queued up
    ~D(perl|python)     DEPENDS (ON); list of pkgs that depend on any pkg
                        whose name matches perl|python
    ~DBpattern          ...like above but only broken dependencies
    ~Rpattern           REVERSE DEPENDS; depended on; list of pkgs that
                        &amp;lt;pattern&amp;gt; depends on
    ~dword              look for &quot;word&quot; in description
    ~nname              eg ~n^lib
    ~Oorigin            eg &#39;!~Oubuntu ~i&#39; shows me libdvdcss2 and
                        w32codecs!!!
    ~Pprovides          PROVIDES; eg ~Pmail-transport-agent
    ~ppriority          this could be &quot;extra&quot;, &quot;optional&quot;, &quot;important&quot;,
                        &quot;required&quot; or &quot;standard&quot;
    ~ssection           eg &quot;~sgnome ~i&quot; -- what gnome stuff do I have
                        installed?
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h4&gt;&lt;a name=&quot;Search_output_formatting_in_aptitude&quot;&gt;Search output formatting in aptitude&lt;/a&gt;&lt;/h4&gt;

&lt;pre&gt;&lt;code&gt;The search output formatting uses the `-F` flag.  Some of the
important fields are listed below; check out the README for more fields as
well as information on how to adjust the width of each column etc.

    %a - action pending,        %c - current state
    %p - pkg name,              %d - description,
    %D - download size,         %I - install size
    %v - current version,       %V - candidate version
    %t - archive it came from (like feisty, feisty-security, etc).
&lt;/code&gt;&lt;/pre&gt;

&lt;h4&gt;&lt;a name=&quot;Sort_rules_on_output&quot;&gt;Sort rules on output&lt;/a&gt;&lt;/h4&gt;

&lt;pre&gt;&lt;code&gt;There are only 4 fields that can be sorted on

        installsize
        name
        priority
        version

You can sort on any combination.  For example,

        -O priority,~name

means sort by priority, and within that reverse sort by name
&lt;/code&gt;&lt;/pre&gt;
&lt;/html&gt;
</pre>
</div>
<div title="digital-blending" modifier="Sitaram" created="200903241920">
<pre>
&lt;html&gt;
&lt;h1&gt;Digital Blending&lt;/h1&gt;

&lt;p&gt;&lt;sup&gt;from &lt;a href=&quot;http://www.luminous-landscape.com/tutorials/digital-blending.shtml&quot;&gt;http://www.luminous-landscape.com/tutorials/digital-blending.shtml&lt;/a&gt;&lt;/sup&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;doesnt work very well&lt;/strong&gt; -- much better to use manual masking once you
realise what exactly this does&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;drop the darker one as a new layer on top of the lighter one&lt;/li&gt;
&lt;li&gt;right click the top layer (darker one) and add a layer mask, black&lt;/li&gt;
&lt;li&gt;left click the bottom layer, Ctrl-A, Ctrl-C&lt;/li&gt;
&lt;li&gt;right click on the layer mask, select both edit and show layer mask&lt;/li&gt;
&lt;li&gt;Ctrl-V, then anchor it.  You should see a B/W image in the mask&lt;/li&gt;
&lt;li&gt;with the B/W showing, Filter/Blur/Gaussian Blur, radius 40
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;OR&lt;/strong&gt; if the two pictures are EXACTly the same in
composition/focus/DOF, use colors/auto/equalise on the B/W mask&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;make sure &quot;disable layer mask&quot; is not set, both the layers are visible
(the &quot;eye&quot;)&lt;/li&gt;
&lt;/ul&gt;
&lt;/html&gt;
</pre>
</div>
<div title="kdiff3" modifier="Sitaram" created="200903241920">
<pre>
&lt;html&gt;
&lt;h1&gt;kdiff3&lt;/h1&gt;

&lt;p&gt;&lt;strong&gt;awesome&lt;/strong&gt;!&lt;/p&gt;

&lt;p&gt;but in dir mode, there may be some gotchas... like only files visible in tree
will make it to the output :-)  Anyway krusader is better for that.&lt;/p&gt;
&lt;/html&gt;
</pre>
</div>
<div title="socat" modifier="Sitaram" created="200906060050">
<pre>
&lt;html&gt;
&lt;h1&gt;&lt;a name=&quot;socat_netcat_on_steroids&quot;&gt;socat -- netcat on steroids&lt;/a&gt;&lt;/h1&gt;

&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#socat_netcat_on_steroids&quot;&gt;socat -- netcat on steroids&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#Quick_tips_and_options&quot;&gt;Quick tips and options&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#specific_HOWTOs&quot;&gt;specific HOWTOs&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#some_concepts_generics&quot;&gt;some concepts/generics&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#more_help_from_the_intertubes&quot;&gt;more help from the intertubes&lt;/a&gt;&lt;br&gt;&lt;/p&gt;

&lt;h3&gt;&lt;a name=&quot;Quick_tips_and_options&quot;&gt;Quick tips and options&lt;/a&gt;&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;always specify &lt;code&gt;,reuseaddr&lt;/code&gt; on any &lt;code&gt;LISTEN&lt;/code&gt; if you want to rerun the
command immediately&lt;/li&gt;
&lt;li&gt;use &lt;code&gt;fork&lt;/code&gt; to keep the program listening for more connections&lt;/li&gt;
&lt;li&gt;specify &lt;code&gt;,verify=0&lt;/code&gt; on any SSL stuff to avoid cert hassles
&lt;ul&gt;
&lt;li&gt;when you really need security, do what
&lt;a href=&quot;http://www.dest-unreach.org/socat/doc/socat-openssltunnel.html&quot;&gt;http://www.dest-unreach.org/socat/doc/socat-openssltunnel.html&lt;/a&gt; says
:-) It sets up the certificates on both sides properly.  [Not clear how
you set up multiple clients though]  It sets up the certificates on both
sides properly.  [Not clear how you set up multiple clients though]&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;other options&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;retry=10,intervall=5
forever,intervall=5
ignoreeof           # like tail -f
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h3&gt;&lt;a name=&quot;specific_HOWTOs&quot;&gt;specific HOWTOs&lt;/a&gt;&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;unwrap SSL to talk to port 995 as if it were 110&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;socat TCP4-LISTEN:1100,reuseaddr,fork OPENSSL:127.0.0.1:995,verify=0 &amp;amp;
nc 127.0.0.1 1100
USER ...
PASS ...
# etc
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;generic CONNECT wrapper for any protocol (in this case port 22, assuming
squid.conf allows CONNECT requests to port 22):&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;socat TCP4-LISTEN:2022,reuseaddr,fork \
PROXY:squid.server:home.server:22,proxyport=3128,proxyauth=user:pass
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;example ssh config/session, assuming squid allows CONNECT on port 22&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;$ tail -5 .ssh/config
host isp
    user sitaram
    hostname shell.isp.com
    port 22
    proxycommand socat - PROXY:squid.server.ip:%h:%p,proxyport=3128
$ ssh isp
sitaram@shell.isp.com&#39;s password:
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a href=&quot;http://www.dest-unreach.org/socat/doc/socat-openssltunnel.html&quot;&gt;http://www.dest-unreach.org/socat/doc/socat-openssltunnel.html&lt;/a&gt; is a good
HOWTO on setting up a single-shot ssl connection between 2 socats.
Briefly, it involves creating &lt;code&gt;.pem&lt;/code&gt; and &lt;code&gt;.crt&lt;/code&gt; files on server and
client, and exchanging the &lt;code&gt;.crt&lt;/code&gt; files with each other.  The &lt;code&gt;.pem&lt;/code&gt; files
are secret and must be protected.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;FILENAME=server     # or &quot;client&quot;
openssl genrsa -out $FILENAME.key 1024 
openssl req -new -key $FILENAME.key -x509 -days 3653 -out $FILENAME.crt 
cat $FILENAME.key $FILENAME.crt &amp;gt;$FILENAME.pem 
chmod 600 $FILENAME.key $FILENAME.pem 

# usage: server side
socat ssl-l:4433,reuseaddr,cert=server.pem,cafile=client.crt echo
# client side
socat stdio ssl:localhost:4433,cert=client.pem,cafile=server.crt
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h3&gt;&lt;a name=&quot;some_concepts_generics&quot;&gt;some concepts/generics&lt;/a&gt;&lt;/h3&gt;

&lt;p&gt;&lt;sup&gt;the following is from &lt;a href=&quot;http://www.linux.com/article.pl?sid=06/04/13/1515258&quot;&gt;http://www.linux.com/article.pl?sid=06/04/13/1515258&lt;/a&gt;&lt;/sup&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://www.dest-unreach.org/socat&quot;&gt;Socat&lt;/a&gt; has been described as &quot;netcat on
steroids.&quot; It can read from and write to files, pipes, and all kinds of
sockets. I use it mostly for port forwarding (TCP relay). For example, to
forward all incoming connections on port 1234 of my host to port 1234 of
destination.host:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;socat TCP4-LISTEN:1234,fork,reuseaddr TCP4:destination.host:1234
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;I also use it as a replacement for &lt;a href=&quot;http://stunnel.mirt.net&quot;&gt;Stunnel&lt;/a&gt; to
tunnel connections through SSL. This is, for example, how I sometimes make an
HTTP-only server support HTTPS in a pinch:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;socat OPENSSL-LISTEN:443,fork TCP4:localhost:80
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;sup&gt;the following is from &lt;a href=&quot;http://www.dest-unreach.org/socat/doc/linuxwochen2007-socat.pdf&quot;&gt;http://www.dest-unreach.org/socat/doc/linuxwochen2007-socat.pdf&lt;/a&gt;&lt;/sup&gt;&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;socat essentially takes two &quot;address&quot; specifications and bounces data
between them.  Common address types are:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;-                               # stdio
tcp4:host:port
tcp4-l:port                     # tcp4-l is short for tcp4-listen
exec:/bin/ls,pty                # run program in sub-process
ssl:https.server:443,verify=0   # ssl client
ssl-l:443,cert=./server.pem     # ssl server

# files, devices, named pipes, pty
fd:3                            # existing file descriptor
open:file.txt
open:/dev/tty
create:newfile
pipe:./named.pipe
pty,link=$HOME/dev/pty0

# UNIX domain stream client, server
unix-connect:/tmp/.X11-unix/X0
unix-listen:$HOME/dev/socket1,fork
# UNIX domain datagram sender, receiver
unix-sendto:/dev/log
unix-recv:/dev/log
unix-recvfrom:$HOME/dev/askmewhat,fork
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;really cool address types:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;readline,history=$HOME/.socat_history
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;too much trouble?&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;system:&#39;while read ...; \
    do ...; done&#39; \
    ,pipes
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;examples:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;# TCP server with direct script
socat tcp-l:7000,reuseaddr exec:&quot;/bin/cat&quot;,nofork

# VPN using tun/tap, server and client side commands
socat&Acirc;&nbsp;-d -d tcp-l:50500,reuseaddr&Acirc;&nbsp;TUN:192.168.10.2/24,up
socat&Acirc;&nbsp;tcp:50500&Acirc;&nbsp;TUN:192.168.10.3/24,up
# use SSL instead of TCP if needed
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;some of the examples are &lt;em&gt;awesome&lt;/em&gt;:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;slide 15: double-client in the office, double-server at home&lt;/li&gt;
&lt;li&gt;slide 31: broadcast and multicast&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h3&gt;&lt;a name=&quot;more_help_from_the_intertubes&quot;&gt;more help from the intertubes&lt;/a&gt;&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;http://www.dest-unreach.org/socat/doc/socat-tun.html&quot;&gt;http://www.dest-unreach.org/socat/doc/socat-tun.html&lt;/a&gt; helps you create a
simple tunnel using an actual TUN device, &lt;strong&gt;which socat creates&lt;/strong&gt;, on each
side.  Very cool!&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://www.dest-unreach.org/socat/doc/socat.html#EXAMPLES&quot;&gt;http://www.dest-unreach.org/socat/doc/socat.html#EXAMPLES&lt;/a&gt; is also a good
starting point.  The full man page causes, as one of my friends&#39; says,
&quot;cognitive overload&quot;.&lt;/li&gt;
&lt;li&gt;for a really cool trick search for &quot;end-close&quot; in the above EXAMPLES url!&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://www.dest-unreach.org/socat/doc/linuxwochen2007-socat.pdf&quot;&gt;http://www.dest-unreach.org/socat/doc/linuxwochen2007-socat.pdf&lt;/a&gt; has
&lt;em&gt;lots&lt;/em&gt; of great stuff&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://www.dest-unreach.org/socat/doc/socat-tun.html&quot;&gt;http://www.dest-unreach.org/socat/doc/socat-tun.html&lt;/a&gt; has more details on
the tun/tap stuff&lt;/li&gt;
&lt;/ul&gt;
&lt;/html&gt;
</pre>
</div>
<div title="mdv-setup" modifier="Sitaram" created="200903241920">
<pre>
&lt;html&gt;
&lt;h1&gt;MDV setup stuff&lt;/h1&gt;

&lt;ul&gt;
&lt;li&gt;vim /etc/*/tmpwatch and add &quot;-a -c&quot; as options for the tmpwatch commands&lt;/li&gt;
&lt;li&gt;add relatime to all ext3 mounts in fstab and remount&lt;/li&gt;
&lt;li&gt;add data=writeback for laptops and UPS protected machines&lt;/li&gt;
&lt;/ul&gt;
&lt;/html&gt;
</pre>
</div>
<div title="bash" modifier="Sitaram" created="200906060050">
<pre>
&lt;html&gt;
&lt;h1&gt;&lt;a name=&quot;notes_from_the_Advanced_Bash_Scripting_Guide&quot;&gt;notes from the Advanced Bash Scripting Guide&lt;/a&gt;&lt;/h1&gt;

&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#notes_from_the_Advanced_Bash_Scripting_Guide&quot;&gt;notes from the Advanced Bash Scripting Guide&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#Debugging_coolness&quot;&gt;Debugging coolness&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#From_the_advanced_bash_scripting_guide&quot;&gt;From the advanced bash scripting guide&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#The_read_command&quot;&gt;The &lt;code&gt;read&lt;/code&gt; command&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#Incrementing_a_number&quot;&gt;Incrementing a number&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#Shell_variable_command_output&quot;&gt;Shell variable &amp;lt;= command output&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#I_O_to_from_a_shell_block&quot;&gt;I/O to/from a shell block&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#Sequences&quot;&gt;Sequences&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#Combining_stderr_into_stdout&quot;&gt;Combining stderr into stdout&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#Here_string&quot;&gt;Here string&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#Tests_and_matches&quot;&gt;Tests and matches&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#Batch_use_only&quot;&gt;Batch use only&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#History_viewing&quot;&gt;History viewing&lt;/a&gt;&lt;br&gt;&lt;/p&gt;

&lt;hr /&gt;

&lt;h3&gt;&lt;a name=&quot;Debugging_coolness&quot;&gt;Debugging coolness&lt;/a&gt;&lt;/h3&gt;

&lt;pre&gt;&lt;code&gt;export PS4=&#39;:$0.$LINENO:&#39;
# now use &quot;-x&quot;
&lt;/code&gt;&lt;/pre&gt;

&lt;h3&gt;&lt;a name=&quot;From_the_advanced_bash_scripting_guide&quot;&gt;From the advanced bash scripting guide&lt;/a&gt;&lt;/h3&gt;

&lt;p&gt;&lt;sup&gt;source: &lt;a href=&quot;http://www.tldp.org/LDP/abs/abs-guide.pdf&quot;&gt;http://www.tldp.org/LDP/abs/abs-guide.pdf&lt;/a&gt;&lt;/sup&gt;&lt;/p&gt;

&lt;h4&gt;&lt;a name=&quot;The_read_command&quot;&gt;The &lt;code&gt;read&lt;/code&gt; command&lt;/a&gt;&lt;/h4&gt;

&lt;p&gt;if reading from a terminal:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;read -t timeout     # for terminal OR pipe
read -s             # silent (no echo) for passwords
read -p prompt      # no trailing newline after prompt; nice!
read -e             # use readline
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;others:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;read -n nchars      # return after nchars read
&lt;/code&gt;&lt;/pre&gt;

&lt;h4&gt;&lt;a name=&quot;Incrementing_a_number&quot;&gt;Incrementing a number&lt;/a&gt;&lt;/h4&gt;

&lt;pre&gt;&lt;code&gt;(( n++ ))
(( n = n + 1 ))     # more general form
&lt;/code&gt;&lt;/pre&gt;

&lt;h4&gt;&lt;a name=&quot;Shell_variable_command_output&quot;&gt;Shell variable &amp;lt;= command output&lt;/a&gt;&lt;/h4&gt;

&lt;p&gt;Really old way:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;ls|wc -l|while read ans; do ...; done
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;A better way:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;read ans &amp;lt; &amp;lt;(ls|wc -l)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;A way to get multi-line output into a single variable&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;read ans &amp;lt;&amp;lt;&amp;lt;$(ls -al)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Best way:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;ans=`ls|wc -l`
&lt;/code&gt;&lt;/pre&gt;

&lt;h4&gt;&lt;a name=&quot;I_O_to_from_a_shell_block&quot;&gt;I/O to/from a shell block&lt;/a&gt;&lt;/h4&gt;

&lt;p&gt;good for a lot of cases where I was doing a &lt;code&gt;while..do...done&lt;/code&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;{ block } &amp;lt; file
{ block } &amp;gt; file
&lt;/code&gt;&lt;/pre&gt;

&lt;h4&gt;&lt;a name=&quot;Sequences&quot;&gt;Sequences&lt;/a&gt;&lt;/h4&gt;

&lt;p&gt;&lt;code&gt;{a..e&lt;/code&gt;}, just like the &lt;code&gt;seq&lt;/code&gt; command except you&#39;re not restricted to
integers.  However, you cannot replicate &lt;code&gt;seq&lt;/code&gt;&#39;s &lt;code&gt;-w&lt;/code&gt; option.&lt;/p&gt;

&lt;h4&gt;&lt;a name=&quot;Combining_stderr_into_stdout&quot;&gt;Combining stderr into stdout&lt;/a&gt;&lt;/h4&gt;

&lt;p&gt;My old way:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;&amp;gt;filename 2&amp;gt;&amp;amp;1!
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;A better way; but can&#39;t be used to pipe to a pager, for example :-(&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;&amp;amp;&amp;gt; filename
&lt;/code&gt;&lt;/pre&gt;

&lt;h4&gt;&lt;a name=&quot;Here_string&quot;&gt;Here string&lt;/a&gt;&lt;/h4&gt;

&lt;p&gt;the &quot;here-string&quot; has all sorts of nifty uses&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;&amp;lt;&amp;lt;&amp;lt; $var
&lt;/code&gt;&lt;/pre&gt;

&lt;hr /&gt;

&lt;h3&gt;&lt;a name=&quot;Tests_and_matches&quot;&gt;Tests and matches&lt;/a&gt;&lt;/h3&gt;

&lt;pre&gt;&lt;code&gt;[[ ... ]]
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;use this instead of [ ... ] in most places.
&amp;amp;&amp;amp;, ||, &amp;lt;, and &gt; work within ~[[ ... ]], but not within [ ... ]&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;[[ ... == ... ]]
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;when you don&#39;t use quotes around the parameters, this does a glob-pattern match&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;[[ ... =~ ... ]]
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;this does a regex match, almost like perl&lt;/p&gt;

&lt;p&gt;Also, you can safely use &lt;code&gt;$VAR&lt;/code&gt; instead of &lt;code&gt;&quot;$VAR&quot;&lt;/code&gt; -- even if it&#39;s value
contains spaces.&lt;/p&gt;

&lt;hr /&gt;

&lt;h3&gt;&lt;a name=&quot;Batch_use_only&quot;&gt;Batch use only&lt;/a&gt;&lt;/h3&gt;

&lt;p&gt;Use of the &lt;strong&gt;null command (&lt;code&gt;:&lt;/code&gt;)&lt;/strong&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;# placeholder in conditional assignments
: ${username=`whoami`}

# evaluate string of variables and abort if not set
: ${HOSTNAME?} ${USER?} ${MAIL?}
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Indirect variable reference -- use the &quot;&lt;code&gt;!&lt;/code&gt;&quot; character&lt;/p&gt;

&lt;hr /&gt;

&lt;h3&gt;&lt;a name=&quot;History_viewing&quot;&gt;History viewing&lt;/a&gt;&lt;/h3&gt;

&lt;pre&gt;&lt;code&gt;set HISTTIMEFORMAT=&quot;%F %T &quot;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Works ok if you put it in /etc/profile.d/history.sh.  This is &lt;strong&gt;not&lt;/strong&gt; a
security feature -- it&#39;s only a sanity feature :-)&lt;/p&gt;
&lt;/html&gt;
</pre>
</div>
<div title="fix-nostalgy" modifier="Sitaram" created="200906221921">
<pre>
&lt;html&gt;
&lt;h1&gt;nostalgy hack&lt;/h1&gt;

&lt;h3&gt;How to make nostalgy clear the search box on a single escape&lt;/h3&gt;

&lt;p&gt;find a line saying&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;Search(&quot;&quot;);
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;it may be in a code block that looks like&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;if (ev.keyCode == KeyEvent.DOM_VK_ESCAPE &amp;amp;&amp;amp; nostalgy_search_focused) {
  // -- sita -- Search(&quot;&quot;); 
  setTimeout(SetFocusThreadPane,0);
  NostalgyStopEvent(ev);
  return;
}
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;just comment out the offending line as above&lt;/p&gt;
&lt;/html&gt;
</pre>
</div>
<div title="posix-shell" modifier="Sitaram" created="201007101556">
<pre>
&lt;html&gt;
&lt;h1&gt;posix shell -- quick notes&lt;/h1&gt;

&lt;p&gt;from https://wiki.ubuntu.com/DashAsBinSh&lt;/p&gt;

&lt;p&gt;All in &lt;code&gt;code&lt;/code&gt; for quick typing&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;[[ ]] does not work; use [ ] instead

use a separate [ ] for each test if you have a composite; use &amp;amp;&amp;amp; and || to
connect them.  Use ordinary parens for grouping.

-z and -n need &quot;&quot; around the operand.  In general, use &quot;&quot; anyway, unless
you&#39;re sure or don&#39;t care about spaces or metas in the argument.

== does not work; use =

=~ does not work; use grep (including a pipe and a redirection!)

(( arith )) does not work; use $(( arith )) instead (see URL above for
examples)

${foo#bar} is ok, as is ##, %, and %%.  All other forms are not OK
(pattern matching, substringing)

$RANDOM may not work

ulimit may not work

let, declare, typeset, do not work

read can only do a plain read (no fancy options) and must specify a
variable (this means there is no real way to do &quot;read -s&quot;)

echo only supports &quot;-n&quot;; use printf for anything fancier
&lt;/code&gt;&lt;/pre&gt;
&lt;/html&gt;
</pre>
</div>
<div title="tcpdump" modifier="Sitaram" created="200903241920">
<pre>
&lt;html&gt;
&lt;h1&gt;tcpdump&lt;/h1&gt;

&lt;h3&gt;Examples&lt;/h3&gt;

&lt;pre&gt;&lt;code&gt;tcpdump not port 22
tcpdump -n -i eth1 -w file.cap -s 0 not port 22
tcpdump -r file.cap
tcpdump -n dst port 80  # direction and port
tcpdump -n portrange 20-23
tcpdump src host xyz.com
tcpdump src next 172.25.148.0/23
&lt;/code&gt;&lt;/pre&gt;
&lt;/html&gt;
</pre>
</div>
<div title="aria2" modifier="Sitaram" created="200903241920">
<pre>
&lt;html&gt;
&lt;h1&gt;aria2&lt;/h1&gt;

&lt;h3&gt;quick start&lt;/h3&gt;

&lt;h4&gt;pros&lt;/h4&gt;

&lt;ul&gt;
&lt;li&gt;metalink!&lt;/li&gt;
&lt;li&gt;poor man&#39;s metalink with a list of mirror URLs&lt;/li&gt;
&lt;li&gt;can also do lists and sequences like curl&lt;/li&gt;
&lt;/ul&gt;

&lt;h4&gt;cons&lt;/h4&gt;

&lt;ul&gt;
&lt;li&gt;does segmented downloads (hammers server) &lt;strong&gt;by default&lt;/strong&gt; -- use &lt;code&gt;-s1&lt;/code&gt;
to prevent this&lt;/li&gt;
&lt;li&gt;the precise rules for -j and -s are not clear.  In particular, there seems
to be an off-by-one error somewhere or something.&lt;/li&gt;
&lt;/ul&gt;

&lt;h3&gt;details&lt;/h3&gt;

&lt;h4&gt;normal downloads&lt;/h4&gt;

&lt;ul&gt;
&lt;li&gt;&lt;code&gt;-Z&lt;/code&gt; &lt;strong&gt;REQUIRED&lt;/strong&gt; when multiple URLs refer to &lt;strong&gt;different&lt;/strong&gt; files&lt;/li&gt;
&lt;li&gt;&lt;code&gt;-c&lt;/code&gt; to resume something partly downloaded by another program&lt;/li&gt;
&lt;li&gt;&lt;code&gt;-j N&lt;/code&gt; number of parallel downloads overall, default 5, max 45&lt;/li&gt;
&lt;li&gt;&lt;code&gt;-s N&lt;/code&gt; connections per file, default 5, max 16&lt;/li&gt;
&lt;li&gt;&lt;code&gt;-P&lt;/code&gt; does the curl magic of lists and sequences
&lt;ul&gt;
&lt;li&gt;example &lt;code&gt;http://{sv1,sv2,sv3}.example.com/[01-20:4].jpg&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;don&#39;t forget the &lt;code&gt;-Z&lt;/code&gt;&lt;/strong&gt; if these are different files!&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h4&gt;metalink&lt;/h4&gt;

&lt;ul&gt;
&lt;li&gt;&lt;code&gt;-M metalinkfile&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;-C N&lt;/code&gt; number of servers to connect simultaneously, default 5&lt;/li&gt;
&lt;/ul&gt;

&lt;h4&gt;torrent&lt;/h4&gt;

&lt;ul&gt;
&lt;li&gt;&lt;code&gt;-T torrentfile&lt;/code&gt; &lt;/li&gt;
&lt;li&gt;&lt;code&gt;-S&lt;/code&gt; show files in torrent&lt;/li&gt;
&lt;li&gt;&lt;code&gt;--select-file=1,3,5-8&lt;/code&gt; download only selected files from torrent&lt;/li&gt;
&lt;li&gt;&lt;code&gt;--listen-port=8681,8685-8688&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;--max-upload-limit=20K&lt;/code&gt;, or use M for MB&lt;/li&gt;
&lt;li&gt;seeding ends when either of these is satisfied
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;--seed-time=MINUTES&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;--seed-ratio=0.5&lt;/code&gt; default 1.0&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/html&gt;
</pre>
</div>
<div title="backup-dirnames-with-spaces" modifier="Sitaram" created="200903241920">
<pre>
&lt;html&gt;
&lt;h1&gt;dar and rdiff-backup with spaces in directory names&lt;/h1&gt;

&lt;p&gt;dar and rdiff-backup with spaces in directory names&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;for rdiff-backup, the include/exclude file should look like:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;./donot
./DO NOT
** ./dodo
** ./DO\ DO

** **
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;and the command should look like:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;rdiff-backup --include-globbing-filelist inc-exc-list . /backup/location
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;(notice that the source directory, &quot;.&quot; in this case, is the start of all
the entries in the inc/exc list)&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;for dar it&#39;s like this:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;-g ./donot
-g &quot;./DO NOT&quot;
--prune ./dodo
--prune &quot;./DO\ DO&quot;
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;and the command looks like:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;dar -v -c junk -B aa
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/html&gt;
</pre>
</div>
<div title="krusader" modifier="Sitaram" created="200906221921">
<pre>
&lt;html&gt;
&lt;h1&gt;krusader&lt;/h1&gt;

&lt;p&gt;All in all, the synchronization is nowhere near unison (it doesn&#39;t keep
history), but is otherwise &lt;em&gt;pretty damn good&lt;/em&gt;, and quite interactive.  So
it&#39;s basically a GUI eqvt of mc, (but no %f and %t, alas!)&lt;/p&gt;

&lt;h4&gt;sanity customizations for a new install&lt;/h4&gt;

&lt;ul&gt;
&lt;li&gt;look-and-feel -&gt; operation -&gt; rename selects extension (off)&lt;/li&gt;
&lt;li&gt;look-and-feel -&gt; operation -&gt; fullscreen terminal (on)&lt;/li&gt;
&lt;li&gt;look-and-feel -&gt; panel toolbar (off)&lt;/li&gt;
&lt;li&gt;look-and-feel -&gt; selection mode -&gt; konqueror mode&lt;/li&gt;
&lt;li&gt;general -&gt; move to trash (not &quot;delete&quot;)&lt;/li&gt;
&lt;li&gt;advanced -&gt; confirmation -&gt; unselect for del/copy/move files&lt;/li&gt;
&lt;li&gt;assign alt-left-arrow to Go-&gt;Back&lt;/li&gt;
&lt;/ul&gt;

&lt;h4&gt;plus points and nice features&lt;/h4&gt;

&lt;ul&gt;
&lt;li&gt;sync -- see section below&lt;/li&gt;
&lt;li&gt;view-&gt;custom &lt;strong&gt;restricts view&lt;/strong&gt; to space-sep list of globs, view-&gt;allfiles
resets&lt;/li&gt;
&lt;li&gt;du -s &lt;strong&gt;plain&lt;/strong&gt;: edit-&gt;calculate occupied space&lt;/li&gt;
&lt;li&gt;du -s &lt;strong&gt;fancy&lt;/strong&gt;: tools-&gt;disk usage -- filelight on steroids!
&lt;ul&gt;
&lt;li&gt;lots of nifty features, explore by right-click, esp. excluding stuff!&lt;/li&gt;
&lt;li&gt;caveat: &quot;step into&quot; is really just &quot;enter&quot; and shift-Down doesn&#39;t work!&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h4&gt;hard to remember but useful controls&lt;/h4&gt;

&lt;ul&gt;
&lt;li&gt;folder &lt;strong&gt;open in new tab&lt;/strong&gt;: alt-ctrl-Enter&lt;/li&gt;
&lt;li&gt;new &lt;strong&gt;net&lt;/strong&gt; connection: ctrl-N&lt;/li&gt;
&lt;li&gt;new &lt;strong&gt;tab&lt;/strong&gt;: alt-ctrl-N, switch tabs: shift-Right/Left&lt;/li&gt;
&lt;li&gt;goto &lt;strong&gt;location bar&lt;/strong&gt;: ctrl-L&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;popular URLs&lt;/strong&gt;: ctrl-Z&lt;/li&gt;
&lt;li&gt;toggle &lt;strong&gt;popup panel&lt;/strong&gt;: alt-Down&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;jump&lt;/strong&gt; between command line and window: ctrl-Up/Down&lt;/li&gt;
&lt;li&gt;edit file &lt;strong&gt;as root&lt;/strong&gt;: Ctrl-E&lt;/li&gt;
&lt;/ul&gt;

&lt;h4&gt;note&lt;/h4&gt;

&lt;ul&gt;
&lt;li&gt;ctrl-Right and ctrl-Left can be very confusing and therefore dangerous:
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;but they cannot be disabled!!&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h4&gt;synchronization&lt;/h4&gt;

&lt;ul&gt;
&lt;li&gt;&quot;compare by content&quot; is slow but useful when sizes and dates are not
enough to decide&lt;/li&gt;
&lt;li&gt;local dirs: paranoid setting: use &quot;ignore date&quot; and &quot;compare by content&quot;
if you can afford the time&lt;/li&gt;
&lt;li&gt;remote dirs: &quot;compare by content&quot; has no rsync-like smarts -- TOO SLOW.
So either
&lt;ul&gt;
&lt;li&gt;the dates should be reliable, OR&lt;/li&gt;
&lt;li&gt;&quot;ignore date&quot; and risk missing file changes that left file size
unchanged&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;only the stuff that is visible in list gets synced, so you can compare
then weed the list to your hearts content before hitting the sync button&lt;/li&gt;
&lt;li&gt;has its own profile settings, over and above the main krusader&lt;/li&gt;
&lt;li&gt;file filter is great: example &lt;code&gt;*.good1 *.good2 | junk*&lt;/code&gt; -- the stuff
after the vertical bar is a negation&lt;/li&gt;
&lt;li&gt;the sync list can be quick-searched by typing in the filename fast...&lt;/li&gt;
&lt;li&gt;other notes
&lt;ul&gt;
&lt;li&gt;read the label &quot;duplicates&quot; as &quot;doubles&quot; (i.e., opposite of &quot;singles&quot;)&lt;/li&gt;
&lt;li&gt;&quot;not equals&quot; button is N/A unless you check &quot;ignore date&quot;&lt;/li&gt;
&lt;li&gt;&quot;deletable&quot; button is N/A unless you check &quot;asymmetric&quot; &lt;em&gt;*&lt;/em&gt; CAREFUL!
left panel is the target, not the source (think &lt;code&gt;krusader --left
olddir --right newdir&lt;/code&gt;)&lt;/li&gt;
&lt;li&gt;&quot;swap sides&quot; button is useful to make sure the right side is a local
file, so that you can do a merge using kdiff3 and have the results
saved (remember that kdiff3 will only save to the last file in the list
if no explicit &quot;-o&quot; option is given)&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;strong&gt;caveats&lt;/strong&gt;&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;(doc says you can sync only a part of the listed tree after comparison
is done, but doesnt work)&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;untested, esp the last one (but doc says kru doesn&#39;t support ftp via http
proxy anyway)&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;&amp;lt;ftp://public.ftpserver.org/directory/&amp;gt;
fish://username@hostname/
sftp://username:password@sftp.foo.org/
&amp;lt;ftp://username@my.server.org:21/directory/&amp;gt;
smb://username:password@server/share
&amp;lt;ftp://username@proxyusername:password@proxipassword@hostname/directory&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h4&gt;crap features&lt;/h4&gt;

&lt;ul&gt;
&lt;li&gt;the following features are crap when used outside of the sync dialog (ie,
in the main krusader)
&lt;ul&gt;
&lt;li&gt;compare by content -- no match for MC&#39;s F9-c-c-t&lt;/li&gt;
&lt;li&gt;compare directories -- only does by name/date, not content&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/html&gt;
</pre>
</div>
<div title="mount" modifier="Sitaram" created="200903241920">
<pre>
&lt;html&gt;
&lt;h1&gt;mount command&lt;/h1&gt;

&lt;h2&gt;common usages&lt;/h2&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;mounting samba as a guest&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;mount -o uid=501 *172.19.58.2/scratch-pad /scratch-pad
mount.cifs *1.2.3.4/smb-share /home/sitaramc/spad -o rw,nosetuids,noperm
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;encrypted file system using cryptoloop (pre-encfs method) (&lt;strong&gt;OBSOLETE --
use EncFS now&lt;/strong&gt;)&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;modprobe aes
modprobe cryptoloop
losetup -e AES256 /dev/loop5 /dev/hda5
file -s /dev/loop5
fsck /dev/loop5
mount /dev/loop5 /enc
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h2&gt;mount options for security&lt;/h2&gt;

&lt;p&gt;These would be useful in eliminating local privilege escalation for ISP type
systems; set these on /home, /tmp, and /var, don&#39;t let them write access
anywhere else, and you&#39;re done&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;noexec: do not allow executables&lt;/li&gt;
&lt;li&gt;nosuid: do not allow suid executable&lt;/li&gt;
&lt;li&gt;nodev: do not allow devices&lt;/li&gt;
&lt;/ul&gt;
&lt;/html&gt;
</pre>
</div>
<div title="indoor-photography" modifier="Sitaram" created="200903241920">
<pre>
&lt;html&gt;
&lt;h1&gt;Indoor photography&lt;/h1&gt;

&lt;p&gt;Objective: to see people or subjects in the foreground and still see the
warmth of the room or any features or lights in the background.&lt;/p&gt;

&lt;p&gt;Settings for Indoor Photography&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;Manual mode&lt;/li&gt;
&lt;li&gt;Widest aperture&lt;/li&gt;
&lt;li&gt;Shutter 1/60 for wide angle, 1/120 for zoom
&lt;ul&gt;
&lt;li&gt;but avoid zoom if low light&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;External slave flashes are a good idea&lt;/li&gt;
&lt;li&gt;Take a few shots and see what they look like.&lt;/li&gt;
&lt;li&gt;If they are not bright enough try bumping up your ISO until happy&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;This style of photography will have great lighting on people in the foreground
and still have the impact of the room lighting and features in the shot. Just
a plain old photo with the flash will normally burn out people in the
foreground and black out the background. Give it a go! &lt;/p&gt;

&lt;p&gt;&lt;sup&gt;source: &lt;a href=&quot;http://digital-photography-school.com/blog/how-to-achieve-great-indoor-photography-results&quot;&gt;http://digital-photography-school.com/blog/how-to-achieve-great-indoor-photography-results&lt;/a&gt;&lt;/sup&gt;&lt;/p&gt;
&lt;/html&gt;
</pre>
</div>
<div title="ipv6" modifier="Sitaram" created="200903241920">
<pre>
&lt;html&gt;
&lt;h1&gt;IPv6 info&lt;/h1&gt;

&lt;p&gt;&lt;sup&gt;mostly from &lt;a href=&quot;http://www.ibiblio.org/pub/Linux/docs/HOWTO/other-formats/html_single/Linux+IPv6-HOWTO.html&quot;&gt;http://www.ibiblio.org/pub/Linux/docs/HOWTO/other-formats/html_single/Linux+IPv6-HOWTO.html&lt;/a&gt;&lt;/sup&gt;&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;code&gt;::1&lt;/code&gt; is like 127.0.0.1&lt;/li&gt;
&lt;li&gt;&lt;code&gt;::&lt;/code&gt; is like 0.0.0.0&lt;/li&gt;
&lt;li&gt;&lt;code&gt;::ffff:a.b.c.d/96&lt;/code&gt; (example ::ffff:1.2.3.4) is an &lt;strong&gt;IPv4-mapped IPv6
address&lt;/strong&gt; (for &quot;sockets created by an IPv6-enabled daemon, but only
binding to an IPv4 address&quot;)&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;::a.b.c.d/96&lt;/code&gt; is an &lt;strong&gt;IPv4-compatible IPv6 address&lt;/strong&gt;&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;not clear what is the difference&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Link local: never pass through a router&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;code&gt;fe[89ab]x:&lt;/code&gt; where x is normally &lt;code&gt;0&lt;/code&gt; but can be any hex char&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Site local: now deprecated, but like 10.0.0.0/8&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;code&gt;fe[cdef]x:&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Unique Local&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;code&gt;fdxx:&lt;/code&gt; or &lt;code&gt;fcxx:&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;next 40 bits are generated using a pseudo-random algorithm&lt;/li&gt;
&lt;li&gt;allows two formerly independent networks to join; unlikely that all 40
bits will match!&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Global &lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;code&gt;2xxx:&lt;/code&gt; or &lt;code&gt;3xxx:&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/html&gt;
</pre>
</div>
<div title="harddisk-mount-in-knoppix" modifier="Sitaram" created="200903241920">
<pre>
&lt;html&gt;
&lt;h1&gt;mounting a hard disk from within a knoppix boot&lt;/h1&gt;

&lt;p&gt;&lt;sup&gt;from &lt;a href=&quot;http://aplawrence.com/Linux/mount_bind.html&quot;&gt;http://aplawrence.com/Linux/mount_bind.html&lt;/a&gt;&lt;/sup&gt;&lt;/p&gt;

&lt;p&gt;You can use mount to bind directories when using a Knoppix cdrom to recover
from mucked up linux bootloaders or resetting root passwords and whatnot.&lt;/p&gt;

&lt;p&gt;Assuming that /dev/hda1 is your OS on your harddrive&#39;s main partition...&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;Boot up with knoppix.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;mount /mnt/hda1&lt;/code&gt;
&lt;ul&gt;
&lt;li&gt;(should set that up automatically, could be in /media though)&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;cd /mnt/hda1&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;mount -t proc proc ./proc&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;mount -t sysfs sys ./sys&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;mount -o bind /KNOPPIX/dev ./dev&lt;/code&gt;
&lt;ul&gt;
&lt;li&gt;(or is that /mnt/KNOPPIX/dev? I forget, been a while)&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;chroot ./ su -&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Or something similar to that. Should end up having full access to the hardware
from inside the chroot environment for setting up grub etc...&lt;/p&gt;
&lt;/html&gt;
</pre>
</div>
<div title="lftp" modifier="Sitaram" created="200903241920">
<pre>
&lt;html&gt;
&lt;h1&gt;lftp notes&lt;/h1&gt;

&lt;p&gt;&lt;strong&gt;AWESOME TOOL -- ftp+++, if you ask me!&lt;/strong&gt;&lt;/p&gt;

&lt;h3&gt;quick start&lt;/h3&gt;

&lt;h4&gt;pros&lt;/h4&gt;

&lt;ul&gt;
&lt;li&gt;interactive, including tab-completion; built-in help for all commands&lt;/li&gt;
&lt;li&gt;downloads can be grouped, bg-ed/fg-ed, run in parallel, queued and
NOHUPped, scheduled, or conditionally run
&lt;ul&gt;
&lt;li&gt;job control: at, jobs, kill, wait, &lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;mirror and reverse mirror&lt;/li&gt;
&lt;li&gt;lots of protocols, including fish (thought &lt;code&gt;mc&lt;/code&gt; is better for that)&lt;/li&gt;
&lt;li&gt;bookmarks! (hey it&#39;s interactive!)&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;lots&lt;/strong&gt; of standard Unix commands on remote that normal FTP clients don&#39;t
have
&lt;ul&gt;
&lt;li&gt;cat, more, zcat, zmore, chmod, find, mv&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;standard &lt;code&gt;/etc/lftp.conf&lt;/code&gt; has some nice stuff like &lt;code&gt;edit&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h4&gt;cons&lt;/h4&gt;

&lt;ul&gt;
&lt;li&gt;only good for straight URLs; browser emulation type stuff is better left
to curl&lt;/li&gt;
&lt;li&gt;simple fish type stuff is better with MC&lt;/li&gt;
&lt;/ul&gt;

&lt;h4&gt;tricks&lt;/h4&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;lftp can&#39;t do curl-like sequences and lists, but you can trick it using
it&#39;s own eval and source commands and my map command; see my .lftprc for a
lovely alias!  Briefly:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;# starts one job with all URLs in it
source -e echo queue get junk{1,2,3}; jobs
# starts many jobs with one URL each
source -e map \&quot;echo queue get\&quot; junk{1,2,3}; jobs
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;The order of the keywords &lt;code&gt;source&lt;/code&gt;, &lt;code&gt;echo&lt;/code&gt;, and &lt;code&gt;queue&lt;/code&gt; is
important.  And remember bash doesn&#39;t 0-pad numbers, so you can&#39;t easily
do {01..15} -- it ends up the same as {1..15}&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;want to start a download at 3am but don&#39;t want to use cron?  Put these in
a file and run it with &lt;code&gt;lftp -f&lt;/code&gt;.  Yes, you need that second command
in that list :-)&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;queue stop
queue queue stop
# sequence of lcd/cd/&quot;queue get&quot; commands
at 03:00 -- queue start &amp;amp;
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;don&#39;t forget to do something like this&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;set parallel 4          # affects non-interactive jobs, like scripts
set queue-parallel 4    # probably more useful
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h3&gt;details&lt;/h3&gt;

&lt;h4&gt;typical usage&lt;/h4&gt;

&lt;pre&gt;&lt;code&gt;lftp site
lftp -u user[,pass] site
lftp -d # for debug mode
lftp -e &quot;run these commands; stay connected&quot;
lftp -c &quot;run these commands; exit
lftp -p 12345 sftp://sitaram@1.2.3.4
&lt;/code&gt;&lt;/pre&gt;

&lt;h4&gt;multiple files and mirrors&lt;/h4&gt;

&lt;ul&gt;
&lt;li&gt;&lt;code&gt;get&lt;/code&gt; can specify multiple files, &lt;code&gt;mget&lt;/code&gt; for globs&lt;/li&gt;
&lt;li&gt;&lt;code&gt;-c&lt;/code&gt; is for resume/continue&lt;/li&gt;
&lt;li&gt;&lt;code&gt;-d&lt;/code&gt; in mget/mput uses full source name on dest instead of just
putting the file in current directory&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;pget [-n N]&lt;/code&gt; command to get a file in parallel (default 5)&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;pget also has &lt;code&gt;-c&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;built-in mirror or mirror -R (reverse mirror) commands&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;not as efficient as rsync of course :-)&lt;/li&gt;
&lt;li&gt;but can use parallel mode to xfr several files in parallel!&lt;/li&gt;
&lt;li&gt;needs &lt;code&gt;set list-options -a&lt;/code&gt; to get dot-files&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;mirror supports lots of options: try help.  Some stuff not in help but may
work:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;code&gt;--only-missing&lt;/code&gt;, &lt;code&gt;--only-existing&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;--no-symlinks&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;--older-than&lt;/code&gt; (like &lt;code&gt;--newer-than&lt;/code&gt;)
&lt;em&gt;*&lt;/em&gt; (timespec for this is a filename or like for the &quot;at&quot; command)&lt;/li&gt;
&lt;li&gt;&lt;code&gt;--parallel N&lt;/code&gt; (N parallel file xfrs)
&lt;em&gt;*&lt;/em&gt; the short form &lt;code&gt;-P&lt;/code&gt; doesn&#39;t seem to work&lt;/li&gt;
&lt;li&gt;&lt;code&gt;--loop&lt;/code&gt; (keep doing it until no changes found)&lt;/li&gt;
&lt;li&gt;&lt;code&gt;-a&lt;/code&gt; (archive mode; see man page)&lt;/li&gt;
&lt;li&gt;&lt;code&gt;-I&lt;/code&gt; and &lt;code&gt;-X&lt;/code&gt; (include/exclude glob patterns)&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;It also supports stuff relating to timestamps, modes, suid/sgid bits, etc.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h4&gt;job control&lt;/h4&gt;

&lt;p&gt;As close to integrating shell concepts into an ftp client as possible!!&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;code&gt;&amp;amp;&lt;/code&gt; for backgrounding&lt;/li&gt;
&lt;li&gt;&lt;code&gt;(...; ...)&lt;/code&gt; &amp;amp; for group backgrounding&lt;/li&gt;
&lt;li&gt;&lt;code&gt;^Z&lt;/code&gt; and &lt;code&gt;fg&lt;/code&gt; like in shell for moving jobs to/from bg&lt;/li&gt;
&lt;li&gt;&lt;code&gt;at&lt;/code&gt; command!&lt;/li&gt;
&lt;li&gt;&lt;code&gt;jobs&lt;/code&gt; command&lt;/li&gt;
&lt;li&gt;can nohup itself if needed&lt;/li&gt;
&lt;li&gt;pipe to any external command&lt;/li&gt;
&lt;li&gt;&lt;code&gt;&amp;amp;&amp;amp;&lt;/code&gt; and &lt;code&gt;||&lt;/code&gt; for conditional execution&lt;/li&gt;
&lt;li&gt;&lt;code&gt;kill&lt;/code&gt; too!&lt;/li&gt;
&lt;li&gt;&lt;code&gt;queue&lt;/code&gt; command to queue commands for same server; will remember
correct directory for different queued commands so don&#39;t queue up &#39;cd&#39; or
&#39;lcd&#39; commands&lt;/li&gt;
&lt;li&gt;&lt;code&gt;repeat&lt;/code&gt; looks cool when you need it&lt;/li&gt;
&lt;/ul&gt;

&lt;h5&gt;Examples&lt;/h5&gt;

&lt;pre&gt;&lt;code&gt;lftp&amp;gt; cat file | gzip &amp;gt; file.gz
lftp&amp;gt; get file &amp;amp;
lftp&amp;gt; (cd /path &amp;amp;&amp;amp; get file) &amp;amp;
&lt;/code&gt;&lt;/pre&gt;

&lt;h4&gt;Other features and notes&lt;/h4&gt;

&lt;ul&gt;
&lt;li&gt;&quot;hftp&quot; is what they call ftp over http proxy&lt;/li&gt;
&lt;li&gt;slots: rather like tabs in firefox? (use alt-0 through alt-9)&lt;/li&gt;
&lt;li&gt;&quot;debug 3&quot; if you want to see greeting messages&lt;/li&gt;
&lt;li&gt;lftp expects a DIRECTORY URL; use lftpget for file URLS&lt;/li&gt;
&lt;li&gt;&lt;p&gt;there&#39;s no &quot;lftpmget&quot;; use something like this for command line mget:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;`lftp -c &#39;open -e &quot;mget patt*&quot; ftp.site/dir/subdir&#39;`
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&quot;set list-options -a&quot; to mirror dot-files also&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&quot;ls -R&quot; is fine, but in the rare case you dont have it, use &quot;find&quot;&lt;/li&gt;
&lt;li&gt;put a bunch of commands in a script and use &quot;lftp -f script&quot;&lt;/li&gt;
&lt;li&gt;rate limiting for each connection or all together&lt;/li&gt;
&lt;li&gt;a HUGE number of variables -- see man page
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;set limit-rate downrate:uprate&lt;/code&gt; in Bps and &lt;code&gt;limit-total-rate&lt;/code&gt;
(all connections)&lt;/li&gt;
&lt;li&gt;also &lt;code&gt;limit-max&lt;/code&gt; and &lt;code&gt;limit-total-max&lt;/code&gt; limit accumulation of
unused limit (like squid delay pools recharging when quiet)&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/html&gt;
</pre>
</div>
<div title="quick-sharpening" modifier="Sitaram" created="200903241920">
<pre>
&lt;html&gt;
&lt;h1&gt;Quick photo sharpening tip&lt;/h1&gt;

&lt;ul&gt;
&lt;li&gt;When you are ready to sharpen your photo (sharpening should be your very
last step), flatten all layers.&lt;/li&gt;
&lt;li&gt;Duplicate the remaining layer.&lt;/li&gt;
&lt;li&gt;Sharpen the top layer to get the best result possible.&lt;/li&gt;
&lt;li&gt;Now grab the eraser and simply brush away any problem areas that have been
over-sharpened. The bottom, unsharpened layer will show through in those
spots. If your photo editor supports it, you can even erase those areas
with partial opacity to customize the amount of sharpening.&lt;/li&gt;
&lt;/ul&gt;
&lt;/html&gt;
</pre>
</div>
<div title="procstat" modifier="Sitaram" created="201110201912">
<pre>
&lt;html&gt;
&lt;h1&gt;&lt;a name=&quot;procps_psmisc_and_systat&quot;&gt;procps, psmisc, and systat&lt;/a&gt;&lt;/h1&gt;

&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#procps_psmisc_and_systat&quot;&gt;procps, psmisc, and systat&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#cheap_tricks&quot;&gt;cheap tricks&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#ps&quot;&gt;ps&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#free&quot;&gt;free&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#fuser&quot;&gt;fuser&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#the_w_command&quot;&gt;the &quot;w&quot; command&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#pwdx&quot;&gt;pwdx&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#pgrep_and_pkill&quot;&gt;pgrep and pkill&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#pstree&quot;&gt;pstree&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#the_real_masala_the_stat_commands&quot;&gt;the real masala -- the &quot;stat&quot; commands&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#terminology&quot;&gt;terminology&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#system_wide&quot;&gt;system-wide&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#pid_wise&quot;&gt;pid-wise&lt;/a&gt;&lt;br&gt;&lt;/p&gt;

&lt;hr /&gt;

&lt;h3&gt;&lt;a name=&quot;cheap_tricks&quot;&gt;cheap tricks&lt;/a&gt;&lt;/h3&gt;

&lt;h4&gt;&lt;a name=&quot;ps&quot;&gt;ps&lt;/a&gt;&lt;/h4&gt;

&lt;p&gt;We favour BSD style; less typing overall, more consistent, etc.&lt;/p&gt;

&lt;p&gt;What processes to select:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;ps U ff                 # by user
ps t 4                  # by tty, /dev/pts/4
ps t tty4               # by tty, /dev/tty4
ps pid1 pid2            # by pid
ps -C command           # by command name
    # for partial command name, use &quot;pgrep comm | xargs ps&quot;
ps ax                   # abso-bloody-lutely all
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;What info to print for selected processes&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;# 3 mutually exclusive formats:
ps l                    # long format (much better than &quot;j&quot;ob control format)
ps u                    # user format
ps v                    # VM format

ps e                    # show ENV after command
ps f                    # ascii art forest
ps w                    # wide output; use twice for unlimited width
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;what do the codes mean?&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;D   Deep sleep (uninterruptible; usually IO)
R   Running or Runnable
S   Sleep
T   sTopped or Traced
Z   Zombie

L   Locked some pages into memory
N   Nice
&amp;lt;   not nice

+   is in the foreground process group
l   is multi-threaded
s   session leader
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;custom format spec&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;o lstart                # gives you a long start time
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ps fo pid,ppid,tty,start,etime,time,ni,%cpu,%mem,rss:8,vsz:8,rtprio,user,group,f,stat,psr=CPU#,wchan,args&lt;/p&gt;

&lt;h4&gt;&lt;a name=&quot;free&quot;&gt;free&lt;/a&gt;&lt;/h4&gt;

&lt;pre&gt;&lt;code&gt;free -s 5   # can poll
&lt;/code&gt;&lt;/pre&gt;

&lt;h4&gt;&lt;a name=&quot;fuser&quot;&gt;fuser&lt;/a&gt;&lt;/h4&gt;

&lt;pre&gt;&lt;code&gt;fuser -m /mount/point   # any file on the mounted device
fuser -k some.file      # kill
fuser -n tcp 22
fuser 22/tcp
# other options: -u for username, -v for verbose
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;code&gt;fuser -h&lt;/code&gt; is brief but complete enough.  The only thing missing is that
&lt;code&gt;fuser 22/tcp&lt;/code&gt; is short for &lt;code&gt;fuser -n tcp 22&lt;/code&gt;.&lt;/p&gt;

&lt;h4&gt;&lt;a name=&quot;the_w_command&quot;&gt;the &quot;w&quot; command&lt;/a&gt;&lt;/h4&gt;

&lt;pre&gt;&lt;code&gt;...has a `-f` option to show where the user came from, unless it is
already shown by default, in which case it toggles (what a pain for
scripting!)
&lt;/code&gt;&lt;/pre&gt;

&lt;h4&gt;&lt;a name=&quot;pwdx&quot;&gt;pwdx&lt;/a&gt;&lt;/h4&gt;

&lt;pre&gt;&lt;code&gt;This is an **awesome** command that tells you the pwd for a PID or list of
PIDs.  Yes you can get the same using `lsof -p PID` and grepping for
&#39;cwd&#39; but this is so much easier :-)
&lt;/code&gt;&lt;/pre&gt;

&lt;h4&gt;&lt;a name=&quot;pgrep_and_pkill&quot;&gt;pgrep and pkill&lt;/a&gt;&lt;/h4&gt;

&lt;p&gt;normally, matches the command name or part of it and prints just the pid&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&quot;-f&quot; says the whole command line is used to find a match&lt;/li&gt;
&lt;li&gt;&quot;-x&quot; exact matches only (no partial matches)&lt;/li&gt;
&lt;li&gt;&quot;-l&quot; will print the command name (or command line if &quot;-f&quot;)&lt;/li&gt;
&lt;li&gt;&quot;-u user&quot; to limit to that user&lt;/li&gt;
&lt;li&gt;&quot;-v&quot; to negate the matching&lt;/li&gt;
&lt;li&gt;&quot;-n&quot; or &quot;-o&quot; to select newest or oldest among matched proceses&lt;/li&gt;
&lt;/ul&gt;

&lt;h4&gt;&lt;a name=&quot;pstree&quot;&gt;pstree&lt;/a&gt;&lt;/h4&gt;

&lt;ul&gt;
&lt;li&gt;&lt;code&gt;pstree --haulp&lt;/code&gt; is the most comprehensive one&lt;/li&gt;
&lt;li&gt;&lt;code&gt;pstree --haulpG|less -r&lt;/code&gt; retains the ANSI line drawing stuff&lt;/li&gt;
&lt;/ul&gt;

&lt;h3&gt;&lt;a name=&quot;the_real_masala_the_stat_commands&quot;&gt;the real masala -- the &quot;stat&quot; commands&lt;/a&gt;&lt;/h3&gt;

&lt;h4&gt;&lt;a name=&quot;terminology&quot;&gt;terminology&lt;/a&gt;&lt;/h4&gt;

&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;iowait&lt;/strong&gt; usually means you&#39;re IO-bound, though on a desktop it could
mean you&#39;re not multitasking at all&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;steal&lt;/strong&gt; happens on VMs only; (need to look at it more later)&lt;/li&gt;
&lt;/ul&gt;

&lt;h4&gt;&lt;a name=&quot;system_wide&quot;&gt;system-wide&lt;/a&gt;&lt;/h4&gt;

&lt;h5&gt;iostat&lt;/h5&gt;

&lt;ul&gt;
&lt;li&gt;best general purpose tool in this category&lt;/li&gt;
&lt;li&gt;&lt;code&gt;-m -p -x&lt;/code&gt; is best option combo&lt;/li&gt;
&lt;li&gt;&lt;code&gt;-x&lt;/code&gt; gives you a lot more detail on disk activity
&lt;ul&gt;
&lt;li&gt;rrqm/s (wrqm/s) are read (write) requests merges per second&lt;/li&gt;
&lt;li&gt;r/s and w/s are the number of requests that actually went to the disk&lt;/li&gt;
&lt;li&gt;(not sure what &quot;number of requests actually received&quot; is; most likely
sum of these two)&lt;/li&gt;
&lt;li&gt;avgrq-sz is in sectors&lt;/li&gt;
&lt;li&gt;await and svctm are averages, in milliseconds, and await is svctm +
time in queue&lt;/li&gt;
&lt;li&gt;if await - svctm &gt; a few milliseconds, and utilisation is nowhere near
100%, it could be because of bursty, simultaneous, requests and a
longish interval.  A long, quiet, period within the measurement
interval reduces the utilisation % but doesn&#39;t affect the await
figures.  This basically means your application is too bursty and might
benefit from some internal optimisation (like readahead)&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h5&gt;mpstat&lt;/h5&gt;

&lt;ul&gt;
&lt;li&gt;better than &lt;code&gt;iostat -c&lt;/code&gt; only if
&lt;ul&gt;
&lt;li&gt;you need per-cpu reports (&lt;code&gt;mpstat -P ALL&lt;/code&gt;)&lt;/li&gt;
&lt;li&gt;or you need %irq, %soft(irq), and intr/s&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h5&gt;vmstat&lt;/h5&gt;

&lt;ul&gt;
&lt;li&gt;&lt;code&gt;-d&lt;/code&gt; is bad; use iostat for IO stats instead&lt;/li&gt;
&lt;li&gt;default mode shows you
&lt;ul&gt;
&lt;li&gt;# procs waiting to run, and # blocked&lt;/li&gt;
&lt;li&gt;the usual memory stuff&lt;/li&gt;
&lt;li&gt;swapin, swap out /s&lt;/li&gt;
&lt;li&gt;blocks in, out /s&lt;/li&gt;
&lt;li&gt;interrupts, context switches /s&lt;/li&gt;
&lt;li&gt;the usual CPU stuff&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;-a&lt;/code&gt; gets you something called &quot;active/inactive&quot; memory (???)
&lt;ul&gt;
&lt;li&gt;from &lt;a href=&quot;http://www.linuxplanet.com/linuxplanet/tutorials/6593/1/&quot;&gt;http://www.linuxplanet.com/linuxplanet/tutorials/6593/1/&lt;/a&gt; it seems
that active pages are in-use, and inactive pages can be dirty or clean;
a clean inactive page is ready for re-use if needed&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h4&gt;&lt;a name=&quot;pid_wise&quot;&gt;pid-wise&lt;/a&gt;&lt;/h4&gt;

&lt;h5&gt;pidstat&lt;/h5&gt;

&lt;ul&gt;
&lt;li&gt;never knew of this one in the old days :-)&lt;/li&gt;
&lt;li&gt;gets you all the info you need for a specific PID (&lt;code&gt;-p PID&lt;/code&gt; or &lt;code&gt;-C
part.of.cmdname&lt;/code&gt;) as opposed to the whole system; could be very useful&lt;/li&gt;
&lt;li&gt;the output format sucks if you combine options&lt;/li&gt;
&lt;li&gt;&lt;code&gt;-u&lt;/code&gt; user/system/total&lt;/li&gt;
&lt;li&gt;&lt;code&gt;-d&lt;/code&gt; IO reads/writes in KB/s&lt;/li&gt;
&lt;li&gt;&lt;code&gt;-r&lt;/code&gt; minor/major page faults, total/resident sizes&lt;/li&gt;
&lt;li&gt;&lt;code&gt;-w&lt;/code&gt; voluntary and involuntary context switches&lt;/li&gt;
&lt;/ul&gt;
&lt;/html&gt;
</pre>
</div>
<div title="firefox-tips" modifier="Sitaram" created="200903241920">
<pre>
&lt;html&gt;
&lt;h1&gt;Firefox - Tips &amp;amp; Tricks&lt;/h1&gt;

&lt;p&gt;&lt;sup&gt;from &lt;a href=&quot;http://www.supernova00.biz/userchrome.html&quot;&gt;http://www.supernova00.biz/userchrome.html&lt;/a&gt;&lt;/sup&gt;&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;userChrome tips: edit &lt;code&gt;userChrome.css&lt;/code&gt; inside
&lt;code&gt;.mozilla/firefox/j373sz6c.default/chrome/&lt;/code&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;/* Add a keyword when adding a bookmark */
#keywordRow { display: -moz-grid-line !important; }

/* Remove Stop button when there&#39;s nothing to Stop */
#stop-button[disabled=&quot;true&quot;] { display: none; }

/* Remove Back button when there&#39;s nothing to go Back to */
#back-button[disabled=&quot;true&quot;] { display: none; }

/* Remove Forward button when there&#39;s nothing to go Forward to */
#forward-button[disabled=&quot;true&quot;] { display: none; }

/* Make the active tab not bold */
tab[selected=&quot;true&quot;] { font-weight: normal !important; }

/* Make inactive tabs hardly visible */
#content tab:not([selected=&quot;true&quot;]) { -moz-opacity: 0.5 !important; }
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;sup&gt;[from a post on the TW list...]&lt;/sup&gt;&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;reduce working memory when browser is minimized
&lt;ul&gt;
&lt;li&gt;add new boolean &lt;code&gt;config.trim_on_minimize&lt;/code&gt; value &lt;code&gt;true&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;apart from reducing memory usage on minimise, it also seems that after
you restore the browser window, it appears to use significantly less
memory than before (though more than when minimized), plus &lt;strong&gt;run a bit
quicker after a minimize/restore&lt;/strong&gt;, especially if it has been running
all day with an actively edited TW document.&lt;/li&gt;
&lt;li&gt;maybe because of some &lt;em&gt;global&lt;/em&gt; garbage collection process that runs when
minimised?&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;#FindToolbar &amp;gt; * {display: -moz-box; }&lt;/code&gt;
&lt;ul&gt;
&lt;li&gt;makes &lt;code&gt;/&lt;/code&gt; or &lt;code&gt;&#39;&lt;/code&gt; eqvt to &lt;code&gt;Ctrl-F&lt;/code&gt; in terms of what comes up on screen&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/html&gt;
</pre>
</div>
<div title="gzip-bzip2-lzma" modifier="Sitaram" created="200903241920">
<pre>
&lt;html&gt;
&lt;h1&gt;Choosing between the gzip, bzip2, and lzma compression programs&lt;/h1&gt;

&lt;p&gt;LZMA is the new kid on the block: less space and faster decompression (than
BZIP2) at the cost of much, &lt;strong&gt;much&lt;/strong&gt; slower compressions.&lt;/p&gt;

&lt;p&gt;(Default compression levels are GZIP: 6, BZIP2: 9, and LZMA: 7)&lt;/p&gt;

&lt;h3&gt;Summary&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;Use none when&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;almost all files in the dataset are already compressed (DUH!)&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Use GZIP when&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;time is more important than space, or&lt;/li&gt;
&lt;li&gt;system memory is very limited, or&lt;/li&gt;
&lt;li&gt;a lot of files in the dataset are already compressed but nowhere near
all of them&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Use LZMA when&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;space is more important than time, or&lt;/li&gt;
&lt;li&gt;space is important AND the file will be decompressed many times&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Benchmark BZIP2, LZMA-1 and perhaps LZMA-2 when&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;both space AND (compression) time are important, and&lt;/li&gt;
&lt;li&gt;you&#39;re going to be compressing this same dataset frequently (like a
daily backup script for your email folders)&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Otherwise just use BZIP2&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/html&gt;
</pre>
</div>
<div title="eee-olpc-classmate" modifier="Sitaram" created="200903241920">
<pre>
&lt;html&gt;
&lt;h1&gt;Comparision between EEE, OLPC, and Classmate&lt;/h1&gt;

&lt;p&gt;&lt;sup&gt;from
http://reviews.zdnet.co.uk/hardware/notebooks/0,1000000333,39359143,00.htm
warning: one photo per page, too many mouse clicks needed, and &lt;em&gt;JS needed&lt;/em&gt;&lt;/sup&gt;&lt;/p&gt;

&lt;p&gt;Let&#39;s face it, just from the size aspect, the EEE wins hands down.  Even over
the EEE!&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;EEE is the smallest of the lot&lt;/li&gt;
&lt;li&gt;OLPC has the best screen (as if this was news!)&lt;/li&gt;
&lt;li&gt;OLPC doesn&#39;t have a fan (hopefully the EEE will follow suit soon)&lt;/li&gt;
&lt;li&gt;EEE is the only one with a VGA connector (yeay!!!)&lt;/li&gt;
&lt;li&gt;Classmate looks like the pregnant mother of the other two!
&lt;ul&gt;
&lt;li&gt;and the EEE is soooo slim -- always loved the slim ones :-)&lt;/li&gt;
&lt;li&gt;see comment at the start!&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;EEE has the &lt;strong&gt;largest&lt;/strong&gt; keyboard, even though it is the smallest of the 3.
&lt;ul&gt;
&lt;li&gt;God is actually talking to me here and telling me which to buy :-)&lt;/li&gt;
&lt;li&gt;or at least which to drool over!&lt;/li&gt;
&lt;li&gt;UPDATE: bought it for my son; he loves it&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;my wife would love the OLPC keyboard&lt;/li&gt;
&lt;li&gt;OLPC screen is really the largest by far!&lt;/li&gt;
&lt;li&gt;Classmate is very hard to get into (motherboard)&lt;/li&gt;
&lt;li&gt;EEE comes with 512 MB RAM (as opposed to 256 on the other 2)&lt;/li&gt;
&lt;/ul&gt;
&lt;/html&gt;
</pre>
</div>
<div title="policy-routing" modifier="Sitaram" created="200903241920">
<pre>
&lt;html&gt;
&lt;h1&gt;Advanced (policy) Routing&lt;/h1&gt;

&lt;h3&gt;Using rules&lt;/h3&gt;

&lt;pre&gt;&lt;code&gt;$ ip rule list
0:  from all lookup 255 
32766:  from all lookup main 
32767:  from all lookup default
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;The &lt;code&gt;main&lt;/code&gt; is the table that &quot;ip route ls&quot; shows by default.&lt;/p&gt;

&lt;p&gt;The idea is to generate rules to point to different tables to override
system-wide routing rules.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;echo 200 John &amp;gt;&amp;gt; /etc/iproute2/rt_tables
ip rule add from 10.11.12.13 table John
ip rule ls
ip route add default via 61.11.49.11 dev eth0 table John
ip route flush cache
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Notes:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;you could have simply used 200 all over instead of &quot;John&quot;, but using a
name helps to document the fact that 10.11.12.13 is John&#39;s IP and this is
how we will route him.&lt;/li&gt;
&lt;li&gt;the &lt;code&gt;ip route flush cache&lt;/code&gt; is not derivable from &lt;code&gt;ip route help&lt;/code&gt;
so remember the command; it is needed for this sort of stuff to work&lt;/li&gt;
&lt;/ul&gt;

&lt;h3&gt;Additional syntax&lt;/h3&gt;

&lt;pre&gt;&lt;code&gt;ip route add 1.2.3.4/16 dev ppp1 src ip.of.dev.ppp1
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;this &lt;code&gt;src&lt;/code&gt; part is new to me; it makes sure the right &lt;em&gt;outgoing&lt;/em&gt; IP address is
chosen -- more complex example can be found in the &quot;Linux Advanced Routing and
Traffic Control HOWTO&quot;&lt;/p&gt;
&lt;/html&gt;
</pre>
</div>
<div title="sort" modifier="Sitaram" created="200903241920">
<pre>
&lt;html&gt;
&lt;h1&gt;Unix sort&lt;/h1&gt;

&lt;p&gt;Unix sort not working as you expect?&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;get into the habit of using &lt;code&gt;-k 2,2&lt;/code&gt; instead of &lt;code&gt;-k 2&lt;/code&gt;, because
the latter actually means &lt;code&gt;-k 2,&amp;lt;endofline&amp;gt;&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;this is especially true when #2 is a numeric key, as in &lt;code&gt;-k 2,2n&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;by default, the field sep is the empty string between a non-blank and a
blank, so it&#39;s like all keys are &quot;right justified&quot;.  To ignore leading
blanks, use &lt;code&gt;-b&lt;/code&gt;.  You can apply &lt;code&gt;-b&lt;/code&gt; to a single key spec or the
whole command.&lt;/li&gt;
&lt;/ul&gt;
&lt;/html&gt;
</pre>
</div>
<div title="lsof" modifier="Sitaram" created="200903241920">
<pre>
&lt;html&gt;
&lt;h1&gt;lsof tricks&lt;/h1&gt;

&lt;p&gt;&lt;sup&gt;from &lt;a href=&quot;http://0xfe.blogspot.com/2006/03/troubleshooting-unix-systems-with-lsof.html&quot;&gt;http://0xfe.blogspot.com/2006/03/troubleshooting-unix-systems-with-lsof.html&lt;/a&gt;&lt;/sup&gt;&lt;/p&gt;

&lt;p&gt;horribly formatted article, and right now DNS cant find the site, but mainly:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;code&gt;lsof +L1&lt;/code&gt; -- deleted but open files!&lt;/li&gt;
&lt;li&gt;&lt;code&gt;lsof -i [TCP|UDP] [@host|ipaddr]:22&lt;/code&gt; -- who&#39;s using ssh?&lt;/li&gt;
&lt;li&gt;&lt;code&gt;lsof /dev/hda1&lt;/code&gt; -- when umount fails with &quot;device is busy&quot;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;lsof +D /tmp&lt;/code&gt; -- recurse directories&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;default param is a file system name like &lt;code&gt;/home&lt;/code&gt;; when used, it will list
all processes using ANY file in that FS&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;code&gt;lsof +f&lt;/code&gt; -- name treat name like a file system even if it looks like
a simple file&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;lsof -f&lt;/code&gt; -- name treat name like a simple file even if it is a file
system (for example when you really want to know who opened &quot;/&quot;)&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;lsof +d dirname&lt;/code&gt; -- looks at dir and first level files&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;lsof +D dirname&lt;/code&gt; -- recurses, and is SLOW&lt;/li&gt;
&lt;li&gt;&lt;code&gt;lsof -p pid1,pid2...&lt;/code&gt; -- files for proc(s) in list&lt;/li&gt;
&lt;li&gt;&lt;code&gt;lsof -t&lt;/code&gt; -- terse list of PIDs for killing etc.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;lsof -w uid,uname,...&lt;/code&gt; -- files for user(s) listed&lt;/li&gt;
&lt;li&gt;&lt;code&gt;lsof -c mpg&lt;/code&gt; -- all procs whose names start with mpg; regexes allowed
if delimited by slashes&lt;/li&gt;
&lt;/ul&gt;
&lt;/html&gt;
</pre>
</div>
<div title="grub" modifier="Sitaram" created="200903241920">
<pre>
&lt;html&gt;
&lt;h1&gt;Getting started with GRUB&lt;/h1&gt;

&lt;p&gt;Boot From a USB drive using GRUB&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;mkdir /mnt/usb
mount /dev/sda1 /mnt/usb
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;(The example below uses the e2fs stage file, which corresponds to the ext2
filesystem.  If sda1 has fat, get that instead...)&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;mkdir /mnt/usb/grub
cp /boot/grub/stage* /boot/grub/e2fs_stage1_5 /mnt/usb/grub/
umount /mnt/usb
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;The final step is to install a master boot record on the drive, using the
GRUB shell.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;grub
grub&amp;gt; device (hd0) /dev/sda
grub&amp;gt; root (hd0,0)
grub&amp;gt; setup (hd0)
grub&amp;gt; quit
&lt;/code&gt;&lt;/pre&gt;

&lt;blockquote&gt;
  &lt;p&gt;(Change &lt;code&gt;sda&lt;/code&gt; to suit...)&lt;/p&gt;
&lt;/blockquote&gt;

&lt;ul&gt;
&lt;li&gt;device tells GRUB what disk device to use when processing commands.&lt;/li&gt;
&lt;li&gt;root sets the default partition that GRUB will use to boot from. This is
the partition where the stage files were copied to. GRUB starts counting
at 0, not 1.&lt;/li&gt;
&lt;li&gt;setup creates the MBR on the USB drive.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;At this point GRUB is installed, and you should be able to boot the USB disk
drive. When you do so, you should get dumped directly into the GRUB shell when
the machine is booted. For information on what you can do with the command
shell, review the &lt;a href=&quot;http://www.gnu.org/software/grub/manual/html_node/Command_002dline-and-menu-entry-commands.html&quot;&gt;GRUB command-line
documentation&lt;/a&gt;
or try typing &#39;help&#39;&lt;/p&gt;

&lt;p&gt;&lt;sup&gt;Source: &lt;a href=&quot;http://www.linux.com/article.pl?sid=07/06/04/141244&quot;&gt;http://www.linux.com/article.pl?sid=07/06/04/141244&lt;/a&gt;&lt;/sup&gt;&lt;/p&gt;
&lt;/html&gt;
</pre>
</div>
<div title="dig" modifier="Sitaram" created="200903241920">
<pre>
&lt;html&gt;
&lt;h1&gt;dig notes&lt;/h1&gt;

&lt;p&gt;Best .digrc seems to be&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;+short
+noshort
+answer
+additional
+authority
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Surprisingly, a noshort following a short gives you just what you want
compared to any other combo!&lt;/p&gt;

&lt;h3&gt;&quot;Dug&quot; a little deeper&lt;/h3&gt;

&lt;p&gt;...pardon the pun!  &lt;code&gt;+short&lt;/code&gt; seems to act like &lt;code&gt;+nocomm +nostat +nocmd
+noadditional +noquestion&lt;/code&gt;, and maybe a few more such &#39;no&#39;s besides.  After
that the &lt;code&gt;+noshort&lt;/code&gt; goes in and enables only the ttl etc...&lt;/p&gt;

&lt;p&gt;That is, a&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;dig +nocomm +nostat +nocmd +noadditional +noquestion domain.to.search
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;seems to give the same output as having that &lt;code&gt;.digrc&lt;/code&gt; you see above.&lt;/p&gt;

&lt;h3&gt;Common Usages&lt;/h3&gt;

&lt;p&gt;You can use these abbreviations if you like&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;+tra[ce]
+ns[ssearch]
+id[entify]
+co[mments]
+st[ats]
&lt;/code&gt;&lt;/pre&gt;
&lt;/html&gt;
</pre>
</div>
<div title="curl" modifier="Sitaram" created="200903241920">
<pre>
&lt;html&gt;
&lt;h1&gt;curl&lt;/h1&gt;

&lt;h3&gt;quick start&lt;/h3&gt;

&lt;h4&gt;pros&lt;/h4&gt;

&lt;ul&gt;
&lt;li&gt;great docs, esp &lt;code&gt;curl -M&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;lots of features for http/s type stuff
&lt;ul&gt;
&lt;li&gt;lists and sequences, byte ranges&lt;/li&gt;
&lt;li&gt;browser emulation like cookies, following redirects, sending forms, etc.&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h4&gt;cons&lt;/h4&gt;

&lt;ul&gt;
&lt;li&gt;strictly batch; needs a file URL not a dir URL&lt;/li&gt;
&lt;li&gt;for scp/ssh/sftp type stuff, lftp/rsync/scp are much better; this one is
much more cumbersome -- doesn&#39;t use ssh-agent or .ssh/config&lt;/li&gt;
&lt;li&gt;no recursion, parallel downloads, metalink support, or job control&lt;/li&gt;
&lt;/ul&gt;

&lt;h3&gt;details&lt;/h3&gt;

&lt;h4&gt;curl URLs&lt;/h4&gt;

&lt;ul&gt;
&lt;li&gt;conform to RFC 3986&lt;/li&gt;
&lt;li&gt;use &lt;code&gt;-o file&lt;/code&gt; or &lt;code&gt;-O&lt;/code&gt; to specify where output should go (default
is stdout)
&lt;ul&gt;
&lt;li&gt;you can have one of these options for each URL given&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;(COOL!) can use lists and sequences, sequences can have a step counter,
but you must use &lt;code&gt;-O&lt;/code&gt; or &lt;code&gt;-o&lt;/code&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;curl -o &quot;dir_#1/file_#2_#3.txt&quot; http://any.org/archive[1-19]/vol[01-04]/part{a,b,c}.html
curl -O http://www.letters.com/file[a-z:2].txt
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;give multiple URLs on the same command to get multiple files efficiently
(reuses connection)&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;-L&lt;/code&gt; follows redirected URLs&lt;/li&gt;
&lt;/ul&gt;

&lt;h4&gt;auth, proxies, proxy auths, and SSL&lt;/h4&gt;

&lt;ul&gt;
&lt;li&gt;&lt;code&gt;-x proxyserver:3128&lt;/code&gt; or set &lt;code&gt;ALL_PROXY&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;you can also set &lt;code&gt;http_proxy&lt;/code&gt;, &lt;code&gt;https_proxy&lt;/code&gt;, &lt;code&gt;ftp_proxy&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;-U proxyuser[:proxypass]&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;-u user[:pass]&lt;/code&gt; for server
&lt;ul&gt;
&lt;li&gt;or use &lt;code&gt;-n&lt;/code&gt; and &lt;code&gt;~/.netrc&lt;/code&gt; containing a line like machine host.dom login
me password whatever&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;-k&lt;/code&gt; lets you use insecure SSL certs (like ultimatix!)&lt;/li&gt;
&lt;li&gt;(COOL!) (BUT DOESNT SEEM TO WORK!!) &lt;code&gt;-p&lt;/code&gt; allows proxy tunnels&lt;/li&gt;
&lt;/ul&gt;

&lt;h4&gt;received headers, verbosity, trouble shooting, etc&lt;/h4&gt;

&lt;ul&gt;
&lt;li&gt;&lt;code&gt;-C -&lt;/code&gt; to resume/continue a transfer&lt;/li&gt;
&lt;li&gt;&lt;code&gt;-D file&lt;/code&gt; to dump headers; can be &quot;-&quot; for stdin&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;-I&lt;/code&gt; for HEAD, and &lt;code&gt;-i&lt;/code&gt; for HEAD+GET&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;-V&lt;/code&gt; to see what features are compiled in&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;-v&lt;/code&gt; shows headers being sent and received, somewhat like &lt;code&gt;GET -USe&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;--trace -&lt;/code&gt; is even more verbose&lt;/li&gt;
&lt;/ul&gt;

&lt;h4&gt;sent headers, cookies, etc&lt;/h4&gt;

&lt;ul&gt;
&lt;li&gt;has cookie and jar support
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;-b &quot;a=b; c=d&quot;&lt;/code&gt; or &lt;code&gt;-b file&lt;/code&gt; where the &quot;file&quot; has plain HTTP
headers (perhaps dumped from &lt;code&gt;-D&lt;/code&gt;); this file is only read, and you
can use it to seed curl with cookies from some other operation
elsewhere&lt;/li&gt;
&lt;li&gt;&lt;code&gt;-c cookiejar&lt;/code&gt;; this file gets written to at the end, and can be
used with &lt;code&gt;-b cookiejar&lt;/code&gt; on subsequent runs&lt;/li&gt;
&lt;li&gt;&lt;code&gt;-j&lt;/code&gt; junk session cookies when reading cookies&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;-e REFERER-URL&lt;/code&gt; &lt;/li&gt;
&lt;li&gt;&lt;code&gt;-A&lt;/code&gt; to set user-agent header&lt;/li&gt;
&lt;li&gt;&lt;code&gt;-H &quot;header: value&quot;&lt;/code&gt; adds, replaces, or removes (if you leave out the
stuff after the colon) headers&lt;/li&gt;
&lt;li&gt;&lt;code&gt;-r&lt;/code&gt; sets a Range header
&lt;ul&gt;
&lt;li&gt;simple examples: 0-499, -500 (last 500 bytes), 999-&lt;/li&gt;
&lt;li&gt;&quot;0-0,-1&quot; (first and last byte), &quot;100-199,500-599&quot;, etc return multipart
responses if the web server supports it&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h4&gt;uploading files and data&lt;/h4&gt;

&lt;ul&gt;
&lt;li&gt;&lt;code&gt;-d&lt;/code&gt; POSTs data as application/x-www-form-urlencoded
&lt;ul&gt;
&lt;li&gt;must be URL-encoded&lt;/li&gt;
&lt;li&gt;can be used multiple times (in which case curl will cat them with &lt;code&gt;&amp;amp;&lt;/code&gt;)&lt;/li&gt;
&lt;li&gt;&lt;code&gt;-d @file&lt;/code&gt; for sending data from file; can be &quot;-&quot; for stdin&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;-G&lt;/code&gt; use GET instead of POST&lt;/li&gt;
&lt;li&gt;&lt;p&gt;also see &lt;code&gt;--data-urlencode&lt;/code&gt; and &lt;code&gt;--data-binary&lt;/code&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;-F&lt;/code&gt; POSTs data as multipart/form-data&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;can upload binary files&lt;/li&gt;
&lt;li&gt;can also specify content-type; see docs&lt;/li&gt;
&lt;li&gt;&lt;p&gt;some examples&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;curl -F formfield=@file [...]
curl -F formfield=&amp;lt;file [...]
# both &quot;file&quot;s can be &quot;-&quot; for stdin
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h4&gt;less important&lt;/h4&gt;

&lt;ul&gt;
&lt;li&gt;&lt;code&gt;-q&lt;/code&gt; as the first parameter disables curlrc&lt;/li&gt;
&lt;li&gt;&lt;code&gt;-#&lt;/code&gt; to get a progress bar instead of the normal display&lt;/li&gt;
&lt;li&gt;&lt;code&gt;--limit-rate 50k&lt;/code&gt; limits average speed of the entire download,
meaning it can go higher to make up for slow periods if needed&lt;/li&gt;
&lt;li&gt;&lt;code&gt;-y N&lt;/code&gt; and &lt;code&gt;-Y M&lt;/code&gt;: abort if speed over the last N seconds is less
then M bytes/sec&lt;/li&gt;
&lt;li&gt;abort if headers indicate file is larger than &lt;code&gt;--max-filesize&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;-m N&lt;/code&gt; limits the whole job to N seconds&lt;/li&gt;
&lt;li&gt;&lt;code&gt;--retry&lt;/code&gt;, &lt;code&gt;--retry-delay&lt;/code&gt;, and &lt;code&gt;--retry-max-time&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;-z file/ts&lt;/code&gt; to get only if remote is newer than file/timestamp; many
formats can be used for the timestamp&lt;/li&gt;
&lt;/ul&gt;
&lt;/html&gt;
</pre>
</div>
<div title="imagemagick-whitespace" modifier="Sitaram" created="200903241920">
<pre>
&lt;html&gt;
&lt;h1&gt;ImageMagick trick -- find photos with lots of &quot;white&quot; space&lt;/h1&gt;

&lt;pre&gt;&lt;code&gt;convert in.jpg -colors 2 -contrast-stretch 0 out.xpm
identify -verbose out.xpm | grep -A2 Histogram:
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;The ratio of the 2 values you see there should tell you how many pixels
were more light than dark.&lt;/p&gt;

&lt;p&gt;This is not the same as picking out black-and-white shots; for that look
for &quot;Colorspace: gray&quot;.&lt;/p&gt;

&lt;p&gt;It is for picking out photos which have much more &quot;light area&quot; (even
off-white or cream) compared to dark area&lt;/p&gt;
&lt;/html&gt;
</pre>
</div>
<div title="wget" modifier="Sitaram" created="201008271831">
<pre>
&lt;html&gt;
&lt;h1&gt;wget&lt;/h1&gt;

&lt;p&gt;unformatted...&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;-r
    recursive

-nc
    MOST IMPORTANT ONE! (continue where you left off)

-np
    ALMOST as important!  &quot;No Parent&quot; sticks to given URL and child
    directories.

-w  seconds
    wait time between shots - be nice!

-P directory
    default is &quot;.&quot;

-Q quota
    eg: -Q 2m limits total to 2MB.  Stops only at file boundaries - not in the
    middle of a file, so you may get more in practice...

-o|a logfile
    to overwrite/append
    default: screen

--spider
    check links

-i file
    read URLs from this file

-l depth
    dft 5

-A|R list
    comma-sep list of filename suffixes to accept/reject; of course HTML
    *must* be loaded...

-D domainlist
    comma-sep list of domains which are &quot;worth&quot; DNS-looking up (in wget&#39;s
    attempt to find alias hosts).  Domains not in this list will be rejected
    outright as possible candidates for being an alias of the host you started
    with.

    Along with -H, does something more complex - see info file node on domain
    acceptance.

--follow-ftp
    not the default when doing http - ftp files will be ignored unles you set
    this.

-k
    make relative links from non-relative ones after downloading (only for
    those which got here!)

-N
    honour timestamps and not get unchanged files
&lt;/code&gt;&lt;/pre&gt;
&lt;/html&gt;
</pre>
</div>
<div title="flickr-by-email" modifier="Sitaram" created="200903241920">
<pre>
&lt;html&gt;
&lt;h1&gt;flickr by email&lt;/h1&gt;

&lt;p&gt;Get a new &quot;codeword&quot; from &lt;a href=&quot;http://www.flickr.com/account/uploadbyemail/&quot;&gt;http://www.flickr.com/account/uploadbyemail/&lt;/a&gt; (need
JS), then send email as follows:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;To: codeword@photos.flickr.com
Subject: short description of photo tags: onewordtag &quot;one phrase tag&quot;

body of email becomes description of photo
&lt;/code&gt;&lt;/pre&gt;

&lt;h2&gt;Privacy in flickr&lt;/h2&gt;

&lt;p&gt;My defaults (on sitaramc_f) are&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;anyone can see&lt;/li&gt;
&lt;li&gt;any flickr user can comment&lt;/li&gt;
&lt;li&gt;and flickr user can add notes and tags&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;strong&gt;In short, DO NOT UPLOAD ANY PICTURES OF FAMILY OR FRIENDS!&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;You can &lt;strong&gt;set non-default privacy&lt;/strong&gt; by addressing the email to&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;codeword+X@photos.flickr.com
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;where X can be&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;friends
family
ff  # both
private # only you
public
&lt;/code&gt;&lt;/pre&gt;
&lt;/html&gt;
</pre>
</div>
<div title="bare" modifier="Sitaram" created="201110051936">
<pre>
&lt;html&gt;
&lt;h1&gt;&lt;a name=&quot;all_about_bare_repos_what_why_and_how_to_fix_a_non_bare_push&quot;&gt;all about &quot;bare&quot; repos -- what, why, and how to fix a non-bare push&lt;/a&gt;&lt;/h1&gt;

&lt;p&gt;&lt;sup&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#all_about_bare_repos_what_why_and_how_to_fix_a_non_bare_push&quot;&gt;all about &quot;bare&quot; repos -- what, why, and how to fix a non-bare push&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#what_is_a_bare_repo_&quot;&gt;what is a bare repo?&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#yeah_yeah_but_why_do_I_need_a_bare_repo_&quot;&gt;yeah yeah, but &lt;strong&gt;why&lt;/strong&gt; do I need a bare repo?&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#how_do_I_fix_such_a_non_bare_push_&quot;&gt;how do I fix such a non-bare push?&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#how_do_I_prevent_the_problem_from_happening_again_&quot;&gt;how do I prevent the problem from happening again?&lt;/a&gt;&lt;br&gt;&lt;/p&gt;

&lt;p&gt;&lt;/sup&gt;&lt;/p&gt;

&lt;hr /&gt;

&lt;p&gt;&lt;center&gt;
&lt;strong&gt;&lt;em&gt;Update for git 1.7.0 and above&lt;/em&gt;&lt;/strong&gt;
&lt;/center&gt;&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;As of git 1.7.0, the default value for &lt;code&gt;receive.denyCurrentBranch&lt;/code&gt; has
  changed from &quot;warn&quot; to &quot;refuse&quot;.  As a result, on 1.7.0 and above, by
  default, you will not get into this sort of trouble.  However, this
  document is still useful as a detailed explanation of what precisely this
  problem is.  Just pretend, as you read along, that you&#39;re on a pre-1.7.0
  system or that someone set &lt;code&gt;receive.denyCurrentBranch&lt;/code&gt; to &quot;warn&quot;, &quot;ignore&quot;
  or &#39;false&#39;.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h3&gt;&lt;a name=&quot;what_is_a_bare_repo_&quot;&gt;what is a bare repo?&lt;/a&gt;&lt;/h3&gt;

&lt;p&gt;A bare repository is a concept that is sort of unique to a Distributed VCS
like git (and, I presume, other such DVCSs like Hg/Bzr/etc also).&lt;/p&gt;

&lt;p&gt;A normal git repository is a directory that contains&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;project directories and files (the &quot;working tree&quot; mentioned above)&lt;/li&gt;
&lt;li&gt;a single directory called &lt;code&gt;.git&lt;/code&gt; containing all of git&#39;s
administrative and control files; we&#39;ll call it the &lt;strong&gt;magic&lt;/strong&gt; directory
because git can&#39;t do any magic without it :-)&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;When you do a &lt;code&gt;git status&lt;/code&gt; inside such a directory, git looks inside the
&quot;magic&quot; directory, compares your current working tree with the &quot;current
branch&quot; as recorded in the magic directory, and tells you what files have
changed, etc etc.&lt;/p&gt;

&lt;p&gt;A &quot;bare&quot; repo, as the git
&lt;a href=&quot;http://www.kernel.org/pub/software/scm/git/docs/gitglossary.html&quot;&gt;glossary&lt;/a&gt;
says, is a repository that does not contain a &quot;working tree&quot; at all.  It
doesn&#39;t contain the special &lt;code&gt;.git&lt;/code&gt; sub-directory either; instead, it
contains all the contents of the &lt;code&gt;.git&lt;/code&gt; subdirectory right in the main
directory itself.&lt;/p&gt;

&lt;h3&gt;&lt;a name=&quot;yeah_yeah_but_why_do_I_need_a_bare_repo_&quot;&gt;yeah yeah, but &lt;strong&gt;why&lt;/strong&gt; do I need a bare repo?&lt;/a&gt;&lt;/h3&gt;

&lt;p&gt;ok; demo time...&lt;/p&gt;

&lt;p&gt;Let&#39;s try creating a small repo, adding a file, committing, and checking
&lt;code&gt;git status&lt;/code&gt;:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;mkdir a; cd a; git init
echo hi &amp;gt; a;git add a; git commit -m a
git status
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;This should respond&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;# On branch master
# nothing to commit (working directory clean)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;So far so good.  Now someone clones our repository, adds a new file, commits,
and pushes his changes back to our repository:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;cd ..;git clone a b
cd b; echo there &amp;gt;&amp;gt; b; git add b; git commit -m b
git push
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;The &lt;code&gt;git push&lt;/code&gt; above sends your new commits to the &quot;origin&quot; repository.  More
specifically, it updates the &quot;magic&quot; directory on repo &quot;a&quot; with this new
commit.&lt;/p&gt;

&lt;p&gt;Now you go back to the main repo and check &lt;code&gt;git status&lt;/code&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;cd ../a
git status
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;which responds&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;# On branch master
# Changes to be committed:
#   (use &quot;git reset HEAD &amp;lt;file&amp;gt;...&quot; to unstage)
#
#       deleted:    b
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Whoa!  What happened here?  We &lt;strong&gt;added&lt;/strong&gt; a file called &lt;code&gt;b&lt;/code&gt; in the cloned
repository and pushed to the &quot;origin&quot;.  But your origin now claims you
&lt;strong&gt;deleted&lt;/strong&gt; that file...?&lt;/p&gt;

&lt;p&gt;To understand this, you need to realise that &lt;strong&gt;the &quot;magic&quot; directory is always
assumed to be correct&lt;/strong&gt;; it is the &quot;standard&quot; against which your working tree
is compared to determine what changes you made in your working tree.&lt;/p&gt;

&lt;p&gt;So when you asked for a status, git first looked inside the magic directory.
The magic directory said you should have two files, &quot;a&quot; and &quot;b&quot;, but your work
tree has only file &quot;a&quot;.  So &lt;code&gt;git status&lt;/code&gt; concludes that you have deleted
the file &quot;b&quot;!&lt;/p&gt;

&lt;p&gt;In other words, when someone changes the &quot;magic&quot; directory &lt;strong&gt;behind your
back&lt;/strong&gt;, your locally checked out copy (your working tree) appears to have the
&lt;strong&gt;opposite&lt;/strong&gt; changes made by you.&lt;/p&gt;

&lt;p&gt;All this confusion can (and &lt;em&gt;should&lt;/em&gt;) be avoided by using a &quot;bare&quot;
repository to clone and pull from, and push to.  It doesn&#39;t have a checked out
tree, so it just does what the &quot;server&quot; notionally does in a centralised VCS
-- records commits, branches, etc when you push to it, and gives you the
latest versions when you clone or pull from it.&lt;/p&gt;

&lt;h3&gt;&lt;a name=&quot;how_do_I_fix_such_a_non_bare_push_&quot;&gt;how do I fix such a non-bare push?&lt;/a&gt;&lt;/h3&gt;

&lt;p&gt;If you did push into a non-bare repo, the first thing to do is make sure that
no one is working on that checked out work tree, and no local changes have
been made since the last checkout.&lt;/p&gt;

&lt;p&gt;Once you&#39;ve made sure of that, you should log onto that machine, cd to that
repo, and do this:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;git reset --hard HEAD
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;If you had local changes on that work tree, or you are not sure if you had
any, then you have a bit of a challenge.  There are ways to deal with it quite
nicely in git, but I haven&#39;t tried them yet.  Ideas:&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;&lt;p&gt;see if any of the HEADs in reflog match your current work tree exactly, in
which case you really do NOT have any local changes, and you can safely do
that reset.  Use &lt;code&gt;git reflog show your-branch-name&lt;/code&gt; to find the topmost
commit after the most recent push or set of pushes (in case there were
more than one) and compare your work tree against that.&lt;/p&gt;

&lt;p&gt;Let&#39;s say your reflog output looks like this:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;$ git reflog show master
fcbb5a7 master@{0}: push
e41b4ce master@{1}: push
6ef3360 master@{2}: commit: blah blah more blah
a48b324 master@{3}: commit: blah blah blah
48e4b98 master@{4}: commit (initial): first commit
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;As you can see, there were two &quot;behind your back&quot; pushes, and it is very
likely that master@{2} is the &quot;base&quot; for your current work tree.  So you
compare against that:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;$ git diff --stat --exit-code master@{2}
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;If there are no differences, you&#39;re probably OK to do that &lt;code&gt;git reset
--hard&lt;/code&gt;.  If you&#39;re really paranoid, you&#39;ll check to make sure that
master@{2} is an ancestor of HEAD:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;git rev-list HEAD..master@{2}   # should be empty
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;anyway, if the diff above showed differences, you have a merge of some
sort coming up.  Here&#39;s what you do:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;make a temporary branch off that same commit&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;git checkout -b temp master@{2}
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;now you have two alternatives:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;The safe way: commit those changes.  If the work is not complete,
complete it -- you have all the time in the world now that you have
created a temp branch, and any number of pushes can now happen on
&#39;master&#39; without affecting you, since it isn&#39;t the checked out branch.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;The quicker way: stash those changes using &lt;code&gt;git stash&lt;/code&gt;.  I am 99% sure
stashing will work as well here, but would appreciate hearing from any
git.experts reading this (email me at sitaramc@gmail.com)&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;now checkout master and either merge temp or &lt;code&gt;git stash pop&lt;/code&gt; depending
on which option you chose above; it&#39;s just a normal branch now!&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ol&gt;

&lt;h3&gt;&lt;a name=&quot;how_do_I_prevent_the_problem_from_happening_again_&quot;&gt;how do I prevent the problem from happening again?&lt;/a&gt;&lt;/h3&gt;

&lt;p&gt;The best option is upgrade to git 1.7.0 or later!&lt;/p&gt;

&lt;p&gt;If you cannot upgrade, and if you or others will continue to push into this
repo, you have to make it a bare repo.&lt;/p&gt;

&lt;p&gt;To make it a &quot;real&quot; bare repo, just delete all the files except &lt;code&gt;.git&lt;/code&gt;, then
&lt;code&gt;mv .git/* .; rmdir .git&lt;/code&gt;.  Finally, edit the file called &lt;code&gt;config&lt;/code&gt; and change
&lt;code&gt;bare = false&lt;/code&gt; to &lt;code&gt;bare = true&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;If you&#39;re not comfortable playing with git at that level, there is another
alternative.  You may have guessed by now that you can make a non-bare repo
look like a bare repo for push purposes by creating and checking out a branch
that your users will not push to.  The entire repo does not have to be bare,
really...&lt;/p&gt;

&lt;p&gt;So just run &lt;code&gt;git checkout -b DUMMY_BRANCH_DONT_USE&lt;/code&gt; (or some such name) and
keep this branch checked out forever in this repo.  This is a cheap way to
make a non-bare repo into a bare repo for all practical purposes.&lt;/p&gt;
&lt;/html&gt;
</pre>
</div>
<div title="soft-hard-mixed" modifier="Sitaram" created="200906302348">
<pre>
&lt;html&gt;
&lt;h1&gt;Easy way to remember what git reset&#39;s soft/hard/mixed do&lt;/h1&gt;

&lt;p&gt;&lt;sup&gt;loosely based on &lt;a href=&quot;http://gitster.livejournal.com/25150.html&quot;&gt;http://gitster.livejournal.com/25150.html&lt;/a&gt;&lt;/sup&gt;&lt;/p&gt;

&lt;p&gt;Assume you start from a &quot;everything is committed and golden&quot; state.  Let&#39;s
pretend you came to this starting point via a &lt;code&gt;git checkout&lt;/code&gt;: and then you
edit a bunch of stuff, compile/test, and then &lt;code&gt;git add&lt;/code&gt; and &lt;code&gt;git
commit&lt;/code&gt;:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;$ git checkout mywork
...edit edit edit...
$ git add ...
$ git commit
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;If at this point you do a &lt;code&gt;git reset&lt;/code&gt;, here&#39;s how the type of reset
(&quot;soft&quot;, &quot;hard&quot;, or the default, which is &quot;mixed&quot;) affects things:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;$ git checkout mywork
            # --hard resets to this point
...edit edit edit...
            # --mixed (default) resets to this point
$ git add ...
            # --soft resets to this point
$ git commit
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Also note, as gitster says, that &lt;code&gt;git commit --amend&lt;/code&gt; makes the &lt;code&gt;git
reset --soft&lt;/code&gt; mostly redundant.&lt;/p&gt;
&lt;/html&gt;
</pre>
</div>
<div title="0-terminology" modifier="Sitaram" created="201110051936">
<pre>
&lt;html&gt;
&lt;h1&gt;&lt;a name=&quot;terminology&quot;&gt;terminology&lt;/a&gt;&lt;/h1&gt;

&lt;p&gt;&lt;sup&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#terminology&quot;&gt;terminology&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#general_VCS_terminology&quot;&gt;general VCS terminology&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#git_specific_terminology&quot;&gt;git-specific terminology&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#working_tree_repository_bare_repository&quot;&gt;working tree, repository, bare repository&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#commits_SHAs&quot;&gt;commits, SHAs&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#parent_commits_commit_tree&quot;&gt;parent commits, commit tree&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#head_branch_tag&quot;&gt;head, branch, tag&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#reachability&quot;&gt;reachability&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#master_HEAD&quot;&gt;master, HEAD&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#index&quot;&gt;index&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#terminology_related_to_being_distributed_&quot;&gt;terminology related to being &quot;distributed&quot;&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#clone_versus_checkout&quot;&gt;clone versus checkout&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#accessing_remote_repositories&quot;&gt;accessing remote repositories&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#naming_remote_repositories&quot;&gt;naming remote repositories&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#what_is_a_bare_repository_&quot;&gt;what is a &quot;bare&quot; repository?&lt;/a&gt;&lt;br&gt;
&lt;/sup&gt;&lt;/p&gt;

&lt;h3&gt;&lt;a name=&quot;general_VCS_terminology&quot;&gt;general VCS terminology&lt;/a&gt;&lt;/h3&gt;

&lt;p&gt;A &lt;strong&gt;project&lt;/strong&gt; is the minimum set of source code (and related files) that need
to be kept together to &lt;strong&gt;build&lt;/strong&gt; the software.  Example: Linux&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;each project will have one &lt;strong&gt;repository&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;one &lt;strong&gt;team&lt;/strong&gt; can work on multiple projects, so there could be multiple
repositories on each desktop&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;A &lt;strong&gt;working tree&lt;/strong&gt; or &lt;strong&gt;worktree&lt;/strong&gt; is the &lt;em&gt;current&lt;/em&gt; set of files that are
being worked on, tested, etc.&lt;/p&gt;

&lt;p&gt;A &lt;strong&gt;branch&lt;/strong&gt; in a project is an active line of development&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;master&lt;/strong&gt; is the conventional name for the main development tree of a
project&lt;/li&gt;
&lt;li&gt;other conventional branches are &lt;strong&gt;next&lt;/strong&gt; (for code that is ready to come
into &lt;em&gt;main&lt;/em&gt;), and various maintenance branches like &lt;strong&gt;v1.3&lt;/strong&gt; or
&lt;strong&gt;v2.6.4&lt;/strong&gt; to designate released versions&lt;/li&gt;
&lt;li&gt;these are only conventions, not rules, but they seem to work well in
general&lt;/li&gt;
&lt;li&gt;more detail about branches is in the next section&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;A &lt;strong&gt;feature&lt;/strong&gt; is a part of a project that is large and complex enough that
it&#39;s day-to-day commits would be too noisy to include in the main project.
Example: the disk subsystem, the networking subsystem, etc., in Linux&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;a &lt;strong&gt;feature branch&lt;/strong&gt; is a branch for a feature, and is usually long-lived.
This means it regularly acquires changes made in the main line, and -- at
stable points in its development cycle -- merges its changes back into the
main line&lt;/li&gt;
&lt;/ul&gt;

&lt;h3&gt;&lt;a name=&quot;git_specific_terminology&quot;&gt;git-specific terminology&lt;/a&gt;&lt;/h3&gt;

&lt;h4&gt;&lt;a name=&quot;working_tree_repository_bare_repository&quot;&gt;working tree, repository, bare repository&lt;/a&gt;&lt;/h4&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;a &lt;strong&gt;working tree&lt;/strong&gt; in git is the same as anywhere else.  When you edit,
compile, test, etc., it is your working tree files that are used&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;a normal &lt;strong&gt;repository&lt;/strong&gt; in git consists of the working tree, plus &lt;strong&gt;one&lt;/strong&gt;
extra directory at the root of the project tree (meaning at the top
directory of your project), called &lt;code&gt;.git&lt;/code&gt;.  Inside this &lt;code&gt;.git&lt;/code&gt; are a bunch
of files and directories which you need not worry about (and should not
mess with unless you know what you&#39;re doing)&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;a &lt;strong&gt;bare repository&lt;/strong&gt; in git is a very special animal: it is a repository
&lt;em&gt;without&lt;/em&gt; a working tree (so you cannot edit, compile, test etc., in it).
Central (or server) repos, meant only for people to push to and clone/pull
from, are usually bare.  Read more about it &lt;a href=&quot;../concepts/bare.html&quot;&gt;here&lt;/a&gt;
if you like&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h4&gt;&lt;a name=&quot;commits_SHAs&quot;&gt;commits, SHAs&lt;/a&gt;&lt;/h4&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;a &lt;strong&gt;commit&lt;/strong&gt; records the content of the project files at a point in time&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;every commit in git is represented by a globally unique 160-bit value (40
hex digits) which is a cryptographically secure hash of the commit data.
This is often called the &lt;strong&gt;SHA&lt;/strong&gt; or SHA-1, after the algorithm used.&lt;/p&gt;

&lt;p&gt;&lt;sup&gt;&quot;Globally unique&quot; means no other commit in any other repository in any
other project anywhere in the world will have the same SHA.  You can
become very, very, famous in the cryptography world if you find two
different commits with the same SHA :-)&lt;/sup&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h4&gt;&lt;a name=&quot;parent_commits_commit_tree&quot;&gt;parent commits, commit tree&lt;/a&gt;&lt;/h4&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;every commit builds on top of one or more previous commits, called
&lt;strong&gt;parents&lt;/strong&gt;.  Normal commits have only one parent, while &quot;merge&quot; commits
have two.  The very first commit in the tree has no parents; this is called
a &quot;root commit&quot;.&lt;/p&gt;

&lt;p&gt;&lt;sup&gt;A repo can have more than one &quot;root commit&quot;, but this is rare&lt;/sup&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;every commit records the SHAs of its parent(s).  It&#39;s as if every commit
has an arrow pointing to its parents, like a back pointer in a linked list&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;thus, merge commits have two arrows pointing out&lt;/li&gt;
&lt;li&gt;and a &quot;fork&quot; (where you created a new branch) has two or more arrows
pointing &lt;strong&gt;in&lt;/strong&gt;, because it&#39;s the parent for more than one commit&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;as a result, the entire repo can look like a &lt;strong&gt;tree&lt;/strong&gt;.  Strictly speaking,
this is a DAG -- or &quot;directed acyclic graph&quot;.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h4&gt;&lt;a name=&quot;head_branch_tag&quot;&gt;head, branch, tag&lt;/a&gt;&lt;/h4&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;a &lt;strong&gt;branch&lt;/strong&gt; represents an active line of development; you use different
branches to track different lines of development.  Without branches,
working on multiple features or versions simultaneously would be a
nightmare!&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;in practice, a branch is a symbolic name that points to the most recent
commit on that line of development.  This &quot;tip&quot; commit is called the
&lt;strong&gt;head&lt;/strong&gt; of that branch.&lt;/p&gt;

&lt;p&gt;When you checkout a branch and make a new commit on it, the &quot;branch&quot; now
points to the &lt;em&gt;new&lt;/em&gt; head node.  In other words, a branch is a pointer that
&lt;em&gt;moves as you make commits&lt;/em&gt;.&lt;/p&gt;

&lt;p&gt;A repository can track many branches, but the working tree is associated
with only one branch at a time&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;a &lt;strong&gt;tag&lt;/strong&gt; is also a symbolic name given to a commit.  Tags don&#39;t &quot;move&quot; as
you make new commits -- they stay where they are.&lt;/p&gt;

&lt;p&gt;Tags are used to mark specific milestones in a project, like &quot;v1.3&quot;, or
&quot;v2.9&quot;, etc.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h4&gt;&lt;a name=&quot;reachability&quot;&gt;reachability&lt;/a&gt;&lt;/h4&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;you can start from a commit X and follow the parent SHAs (&quot;arrows&quot;) until
you come to a root commit.  The commits you found in this process are all
said to be &lt;strong&gt;reachable&lt;/strong&gt; from X&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;if you have commit X in some other repo, git guarantees that that repo
also has all these &quot;reachable&quot; commits.&lt;/p&gt;

&lt;p&gt;&lt;sup&gt;[If you know about grafts or shallow clones, you&#39;re too advanced to be
reading this document ;-)]&lt;/sup&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;when you merge a branch into the currently checked out branch, git uses
reachability to determine what commits to actually bring in.  All the
commits reachable from the branch being merged, which are not already
reachable from the current branch, are pulled in and applied&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h4&gt;&lt;a name=&quot;master_HEAD&quot;&gt;master, HEAD&lt;/a&gt;&lt;/h4&gt;

&lt;ul&gt;
&lt;li&gt;&lt;em&gt;master&lt;/em&gt;: default branch in a project (main development tree), by
convention&lt;/li&gt;
&lt;li&gt;&lt;em&gt;HEAD&lt;/em&gt;: tip of the branch associated with the working tree; this is where
commits go.  Normally.  There is also something called a &#39;detached HEAD&#39;
that you should be aware of.  See the article on the &lt;a href=&quot;detached-head.html&quot;&gt;detached
HEAD&lt;/a&gt; for more.&lt;/li&gt;
&lt;/ul&gt;

&lt;h4&gt;&lt;a name=&quot;index&quot;&gt;index&lt;/a&gt;&lt;/h4&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;a staging area for the next commit; when you commit, the current
index is turned into a real commit object&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;the &lt;strong&gt;index&lt;/strong&gt; is also called &lt;strong&gt;stage&lt;/strong&gt; or &lt;strong&gt;cache&lt;/strong&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;strong&gt;staging&lt;/strong&gt; a file (&lt;code&gt;git add file&lt;/code&gt;) marks its &lt;em&gt;current&lt;/em&gt; contents
  for inclusion in the next commit&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;strong&gt;unstaging&lt;/strong&gt; a file (&lt;code&gt;git reset file&lt;/code&gt;, or in the case of a new
  file, &lt;code&gt;git rm --cached file&lt;/code&gt;) undoes all staging since the last
  commit&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;the &lt;strong&gt;unstaged changes&lt;/strong&gt; are the difference between index and
working tree (&lt;code&gt;git diff&lt;/code&gt;)&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;the &lt;strong&gt;uncommitted but staged changes&lt;/strong&gt; are the difference between
HEAD and index (&lt;code&gt;git diff --cached&lt;/code&gt;)&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;see &lt;a href=&quot;uses-of-index.html&quot;&gt;uses of index&lt;/a&gt; for the cool things you
can do with it&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h3&gt;&lt;a name=&quot;terminology_related_to_being_distributed_&quot;&gt;terminology related to being &quot;distributed&quot;&lt;/a&gt;&lt;/h3&gt;

&lt;h4&gt;&lt;a name=&quot;clone_versus_checkout&quot;&gt;clone versus checkout&lt;/a&gt;&lt;/h4&gt;

&lt;p&gt;In a &lt;em&gt;distributed&lt;/em&gt; VCS, every developer&#39;s workstation has a full copy of the
entire repository.  It is therefore called a &lt;strong&gt;clone&lt;/strong&gt; -- you &lt;strong&gt;clone&lt;/strong&gt; the
remote repository, you don&#39;t merely &lt;em&gt;checkout&lt;/em&gt; the latest version from it.&lt;/p&gt;

&lt;p&gt;So where does &lt;em&gt;checkout&lt;/em&gt; come in?  In git, you &lt;strong&gt;checkout&lt;/strong&gt; a &lt;em&gt;branch&lt;/em&gt; from
your local repo, so this happens &lt;em&gt;after&lt;/em&gt; the clone.  Remember this is a full
repo, so you already have all the branches that the parent repo had when you
cloned.&lt;/p&gt;

&lt;p&gt;By default, after the clone is done, git will &lt;strong&gt;checkout&lt;/strong&gt; the same branch
that was currently checked out in the repository you&#39;re cloning from.
However, you can checkout some other branch at any time (and if you&#39;re using
git, you will checkout and manage multiple branches on your local repo all the
time, otherwise you&#39;re not really &lt;em&gt;using&lt;/em&gt; git!)&lt;/p&gt;

&lt;h4&gt;&lt;a name=&quot;accessing_remote_repositories&quot;&gt;accessing remote repositories&lt;/a&gt;&lt;/h4&gt;

&lt;p&gt;Every remote repository (often called just a &lt;strong&gt;remote&lt;/strong&gt;) has a URL associated
with it, depending on how your local repo is able to reach it.  The simplest
URL is for a repo that is on the same machine, which can then use the &lt;em&gt;file&lt;/em&gt;
protocol: &lt;code&gt;file:///home/sitaram/path/to/repo.git&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;Anonymous access (read-only) repositories can be grabbed using the &lt;em&gt;git&lt;/em&gt;
protocol; for example, Linus Torvalds&#39; version of the current Linux kernel is
at &lt;code&gt;git://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux-2.6.git&lt;/code&gt;.
Read-only repos can also use the HTTP protocol, although this is not as
efficient for continuous use.&lt;/p&gt;

&lt;p&gt;A remote repository to which you have write access will almost certainly use
&lt;em&gt;ssh&lt;/em&gt; as the underlying authentication protocol, so the remote URL might look
like &lt;code&gt;ssh://sitaram@172.1.7.2/full/path/to/repo.git&lt;/code&gt;.&lt;/p&gt;

&lt;h4&gt;&lt;a name=&quot;naming_remote_repositories&quot;&gt;naming remote repositories&lt;/a&gt;&lt;/h4&gt;

&lt;p&gt;You can refer to, (or fetch from, and push to) many remote repos in &lt;em&gt;your&lt;/em&gt;
clone, because they all have different URLs.  After a while it gets
inconvenient to use the full URLs in your &lt;code&gt;git fetch&lt;/code&gt; and &lt;code&gt;git push&lt;/code&gt; commands,
so git allows you to give an easy to remember &quot;nickname&quot; for each &quot;remote&quot;.  I
could, for instance, do this:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;git remote add sejal ssh://sitaram@sejal.herlab.ourcompany.com/path/to/repo.git
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;After this I could refer to the longer URL by the shortname &quot;sejal&quot; and it
would be the same thing.&lt;/p&gt;

&lt;h5&gt;origin&lt;/h5&gt;

&lt;p&gt;So now you know what a nickname is, you can understand what &quot;origin&quot; means.
&quot;origin&quot; is just the default name given to the remote repository when you do a
&lt;code&gt;git clone&lt;/code&gt;.  So for example, if I do&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;git clone ssh://sitaram@sejal.herlab.ourcompany.com/path/to/repo.git
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;then, after the clone completes, git automatically creates a remote with the
nickname &lt;code&gt;origin&lt;/code&gt;, which points to
&lt;code&gt;ssh://sitaram@sejal.herlab.ourcompany.com/path/to/repo.git&lt;/code&gt;.  It&#39;s just a
convenience thing.  You can delete that nickname, you can rename it to
something else, etc., if you like.&lt;/p&gt;

&lt;h4&gt;&lt;a name=&quot;what_is_a_bare_repository_&quot;&gt;what is a &quot;bare&quot; repository?&lt;/a&gt;&lt;/h4&gt;

&lt;p&gt;This has been moved into it&#39;s &lt;a href=&quot;bare.html&quot;&gt;own page&lt;/a&gt; now.&lt;/p&gt;
&lt;/html&gt;
</pre>
</div>
<div title="reflog" modifier="Sitaram" created="201110051936">
<pre>
&lt;html&gt;
&lt;h1&gt;what the heck is a &lt;em&gt;reflog&lt;/em&gt; and why is it so important?&lt;/h1&gt;

&lt;h3&gt;what is it&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;a reflog is a very special &quot;branch&quot; that records each position of HEAD
in the last 30 days (by default). So removed branches won&#39;t be purged by
prune until after waiting for 30 days, when the last reference to them
will finally be released.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;reflog history is not shared -- it is exclusive to your repository.  This
is the only thing you lose if you clone a project as a means of performing
a backup.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h3&gt;how do I visualise it&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;the basic reflog commands are like this (the relative date is my
preference; see &lt;code&gt;git help log&lt;/code&gt; for other choices)&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;# activity on HEAD, including timestamp
git reflog show --date=relative
# same, on some_branch
git reflog show --date=relative some_branch
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;a good way to visualise the reflog is &lt;code&gt;git show-branch -g&lt;/code&gt; (or &lt;code&gt;-gN&lt;/code&gt;,
where N is some integer).  This shows reflog info for the branch specified
(defaulting to the current branch), including topological relationships
and relative time.  This is useful if you had a lot of rebases or amended
commits and you think you might need one of them back :-)&lt;/p&gt;

&lt;p&gt;It takes a little getting used to, so here&#39;re some hints:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;the top of each vertical line represents a prior position of HEAD (or
whatever branch you specified), with the latest one being the extreme
left column&lt;/li&gt;
&lt;li&gt;for each commit, the non-blank commit vertically below is its parent
commit (merge commits are represented by a &quot;-&quot; sign)&lt;/li&gt;
&lt;li&gt;so when you see a dip in the &quot;line of peaks&quot;, you know there was a
reset to something earlier followed by a new set of commits&lt;/li&gt;
&lt;li&gt;very likely, the top commit to the right of any such &quot;dip&quot; is probably
unreachable&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h3&gt;why would I need it&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;I particularly like setting&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;git config --global core.logAllRefUpdates true
git config --global receive.denyDeletes true
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;on bare repositories so that even if an over-zealous team member
force-pushes a bad revision, the reflog on the server will let me find the
previous (good) revisions easily&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;you can recover commits made on a detached head: see
&lt;a href=&quot;../concepts/detached-head.html#Auld_Lang_Syne&quot;&gt;this&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;you can fix a non-bare push: see
&lt;a href=&quot;../concepts/bare.html#how_do_I_fix_such_a_non_bare_push_&quot;&gt;this&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h3&gt;cool tricks&lt;/h3&gt;

&lt;p&gt;&lt;a href=&quot;../tools/git-reflogk&quot;&gt;Here&lt;/a&gt;&#39;s a neat tool that shows you reflog output but
using gitk -- the graphical viewer.  Don&#39;t knock it until you&#39;ve tried it :-)&lt;/p&gt;

&lt;hr /&gt;

&lt;p&gt;&lt;sup&gt;based on a comment in &lt;a href=&quot;http://blogs.gnome.org/newren/2007/11/24/local-caching-a-major-distinguishing-difference-between-vcses/&quot;&gt;http://blogs.gnome.org/newren/2007/11/24/local-caching-a-major-distinguishing-difference-between-vcses/&lt;/a&gt; &lt;/sup&gt;&lt;/p&gt;
&lt;/html&gt;
</pre>
</div>
<div title="uses-of-index" modifier="Sitaram" created="201110051936">
<pre>
&lt;html&gt;
&lt;h1&gt;&lt;a name=&quot;Why_the_index_staging_area_is_so_useful&quot;&gt;Why the index/staging area is so useful&lt;/a&gt;&lt;/h1&gt;

&lt;p&gt;&lt;sup&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#Why_the_index_staging_area_is_so_useful&quot;&gt;Why the index/staging area is so useful&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#what_is_the_index&quot;&gt;what is the index&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#staging_helps_you_split_up_one_large_change_into_multiple_commits&quot;&gt;staging helps you split up one large change into multiple commits&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#staging_helps_in_reviewing_changes&quot;&gt;staging helps in reviewing changes&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#staging_helps_when_a_merge_has_conflicts&quot;&gt;staging helps when a merge has conflicts&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#staging_helps_you_keep_extra_local_files_hanging_around&quot;&gt;staging helps you keep extra local files hanging around&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#staging_helps_you_sneak_in_small_changes_&quot;&gt;staging helps you sneak in small changes ;-)&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#a_word_of_warning_&quot;&gt;a word of warning...&lt;/a&gt;&lt;br&gt;&lt;/p&gt;

&lt;p&gt;[Also see &lt;a href=&quot;../tips/1-vc-habits.html&quot;&gt;good version control habits&lt;/a&gt; for more on
a related topic.]&lt;/p&gt;

&lt;p&gt;&lt;/sup&gt;&lt;/p&gt;

&lt;hr /&gt;

&lt;blockquote&gt;
  &lt;p&gt;Newcomers to git often ask why there is such a thing as the index, and
    what use is it.  They&#39;d rather just do &lt;code&gt;git add -A; git commit&lt;/code&gt; each time
    to avoid thinking about the index at all, because it seems like one extra
    (and needless) complication.&lt;/p&gt;

&lt;p&gt;So... what use is this, apart from confusing you with multiple names like
    index, staging area, and cache?&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h3&gt;&lt;a name=&quot;what_is_the_index&quot;&gt;what is the index&lt;/a&gt;&lt;/h3&gt;

&lt;p&gt;The index (or any of its other names) is essentially a &quot;holding area&quot; for
changes that will be committed when you next do &lt;code&gt;git commit&lt;/code&gt;.  That is, unlike
other VCSs, a &quot;commit&quot; operation does not simply take the current working tree
and check it as-is into the repository.  The index allows you to control what
parts of the working tree go into the repository on the next &quot;commit&quot;
operation.&lt;/p&gt;

&lt;p&gt;That should be sufficient background to appreciate (in abstract terms) the
following discussion.&lt;/p&gt;

&lt;h3&gt;&lt;a name=&quot;staging_helps_you_split_up_one_large_change_into_multiple_commits&quot;&gt;staging helps you split up one large change into multiple commits&lt;/a&gt;&lt;/h3&gt;

&lt;p&gt;Let&#39;s say you worked on a large-ish change, involving a lot of files and quite
a few different subtasks.  You didn&#39;t actually commit any of these -- you were
&quot;in the zone&quot;, as they say, and you didn&#39;t want to think about splitting up
the commits the right way just then.  (And you&#39;re smart enough not to make the
whole thing on honking big commit!)&lt;/p&gt;

&lt;p&gt;Now the change is all tested and working, you need to commit all this
properly, in several clean commits each focused on one aspect of the code
changes.&lt;/p&gt;

&lt;p&gt;With the index, just stage each set of changes and commit until no more
changes are pending.  Really works well with &lt;code&gt;git gui&lt;/code&gt; if you&#39;re into that
too, or you can use &lt;code&gt;git add -p&lt;/code&gt; or, with newer gits, &lt;code&gt;git add -e&lt;/code&gt;.&lt;/p&gt;

&lt;h3&gt;&lt;a name=&quot;staging_helps_in_reviewing_changes&quot;&gt;staging helps in reviewing changes&lt;/a&gt;&lt;/h3&gt;

&lt;p&gt;Staging helps you &quot;check off&quot; individual changes as you review a complex
commit, and to concentrate on the stuff that has not yet passed your review.
Let me explain.&lt;/p&gt;

&lt;p&gt;Before you commit, you&#39;ll probably review the whole change by using &lt;code&gt;git
diff&lt;/code&gt;.  If you stage each change as you review it, you&#39;ll find that you can
concentrate better on the changes that are not yet staged.&lt;/p&gt;

&lt;p&gt;&lt;code&gt;git gui&lt;/code&gt; is great here.  It&#39;s two left panes show unstaged and staged changes
respectively, and you can move files between those two panes
(stage/unstage) just by clicking on the icon to the left of the filename.&lt;/p&gt;

&lt;p&gt;Even better, you can even stage &lt;em&gt;partial changes&lt;/em&gt; to a file.  In the right
pane of &lt;code&gt;git gui&lt;/code&gt;, right click on a change that you approve of and choose
&quot;stage hunk&quot;.  &lt;em&gt;Just that change&lt;/em&gt; (not the entire file) is now staged; in
fact, if there are other, unstaged, changes in that same file, you&#39;ll find
that the file now appears on &lt;em&gt;both&lt;/em&gt; top and bottom left panes!&lt;/p&gt;

&lt;p&gt;&lt;sup&gt;[Do remember, however, that if the change is really complex maybe you should
split it into multiple commits!]&lt;/sup&gt;&lt;/p&gt;

&lt;h3&gt;&lt;a name=&quot;staging_helps_when_a_merge_has_conflicts&quot;&gt;staging helps when a merge has conflicts&lt;/a&gt;&lt;/h3&gt;

&lt;p&gt;When a merge happens, changes that merge cleanly are updated both in the
staging area as well as in your work tree.  Only changes that did not merge
cleanly (i.e., caused a conflict) will show up when you do a &lt;code&gt;git diff&lt;/code&gt;,
or in the top left pane of &lt;code&gt;git gui&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;Again, this lets you concentrate on the stuff that needs your attention -- the
merge conflicts.&lt;/p&gt;

&lt;h3&gt;&lt;a name=&quot;staging_helps_you_keep_extra_local_files_hanging_around&quot;&gt;staging helps you keep extra local files hanging around&lt;/a&gt;&lt;/h3&gt;

&lt;p&gt;Usually, files that should not be committed go into &lt;code&gt;.gitignore&lt;/code&gt; or the
local variant, &lt;code&gt;.git/info/exclude&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;However, sometimes you want a local change to a file that cannot be excluded
(which is not good practice but can happen sometimes).  For example, perhaps
you upgraded your build environment and it now requires an extra flag or
option for compatibility, but if you commit the change to the Makefile, the
other developers will have a problem.&lt;/p&gt;

&lt;p&gt;Of course you have to discuss with your team and work out a more permanent
solution, but right now, you &lt;em&gt;need&lt;/em&gt; that change in your working tree to do
&lt;em&gt;any&lt;/em&gt; work at all!&lt;/p&gt;

&lt;p&gt;Another situation could be that you want a new local file that is temporary,
and you don&#39;t want to bother with the ignore mechanism.  This may be some test
data, a log file or trace file, or a temporary shell script to automate some
test... whatever.&lt;/p&gt;

&lt;p&gt;In git, all you have to do is never to stage that file or that change.  That&#39;s
it.&lt;/p&gt;

&lt;h3&gt;&lt;a name=&quot;staging_helps_you_sneak_in_small_changes_&quot;&gt;staging helps you sneak in small changes ;-)&lt;/a&gt;&lt;/h3&gt;

&lt;p&gt;Let&#39;s say you&#39;re in the middle of a somewhat large-ish change and you are told
about a very important bug that needs to be fixed asap.&lt;/p&gt;

&lt;p&gt;The usual recommendation is to do this on a separate branch, but let&#39;s say
this fix is really just a line or two, and can be tested just as easily
without affecting your current work.&lt;/p&gt;

&lt;p&gt;With git, you can quickly make and commit &lt;em&gt;only that change&lt;/em&gt;, without
committing all the other stuff you&#39;re still working on.&lt;/p&gt;

&lt;p&gt;Again, if you use &lt;code&gt;git gui&lt;/code&gt;, whatever&#39;s on the bottom left pane gets
committed, so just make sure only that change gets there and commit, then
push!&lt;/p&gt;

&lt;h4&gt;&lt;a name=&quot;a_word_of_warning_&quot;&gt;a word of warning...&lt;/a&gt;&lt;/h4&gt;

&lt;p&gt;While the first 3 use cases are perfectly legitimate and useful uses of the
index, this last example could be dangerous if you get carried away.  You
might end up committing something that is not tested &lt;em&gt;exactly&lt;/em&gt;, because you
tested with the contents of the work tree, which is not the same as the index
that is being committed.&lt;/p&gt;

&lt;p&gt;Of course, using a powerful DVCS does not absolve you from the responsibility
of thinking :-)  So if you want to be 100% sure, there is a simple way to test
only the staged code:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;# stash away the changes to git-tracked files that you have not staged yet
git stash save --keep-index
# now do your tests on the exact stuff being committed
make; make test     # etc...
# when satisfied, commmit
git commit

# now bring the stashed changes back to continue normal work
git stash pop
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;If you need to understand how/why this works, &lt;a href=&quot;mailto:sitaramc@gmail.com&quot;&gt;ask
me&lt;/a&gt;, otherwise just use it and be happy :-)&lt;/p&gt;
&lt;/html&gt;
</pre>
</div>
<div title="grafting" modifier="Sitaram" created="200906302348">
<pre>
&lt;html&gt;
&lt;h1&gt;&lt;a name=&quot;gardening_tips_grafting_branches&quot;&gt;gardening tips -- grafting branches&lt;/a&gt;&lt;/h1&gt;

&lt;p&gt;&lt;sup&gt;[If you think the jokes are bad, you don&#39;t know me very well.  Clearly that
is &lt;em&gt;your&lt;/em&gt; fault, not mine :-)]&lt;/sup&gt;&lt;/p&gt;

&lt;p&gt;&lt;sup&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#gardening_tips_grafting_branches&quot;&gt;gardening tips -- grafting branches&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#connecting_two_unrelated_lines&quot;&gt;connecting two unrelated lines&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#breaking_a_line_into_two_&quot;&gt;breaking a line into two...&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#_and_joining_them_parallely_branch_merge_&quot;&gt;...and joining them parallely (branch + merge)&lt;/a&gt;&lt;br&gt;
&lt;/sup&gt;&lt;/p&gt;

&lt;hr /&gt;

&lt;p&gt;Even people who consider themselves really good gardeners shy away from
grafting.  Wikipedia says &quot;For successful grafting to take place, the vascular
cambium tissues of the stock and scion plants must be placed in contact with
each other. Both tissues must be kept alive until the graft has taken, usually
a period of a few weeks.&quot;  That sounds... difficult.&lt;/p&gt;

&lt;p&gt;Fortunately, Grum on IRC explained to me that all that is bunkum in git.  Git
has no issues with tissues, and if Linus had to wait a few weeks for a graft
to &quot;take&quot;, we&#39;d still be at kernel level 2.2 or something.&lt;/p&gt;

&lt;p&gt;So, here&#39;s the long and short of grafting in git.  Enjoy!  (And thank Grum
with a ++ next time you see him on #git!).&lt;/p&gt;

&lt;p&gt;Note: The following description will use the word &quot;line&quot; to mean &quot;a long chain
of commits with no branch or merge within it&quot;.  In &lt;code&gt;gitk --all&lt;/code&gt;, it is
literally a straight line.&lt;/p&gt;

&lt;h3&gt;&lt;a name=&quot;connecting_two_unrelated_lines&quot;&gt;connecting two unrelated lines&lt;/a&gt;&lt;/h3&gt;

&lt;p&gt;Let&#39;s say you have the following history, with two unrelated lines of
development (quite easily achieved by just fetching from some other repo that
has no common commits with yours!).&lt;/p&gt;

&lt;p&gt;&lt;sup&gt;(By the way, how can you tell they are unrelated?  Easy -- just look at the
break in the graph connector after &quot;a1&quot;!)&lt;/sup&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;$ git log --graph &#39;--pretty=tformat:%H %d %s %n&#39;  --all
* 891f2a69544779e7f61a6ae2c213a3c2dc2957b1  (refs/heads/a-m) a3
|
* 6a5b7c3ba50f91630f71aeaa36e2926ea6ad42f4  a2
|
* bb1cd6894bf5a073a80fb67575adb504539fca86  a1

* b2ccb766b20061124010877b5c22e69015e0d076  (refs/heads/master) b3
|
* adec8003a1c14984a8c39fc796c1ccbac27048e0  b2
|
* c5e268659a39921d87d6d50d6d3c6eccd12f4916  b1
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Suppose the two lines are actually of the same project, and you now want to
join them. You have decided that &quot;b1&quot; is the true root of the repository
(probably because that is the one that a couple of thousand people have
already cloned, and you can&#39;t change that chain ;-) and want to make the &quot;a&quot;
line a fork from the &quot;b&quot; line at the point &quot;b1&quot;.&lt;/p&gt;

&lt;p&gt;Just make a graft that says that &quot;b1&quot; is the parent of &quot;a1&quot;!  Of course you
have to use the full SHA1s, and this isn&#39;t one of the more user-friendly parts
of git, but:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;$ echo bb1cd6894bf5a073a80fb67575adb504539fca86 \
c5e268659a39921d87d6d50d6d3c6eccd12f4916 &amp;gt; .git/info/grafts
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;So now the repo looks like this:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;$ git log --graph &#39;--pretty=tformat:%H %d %s %n&#39; --all
* 891f2a69544779e7f61a6ae2c213a3c2dc2957b1  (refs/heads/a-m) a3
|
* 6a5b7c3ba50f91630f71aeaa36e2926ea6ad42f4  a2
|
* bb1cd6894bf5a073a80fb67575adb504539fca86  a1
|
| * b2ccb766b20061124010877b5c22e69015e0d076  (refs/heads/master) b3
| |
| * adec8003a1c14984a8c39fc796c1ccbac27048e0  b2
|/
|
* c5e268659a39921d87d6d50d6d3c6eccd12f4916  b1
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;So far so good.  You&#39;ve somehow made &quot;a1&quot; a child of &quot;b1&quot;, but there&#39;s
something not quite right -- the adoption has merely been recorded on a wee
bit of notepaper, called &lt;code&gt;.git/info/grafts&lt;/code&gt;.  That thing could get lost,
damaged, or whatever.  In fact, it won&#39;t even make it past a clone, leave
alone pushes and pulls.  You need to get a more formal adoption certificate,
on thick, strong, bond paper.  With the logo of the local something-or-other.
Maybe even laminated!&lt;/p&gt;

&lt;p&gt;Here&#39;s how to apply for one from the district magistrate&#39;s office:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;git filter-branch --tag-name-filter cat -- --all
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;And now the repo looks like this:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;$ git log --graph &#39;--pretty=tformat:%H %d %s %n&#39; master a-m
* b2ccb766b20061124010877b5c22e69015e0d076  (refs/heads/master) b3
|
* adec8003a1c14984a8c39fc796c1ccbac27048e0  b2
|
| * f34c278dd638a8ade860aafb47bd7a5c8d79865b  (refs/heads/a-m) a3
| |
| * 92a7be0c15b242c8204ba86a4b5191d1492b1dd4  a2
| |
| * 941e144b19e7b0fadbd3bedc295d4e1f2441ed79  a1
|/
|
* c5e268659a39921d87d6d50d6d3c6eccd12f4916  b1
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Observant people will note that the SHA1 hashes for all the &quot;a&quot; commits have
changed, which of course they will.  The SHA1 hash for a commit is derived
from all parent commits, the current tree for that commit, the commit message,
author/committor info, and the date/time.  Since the &lt;code&gt;filter-branch&lt;/code&gt; command
has made the relationship &lt;em&gt;permanent&lt;/em&gt;, the SHAs for the &quot;a&quot;s change.&lt;/p&gt;

&lt;p&gt;Even &lt;em&gt;more&lt;/em&gt; observant people will notice that in the previous diagram, the
&quot;a&quot;s are in a straight line and the &quot;b&quot;s are on a &quot;branch&quot;, while in the next
diagram they have switched places.  Topologically that&#39;s irrelevant, so don&#39;t
worry about it.&lt;/p&gt;

&lt;p&gt;&lt;sup&gt;
The &lt;em&gt;most&lt;/em&gt; observant people will notice that instead of &lt;code&gt;--all&lt;/code&gt; I have now
passed &lt;code&gt;master a-m&lt;/code&gt; (the actual branch names).  This is what you will see if
you do this with &lt;code&gt;--all&lt;/code&gt;:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;$ g log --graph &#39;--pretty=tformat:%H %d %s %n&#39;  --all
* f34c278dd638a8ade860aafb47bd7a5c8d79865b  (refs/heads/a-m) a3
|
* 92a7be0c15b242c8204ba86a4b5191d1492b1dd4  a2
|
* 941e144b19e7b0fadbd3bedc295d4e1f2441ed79  a1
|
| * b2ccb766b20061124010877b5c22e69015e0d076  (refs/heads/master) b3
| |
| * adec8003a1c14984a8c39fc796c1ccbac27048e0  b2
|/
|
| * 891f2a69544779e7f61a6ae2c213a3c2dc2957b1  (refs/original/refs/heads/a-m) a3
| |
| * 6a5b7c3ba50f91630f71aeaa36e2926ea6ad42f4  a2
| |
| * bb1cd6894bf5a073a80fb67575adb504539fca86  a1
|/
|
* c5e268659a39921d87d6d50d6d3c6eccd12f4916  b1
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;That&#39;s an artifact of the &lt;code&gt;filter-branch&lt;/code&gt; command and git&#39;s well-known
principle of making it very hard to lose data.  If you did not like the
filter-branch for some reason, you would just:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;git checkout a-m
git reset --hard original/refs/heads/a-m
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;But if everything worked out, and the new tree looks good, you would type,
&lt;strong&gt;very carefully&lt;/strong&gt;:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;rm -rf .git/refs/original/
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;That&#39;s it!
&lt;/sup&gt;&lt;/p&gt;

&lt;h3&gt;&lt;a name=&quot;breaking_a_line_into_two_&quot;&gt;breaking a line into two...&lt;/a&gt;&lt;/h3&gt;

&lt;p&gt;What other tricks can you get up to?&lt;/p&gt;

&lt;p&gt;How about taking this:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;$ g log --graph &#39;--pretty=tformat:%H %d %s %n&#39;  --all
* cb479e433d0fa639c5738f9b26c0cd5ca0d1e1e7  (refs/heads/master) a9
|
* 0f127260fff51ad71d092788d5630b6bf0c4764f  a8
|
* fb9c6ac521e99216d0202d54d03800e2ebd1d3a4  a7
|
* 8e48f4975469c9c9c5de644eb8eff1e165241b09  a6
|
* 6071135a250f9870aa8211eb871b4ac5d8e7e585  (refs/heads/branch) a5
|
* 179fb20ebbe3d9381b8944cc53c1ef0b893f431d  a4
|
* 891f2a69544779e7f61a6ae2c213a3c2dc2957b1  a3
|
* 6a5b7c3ba50f91630f71aeaa36e2926ea6ad42f4  a2
|
* bb1cd6894bf5a073a80fb67575adb504539fca86  a1
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;and turning it into this:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;$ g log --graph &#39;--pretty=tformat:%H %d %s %n&#39;  --all
* cb479e433d0fa639c5738f9b26c0cd5ca0d1e1e7  (refs/heads/master) a9 at Sat Apr 11 17:20:21 IST 2009
|
* 0f127260fff51ad71d092788d5630b6bf0c4764f  a8 at Sat Apr 11 17:20:19 IST 2009
|
* fb9c6ac521e99216d0202d54d03800e2ebd1d3a4  a7 at Sat Apr 11 17:20:17 IST 2009
|
* 8e48f4975469c9c9c5de644eb8eff1e165241b09  a6 at Sat Apr 11 17:20:15 IST 2009

* 6071135a250f9870aa8211eb871b4ac5d8e7e585  (refs/heads/branch) a5 at Sat Apr 11 17:20:13 IST 2009
|
* 179fb20ebbe3d9381b8944cc53c1ef0b893f431d  a4 at Sat Apr 11 17:20:11 IST 2009
|
* 891f2a69544779e7f61a6ae2c213a3c2dc2957b1  a3 at Sat Apr 11 16:21:44 IST 2009
|
* 6a5b7c3ba50f91630f71aeaa36e2926ea6ad42f4  a2 at Sat Apr 11 16:21:42 IST 2009
|
* bb1cd6894bf5a073a80fb67575adb504539fca86  a1 at Sat Apr 11 16:21:40 IST 2009
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;How?  Just:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;$ echo 8e48f4975469c9c9c5de644eb8eff1e165241b09 &amp;gt; .git/info/grafts
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;We&#39;ve made &quot;a6&quot; what is called a &quot;root&quot; commit -- it has no parent.  Of
course, if you do this without giving &quot;a5&quot; (&quot;a6&quot;&#39;s original parent) a proper
name, &quot;a5&quot; will become unreachable.  Which is why we gave it a name.&lt;/p&gt;

&lt;h3&gt;&lt;a name=&quot;_and_joining_them_parallely_branch_merge_&quot;&gt;...and joining them parallely (branch + merge)&lt;/a&gt;&lt;/h3&gt;

&lt;p&gt;Or how about not just breaking them and leaving them separate, but taking the
pieces and putting them &lt;em&gt;parallel&lt;/em&gt; to each other, with the tops and bottoms
joined:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;$ echo 6071135a250f9870aa8211eb871b4ac5d8e7e585 \
bb1cd6894bf5a073a80fb67575adb504539fca86 &amp;gt; .git/info/grafts

$ echo cb479e433d0fa639c5738f9b26c0cd5ca0d1e1e7 \
0f127260fff51ad71d092788d5630b6bf0c4764f \
179fb20ebbe3d9381b8944cc53c1ef0b893f431d &amp;gt;&amp;gt; .git/info/grafts

$ g log --graph &#39;--pretty=tformat:%H %d %s %n&#39;  --all
*   cb479e433d0fa639c5738f9b26c0cd5ca0d1e1e7  (refs/heads/master) a9
|\
| |
| * 179fb20ebbe3d9381b8944cc53c1ef0b893f431d  a4
| |
| * 891f2a69544779e7f61a6ae2c213a3c2dc2957b1  a3
| |
| * 6a5b7c3ba50f91630f71aeaa36e2926ea6ad42f4  a2
| |
* | 0f127260fff51ad71d092788d5630b6bf0c4764f  a8
| |
* | fb9c6ac521e99216d0202d54d03800e2ebd1d3a4  a7
| |
* | 8e48f4975469c9c9c5de644eb8eff1e165241b09  a6
| |
* | 6071135a250f9870aa8211eb871b4ac5d8e7e585  a5
|/
|
* bb1cd6894bf5a073a80fb67575adb504539fca86  a1
&lt;/code&gt;&lt;/pre&gt;

&lt;hr /&gt;

&lt;p&gt;They say gardening is the closest to playing God that God-fearing folks dare
to do :-)  Feel the power yet?&lt;/p&gt;
&lt;/html&gt;
</pre>
</div>
<div title="branches" modifier="Sitaram" created="200907090459">
<pre>
&lt;html&gt;
&lt;h1&gt;&lt;a name=&quot;all_about_branches_and_product_maintenance&quot;&gt;all about branches and product maintenance&lt;/a&gt;&lt;/h1&gt;

&lt;p&gt;&lt;sup&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#all_about_branches_and_product_maintenance&quot;&gt;all about branches and product maintenance&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#local_and_remote_branches&quot;&gt;local and remote branches&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#topic_branches&quot;&gt;topic branches&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#product_maintenance&quot;&gt;product maintenance&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#throwaway_integration_branches&quot;&gt;throwaway integration branches&lt;/a&gt;&lt;br&gt;
&lt;/sup&gt;&lt;/p&gt;

&lt;hr /&gt;

&lt;p&gt;&lt;sup&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;CVS/SVN folks -- please read this first&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;SVN and CVS treat a branch as another subdirectory of your project.
Conversely, you can also pretend a subdirectory is a branch.  In other words,
branches (and tags) share the same namespace as the subdirectories of your
project.&lt;/p&gt;

&lt;p&gt;This is not the right way to think of branches.  &lt;strong&gt;A branch is merely an
alternate reality for your project&lt;/strong&gt;.  That&#39;s the simplest way to put it.
Each commit is a &quot;snapshot&quot; of the state of your code at a certain point in
time, and each branch (consisting of a series of commits) represents a
different timeline than the other branches do.&lt;/p&gt;

&lt;p&gt;Thus, branches and subdirectories have &lt;em&gt;nothing&lt;/em&gt; to do with each other.&lt;/p&gt;

&lt;p&gt;&lt;/sup&gt;&lt;/p&gt;

&lt;hr /&gt;

&lt;h3&gt;&lt;a name=&quot;local_and_remote_branches&quot;&gt;local and remote branches&lt;/a&gt;&lt;/h3&gt;

&lt;p&gt;The git repository is really just a DAG (directed acyclic graph) of commits.
Each commits points to its parent or parents (merge commits have more than one
parent).  A branch in git is merely a pointer to some commit in the DAG.&lt;/p&gt;

&lt;p&gt;When you checkout a branch, git simply makes your working tree look like the
files that existed when that commit was made, and makes a note that this is
your &quot;current&quot; branch.  When you make a commit on top of this, git updates
this current branch to point to the new &quot;head&quot; commit.  This is conceptually
the same as adding a new item to a linked list and moving the &quot;head&quot; pointer
to the new item, if you remember your data structures course from many years
ago.&lt;/p&gt;

&lt;p&gt;A developer&#39;s repository will typically have several branches residing in it,
although of course only one is &quot;checked out&quot; at any given time into the
working tree.&lt;/p&gt;

&lt;p&gt;Apart from local branches (like &lt;code&gt;master&lt;/code&gt;, &lt;code&gt;next&lt;/code&gt;, and maybe &lt;code&gt;v1.2&lt;/code&gt;,
&lt;code&gt;some-new-feature&lt;/code&gt;), etc., you will also have a set of branches called
&lt;strong&gt;origin/branchname&lt;/strong&gt; (example: &lt;code&gt;origin/master&lt;/code&gt;).  These are &lt;em&gt;your copy&lt;/em&gt; of
the corresponding branch from the &quot;origin&quot; server.  You should &lt;a href=&quot;../concepts/detached-head.html&quot;&gt;never commit
to them directly&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;And the most important thing is, you can have any other branches you wish!  Go
wild -- no one will stop you, and it&#39;s quite difficult to lose data so have
fun!&lt;/p&gt;

&lt;h3&gt;&lt;a name=&quot;topic_branches&quot;&gt;topic branches&lt;/a&gt;&lt;/h3&gt;

&lt;p&gt;As you read about workflows in modern VCSs, you&#39;ll often hear about topic
branches. According to the &lt;a href=&quot;http://www.kernel.org/pub/software/scm/git/docs/gitglossary.html#def_topic_branch&quot;&gt;git
glossary&lt;/a&gt;,
a topic branch is:&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;em&gt;A regular git branch that is used by a developer to identify a conceptual
    line of development. Since branches are very easy and inexpensive, it is
    often desirable to have several small branches that each contain very well
    defined concepts or small incremental yet related changes.&lt;/em&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;A topic branch could represent any self-contained, pretty much
independent-of-others, line of development.  A specific bug, a new feature, a
refactor, a set of enhancements to a core feature, etc., can all be managed as
topics in their own right.&lt;/p&gt;

&lt;h3&gt;&lt;a name=&quot;product_maintenance&quot;&gt;product maintenance&lt;/a&gt;&lt;/h3&gt;

&lt;p&gt;Let&#39;s say your version tree looks like this:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;V3---o---o---o---o---o---V4---o---o--- (master)
 \                        \
  \---o---o--- (V3maint)   \
   \                        \---o---o--- (V4maint)
    \-o--- (topicA)          \
                              \-o--- (topicB)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;In this picture, V3 and V4 are tags representing specific versions.  V3maint
is a maintenance branch that collects ongoing fixes for V3.  These ongoing
fixes could come from commits within V3maint itself, or by integrating topic
branches such as topicA.  At various points in it&#39;s lifecycle, when things are
stable, the top commit on V3maint will be tagged V3.1, V3.2, etc., as needed.&lt;/p&gt;

&lt;p&gt;(...all this applies equivalently to V4 also, of course...)&lt;/p&gt;

&lt;p&gt;The &quot;master&quot; branch is where on-going development for the future V5 is
happening.  This &quot;new&quot; development may well have its own set of topic
branches, probably by feature name, but right now we&#39;ll concentrate on the
maintenance aspect of fixing bugs or making enhancements to the released
versions.&lt;/p&gt;

&lt;p&gt;The simplest way to manage the flow of patches and fixes is this:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;when a change is small enough to not need a topic branch, &lt;strong&gt;&lt;em&gt;commit it on
the oldest branch that needs the change&lt;/em&gt;&lt;/strong&gt;.  In this example, that could
be the V3maint or V4maint branch, depending on whether the issue affects
V3 or not.&lt;/p&gt;

&lt;p&gt;Note that you &lt;strong&gt;cannot commit on V3&lt;/strong&gt;.  V3 is a tag -- a tag represents a
&quot;fixed point&quot; in the commit hierarchy -- it&#39;s value can&#39;t change.  You can
only commit on a &quot;branch&quot;.  In C terms, a tag is a &lt;code&gt;const&lt;/code&gt; :-)&lt;/p&gt;

&lt;p&gt;Also, note that although V3maint is primarily an integration branch for
the topic branches pertaining to V3, in this case it is acting as a
&quot;catchall&quot; topic branch for commits that are too small to have their own
topics.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;for larger changes, create a topic branch by making a &lt;strong&gt;&lt;em&gt;fork at the
oldest branch that needs this change&lt;/em&gt;&lt;/strong&gt;.  For a bug that is applicable to
V4 but not to V3, you&#39;d fork a topic branch at V4.  On the other hand, if
the bug applies to V3 also, you&#39;d fork at V3.&lt;/p&gt;

&lt;p&gt;&lt;em&gt;Note&lt;/em&gt; that you&#39;re &lt;em&gt;not&lt;/em&gt; forking at V3maint or V4maint; you&#39;re forking at
V3 or V4.  See discussion in the previous bullet about V3maint&#39;s role.&lt;/p&gt;

&lt;p&gt;However, it may sometimes happen that the bug does not apply to V3 but
&lt;em&gt;only&lt;/em&gt; to V3maint (perhaps it&#39;s a bug that was caused by some previous fix
within the V3maint branch).  In that case, you must commit/fork it at the
current tip of V3maint.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Periodically &lt;strong&gt;&lt;em&gt;merge the older branches into newer ones&lt;/em&gt;&lt;/strong&gt; so the new
branches get the benefit of accumulated fixes and enhancements on the
older branches.  This means, for instance, that we merge V3maint, as well
as topic branches that forked from V3 (like topicA), into V4maint, and
then V4maint, (plus topics like topicB) into &quot;master&quot;, which is the future
V5, etc.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;The exception to these rules is if you have bugs on older versions that do not
apply to newer versions.  Merging fixes that are relevant &lt;em&gt;only&lt;/em&gt; to V3, into
the V4 branch, is meaningless, and may even get you conflicts.  The way to
deal with those is as follows:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;create a new branch called, say, V3only, forked from V3&lt;/li&gt;
&lt;li&gt;fixes that apply &lt;em&gt;only&lt;/em&gt; to V3 go on V3only&lt;/li&gt;
&lt;li&gt;fixes that apply &lt;em&gt;from&lt;/em&gt; V3, to all future versions, go on V3maint&lt;/li&gt;
&lt;li&gt;periodically, V3maint is merged into both V4maint as well as to V3only&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Note that V3only will never get merged into V4maint or V3maint, preserving the
condition that commits made in V3only are not picked up by the newer versions.&lt;/p&gt;

&lt;h3&gt;&lt;a name=&quot;throwaway_integration_branches&quot;&gt;throwaway integration branches&lt;/a&gt;&lt;/h3&gt;

&lt;p&gt;In all the above discussion, we kept saying &quot;merge X into Y&quot;.  Which is all
very well if things go fine, but how do you back out if something went wrong?&lt;/p&gt;

&lt;p&gt;The answer is something called a &quot;throwaway integration branch&quot;.&lt;/p&gt;

&lt;p&gt;We&#39;ll use an analogy to understand this.  Let&#39;s say you&#39;re writing a function
to insert a bunch of items into a linked list.  And let&#39;s say it&#39;s a complex
function, and at the start, you&#39;re not sure if it&#39;s going to succeed, and you
want the &quot;head&quot; pointer to be updated only if the whole thing succeeds.&lt;/p&gt;

&lt;p&gt;How would you deal with this?  You&#39;d make a temporary copy of the &quot;head&quot;
pointer, use that in your function, and if the function returns a success
value, you&#39;d update the real &quot;head&quot; pointer.  Conversely, if the function
returned an error, you would leave your real &quot;head&quot; pointer as it is and just
discard the temporary value.&lt;/p&gt;

&lt;p&gt;Git makes creating a new branch just as easy.  So instead of doing this:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;git checkout V4maint
git merge V3maint   # what if merge fails?
make test           # what if merge succeeds but tests fail?
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;where if either of the last 2 steps fail, you have to figure out how to get
back to the old V4, you do this instead:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;git branch -f test V4maint      # forcibly set test branch to V4
git checkout test               # and check it out
git merge V3maint
make test
# all good?
git branch -f V4maint test      # forcibly set V4maint to test
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;And of course if things didn&#39;t work out you would not do that last step,
preserving your V4maint at its previous revision.&lt;/p&gt;
&lt;/html&gt;
</pre>
</div>
<div title="detached-head" modifier="Sitaram" created="201110051936">
<pre>
&lt;html&gt;
&lt;h1&gt;&lt;a name=&quot;detached_HEAD_explained&quot;&gt;detached HEAD explained&lt;/a&gt;&lt;/h1&gt;

&lt;p&gt;&lt;sup&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#detached_HEAD_explained&quot;&gt;detached HEAD explained&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#the_analogy&quot;&gt;the analogy&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#reality_check&quot;&gt;reality check&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#re_attaching_the_HEAD&quot;&gt;re-attaching the HEAD&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#Auld_Lang_Syne&quot;&gt;Auld Lang Syne&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#reality_check_conclusion&quot;&gt;reality check -- conclusion&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#footnotes&quot;&gt;footnotes&lt;/a&gt;&lt;br&gt;&lt;/p&gt;

&lt;h2&gt;&lt;/sup&gt;&lt;/h2&gt;

&lt;p&gt;Git has something called a &#39;detached HEAD&#39; that bears some explanation.  You
are told &#39;do not commit on a detached HEAD&#39;, and it is not always clear what
or why this is.&lt;/p&gt;

&lt;hr /&gt;

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;This document is here for historical reasons, and because it
provides a nice analogy.  However, &lt;a href=&quot;../gcs/index.html&quot;&gt;Git for Computer Scientists (my
version)&lt;/a&gt; should be a much nicer read for most people.
Despite the name, it has very few mentions of linked lists, and no pseudo-code
at &lt;em&gt;all&lt;/em&gt;!  Instead, it has a lot of nice pictures, and it also touches upon
many other issues, not just on detached HEADs.  &lt;/font&gt;&lt;/p&gt;

&lt;h4&gt;&lt;a name=&quot;the_analogy&quot;&gt;the analogy&lt;/a&gt;&lt;/h4&gt;

&lt;p&gt;Forget git for a bit and think about linked lists from your data structures
course.  Specifically, consider a &lt;em&gt;singly linked&lt;/em&gt; list, where each node is
created as a &quot;child&quot; of some existing node, and contains a link to that
&quot;parent&quot; node.  &lt;font color=&quot;gray&quot;&gt;The words &quot;child&quot; and &quot;parent&quot; are chosen
to be similar to git&#39;s nomenclature for the relationship between a commit and
its predecessor commit(s).&lt;/font&gt;&lt;/p&gt;

&lt;p&gt;As with any list, you have a pointer to the node at the top of the list (we&#39;ll
call this pointer &lt;code&gt;list_top&lt;/code&gt;).  This would be the most recently created node,
and so there&#39;s a chain of &quot;parent&quot; links that can take you all the way to the
first node created.&lt;/p&gt;

&lt;p&gt;And you know how to add a new node to this linked list.  In pseudo-code:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;// insert a new node at &#39;list_top&#39;
temp = malloc(...);         // ask for some memory for the struct
temp.body = ...;            // fill in the node info
temp.parent = list_top;     // fill in the backlink
list_top = temp;            // move list head to new node
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Let&#39;s also assume that all list operations are done with some temporary
variable (that is, they never directly use &lt;code&gt;list_top&lt;/code&gt; etc.).&lt;/p&gt;

&lt;p&gt;Now suppose you &lt;em&gt;move&lt;/em&gt; to the grandparent of the current &lt;code&gt;list_top&lt;/code&gt;, to do
something (like examine that node, print it out, whatever):&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;temp = list_top;
temp = temp.parent;         // parent of list_top
temp = temp.parent;         // grandparent
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;So far, no harm done; your &lt;code&gt;list_top&lt;/code&gt; variable still points to the top of the
list, and you can always do &lt;code&gt;temp = list_top&lt;/code&gt; to go back to where you were for
any further operations.&lt;/p&gt;

&lt;p&gt;Now suppose you add a new node to the list on top of the &lt;em&gt;current node&lt;/em&gt;:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;// insert a new node at &#39;temp&#39;
temp2 = malloc(...);        // ask for some memory for the struct
temp2.body = ...;           // fill in the node info
temp2.parent = temp;        // fill in the backlink
temp = temp2;               // move list head to new node
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;This is the same code as before, except temp has taken the place of &lt;code&gt;list_top&lt;/code&gt;
this time.&lt;/p&gt;

&lt;p&gt;But &#39;temp&#39; is a temporary variable, and unless you somehow save its value
into some &#39;global&#39; (or &#39;static&#39;) variable, you risk losing that commit you
just made, oops, I mean the new node you added to the linked list :-)&lt;/p&gt;

&lt;h4&gt;&lt;a name=&quot;reality_check&quot;&gt;reality check&lt;/a&gt;&lt;/h4&gt;

&lt;p&gt;A previous version of this article took the analogy too far into git
territory, and I did not realise how many facts about git I had passed
over/simplified until an extended review on irc by &lt;em&gt;doener&lt;/em&gt; and &lt;em&gt;jsquared&lt;/em&gt;.&lt;/p&gt;

&lt;p&gt;So we&#39;ll &lt;em&gt;git real&lt;/em&gt;, if you&#39;ll pardon the weak pun, and get on with
understanding a &#39;detached HEAD&#39;.&lt;/p&gt;

&lt;p&gt;In git, commits always go on top of HEAD.  In terms of our linked list
analogy, they &#39;insert a new commit at HEAD&#39;.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;HEAD&lt;/strong&gt; is, normally, a symbolic reference to [the tip of] a branch.  For
instance, if you do &lt;code&gt;cat .git/HEAD&lt;/code&gt; on a brand new repository, you&#39;ll get back
&lt;code&gt;ref: refs/heads/master&lt;/code&gt;.  When you add a commit, git actually updates
&#39;master&#39;, because that&#39;s where HEAD points.  You can see this by doing &lt;code&gt;cat
.git/refs/heads/master&lt;/code&gt; before and after making a commit.  HEAD does not
change (it&#39;s only a symbolic reference) but &#39;master&#39; does.&lt;/p&gt;

&lt;p&gt;When you do a &lt;code&gt;git checkout branchname&lt;/code&gt;, HEAD will now become a symbolic
reference to &#39;branchname&#39;.  This means &lt;code&gt;cat .git/HEAD&lt;/code&gt; will return &lt;code&gt;ref:
refs/heads/branchname&lt;/code&gt; now.  New commits will now go on &#39;branchname&#39; instead
of master, and correspondingly, the contents of &lt;code&gt;.git/refs/heads/branchname&lt;/code&gt;
will change.&lt;/p&gt;

&lt;p&gt;However, when you checkout anything that is not a proper, local, branch name,
then HEAD is no longer a symbolic reference to anything.  Instead, it actually
contains the SHA-1 hash (the commit id) of the commit you are switching to.&lt;/p&gt;

&lt;p&gt;This is called a &lt;strong&gt;detached HEAD&lt;/strong&gt;.  Example commands that will cause your
HEAD to become detached (ouch!) are&lt;sup&gt;&lt;a href=&quot;#fn&quot;&gt;[1]&lt;/a&gt;&lt;/sup&gt;:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;git checkout master^        # parent of master
git checkout HEAD~2         # grandparent of current HEAD
git checkout origin/master  # a non-local branch
git checkout tagname        # since you cant commit to a tag!
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;These will all make &lt;code&gt;.git/HEAD&lt;/code&gt; contain the actual (40-hex-digit) hash of the
corresponding commit instead of some string like &lt;code&gt;ref: refs/heads/branch&lt;/code&gt;.&lt;/p&gt;

&lt;h5&gt;&lt;a name=&quot;re_attaching_the_HEAD&quot;&gt;re-attaching the HEAD&lt;/a&gt;&lt;/h5&gt;

&lt;p&gt;If you made the classic error of checking out a remote branch (like &lt;code&gt;git
checkout origin/master&lt;/code&gt;) and making a few commits on it before realising
something was wrong, you can recover quite easily:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;git checkout -b newbranch
# or, in 2 steps: git branch newbranch; git checkout newbranch
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;To go back to the linked list analogy way up there, you just created a new
&#39;global&#39; variable to save off the value of &#39;temp&#39; before some other operation
overwrote it.&lt;/p&gt;

&lt;h5&gt;&lt;a name=&quot;Auld_Lang_Syne&quot;&gt;Auld Lang Syne&lt;/a&gt;&lt;/h5&gt;

&lt;p&gt;What if you didn&#39;t realise this, and -- after making those commits -- blithely
switched to another branch:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;git checkout someoldbranch
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;HEAD is now a symbolic reference to &#39;someoldbranch&#39;, and its previous value
(the SHA-1 representing the top commit you made on the detached HEAD) has now
been overwritten.&lt;/p&gt;

&lt;p&gt;So is it gone for good now, never to be seen again?  Fortunately, no!  The
commit object itself is still safe out there somewhere, but you don&#39;t know
where!  You have to find it...&lt;/p&gt;

&lt;p&gt;Think back to these 2 lines in the analogy above, where the &#39;current node&#39; was
updated:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;list_top = temp;            // in the first example
temp = temp2;               // in the second example
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;What if you had some sort of wrapper around that line, such that, every time
this happened, the new value being assigned is also saved away somewhere,
including information on what command called it and when.  And let&#39;s say this
information is kept for 30 days.  So, even if you lost all your pointers, you
could check this saved list and the caller/time information to jog your memory
of which one it was, and actually use that pointer value to recover the node
you &#39;lost&#39;.&lt;/p&gt;

&lt;p&gt;That&#39;s the &#39;reflog&#39; in git:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;git reflog show HEAD@{now} -10

dcd215b... HEAD@{5 minutes ago}: commit (amend): 0-terminology: the malloc analogy added, plus
5ce8bfe... HEAD@{11 minutes ago}: commit: 0-terminology: the malloc analogy added, plus
3d93420... HEAD@{11 minutes ago}: rebase -i (pick): updating HEAD
7fdae94... HEAD@{11 minutes ago}: checkout: moving from master to 7fdae94815d6c676742c9984132b7b9e71a57f98
3d93420... HEAD@{13 minutes ago}: rebase -i (squash): updating HEAD
c55900c... HEAD@{13 minutes ago}: rebase -i (pick): updating HEAD
7fdae94... HEAD@{13 minutes ago}: checkout: moving from master to 7fdae94815d6c676742c9984132b7b9e71a57f98
e9955c8... HEAD@{14 minutes ago}: commit: s
97ab644... HEAD@{20 minutes ago}: commit: autogen
c55900c... HEAD@{23 minutes ago}: commit (amend): 0-terminology: the malloc analogy added, plus
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Now you look at this, decide which one you want, and grab it:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;git branch thank_God_its_safe 7fdae94
# like &#39;thank_God_its_safe = 0x7fdae94815d6c676742c9984132b7b9e71a57f98&#39;
git checkout thank_God_its_safe
&lt;/code&gt;&lt;/pre&gt;

&lt;h5&gt;&lt;a name=&quot;reality_check_conclusion&quot;&gt;reality check -- conclusion&lt;/a&gt;&lt;/h5&gt;

&lt;p&gt;There are a few other points that don&#39;t fit the simple &#39;linked list&#39; analogy,
or present some additional information that may be useful:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;a commit &#39;tree&#39; is really more of a graph.  A &#39;directed acyclic graph&#39;, to
be precise; see &lt;a href=&quot;../gcs/index.html&quot;&gt;here&lt;/a&gt; for more on this.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;a branch can point to any node in the graph, not just the top one.  For
example, when you fork a branch called &#39;new&#39; from &#39;master&#39;, and make 2
commits on &#39;new&#39;, then &#39;new&#39; is pointing to the top node in that portion
of the graph, but &#39;master&#39; is still pointing two commits down from the top
node.  This is because the &#39;master&#39; branch represents the same set of
commits it did before; we have done nothing to change that.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;while most commits have only one parent, a &#39;merge&#39; commit has more than
one parent.  Most merges have 2 parents, but an octopus merge can have any
number of parents.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;apart from the reflog for HEAD, git also stores a reflog for each local
branch (recording commits, rebases, merges, and so on) and each remote
branch (recording pulls/fetches mainly).  The HEAD reflog is effectively a
superset of the reflogs of all the local branches, with some extra detail
(like individual steps within a rebase, for instance).&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;hr /&gt;

&lt;h5&gt;&lt;a name=&quot;footnotes&quot;&gt;footnotes&lt;/a&gt;&lt;/h5&gt;

&lt;p&gt;&lt;a name=&quot;fn&quot;&gt;&lt;sup&gt;[1] Curiously, &lt;code&gt;git checkout master^0&lt;/code&gt; also gets you a detached HEAD.  The
command actually says &quot;switch to the commit that master currently points to&quot;.
Now you&#39;d think, since &#39;master&#39; and &#39;HEAD&#39; are currently pointing at the same
commit, it shouldn&#39;t be a detached HEAD, but the point is not that they happen
to be pointing to the same commit.  The point is that HEAD is no longer a
symbolic ref (containing something like &lt;code&gt;ref: refs/heads/master&lt;/code&gt;) and instead
contains an explicit SHA-1 in it.&lt;/sup&gt;&lt;/p&gt;
&lt;/html&gt;
</pre>
</div>
<div title="gj-archeology" modifier="Sitaram" created="200906302348">
<pre>
&lt;html&gt;
&lt;h1&gt;(from gitster.livejournal.com) the importance of archeology&lt;/h1&gt;

&lt;p&gt;...some quotes from &lt;a href=&quot;http://gitster.livejournal.com/9562.html&quot;&gt;http://gitster.livejournal.com/9562.html&lt;/a&gt; (part of
&lt;a href=&quot;http://gitster.livejournal.com/2007/09/02/&quot;&gt;http://gitster.livejournal.com/2007/09/02/&lt;/a&gt;)&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;Another important aspect of SCM is archaeology, and this is especially
    important after a project [...] accumulates a long history.  [...] in
    order to go forward, you need to be able to look back every once in a
    while.&lt;/p&gt;

&lt;p&gt;This is not &quot;learning from past mistakes&quot;.  That&#39;s bull.  I am not talking
    about failed experiments that did not pan out even from the beginning.
    The archaeology that is important is to gain better understanding of why
    things are the way they are in the current state.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;hr /&gt;

&lt;p&gt;Junio did not address this directly, but this is even more useful for &lt;em&gt;new&lt;/em&gt;
developers.&lt;/p&gt;

&lt;p&gt;It helps space out their learning of the system, instead of being overwhelmed
by having precisely one monolothic view of the project to look at in order to
learn it.&lt;/p&gt;
&lt;/html&gt;
</pre>
</div>
<div title="blame-detection-and-C-levels" modifier="Sitaram" created="200906302348">
<pre>
&lt;html&gt;
&lt;h1&gt;blame detection&lt;/h1&gt;

&lt;p&gt;Git tracks content, not files.  As a result, the &lt;code&gt;git blame&lt;/code&gt; and the
&lt;code&gt;git gui blame&lt;/code&gt; commands can detect code moved or copied from elsewhere in
the project.  It&#39;s a very powerful feature, accessed by specifying the
&lt;code&gt;-C&lt;/code&gt; flag one or more times, but there are some nuances.&lt;/p&gt;

&lt;h4&gt;move detection versus copy detection&lt;/h4&gt;

&lt;p&gt;When the &lt;code&gt;-C&lt;/code&gt; flag is given only once, it looks for code blocks that were
&lt;strong&gt;moved&lt;/strong&gt;.  That is, it searches for new code among other files that were also
modified in the same commit.  This runs very fast.&lt;/p&gt;

&lt;p&gt;When you give the flag &lt;strong&gt;twice&lt;/strong&gt;, it looks for new code among &lt;strong&gt;all&lt;/strong&gt; the
files in the parent commit, and so it detects code that was &lt;strong&gt;copied&lt;/strong&gt;.&lt;/p&gt;

&lt;p&gt;&lt;code&gt;git gui blame&lt;/code&gt; behaves like &lt;code&gt;-C -C&lt;/code&gt; by default, but can behave like &lt;code&gt;-C&lt;/code&gt; if
&lt;code&gt;gui.fastcopyblame&lt;/code&gt; is true.&lt;/p&gt;

&lt;h4&gt;threshold, and how to specify it&lt;/h4&gt;

&lt;p&gt;There is a concept of a &quot;threshold&quot;, which is the minimum number of
alphanumeric characters required to count something as a code move/copy -- be
sure to read under &lt;code&gt;-C&lt;/code&gt; in &lt;code&gt;man git-blame&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;This threshold defaults to 40 characters for copy detection, and 20 for move
detection.  You can override it by appending a number to the &lt;code&gt;-C&lt;/code&gt; option.&lt;/p&gt;

&lt;p&gt;&lt;code&gt;git gui blame&lt;/code&gt; defaults to 40 for this -- it actually sets &lt;code&gt;-C40&lt;/code&gt; and calls
(I assume) the command line blame tool.  If you want to override it, use the
GUI (Edit-&gt;Options), or directly set the &lt;code&gt;gui.copyblamethreshold&lt;/code&gt; config
variable.&lt;/p&gt;

&lt;h4&gt;documentation lacunae&lt;/h4&gt;

&lt;p&gt;The documentation does not seem to be very clear about the effect of &lt;em&gt;three&lt;/em&gt;
&lt;code&gt;-C&lt;/code&gt; options on &lt;code&gt;git blame&lt;/code&gt;.  (In the GUI this is done by choosing full copy
detection from the right click menu).&lt;/p&gt;

&lt;p&gt;The best hint is in &lt;code&gt;builtin-blame.c&lt;/code&gt;, which says, within a function called
&lt;code&gt;blame_copy_callback&lt;/code&gt;:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;/*
 * -C enables copy from removed files;
 * -C -C enables copy from existing files, but only
 *       when blaming a new file;
 * -C -C -C enables copy from existing files for
 *          everybody
 */
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Sidenote: correlating the single and double cases in the code with the
documentation, I imagine &quot;removed files&quot; actually means &quot;code from some other
modified file in the same commit&quot;, and similarly &quot;existing files&quot; means &quot;code
from any files in the parent commit&quot;.&lt;/p&gt;

&lt;h4&gt;my observations&lt;/h4&gt;

&lt;ul&gt;
&lt;li&gt;a very high threshold makes it behave like no &lt;code&gt;-C&lt;/code&gt; flags were supplied&lt;/li&gt;
&lt;/ul&gt;
&lt;/html&gt;
</pre>
</div>
<div title="git-pull--rebase" modifier="Sitaram" created="201110051936">
<pre>
&lt;html&gt;
&lt;h1&gt;what does &quot;git pull --rebase&quot; do?&lt;/h1&gt;

&lt;p&gt;[To understand this article you need to understand what a reflog is, and what
a rebase does, especially the full form of the rebase command]&lt;/p&gt;

&lt;p&gt;[My initial article was a little simplistic; more exact details added thanks
to doener!]&lt;/p&gt;

&lt;hr /&gt;

&lt;p&gt;Sometimes we have an upstream that rebased/rewound a branch we&#39;re depending
on.  This can be a big problem -- causing messy conflicts for us if we&#39;re
downstream.&lt;/p&gt;

&lt;p&gt;Without going into why they would do that, and how many beers (I prefer
rum+coke, thank you!) should be offered in compensation to downstream users,
let&#39;s just try and describe how git helps you deal with it.&lt;/p&gt;

&lt;p&gt;The magic is &lt;code&gt;git pull --rebase&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;A normal &lt;code&gt;git pull&lt;/code&gt; is, loosely speaking, something like this (we&#39;ll use a
remote called &lt;code&gt;origin&lt;/code&gt; and a branch called &lt;code&gt;foo&lt;/code&gt; in all these examples):&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;# assume current checked out branch is &quot;foo&quot;
git fetch origin
git merge origin/foo
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;At first glance, you might think that a &lt;code&gt;git pull --rebase&lt;/code&gt; does just this:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;git fetch origin
git rebase origin/foo
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;But that will not help if the upstream rebase involved any &quot;squashing&quot;
(meaning that the &lt;code&gt;patch-id&lt;/code&gt;s of the commits changed, not just their order).&lt;/p&gt;

&lt;p&gt;Which means &lt;code&gt;git pull --rebase&lt;/code&gt; has to do a little bit more than that.  Here&#39;s
an explanation of what it does and how.&lt;/p&gt;

&lt;p&gt;Let&#39;s say your starting point is this:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;a---b---c---d---e  (origin/foo) (also your local &quot;foo&quot;)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Time passes, and you have made some commits on top of your own &quot;foo&quot;:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;a---b---c---d---e---p---q---r (foo)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Meanwhile, in a fit of anti-social rage, the upstream maintainer has not only
rebased his &quot;foo&quot;, he even used a squash or two.  His commit chain now looks
like this:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;a---b+c---d+e---f  (origin/foo)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;A &lt;code&gt;git pull&lt;/code&gt; at this point would result in chaos.  Even a &lt;code&gt;git fetch; git
rebase origin/foo&lt;/code&gt; would not cut it, because commits &quot;b&quot; and &quot;c&quot; on one side,
and commit &quot;b+c&quot; on the other, would conflict.  (And similarly with d, e, and
d+e).&lt;/p&gt;

&lt;p&gt;What &lt;code&gt;git pull --rebase&lt;/code&gt; does, in this case, is:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;git fetch origin
git rebase --onto origin/foo e foo
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;This gives you:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;a---b+c---d+e---f---p---q---r (foo)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;You may still get conflicts, but they will be genuine conflicts (between p/q/r
and a/b+c/d+e/f), and not conflicts caused by b/c conflicting with b+c, etc.&lt;/p&gt;

&lt;hr /&gt;

&lt;p&gt;So how does this actually work?&lt;/p&gt;

&lt;p&gt;The command tries to find out which commits are &lt;em&gt;really&lt;/em&gt; your local ones, and
which had come from upstream in an earlier fetch.&lt;/p&gt;

&lt;p&gt;To do this, it looks at the reflog of the remote tracking branch
(&lt;code&gt;origin/foo&lt;/code&gt;, in this case).  This reflog represents the tips of successive
&lt;code&gt;git fetch&lt;/code&gt; operations on &lt;code&gt;origin&lt;/code&gt;, in &quot;most recent first&quot; order.&lt;/p&gt;

&lt;p&gt;For each reflog entry, (&lt;code&gt;origin/foo@{1}&lt;/code&gt;, then &lt;code&gt;...{2}&lt;/code&gt;, and so on) it checks
if that commit is an ancestor of the current branch head &lt;code&gt;foo&lt;/code&gt;.  As soon as it
finds one, it picks it as the starting point for the rebase (&lt;code&gt;e&lt;/code&gt; in the
example above).&lt;/p&gt;

&lt;p&gt;That might sound a little complicated, but it works out fine.  Just try it
next time your upstream rebases something on you.&lt;/p&gt;
&lt;/html&gt;
</pre>
</div>
<div title="git-over-proxy" modifier="Sitaram" created="201110051936">
<pre>
&lt;html&gt;
&lt;h1&gt;&lt;a name=&quot;How_to_use_git_over_an_HTTP_proxy_with_socat&quot;&gt;How to use git over an HTTP proxy, with socat&lt;/a&gt;&lt;/h1&gt;

&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#How_to_use_git_over_an_HTTP_proxy_with_socat&quot;&gt;How to use git over an HTTP proxy, with socat&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#a_word_about_socat&quot;&gt;a word about socat&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#proxying_the_git_protocol&quot;&gt;proxying the &lt;strong&gt;git&lt;/strong&gt; protocol&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#proxying_the_ssh_protocol&quot;&gt;proxying the &lt;strong&gt;ssh&lt;/strong&gt; protocol&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#ssh_proxy_using_corkscrew_instead_of_socat&quot;&gt;ssh proxy using corkscrew instead of socat&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#extra_coolness_for_github&quot;&gt;extra coolness for github&lt;/a&gt;&lt;br&gt;&lt;/p&gt;

&lt;p&gt;Corporate firewalls and proxy typically block both of these (and often a lot
more); here&#39;s how to get around them.  &lt;/p&gt;

&lt;p&gt;If you&#39;re tracking a public repo, you will need to use the &quot;git&quot; protocol,
because the &quot;http&quot; protocol is not very efficient, and/or requires some
special handling on the server side.  If you&#39;re pushing code to a public repo,
you &lt;strong&gt;definitely&lt;/strong&gt; need to use the &quot;ssh&quot; protocol.&lt;/p&gt;

&lt;h3&gt;&lt;a name=&quot;a_word_about_socat&quot;&gt;a word about socat&lt;/a&gt;&lt;/h3&gt;

&lt;p&gt;I will be using &quot;socat&quot;, an absolute corker of a program that does so many
things it&#39;s incredible!  Other people use corkscrew, ssh-https-tunnel, etc.,
which are all specialised for just one purpose.  I prefer socat, and once you
spend the 2-3 years :-) needed to read the man page, you will see why!&lt;/p&gt;

&lt;p&gt;The basic idea is that you will somehow invoke socat, which will negotiate
with the HTTP(S) proxy server using the CONNECT method to get you a clean pipe
to the server on the far side.&lt;/p&gt;

&lt;p&gt;However, do note that socat does have one disadvantage: the passwords to your
proxy server are visible in to local users running &lt;code&gt;ps -ef&lt;/code&gt; or something.
I don&#39;t care since I don&#39;t have anyone else logging into my desktop, and the
ability to use a program I already have anyway (socat) is more important.&lt;/p&gt;

&lt;h3&gt;&lt;a name=&quot;proxying_the_git_protocol&quot;&gt;proxying the &lt;strong&gt;git&lt;/strong&gt; protocol&lt;/a&gt;&lt;/h3&gt;

&lt;p&gt;When I want to download a public repo, I just type&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;proxied_git clone ...repo...
proxied_git pull
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;and so on, instead of&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;git clone ...repo...
git pull
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Here&#39;s the how and why of it.&lt;/p&gt;

&lt;p&gt;To proxy the git protocol, you need to export an environment variable
called &lt;code&gt;GIT_PROXY_COMMAND&lt;/code&gt;, which contains the command that is to be
invoked.  I have a shell function in my &lt;code&gt;.bashrc&lt;/code&gt; that looks like
this:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;proxied_git () 
( 
    export GIT_PROXY_COMMAND=/tmp/gitproxy;

    cat  &amp;gt; $GIT_PROXY_COMMAND &amp;lt;&amp;lt;EOF
#!/bin/bash
/usr/bin/socat - PROXY:172.25.149.2:\$1:\$2,proxyport=3128
EOF
    chmod +x $GIT_PROXY_COMMAND;

    git &quot;$@&quot;
)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Possible variations are:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;you could give &lt;code&gt;/tmp/gitproxy&lt;/code&gt; a more permanent name and remove the
middle pararaph completely.  I don&#39;t do this because that&#39;s too small a
file to bother with; it just seems cleaner this way)&lt;/li&gt;
&lt;li&gt;you could permanently set the environment variable if &lt;strong&gt;all&lt;/strong&gt; your git
repos are remote (very unlikely)&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;One thing you &lt;em&gt;cannot&lt;/em&gt; do is to roll the entire socat command into the
environment variable.  Git passes the host and port as two arguments to the
proxy command, but socat expects them in the syntax you see above, so you
&lt;em&gt;will&lt;/em&gt; need to wrap it in a script as I have done.  I guess you could argue
that this is a point in favour of corkscrew etc. ;-)&lt;/p&gt;

&lt;h3&gt;&lt;a name=&quot;proxying_the_ssh_protocol&quot;&gt;proxying the &lt;strong&gt;ssh&lt;/strong&gt; protocol&lt;/a&gt;&lt;/h3&gt;

&lt;p&gt;The git protocol is handled directly by git (duh!), but if you use the ssh
protocol, it invokes ssh explicitly (again, duh!).&lt;/p&gt;

&lt;p&gt;Ssh already has this sort of stuff built-in, so you simply add a few lines to
your &lt;code&gt;~/.ssh/config&lt;/code&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;host gh
    user git
    hostname github.com
    port 22
    proxycommand socat - PROXY:your.proxy.ip:%h:%p,proxyport=3128,proxyauth=user:pwd
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Now you can just say (for example):&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;git clone gh:sitaramc/git-notes.git
&lt;/code&gt;&lt;/pre&gt;

&lt;h4&gt;&lt;a name=&quot;ssh_proxy_using_corkscrew_instead_of_socat&quot;&gt;ssh proxy using corkscrew instead of socat&lt;/a&gt;&lt;/h4&gt;

&lt;ul&gt;
&lt;li&gt;download and install corkscrew (&lt;a href=&quot;http://www.agroman.net/corkscrew/&quot;&gt;http://www.agroman.net/corkscrew/&lt;/a&gt;)&lt;/li&gt;
&lt;li&gt;create a file (eg., ~/.ssh/myauth) and put your http proxy
username and password as &quot;username:password&quot; in it and save
it.&lt;/li&gt;
&lt;li&gt;&lt;p&gt;safeguard the file&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;chmod 600 ~/.ssh/myauth
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;open ~/.ssh/config and add the following entry, adding an explicit path to
corkscrew if needed.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;host gh
    user git
    hostname github.com
    port 22
    proxycommand corkscrew your.proxy.ip 3128 %h %p ~/.ssh/myauth
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h4&gt;&lt;a name=&quot;extra_coolness_for_github&quot;&gt;extra coolness for github&lt;/a&gt;&lt;/h4&gt;

&lt;p&gt;Noting that many corporate firewalls block access to the CONNECT method on
ports other than 443, the good folks at github have an ssh server listening on
443 if you use the host &quot;ssh.github.com&quot;, so you can replace the hostname and
the port in the above ssh config stanza as appropriate, and you&#39;re all set&lt;/p&gt;
&lt;/html&gt;
</pre>
</div>
<div title="create-on-push" modifier="Sitaram" created="201110051936">
<pre>
&lt;html&gt;
&lt;h1&gt;create on push&lt;/h1&gt;

&lt;p&gt;If you want to create a repo on a push, here&#39;s how you do it:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;put the following code somewhere on the server and make it executable.
Let&#39;s say you called it &lt;code&gt;/usr/local/bin/ac-grp&lt;/code&gt; (which stands for
auto-creating-git-receive-pack ;-)&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;#!/bin/bash

if [ ! -d $1 ]
then
    git init --bare $1
fi &amp;gt;&amp;amp;2
exec git-receive-pack &quot;$@&quot;
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;on the client side, instead of:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;git push user@host:reponame master
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;try&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;git push --receive-pack=/usr/local/bin/ac-grp user@host:reponame master
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;if you want to make this permanent, (and this is untested, so if you use
it and it works please let me know):&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;cd /usr/local/bin   # or wherever your git binaries are
mv git-receive-pack git-receive-pack.original
vim /usr/local/bin/ac-grp
    # and change the last line to refer to git-receive-pack.original
    # instead of git-receive-pack
mv ac-grp git-receive-pack
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/html&gt;
</pre>
</div>
<div title="1-vc-habits" modifier="Sitaram" created="200906302348">
<pre>
&lt;html&gt;
&lt;h1&gt;(not git-specific) version control habits of good developers&lt;/h1&gt;

&lt;p&gt;This article is based on &lt;a href=&quot;http://blog.bstpierre.org/version-control-habits&quot;&gt;http://blog.bstpierre.org/version-control-habits&lt;/a&gt; -- a
blog post that is well worth checking out, especially if you want more
details.  However, this article represents my priorities on this matter, and
most of the words are mine.&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;strong&gt;USE IT&lt;/strong&gt;!  If you don&#39;t use version control you should get out of the
software development profession!&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;strong&gt;check-in often&lt;/strong&gt;: check-in when some logical unit of work is done
(compiles OK after major changes, or some feature is complete, or some
test was passed, etc.).  &quot;going home for the day&quot; is NOT a logical unit of
work; ideally you should not treat the version control system as a &quot;backup
mechanism&quot;.  If you do this sort of time-based check-in, &quot;&lt;em&gt;the danger is
that if you have to revert because you&#39;ve made some disastrous changes,
you won&#39;t have a sane state to revert to&lt;/em&gt;.&quot;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;strong&gt;check-in bite sized chunks&lt;/strong&gt;: large check-ins are hard to review, and
harder to revert&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;if you check-in 20 &quot;logical units of work&quot; in one shot, and the 3rd and
the 14th are bad, you&#39;ll have to revert the entire check-in, remove
changes 3 and 14, and then check-in again.  If you checked them all in
separately, you can revert just the changes that were not acceptable,
while retaining all the other stuff&lt;/li&gt;
&lt;li&gt;if the &quot;feature&quot; is too large, create a branch and check-in locally&lt;/li&gt;
&lt;li&gt;however, check-ins should be &lt;strong&gt;atomic&lt;/strong&gt; -- for instance, a related
change in 2 &quot;.c&quot; files and a &quot;.h&quot; file should not become 3 check-ins if
those changes all depend on each other.&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;strong&gt;make sure you include everything that is needed to rebuild the
project&lt;/strong&gt;: (this is more for single-developer projects) since we don&#39;t
want to check-in binary files like executables and libraries, we normally
set up the VCS to ignore some files based on extension or whatever.  This
list has to be made carefully, and reviewed once in a while, otherwise
something that is important to the build may get left out!&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;in git, you can temporarily rename the .gitignore file and then do a
&quot;git status&quot; (or run &quot;git gui&quot;) to see the files that git is ignoring&lt;/li&gt;
&lt;li&gt;or you can clone the entire project into a new directory and see if it
compiles&lt;/li&gt;
&lt;li&gt;&lt;p&gt;or you can run:&lt;/p&gt;

&lt;p&gt;git ls-files --exclude-standard -o -i&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;strong&gt;take backups&lt;/strong&gt;!  Don&#39;t use the version control system as a backup
medium&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;strong&gt;keep &quot;data&quot; outside the &quot;source&quot; tree&lt;/strong&gt;: putting data in the same
directory as the source tree is a very bad practice, and in fact I expect
seasoned programmers who are reading this to go &quot;huh?  somebody actually
does stupid things like that?&quot; :-)  Small amounts of textual data used to
trigger specific tests are OK, and may even benefit from version control
in the sense that a test suite is an integral part of any software with
longevity.  But anything larger than that, and more so if they are binary
blobs, should NOT be in the repository.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;strong&gt;don&#39;t break the build&lt;/strong&gt;!&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;strong&gt;update (&quot;git pull&quot;) regularly&lt;/strong&gt;: otherwise, you risk a large effort in
resolving conflicts when you eventually do pull&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;strong&gt;write good check-in comments&lt;/strong&gt;: this helps people understand the
evolution of the project much better over a long period of time.  Don&#39;t
forget the second purpose of a VCS is annotation: who changed it, what did
they change, and &lt;strong&gt;why&lt;/strong&gt;?&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;strong&gt;use branches or holding areas&lt;/strong&gt;: branching and merging is cheap and
easy, and helps you keep things separate in your own mind too.  Having a
hierarchy of branches is very useful.  For instance:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&quot;master&quot; is what is pulled from/pushed to the repository, &quot;work&quot; is
where you do the day-to-day development, &quot;ut&quot; is where you unit test,
pulling specific commits from &quot;work&quot; for a build and a test, &quot;st-it&quot; is
for integration test/system test, and so on.&lt;/li&gt;
&lt;li&gt;in git, it&#39;s easy to use the &quot;gitk&quot; gui to pick individual changes from
another branch into the current one&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/html&gt;
</pre>
</div>
<div title="other-cool-stuff" modifier="Sitaram" created="200906302348">
<pre>
&lt;html&gt;
&lt;h1&gt;other cool stuff&lt;/h1&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;a href=&quot;http://www.kernel.org/pub/software/scm/git/docs/howto/rebase-from-internal-branch.txt&quot;&gt;http://www.kernel.org/pub/software/scm/git/docs/howto/rebase-from-internal-branch.txt&lt;/a&gt;
-- excellent article on rebase. This article is also available in the git
installs, at least on MDV.  We already knew git was smart about not
re-applying patches already applied, based on the SHA1 being in the chain.
But the &lt;strong&gt;really cool&lt;/strong&gt; thing about rebase is that it can ignore patches
even when they had a different SHA1 (in the same way that git cherry does,
by examining the changeset) which helps when your changes may have made it
into the master via email.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;strong&gt;cherry picking&lt;/strong&gt; -- another good reason to make small commits!&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;cherry picking while doing a rebase; &lt;code&gt;man git-rebase&lt;/code&gt; for details.  In
particular, you can rebase off of your own ancestor, to refactor a large
set of recent changes, like this:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;git rebase -i HEAD~10
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;You won&#39;t know how cool this is until you try it!&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Advantages of doing a rebase: doing a &lt;code&gt;git bisect&lt;/code&gt; on a merged chain
sometimes makes it difficult to find the specific commit that caused an
error.  See
&lt;a href=&quot;http://www.kernel.org/pub/software/scm/git/docs/user-manual.html#bisect-merges&quot;&gt;http://www.kernel.org/pub/software/scm/git/docs/user-manual.html#bisect-merges&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/html&gt;
</pre>
</div>
<div title="recover-dropped-stash" modifier="Sitaram" created="201110051936">
<pre>
&lt;html&gt;
&lt;h1&gt;recovering a dropped stash:&lt;/h1&gt;

&lt;h4&gt;the GUI way&lt;/h4&gt;

&lt;p&gt;You dropped a stash that was created recently, and now you want to recover it.
As long as you did not do a garbage collection in between, this should work:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;gitk $(git fsck | grep commit | cut -f3 -d&#39; &#39;) --since=&#39;1 week ago&#39;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;The part within the parenthesis finds all unreachable commit objects and
returns their hashes.  If you never did a garbage collect there might be too
many false positives so the &lt;code&gt;--since&lt;/code&gt; clause (which you can adjust to whatever
you want of course; mine is just an example) limits the display to commits
created recently.&lt;/p&gt;

&lt;p&gt;A &quot;stash&quot; has a very recognisable, triangular, shape in the commit DAG, and
with gitk you can visually find stashes really fast.  For me, this is the kind
of task that &lt;em&gt;calls out&lt;/em&gt; for a GUI -- infrequently required, no conceivable
need to automate, and containing data that stands out visually.&lt;/p&gt;

&lt;h4&gt;the command line way&lt;/h4&gt;

&lt;p&gt;Writing something longer than that for a problem that occurs once in a blue
moon is not my style (very low ROI!), but doener gave me this:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;git fsck --unreachable | grep commit | cut -d\  -f3 |
xargs git log --no-walk --merges --grep=&#39;^\(WIP on \|On \)\((no branch)\|[^ ]\+\):&#39;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;I knew about &lt;code&gt;--merges&lt;/code&gt; but not &lt;code&gt;--no-walk&lt;/code&gt;, and I anticipate using it a lot
more in future :-)&lt;/p&gt;
&lt;/html&gt;
</pre>
</div>
<div title="backing-up-wip" modifier="Sitaram" created="200906302348">
<pre>
&lt;html&gt;
&lt;h1&gt;backing up work in progress&lt;/h1&gt;

&lt;p&gt;This is how you can backup everything on your local repo that is not already
on one of your remotes, including all untracked files not covered by the
ignore mechanism.  I use a script based on this to save my work to a remote
server at regular intervals, in case of a disaster (hardware failure, etc) on
the regular desktop.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;# sort of like stash; untracked files also saved
git commit --allow-empty -m wip-index-state
git add -A &amp;amp;&amp;amp; git commit --allow-empty -m wip-worktree-state

# make a temp branch (FIXME: should we do this first?)
git branch wip-backup ||
    die &#39;could not create wip-backup branch; aborting&#39;;

# unstash
git reset --mixed HEAD^
git reset --soft HEAD^

# create the bundle and remove the temp branch
git bundle create /tmp/sos.bdl --all --not --remotes
git branch -D wip-backup

# copy that file wherever you want, however you want...
rsync /tmp/sos.bdl bkphost:   # or scp, or whatever
&lt;/code&gt;&lt;/pre&gt;
&lt;/html&gt;
</pre>
</div>
<div title="corruption" modifier="Sitaram" created="201110051936">
<pre>
&lt;html&gt;
&lt;h1&gt;corruption in a git repository&lt;/h1&gt;

&lt;p&gt;For now, this is just loosely formatted text, maybe like a series of case
studies.&lt;/p&gt;

&lt;p&gt;IMPORTANT NOTE: &lt;code&gt;git fsck --full&lt;/code&gt; is needed to reliably find repo corruption&lt;/p&gt;

&lt;h3&gt;case 1: Kolkata Korruption -- 2 missing tree objects&lt;/h3&gt;

&lt;p&gt;what finally worked:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;# on some good repo
TYPE=$(git cat-file -t $BADOBJSHA)
git cat-file $TYPE $BADOBJSHA &amp;gt; file

# copy file to bad repo
git hash-object -t $TYPE -w --stdin &amp;lt; file
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;However, this may not always work; it is not certain that hash-object will
&lt;em&gt;replace&lt;/em&gt; a corrupted object (as opposed to creating a &lt;em&gt;missing&lt;/em&gt; object).  So
try that, &lt;em&gt;as well as&lt;/em&gt; this (generic object):&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;# on some good repo
echo $object | git pack-objects --revs pack
# will create two files named pack-*.{idx,pack}
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;confirm:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;git verify-pack -v pack-*.idx | grep $object
# should also contain all sub objects
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;copy:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;pack* to $bad_repo/[.git?]/objects/pack
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;repack:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;repack -a -d
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;(you could also do &quot;unpack-objects&quot; I guess)&lt;/p&gt;
&lt;/html&gt;
</pre>
</div>
<div title="git-tasks" modifier="Sitaram" created="201110051936">
<pre>
&lt;html&gt;
&lt;h1&gt;&lt;a name=&quot;git_command_line_usage_cheatsheet_quickref&quot;&gt;git command-line usage cheatsheet/quickref&lt;/a&gt;&lt;/h1&gt;

&lt;p&gt;This document describes stuff that&#39;s not necessarily done every day.  The bare
minium stuff like &lt;code&gt;git add/commit/push/checkout/branch&lt;/code&gt; etc is not
covered.&lt;/p&gt;

&lt;hr /&gt;

&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#git_command_line_usage_cheatsheet_quickref&quot;&gt;git command-line usage cheatsheet/quickref&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#setting_up&quot;&gt;setting up&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#bash_aliases_for_git&quot;&gt;bash aliases for git&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#most_useful_stuff_in_HOME_gitconfig_&quot;&gt;most useful stuff in &lt;code&gt;$HOME/.gitconfig&lt;/code&gt;&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#stuff_you_tend_to_forget&quot;&gt;stuff you tend to forget&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#add_and_commit&quot;&gt;add and commit&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#push&quot;&gt;push&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#diff&quot;&gt;diff&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#conflicts_on_pull_merge&quot;&gt;conflicts on pull/merge&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#log_pickaxe_and_blame&quot;&gt;log pickaxe and blame&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#misc&quot;&gt;misc&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#_oopsies_recovering_from_mistakes_&quot;&gt;&lt;strong&gt;oopsies! (recovering from mistakes)&lt;/strong&gt;&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#useful_commands&quot;&gt;useful commands&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#grep&quot;&gt;grep&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#log_and_show&quot;&gt;log and show&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#reflog&quot;&gt;reflog&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#show_branch&quot;&gt;show-branch&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#cherry_not_cherry_pick_&quot;&gt;cherry (not cherry-pick)&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#cat_file_repo_object_and_ls_tree_tree_object_&quot;&gt;cat-file (repo object) and ls-tree (tree object)&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#ls_files&quot;&gt;ls-files&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#the_bleeding_edge&quot;&gt;the bleeding edge&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#git_bundle_lifesaver_for_disconnected_machines_&quot;&gt;git bundle -- lifesaver for disconnected machines!&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#making_an_independent_branch_in_an_existing_repo&quot;&gt;making an independent branch in an existing repo&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#garbage_collection&quot;&gt;garbage collection&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#remotes&quot;&gt;remotes&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#combining_and_splitting_commits&quot;&gt;combining and splitting commits&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#more_exploration&quot;&gt;more exploration&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#simulating_git_stash&quot;&gt;simulating git stash&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#startup_tips_for_CVSers&quot;&gt;startup tips for CVSers&lt;/a&gt;&lt;br&gt;&lt;/p&gt;

&lt;h3&gt;&lt;a name=&quot;setting_up&quot;&gt;setting up&lt;/a&gt;&lt;/h3&gt;

&lt;p&gt;I &lt;strong&gt;strongly&lt;/strong&gt; recommend these settings to make life easier.&lt;/p&gt;

&lt;h4&gt;&lt;a name=&quot;bash_aliases_for_git&quot;&gt;bash aliases for git&lt;/a&gt;&lt;/h4&gt;

&lt;pre&gt;&lt;code&gt;alias g=&#39;git --no-pager&#39;
alias gp=&#39;git -p&#39;
alias mg=&#39;git help&#39;
&lt;/code&gt;&lt;/pre&gt;

&lt;h4&gt;&lt;a name=&quot;most_useful_stuff_in_HOME_gitconfig_&quot;&gt;most useful stuff in &lt;code&gt;$HOME/.gitconfig&lt;/code&gt;&lt;/a&gt;&lt;/h4&gt;

&lt;p&gt;My &lt;code&gt;.gitconfig&lt;/code&gt; is &lt;a href=&quot;../tools/my.gitconfig.txt&quot;&gt;here&lt;/a&gt;.  Parts of this
document assume some of these aliases.&lt;/p&gt;

&lt;h3&gt;&lt;a name=&quot;stuff_you_tend_to_forget&quot;&gt;stuff you tend to forget&lt;/a&gt;&lt;/h3&gt;

&lt;h4&gt;&lt;a name=&quot;add_and_commit&quot;&gt;add and commit&lt;/a&gt;&lt;/h4&gt;

&lt;pre&gt;&lt;code&gt;# stage updates/deletes for files git already knows about
git add -u  [paths...]
# ditto for ALL files, including new ones
git add -A

# stage updates/deletes for files git already knows about AND COMMIT
git commit -a
&lt;/code&gt;&lt;/pre&gt;

&lt;h4&gt;&lt;a name=&quot;push&quot;&gt;push&lt;/a&gt;&lt;/h4&gt;

&lt;ul&gt;
&lt;li&gt;don&#39;t forget to &lt;code&gt;git push --tags&lt;/code&gt; when needed&lt;/li&gt;
&lt;/ul&gt;

&lt;h4&gt;&lt;a name=&quot;diff&quot;&gt;diff&lt;/a&gt;&lt;/h4&gt;

&lt;pre&gt;&lt;code&gt;# diff between work area and stage
git diff
# diff between work area and repo (CVS model)
# note that &quot;git diff&quot; + &quot;git diff --cached&quot; == &quot;git diff HEAD&quot;
git diff HEAD
# other coolness
git diff &quot;@{yesterday}&quot;
&lt;/code&gt;&lt;/pre&gt;

&lt;h4&gt;&lt;a name=&quot;conflicts_on_pull_merge&quot;&gt;conflicts on pull/merge&lt;/a&gt;&lt;/h4&gt;

&lt;ul&gt;
&lt;li&gt;try &lt;code&gt;gitk --merge conflicted_path&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;git diff MERGE_HEAD...HEAD&lt;/code&gt; (note the &lt;em&gt;three&lt;/em&gt; dots) shows you
differences between the common ancestor and your HEAD.&lt;/li&gt;
&lt;li&gt;similarly &lt;code&gt;git diff HEAD...MERGE_HEAD&lt;/code&gt; shows you differences between
the common ancestor and the branch you&#39;re trying to merge&lt;/li&gt;
&lt;li&gt;&lt;code&gt;git checkout --conflict=diff3 conflicted_path&lt;/code&gt; is a novel way of
getting all 3 versions into the file so you can hack at it in vim&lt;/li&gt;
&lt;li&gt;&lt;p&gt;you can tell git blame to only show important changes, like so (pity it
does not work with the GUI blame)&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;git blame -C $(git merge-base HEAD MERGE_HEAD).. conflicted_path
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h4&gt;&lt;a name=&quot;log_pickaxe_and_blame&quot;&gt;log pickaxe and blame&lt;/a&gt;&lt;/h4&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;finding out when a particular change happened or who made it&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;git log -S&quot;some code line&quot; file.c   # why is this called pickaxe search?
git blame -b file.c
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h4&gt;&lt;a name=&quot;misc&quot;&gt;misc&lt;/a&gt;&lt;/h4&gt;

&lt;ul&gt;
&lt;li&gt;&lt;code&gt;ORIG_HEAD&lt;/code&gt;: pull or merge (or anything that moves HEAD drastically)
leave a copy of the old head with this name.  Reset can use it if needed.
(see &lt;code&gt;man git-reset&lt;/code&gt;).  &lt;code&gt;reset&lt;/code&gt; itself copies the old &lt;code&gt;HEAD&lt;/code&gt;
to &lt;code&gt;ORIG_HEAD&lt;/code&gt;, though that seems less useful&lt;/li&gt;
&lt;li&gt;&lt;code&gt;FETCH_HEAD&lt;/code&gt;: records the branch you fetched from a remote repository
with your last &#39;git-fetch&#39; invocation&lt;/li&gt;
&lt;li&gt;&lt;code&gt;MERGE_HEAD&lt;/code&gt; records the commit(s) you are merging into your branch
when you run &#39;git-merge&#39;&lt;/li&gt;
&lt;/ul&gt;

&lt;h4&gt;&lt;a name=&quot;_oopsies_recovering_from_mistakes_&quot;&gt;&lt;strong&gt;oopsies! (recovering from mistakes)&lt;/strong&gt;&lt;/a&gt;&lt;/h4&gt;

&lt;p&gt;The following are useful to undo &lt;strong&gt;before a commit&lt;/strong&gt;.  Note that these usages
of &quot;checkout&quot; (with &lt;strong&gt;specific&lt;/strong&gt; files/paths) do not result in switching
branches but in updating the files/paths given.&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;bad working copy, want to make working &amp;lt;= staged&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;git checkout -- filename
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;bad working copy, want to make working &amp;lt;= HEAD&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;git checkout HEAD -- filename
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;bad staged version, want to make staged &amp;lt;= HEAD (working copy is not
touched)&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;git reset HEAD -- filename
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;When things get worse, and it&#39;s not just a few files that were screwed up, use
this&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;throw away all local changes and make working, staged &amp;lt;= HEAD&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;git checkout -f
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;The following are useful to undo &lt;strong&gt;after a commit&lt;/strong&gt;, as long as you haven&#39;t
published or pushed the commit elsewhere:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;screwed up commit?  hope no one else pulled your last commit, quickly fix
the source, and then&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;git commit -a --amend
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;bad commit? apply a reversed patch as an additional commit on top&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;git revert HEAD^    # one revision ago
git revert &quot;@{1 hour ago}&quot;
git revert &quot;@{5}&quot;   # 5th last saved state, from reflog
    # this may not be the 5th last revision if there were resets in
    # between.
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;commit is so bad you want to roll back time?&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;git reset --hard HEAD~5 # 5th last revision
    # a reset rolls back the log, but is still recorded in the reflog,
    # which gets expired after some 30 to 90 days.
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h3&gt;&lt;a name=&quot;useful_commands&quot;&gt;useful commands&lt;/a&gt;&lt;/h3&gt;

&lt;h4&gt;&lt;a name=&quot;grep&quot;&gt;grep&lt;/a&gt;&lt;/h4&gt;

&lt;p&gt;&lt;code&gt;git grep&lt;/code&gt; is very, &lt;em&gt;*very&lt;/em&gt;, powerful.  It has pretty much all the normal grep
options, plus:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;doesn&#39;t search files that are not revisioned (untracked, excluded/ignored,
etc)&lt;/li&gt;
&lt;li&gt;with &lt;code&gt;--cached&lt;/code&gt;, looks only in the cache&lt;/li&gt;
&lt;li&gt;with one or more ref names, searched only within those revisions&lt;/li&gt;
&lt;li&gt;can take a pattern, like &lt;code&gt;*.c&lt;/code&gt;, to restrict the files searched&lt;/li&gt;
&lt;li&gt;&lt;p&gt;can do &lt;code&gt;--and&lt;/code&gt;, &lt;code&gt;--or&lt;/code&gt;, &lt;code&gt;--not&lt;/code&gt;, etc with patterns.  This is a pretty big
wow.  As &lt;a href=&quot;http://gitster.livejournal.com/27674.html&quot;&gt;http://gitster.livejournal.com/27674.html&lt;/a&gt; says:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;git grep -e &#39;;;&#39; --and --not -e &#39;for *(.*;;&#39; -- &#39;*.c&#39;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;which searches for &#39;;;&#39; in all C files, unless they occur in a typical
&lt;code&gt;for (;;) {&lt;/code&gt; type of construct.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;finally, there&#39;s a somewhat gratuitously thrown in &lt;code&gt;--all-match&lt;/code&gt; option,
which says &quot;match any of these strings, but print matches only from files
that have &lt;em&gt;all&lt;/em&gt; of them&quot;.  I wonder whose scratch that was... ;-)&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h4&gt;&lt;a name=&quot;log_and_show&quot;&gt;log and show&lt;/a&gt;&lt;/h4&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;git lga&lt;/code&gt; is pretty cool; lga is an alias in my config for&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;log --graph --pretty=oneline --abbrev-commit --decorate --all
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Check the logs to see what&#39;s happened recently&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;git log [--stat] -[p] [-n &amp;lt;number of commits to show&amp;gt;]
git log &quot;@{yesterday}..&quot;
    # note the suffix &quot;..&quot;, since the default is prefix &quot;..&quot;, which is
    # probably not what you want
git log somefile.c
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;git show&lt;/code&gt; is almost an alias for &lt;code&gt;git log -p -n 1&lt;/code&gt;.  In general,
&lt;code&gt;git show&lt;/code&gt; does the right thing: shows a commit as a commit, a tree as
a plain &quot;ls&quot;, etc.  But if you&#39;re printing a large blob you better use a
pager or redirect!&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;git show [ HEAD^ | HEAD^^ | HEAD@{3} | origin | origin/master | etc ]
git show 7a8b9c     # or some hex number; shows you the object
git show HEAD~3:file.c  # get file.c from 3 versions back
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h4&gt;&lt;a name=&quot;reflog&quot;&gt;reflog&lt;/a&gt;&lt;/h4&gt;

&lt;p&gt;...see this more detailed &lt;a href=&quot;../concepts/reflog.html&quot;&gt;note&lt;/a&gt;&lt;/p&gt;

&lt;h4&gt;&lt;a name=&quot;show_branch&quot;&gt;show-branch&lt;/a&gt;&lt;/h4&gt;

&lt;ul&gt;
&lt;li&gt;&lt;code&gt;git show-branch -a&lt;/code&gt; is useful to get a bird&#39;s eye view of all your
branches and their topological relationships.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;git show-branch -gN&lt;/code&gt; (N is some number) shows you reflog info for the
current branch, including topological relationships and relative time.
This is useful if you had a lot of rebases or amended commits and you
think you might need one of them back :-)  See
&lt;a href=&quot;../concepts/reflog.html&quot;&gt;reflog&lt;/a&gt; for more on this&lt;/li&gt;
&lt;li&gt;&lt;p&gt;if you need serious troubleshooting with branches, use the following.  It
may be useful in some contexts where &lt;code&gt;git lg&lt;/code&gt; is too complex to figure
out what tip contains what commit, and you are unable to use gitk&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;git show-branch $(git show-ref -h |cut -c41-)
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h4&gt;&lt;a name=&quot;cherry_not_cherry_pick_&quot;&gt;cherry (not cherry-pick)&lt;/a&gt;&lt;/h4&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;summary: &lt;code&gt;+&lt;/code&gt; shows you commits you have that the &#39;upstream&#39; doesn&#39;t&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;git cherry -v upstream [head]
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;detail: for every commit in &#39;head&#39; that doesn&#39;t exist in &#39;upstream&#39;&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;prefix &lt;code&gt;-&lt;/code&gt; if there is at least an &lt;em&gt;equivalent&lt;/em&gt; commit&lt;/li&gt;
&lt;li&gt;prefix &lt;code&gt;+&lt;/code&gt; if there&#39;s not even that&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;TIP: if you&#39;re trying to cut some branches (like &lt;code&gt;git branch --merged&lt;/code&gt;)&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;put the candidate to be cut &lt;strong&gt;on the right side&lt;/strong&gt;, and&lt;/li&gt;
&lt;li&gt;make sure there are no &lt;code&gt;+&lt;/code&gt;s in the output&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h4&gt;&lt;a name=&quot;cat_file_repo_object_and_ls_tree_tree_object_&quot;&gt;cat-file (repo object) and ls-tree (tree object)&lt;/a&gt;&lt;/h4&gt;

&lt;p&gt;Note: I&#39;m not sure what, if any, is the difference between &lt;code&gt;show&lt;/code&gt; and
&lt;code&gt;cat-file -p&lt;/code&gt; for &quot;blob&quot; objects.  For commits there is a subtle
difference.  (Try it)&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;# any object
git cat-file [ -t | -s | -p ] 789abc
    # find the type or size of an object, or pretty print it
    # If it&#39;s a blob, I&#39;d use use &quot;git show&quot; until we find out what
    # &quot;pretty&quot; means for arbitrary blobs :-)
git cat-file blob 789abc        # cat the object

# any tree
git ls-tree         # files and directories, top level only
git ls-tree -l      # also show the size of the object
git ls-tree -d      # only directories
git ls-tree -r      # recurse, only files
git ls-tree -r -d   # recurse, only directories
git ls-tree -r -t   # recurse, both directories and files
&lt;/code&gt;&lt;/pre&gt;

&lt;h4&gt;&lt;a name=&quot;ls_files&quot;&gt;ls-files&lt;/a&gt;&lt;/h4&gt;

&lt;p&gt;To get listings of various types of files, use &lt;code&gt;git ls-files&lt;/code&gt;.  The common
but less intuitive ones are shown here, the rest can be had from the man page:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;# deleted files and modified files (deleted files are also counted as
# modified, so may come up twice...
git ls-files -d -m
# what&#39;s in the index; includes files that were &quot;git add&quot;ed
git ls-files -s
# conflicted files
git ls-files -u
# &quot;other files&quot;; includes EVERYthing not in d/m/s, I think
# seems to be equal to untracked + ignored
git ls-files -o
# untracked files only
git ls-files --exclude-standard -o
# ignored files only
git ls-files --exclude-standard -o -i
&lt;/code&gt;&lt;/pre&gt;

&lt;h3&gt;&lt;a name=&quot;the_bleeding_edge&quot;&gt;the bleeding edge&lt;/a&gt;&lt;/h3&gt;

&lt;h4&gt;&lt;a name=&quot;git_bundle_lifesaver_for_disconnected_machines_&quot;&gt;git bundle -- lifesaver for disconnected machines!&lt;/a&gt;&lt;/h4&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;really awesome, but be careful, not all refspecs will work on the
receiving side.  Assuming we&#39;re talking about a normal &quot;origin&quot; pull for
an existing clone, this is what you do&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;# sending side
git bundle create ~/junk HEAD^^^..
    # or say &quot;254c8de..&quot;, assuming the receiving side has that hash)
# receiving side
git ls-remote ~/junk    # note the refs on the right side
git fetch ~/junk HEAD   # one of the refs that showed up
# now merge it wherever you want
git merge FETCH_HEAD
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;to clone a repo using this method:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;# sending side: cd to repo and checkout the master or whatever, then:
git bundle create ~/junk HEAD
# receiving side: mkdir/cd some empty directory, then:
git init; git pull ~/junk
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h4&gt;&lt;a name=&quot;making_an_independent_branch_in_an_existing_repo&quot;&gt;making an independent branch in an existing repo&lt;/a&gt;&lt;/h4&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;based on
&lt;a href=&quot;http://madduck.net/blog/2007.07.11:creating-a-git-branch-without-ancestry/&quot;&gt;http://madduck.net/blog/2007.07.11:creating-a-git-branch-without-ancestry/&lt;/a&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;# ensure all changes are committed
git status
# ensure even ignored files aren&#39;t present, or you don&#39;t care
git ls-files --exclude-standard -o -i

# WARNING -- IF THE ABOVE COMMANDS SHOW ANY USEFUL FILES,
#               STOP HERE!

# create an empty tree -- choose one of these options
# if you&#39;re sure you have no dot-files
rm -rf *
# if your tree may have dot files...
git rm -r .; git clean -fdx

# remove the index
rm .git/index

# point HEAD to the new branchname, whatever it is
git symbolic-ref HEAD refs/heads/indbr

# create some files, add, commit
touch empty
git add .
git commit -m &quot;first commit of independent branch&quot;
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h4&gt;&lt;a name=&quot;garbage_collection&quot;&gt;garbage collection&lt;/a&gt;&lt;/h4&gt;

&lt;ul&gt;
&lt;li&gt;Warning: &lt;code&gt;git gc --prune&lt;/code&gt; is dangerous if others may be pushing to the
repo at the same time!&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Warning: &lt;code&gt;git gc&lt;/code&gt; may &lt;strong&gt;increase&lt;/strong&gt; the space used, since it even
unpacks objects that were in packs if they became unreachable.  This is
the same thing as &lt;code&gt;git repack -Adf&lt;/code&gt; (note the uppercase &quot;A&quot;)&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;To bring the repo size down the bare minimum, you need &lt;em&gt;both&lt;/em&gt; the
following commands (neither command by itself does the whole job).  Also
Note the lowercase &quot;a&quot; on the &quot;repack&quot;, which says you want to blindly
discard unreachable objects instead of keeping them as loose objects.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;git repack -adf     # kills in-pack garbage
git prune           # kills loose garbage
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;(from the do-you-really-want-to-do-this? department)&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;git reflog expire --expire=10days --all
# use expire-unreachable to limit it a bit
# use branchname(s) instead of --all
# units can be seconds, minutes, etc
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h4&gt;&lt;a name=&quot;remotes&quot;&gt;remotes&lt;/a&gt;&lt;/h4&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;how do you find out how many remotes you have and what they are called?&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;vim .git/config                         # or...
git remote | map git remote [-n] show   # even better!
    # use -n to prevent lookup if needed
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h4&gt;&lt;a name=&quot;combining_and_splitting_commits&quot;&gt;combining and splitting commits&lt;/a&gt;&lt;/h4&gt;

&lt;ul&gt;
&lt;li&gt;to split the top commit into multiple commits
&lt;ul&gt;
&lt;li&gt;start &lt;code&gt;git gui&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;choose &quot;amend last commit&quot; from the commit menu&lt;/li&gt;
&lt;li&gt;unstage all files&lt;/li&gt;
&lt;li&gt;pick files or hunks in files to stage and commit&lt;/li&gt;
&lt;li&gt;continue until all changes are committed&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;same as above, but the commit to split is not the top one
&lt;ul&gt;
&lt;li&gt;start an interactive rebase that includes that commit&lt;/li&gt;
&lt;li&gt;mark that commit as &quot;edit&quot; and start the rebase&lt;/li&gt;
&lt;li&gt;when the rebase pauses, use &lt;code&gt;git gui&lt;/code&gt; as described above&lt;/li&gt;
&lt;li&gt;continue the rebase&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;to combine a set of commits and split the result in some other way
&lt;ul&gt;
&lt;li&gt;start an interactive rebase&lt;/li&gt;
&lt;li&gt;move lines as appropriate so your commits are together&lt;/li&gt;
&lt;li&gt;choose &quot;squash&quot; on the second and subsequent ones and start the rebase&lt;/li&gt;
&lt;li&gt;(dirty trick warning) when the editor for the combined commit message
pops up, delete ALL the lines and save&lt;/li&gt;
&lt;li&gt;use git gui as above&lt;/li&gt;
&lt;li&gt;then continue the rebase&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h4&gt;&lt;a name=&quot;more_exploration&quot;&gt;more exploration&lt;/a&gt;&lt;/h4&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;to see a list of ALL the objects in the entire system, including
filenames (but this isn&#39;t tremendously useful though):&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;git rev-list --objects --all
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h4&gt;&lt;a name=&quot;simulating_git_stash&quot;&gt;simulating git stash&lt;/a&gt;&lt;/h4&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;some say it&#39;s better to simulate git stash than actually use it!  The
following makes use of the fact that the repo HEAD is usually one step
behind the index, which is one step behind the working tree.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;# initial values: R (repo), I (index), C (changed), and U (untracked)
# notation: repo contents/index contents/work tree contents
# R/RI/RICU; start
git commit --allow-empty -m wip-index-state
# now RI/RI/RICU; pushed index onto repo
git add -A &amp;amp;&amp;amp; git commit --allow-empty -m wip-worktree-state
# now RICU/RICU/RICU; pushed C/U files onto repo
    #   ... switch branch, work work work, commit ...
    #   now you want to get back to the saved state
# go back to whatever branch it was
git checkout whatever
# now RICU/RICU/RICU
git reset --mixed HEAD^ # repo=index=R+I
# now RI/RI/RICU; moved HEAD and index back one step
git reset --soft HEAD^
# now R/RI/RICU; moved HEAD back one more step
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h3&gt;&lt;a name=&quot;startup_tips_for_CVSers&quot;&gt;startup tips for CVSers&lt;/a&gt;&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;gotcha&lt;/strong&gt;: &lt;code&gt;git add somefile&lt;/code&gt; adds the &lt;strong&gt;current&lt;/strong&gt; content of
&lt;code&gt;somefile&lt;/code&gt; to the staging area.  Changes made after this do not affect
&lt;code&gt;git commit&lt;/code&gt; unless you again do a &lt;code&gt;git add&lt;/code&gt; or use the &lt;code&gt;-a&lt;/code&gt;
option to &lt;code&gt;git commit&lt;/code&gt;.
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;you will eventually prefer this :-)&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;gotcha&lt;/strong&gt;: &lt;code&gt;commit&lt;/code&gt; means to your local repo, not to the &quot;server&quot;!&lt;/li&gt;
&lt;li&gt;&lt;p&gt;these commands/options effectively bypass the &quot;index&quot; or &quot;staging
area&quot;, &lt;strong&gt;but the INDEX is really a wonderful concept, and you really
should not bypass it like this&lt;/strong&gt;.  See &lt;a href=&quot;../concepts/uses-of-index.html&quot;&gt;why the index is
useful&lt;/a&gt; or
&lt;a href=&quot;http://blogs.gnome.org/newren/2007/12/08/limbo-why-users-are-more-error-prone-with-git-than-other-vcses/&quot;&gt;http://blogs.gnome.org/newren/2007/12/08/limbo-why-users-are-more-error-prone-with-git-than-other-vcses/&lt;/a&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;git diff HEAD       # to see changes you made
git add             # to tell git about new files...
git commit -a       # ...and let git figure out changed and deleted files before committing
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;CVS equivalence&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;CVS                 GIT
---                 ---
checkout            clone
update              pull
checkin             commit + push
add                 add
remove              rm
???                 mv
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a href=&quot;http://github.com/guides/completely-remove-a-file-from-all-revisions&quot;&gt;http://github.com/guides/completely-remove-a-file-from-all-revisions&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/html&gt;
</pre>
</div>
<div title="souped-up-bash-prompt" modifier="Sitaram" created="200905090638">
<pre>
&lt;html&gt;
&lt;h1&gt;&lt;a name=&quot;souping_up_your_bash_prompt&quot;&gt;souping up your bash prompt&lt;/a&gt;&lt;/h1&gt;

&lt;p&gt;&lt;sup&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#souping_up_your_bash_prompt&quot;&gt;souping up your bash prompt&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#Summary_for_the_impatient_expert&quot;&gt;Summary for the impatient/expert&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#Details&quot;&gt;Details&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#Download_bash_script&quot;&gt;Download bash script&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#Screenshot&quot;&gt;Screenshot&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#extracode&quot;&gt;Supplementary code&lt;/a&gt;&lt;br&gt;
&lt;/sup&gt;&lt;/p&gt;

&lt;hr /&gt;

&lt;p&gt;This document describes how to get command completion as well as a souped up
bash prompt.&lt;/p&gt;

&lt;p&gt;Git comes with a bash script in the &#39;contrib/completion&#39; directory which takes
care of command completion as well as displaying the current branch name in your
&lt;code&gt;PS1&lt;/code&gt; (primary bash prompt).  We use that as a basis, and -- without digging
inside of it (meaning you can upgrade that without worry) -- we add more
functionality.&lt;/p&gt;

&lt;h4&gt;&lt;a name=&quot;Summary_for_the_impatient_expert&quot;&gt;Summary for the impatient/expert&lt;/a&gt;&lt;/h4&gt;

&lt;ul&gt;
&lt;li&gt;normally, shows whatever &lt;code&gt;__git_ps1&lt;/code&gt; sends back.  That is, completion,
branch name, and branch state text come from &lt;code&gt;__git_ps1&lt;/code&gt;, in
&#39;contrib/completion/git-completion.bash&#39; in the git source tree&lt;/li&gt;
&lt;li&gt;&lt;p&gt;but when you&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;switch branches, or&lt;/li&gt;
&lt;li&gt;change current working directory, or&lt;/li&gt;
&lt;li&gt;&lt;em&gt;hit enter twice in quick succession at the bash prompt&lt;/em&gt; (!!)&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;p&gt;it shows a color-coded count of files in various states: unmerged (bold
red), untracked (blue), modified (red), and staged (green).  In addition,
the branch name reported by &lt;code&gt;__git_ps1&lt;/code&gt; is also colored (for example,
bright red when the head is detached).&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
You might be wondering about that &quot;hit enter twice in quick succession&quot; piece
:-) The idea is that it should be as convenient and accessible as the current
implementation, but it shouldn&#39;t really happen on &lt;em&gt;every&lt;/em&gt; prompt because it&#39;s
expensive to compute and could delay the prompt.&lt;/p&gt;

&lt;p&gt;The implementation is either a neat and elegant hack or kludge city, depending
on whom you ask :)&lt;/p&gt;

&lt;h4&gt;&lt;a name=&quot;Details&quot;&gt;Details&lt;/a&gt;&lt;/h4&gt;

&lt;p&gt;For a while, I&#39;ve wanted a quick summary of &lt;code&gt;git status&lt;/code&gt; -- how many files are
staged (&lt;code&gt;git add&lt;/code&gt;ed), modified, untracked, unmerged, etc.  I&#39;ve also wanted a
quick indication of whether the current HEAD is a detached head, etc.  And I
wanted it to be as compact as possible.&lt;/p&gt;

&lt;p&gt;But...  I didn&#39;t want &#39;git status&#39; to run on every prompt -- that would be too
expensive for some of the msysgit users I support.  I wanted this extra piece
to kick in only when&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;I change directories, or&lt;/li&gt;
&lt;li&gt;I switch branches, or the branch state changes, or&lt;/li&gt;
&lt;li&gt;when I want it to, but I&#39;m too lazy to type a command to tell it (also
called psychic mode!)&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;That last part was tough, but I&#39;m pleased that my solution not only works, it
even works on msysgit so my Windows users are happy too!&lt;/p&gt;

&lt;h4&gt;&lt;a name=&quot;Download_bash_script&quot;&gt;Download bash script&lt;/a&gt;&lt;/h4&gt;

&lt;p&gt;The part that computes the status and summarises it with colored numbers is a
hacked up version of git://github.com/lvv/git-prompt.git), and you can
download it &lt;a href=&quot;../tools/git-completion-plus.bash.txt&quot;&gt;here&lt;/a&gt;.  And here&#39;s a
&lt;a href=&quot;../tools/git-completion-plus.bash.html&quot;&gt;syntax colored&lt;/a&gt; version to quickly
view on a browser.  You&#39;re expected to source it into your &lt;code&gt;.bashrc&lt;/code&gt;; it&#39;ll
take care of sourcing the git-supplied one, which it looks for in &lt;code&gt;$HOME&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;After that, you need to include the snippet of bash code given in &lt;a href=&quot;#extracode&quot;&gt;this
section&lt;/a&gt;.  I used to have all this in one file, but the code to
detect the quick-double-enter has uses outside git also, so I separated that
logic from the &#39;git status colorisation&#39; stuff.&lt;/p&gt;

&lt;h4&gt;&lt;a name=&quot;Screenshot&quot;&gt;Screenshot&lt;/a&gt;&lt;/h4&gt;

&lt;p&gt;[Update 2009-03-19: the screenshot is not quite current but will suffice to
give you the general idea]&lt;/p&gt;

&lt;p&gt;Someone asked for a screenshot so &lt;a href=&quot;../images/git-completion-plus.png&quot;&gt;here is
one&lt;/a&gt;; it should give you enough of an idea.
You can see the extra information (namely, the output of &lt;code&gt;__git_ps1&lt;/code&gt; being
colored, and a few numbers after that in different colors at certain places:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;when I hit enter twice quickly (the timestamps on the left side will tell
you when I did that)&lt;/li&gt;
&lt;li&gt;when the output of &lt;code&gt;__git_ps1&lt;/code&gt; changes (this is the bit inside
parentheses)&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;The color choices retain the colors that git status shows (with &lt;code&gt;git config
--global color.ui true&lt;/code&gt;) for staged and modified files -- this is green and
red, respectively.  &lt;code&gt;git status&lt;/code&gt; uses red for untracked files also, but we use
blue.  Unmerged files are magenta.&lt;/p&gt;

&lt;p&gt;I didn&#39;t show changing to another directory and coming back -- that would also
trigger the extra info.  I also didn&#39;t show all 4 colors (staged, modified,
untracked, unmerged) at the same time but I&#39;m sure you get the idea.&lt;/p&gt;

&lt;h4&gt;&lt;a name=&quot;extracode&quot;&gt;Supplementary code&lt;/a&gt;&lt;/h4&gt;

&lt;p&gt;The following code contains the hack to do something different if you hit
enter twice in quick succession.  It need to be run via bash&#39;s
&lt;code&gt;PROMPT_COMMAND&lt;/code&gt; mechanism -- do not call it directly from &lt;code&gt;PS1&lt;/code&gt; using the
&lt;code&gt;$(bash_command)&lt;/code&gt; syntax.  That syntax runs things in a sub-shell, which won&#39;t
let you maintain state.&lt;/p&gt;

&lt;p&gt;You&#39;ll notice there&#39;s git-specific stuff in there.  The idea is that if you
need some &lt;em&gt;other&lt;/em&gt; information (like, perhaps, percentage disk free, or maybe
system load, if you don&#39;t have conky or gkrellm), then that also can use the
same mechanism; you&#39;d just add bits of code in here, piggy-backing on the
logic already present to make things run only sometimes instead of on every
prompt.&lt;/p&gt;

&lt;p&gt;Of course you can change the &lt;code&gt;PS1=[...]&lt;/code&gt; lines however you like.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;export PROMPT_COMMAND=__ps1_plus
__ps1_plus()
{
    # elegant hack or extreme kludgery?  You decide...

    # I wanted a way to see a long prompt very conveniently, but
    # not on *every* prompt -- hitting enter twice in quick succession at the
    # bash prompt was about as much as I was willing to do :-)

    # The hack works by remembering the $SECONDS value at the end of each
    # unsuccesful invocation.  When the next invocation still has the same
    # $SECONDS, you know the user hit enter twice, so you do the &#39;git status&#39;
    # stuff.

    # In addition, of course, if the PWD or the output of __git_ps1 itself
    # changed, that also triggers the extra stuff.

    local gitps1
    declare -F __git_ps1 &amp;gt;/dev/null &amp;amp;&amp;amp; gitps1=$(__git_ps1)
    if [[ $__ps1_state != $PWD/$gitps1 || $__ps1_plus_last -eq $SECONDS ]]
    then
        __ps1_state=$PWD/$gitps1

        # if enhanced PS1 builder exists call it to set __git_ps1_text;
        # otherwise default is the git-distributed one
        __git_ps1_text=$gitps1
        declare -F __git_ps1_plus &amp;gt;/dev/null &amp;amp;&amp;amp; __git_ps1_plus

        echo -n -e &#39;\e]0;&#39;${HOSTNAME%%.*}:
        [[ $PWD == $HOME ]] &amp;amp;&amp;amp; echo -n &#39;~&#39; || echo -n $(basename $PWD)
        echo -n -e &#39;\a&#39;
        PS1=&#39;\[\e[4m\e[32m\]\t \h:\W$__git_ps1_text\[\e[m\] \$ &#39;; [[ $EUID == 0 ]] &amp;amp;&amp;amp;
        PS1=&#39;\[\e[4m\e[31m\]\t \h:\W$__git_ps1_text\[\e[m\] \$ &#39;
    else
        PS1=&#39;\[\e[4m\e[32m\]\t\[\e[m\] \$ &#39;; [[ $EUID == 0 ]] &amp;amp;&amp;amp;
        PS1=&#39;\[\e[4m\e[32m\]\t\[\e[m\] \$ &#39;
    fi
    __ps1_plus_last=$SECONDS
}
&lt;/code&gt;&lt;/pre&gt;

&lt;hr /&gt;

&lt;p&gt;&lt;sup&gt;and &lt;a href=&quot;../tools/git-completion.bash.txt&quot;&gt;this&lt;/a&gt; is a copy of the v1.6.1 version of
git-completion.bash from the git source tree; you probably have it already&lt;/sup&gt;&lt;/p&gt;
&lt;/html&gt;
</pre>
</div>
<div title="index" modifier="Sitaram" created="201110271747">
<pre>
&lt;html&gt;
&lt;h1&gt;git for computer scientists -- my version&lt;/h1&gt;

&lt;p&gt;[Inside joke: Hey I rewrote gitosis so why not this?]&lt;/p&gt;

&lt;hr /&gt;

&lt;p&gt;In this document:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#_basics&quot;&gt;basics&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#_the_4_git_object_types&quot;&gt;the 4 git object types&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#_what_is_a_SHA&quot;&gt;what is a SHA&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#_what_is_a_repo&quot;&gt;what is a repo&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#_why_are_the_arrows_backward_in_your_pictures_&quot;&gt;&lt;strong&gt;(why are the arrows backward in your pictures?)&lt;/strong&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#_branches_and_tags&quot;&gt;branches and tags&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#_branch&quot;&gt;branch&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#_more_than_one_branch&quot;&gt;more than one branch&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#_more_than_one_parent_commit&quot;&gt;more than one parent commit&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#_current_branch_checked_out_branch&quot;&gt;current branch/checked out branch&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#_committing&quot;&gt;committing&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#_naming_non_leaf_nodes&quot;&gt;naming non-leaf nodes&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#_tags&quot;&gt;tags&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#_the_difference_between_branches_and_tags&quot;&gt;the difference between branches and tags&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#_digressions&quot;&gt;digressions&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#_what_is_a_git_URL_&quot;&gt;what is a git URL?&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#_what_is_a_remote_&quot;&gt;what is a &quot;remote&quot;?&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#_local_and_remote_repos&quot;&gt;local and remote repos&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#_remote_branches&quot;&gt;remote branches&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#_multiple_remotes&quot;&gt;multiple remotes&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#_fetching_and_merging_from_another_repo&quot;&gt;fetching and merging from another repo&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#_the_object_store&quot;&gt;the object store&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#_what_is_a_repo_again_&quot;&gt;what is a repo (again)&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#_objects_and_branches_tags&quot;&gt;objects and branches/tags&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#_advanced_operations&quot;&gt;advanced operations&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#_merging&quot;&gt;merging&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#_cherry_pick&quot;&gt;cherry-pick&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#_rebasing&quot;&gt;rebasing&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#_the_confusion_about_checkout_versus_reset&quot;&gt;the confusion about checkout versus reset&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#_detached_HEAD_and_all_that&quot;&gt;detached HEAD and all that&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#_other_ways_to_detach_your_HEAD&quot;&gt;other ways to detach your HEAD&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#_re_attaching_the_HEAD&quot;&gt;re-attaching the HEAD&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#_the_reflog&quot;&gt;the reflog&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;hr /&gt;

&lt;p&gt;&lt;a name=&quot;_basics&quot;&gt;&lt;/a&gt;&lt;/p&gt;

&lt;h3&gt;basics&lt;/h3&gt;

&lt;p&gt;&lt;a name=&quot;_the_4_git_object_types&quot;&gt;&lt;/a&gt;&lt;/p&gt;

&lt;h4&gt;the 4 git object types&lt;/h4&gt;

&lt;p&gt;Git keeps all its data inside a special directory called &lt;code&gt;.git&lt;/code&gt; at the top
level of your repository.  Somewhere in there is what we will simply call the
&lt;em&gt;object store&lt;/em&gt; (if you&#39;re not comfortable with that phrase, pretend it&#39;s some
sort of database).&lt;/p&gt;

&lt;p&gt;Git knows about 4 types of objects:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;strong&gt;blob&lt;/strong&gt; -- each file that you add to the repo is turned into a blob
object.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;strong&gt;tree&lt;/strong&gt; -- each directory is turned into a tree object.&lt;/p&gt;

&lt;p&gt;Obviously, a tree object can contain other tree objects and blob objects,
just like a directory can contain other directories and files.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;strong&gt;commit&lt;/strong&gt; -- a commit is a snapshot of your working tree at a point in
time, although it contains a lot of other information also.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;strong&gt;tag&lt;/strong&gt; -- we will see this type a bit later.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;a name=&quot;_what_is_a_SHA&quot;&gt;&lt;/a&gt;&lt;/p&gt;

&lt;h4&gt;what is a SHA&lt;/h4&gt;

&lt;p&gt;A commit is uniquely identified by a 160-bit hex value (the &#39;SHA&#39;).  This is
computed from the tree, plus the following pieces of information:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;the SHA of the parent commit(s) -- every commit except the very first one
in the repo has at least one parent commit that the change is based upon.&lt;/li&gt;
&lt;li&gt;the commit message -- what you type in the editor when you commit&lt;/li&gt;
&lt;li&gt;the author name/email/timestamp&lt;/li&gt;
&lt;li&gt;the committer name/email/timestamp&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;(Actually, all 4 git objects types are identified by SHAs, but of course
they&#39;re computed differently for each object type.  However, the SHAs of the
other object types are not relevant to this discussion).&lt;/p&gt;

&lt;p&gt;In the end, as I said, it&#39;s just a large, apparently random looking, number,
which is actually a cryptographically-strong checksum.  It&#39;s usually written
out as 40 hex digits.&lt;/p&gt;

&lt;p&gt;Humans are not expected to remember this number.  For the purposes of this
discussion, think of it as something similar to a memory address returned by
malloc().&lt;/p&gt;

&lt;p&gt;It is also GLOBALLY unique!  No commit in any repo anywhere in the world will
have the same SHA.  (It&#39;s not a mathematical impossibility, but just so
extremely improbable that we take it as fact.  If you didn&#39;t understand that,
just take it on faith).&lt;/p&gt;

&lt;p&gt;An example SHA: &lt;code&gt;a30236028b7ddd65f01321af42f904479eaff549&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;&lt;a name=&quot;_what_is_a_repo&quot;&gt;&lt;/a&gt;&lt;/p&gt;

&lt;h4&gt;what is a repo&lt;/h4&gt;

&lt;p&gt;A repository (&#39;repo&#39;) is a graph of commits.  In our figures, we represent
SHAs with numbers for convenience.  We also represent time going
upward (bottom to top).&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;.gv file=plain plain
1 .. 2 .. 3 .. 4
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;a name=&quot;_why_are_the_arrows_backward_in_your_pictures_&quot;&gt;&lt;/a&gt;&lt;/p&gt;

&lt;h3&gt;&lt;strong&gt;(why are the arrows backward in your pictures?)&lt;/strong&gt;&lt;/h3&gt;

&lt;p&gt;So why are the arrows pointing backward?&lt;/p&gt;

&lt;p&gt;Well... every commit knows what its parent commit is (as described in the
&quot;what is a SHA&quot; section above).  But it can&#39;t know what it&#39;s child commits are
-- they haven&#39;t been made yet!&lt;/p&gt;

&lt;p&gt;Therefore a repo is like a single linked list.  It cannot be a double linked
list -- this is because any change to the contents would change the SHA!&lt;/p&gt;

&lt;p&gt;&lt;a name=&quot;_branches_and_tags&quot;&gt;&lt;/a&gt;&lt;/p&gt;

&lt;h3&gt;branches and tags&lt;/h3&gt;

&lt;p&gt;&lt;a name=&quot;_branch&quot;&gt;&lt;/a&gt;&lt;/p&gt;

&lt;h4&gt;branch&lt;/h4&gt;

&lt;p&gt;Traditionally, the top of a linked list has a name.  That name is a BRANCH
name.  We show branch names in green circles.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;.gv master
1 .. 2 .. 3 .. 4
[g] master
4 -- master
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;a name=&quot;_more_than_one_branch&quot;&gt;&lt;/a&gt;&lt;/p&gt;

&lt;h4&gt;more than one branch&lt;/h4&gt;

&lt;p&gt;(a.k.a &quot;more than one child commit&quot;)&lt;/p&gt;

&lt;p&gt;Remember we said a repo is a GRAPH?  Specifically, more than one child node
may be pointing at the same parent node.  In this case, each &#39;leaf node&#39; is a
branch, and will have a name.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;.gv
.he 1 .. 2 .. 3 .. 7
3 .. 4
2 .. 5
.he 5 .. 6
[g] master
[g] devel
[g] feature_X
4 -- feature_X
6 -- devel
7 -- master
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;a name=&quot;_more_than_one_parent_commit&quot;&gt;&lt;/a&gt;&lt;/p&gt;

&lt;h4&gt;more than one parent commit&lt;/h4&gt;

&lt;p&gt;Well we can&#39;t keep creating more branches without eventually merging them
back.  So let&#39;s say &quot;feature X&quot; is now tested enough to be merged into the
main branch, so you &lt;code&gt;git merge feature_X&lt;/code&gt;.  Here&#39;s what you get:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;.gv
.he 1 .. 2 .. 3 .. 7 .. 8
3 .. 4
4 .. 8
2 .. 5
.he 5 .. 6
[g] master
[g] devel
[g] feature_X
4 -- feature_X
6 -- devel
8 -- master
.eq 4 6 7
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Notice that commit 8 now has 2 parents, showing that it is a &quot;merge commit&quot;.&lt;/p&gt;

&lt;p&gt;At this point, it&#39;s quite common to delete the feature branch, especially if
you anticipate no more &quot;large&quot; changes.  So you can run &lt;code&gt;git branch -d
feature_X&lt;/code&gt;, which gives you this:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;.gv
.he 1 .. 2 .. 3 .. 7 .. 8
3 .. 4
4 .. 8
2 .. 5
.he 5 .. 6
[g] master
[g] devel
6 -- devel
8 -- master
.eq 4 6 7
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;a name=&quot;_current_branch_checked_out_branch&quot;&gt;&lt;/a&gt;&lt;/p&gt;

&lt;h4&gt;current branch/checked out branch&lt;/h4&gt;

&lt;p&gt;There is a notion of a &#39;currently checked out&#39; branch.  This is denoted by a
special ref called HEAD.  HEAD is a &lt;strong&gt;symbolic&lt;/strong&gt; ref, which points to the
&#39;current branch&#39;.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;.gv file=HEAD HEAD
.he 1 .. 2 .. 3 .. 7
3 .. 4
2 .. 5
.he 5 .. 6
[] [y] HEAD
[g] master
[g] devel
[g] feature_X
4 -- feature_X
6 -- devel
7 -- master .. HEAD
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;a name=&quot;_committing&quot;&gt;&lt;/a&gt;&lt;/p&gt;

&lt;h4&gt;committing&lt;/h4&gt;

&lt;p&gt;When you make a new commit, the current branch moves.  Technically, whatever
branch HEAD is pointing to will move.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;.gv
.he 1 .. 2 .. 3 .. 7 .. 8
3 .. 4
2 .. 5
.he 5 .. 6
[] [y] HEAD
[g] master
[g] devel
[g] feature_X
4 -- feature_X
6 -- devel
8 -- master .. HEAD
.eq 4 6 7
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;a name=&quot;_naming_non_leaf_nodes&quot;&gt;&lt;/a&gt;&lt;/p&gt;

&lt;h4&gt;naming non-leaf nodes&lt;/h4&gt;

&lt;p&gt;It&#39;s not just &#39;leaf&#39; nodes, but inner nodes can also have names.  Recall the
result of merging &lt;code&gt;feature_X&lt;/code&gt; earlier (see the &quot;more than one parent commit&quot;
section):&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;.gv
.he 1 .. 2 .. 3 .. 7 .. 8
3 .. 4
4 .. 8
2 .. 5
.he 5 .. 6
[g] master
[g] devel
[g] feature_X
4 -- feature_X
6 -- devel
8 -- master
.eq 4 6 7
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;At this point, you could leave &lt;code&gt;feature_X&lt;/code&gt; as it is forever.  Or you could
delete the branch (as we showed in that section), in which case that label
would simply disappear.  (The commit it points to is safely reachable from
&lt;code&gt;master&lt;/code&gt; because of the merge.)&lt;/p&gt;

&lt;p&gt;You can also continue to develop on the &lt;code&gt;feature_X&lt;/code&gt; branch, further refining
it with a view to once again merging it at some later point in time.  &lt;font
color=&quot;gray&quot;&gt;Although not relevant to the topic of this document, I should
mention that the usual practice is to first merge master back into &lt;code&gt;feature_X&lt;/code&gt;
to make sure it has all the other stuff that master may have acquired till
now (this is shown by commit 9 below) before continuing further
development:&lt;/font&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;.gv
.he 1 .. 2 .. 3 .. 7 .. 8
3 .. 4
4 .. 8
2 .. 5
.he 4 .. 9 .. 10
.he 5 .. 6
[g] master
[g] devel
[g] feature_X
10 -- feature_X
6 -- devel
8 -- master
.eq 4 6 7
8 .. 9
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;a name=&quot;_tags&quot;&gt;&lt;/a&gt;&lt;/p&gt;

&lt;h4&gt;tags&lt;/h4&gt;

&lt;p&gt;More commonly, inner nodes are TAGS.  We show tag names in yellow circles.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;.gv
.he 1 .. 2 .. 3 .. 7 .. 8
3 .. 4
2 .. 5
.he 5 .. 6
[] [y] HEAD
[g] master
[g] devel
[g] feature_X
4 -- feature_X
6 -- devel
8 -- master .. HEAD
.eq 4 6 7
[y] &quot;v1.0&quot;
3 -- &quot;v1.0&quot;
.eq 3 &quot;v1.0&quot;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;a name=&quot;_the_difference_between_branches_and_tags&quot;&gt;&lt;/a&gt;&lt;/p&gt;

&lt;h3&gt;the difference between branches and tags&lt;/h3&gt;

&lt;p&gt;The main difference between a branch and a tag is branches move, tags don&#39;t.
When you make a commit with the &quot;master&quot; branch currently checked out, master
will move to point to the new commit.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;.gv
.he 1 .. 2 .. 3 .. 7 .. 8 .. 9
3 .. 4
2 .. 5
.he 5 .. 6
[] [y] HEAD
[g] master
[g] devel
[g] feature_X
4 -- feature_X
6 -- devel
9 -- master .. HEAD
.eq 4 6 7
[y] &quot;v1.0&quot;
3 -- &quot;v1.0&quot;
.eq 3 &quot;v1.0&quot;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;a name=&quot;_digressions&quot;&gt;&lt;/a&gt;&lt;/p&gt;

&lt;h3&gt;digressions&lt;/h3&gt;

&lt;p&gt;&lt;a name=&quot;_what_is_a_git_URL_&quot;&gt;&lt;/a&gt;&lt;/p&gt;

&lt;h4&gt;what is a git URL?&lt;/h4&gt;

&lt;p&gt;Git repos are accessed by providing a URL.  There are typically 4 kinds of Git
URLs:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;ssh: like &lt;code&gt;ssh://git@server:reponame&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;http: like &lt;code&gt;http://server:reponame&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;git: like &lt;code&gt;git://server:reponame&lt;/code&gt; -- note that this is an unauthenticated
protocol suitable only for allowing downloads of open source or similar
software&lt;/li&gt;
&lt;li&gt;local file: like &lt;code&gt;file:///full/path/to/reponame&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;a name=&quot;_what_is_a_remote_&quot;&gt;&lt;/a&gt;&lt;/p&gt;

&lt;h4&gt;what is a &quot;remote&quot;?&lt;/h4&gt;

&lt;p&gt;A remote is a short name (like an alias) used to refer to a specific git
repository.  Instead of always saying &lt;code&gt;git fetch git://sitaramc/gitolite&lt;/code&gt;, you
can add that as a remote and use that short name instead of the long URL.&lt;/p&gt;

&lt;p&gt;For convenience, a &#39;remote&#39; called &#39;origin&#39; is automatically created
when you clone a repo, pointing to the repo you cloned from.&lt;/p&gt;

&lt;p&gt;&lt;a name=&quot;_local_and_remote_repos&quot;&gt;&lt;/a&gt;&lt;/p&gt;

&lt;h3&gt;local and remote repos&lt;/h3&gt;

&lt;p&gt;&lt;a name=&quot;_remote_branches&quot;&gt;&lt;/a&gt;&lt;/p&gt;

&lt;h4&gt;remote branches&lt;/h4&gt;

&lt;p&gt;Git is a distributed version control system.  So when you clone someone&#39;s
repo, you get all the branches in that one.  Remote branches are prefixed by
the name of the remote, and we show them in orange.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;.gv
.he 1 .. 2 .. 3 .. 7 .. 8 .. 9
3 .. 4
2 .. 5
.he 5 .. 6
[] [y] HEAD
[g] master
[o] &quot;origin/master&quot;
[o] &quot;origin/devel&quot;
[o] &quot;origin/feature_X&quot;
4 -- &quot;origin/feature_X&quot;
6 -- &quot;origin/devel&quot;
9 -- &quot;origin/master&quot;
9 -- master .. HEAD
[y] &quot;v1.0&quot;
3 -- &quot;v1.0&quot;
.eq 3 &quot;v1.0&quot;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;a name=&quot;_multiple_remotes&quot;&gt;&lt;/a&gt;&lt;/p&gt;

&lt;h4&gt;multiple remotes&lt;/h4&gt;

&lt;p&gt;You can have several remotes.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;.gv
.he 1 .. 2 .. 3 .. 7 .. 8 .. 9
3 .. 4
2 .. 5
.he 5 .. 6
[] [y] HEAD
[g] master
[o] &quot;origin/master&quot;
[o] &quot;origin/devel&quot;
[o] &quot;origin/feature_X&quot;
[o] &quot;sitas-repo/master&quot;
[o] &quot;sitas-repo/devel&quot;
4 -- &quot;origin/feature_X&quot;
6 -- &quot;origin/devel&quot;
9 -- &quot;origin/master&quot;
6 -- &quot;sitas-repo/devel&quot;
9 -- &quot;sitas-repo/master&quot;
9 -- master .. HEAD
[y] &quot;v1.0&quot;
3 -- &quot;v1.0&quot;
.eq 3 &quot;v1.0&quot;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;a name=&quot;_fetching_and_merging_from_another_repo&quot;&gt;&lt;/a&gt;&lt;/p&gt;

&lt;h4&gt;fetching and merging from another repo&lt;/h4&gt;

&lt;p&gt;Now let&#39;s say Sita&#39;s repo had a couple of new commits on its master, and you
run &lt;code&gt;git fetch sitas-repo&lt;/code&gt;.  (We have pruned the graph a litle for clarity,
showing only the relevant commits; the rest of the commits and branches are
assumed to be present as in the previous picture).&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;.gv
&quot;. . .&quot; .. 9 .. 10 .. 11
[] [y] HEAD
[g] master
[o] &quot;origin/master&quot;
[o] &quot;sitas-repo/master&quot;
9 -- &quot;origin/master&quot;
11 -- &quot;sitas-repo/master&quot;
9 -- master .. HEAD
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Now you want to merge Sita&#39;s master branch into yours.  Since your master does
not have any commits that Sita&#39;s master doesn&#39;t have (i.e., Sita&#39;s master is
like a superset of yours), running &lt;code&gt;git merge sitas-repo/master&lt;/code&gt; will get you
this:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;.gv
.he &quot;[ . . . ]&quot; .. 9 .. 10 .. 11
[] [y] HEAD
[g] master
[o] &quot;origin/master&quot;
[o] &quot;sitas-repo/master&quot;
9 -- &quot;origin/master&quot;
11 -- &quot;sitas-repo/master&quot;
11 -- master .. HEAD
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;a name=&quot;_the_object_store&quot;&gt;&lt;/a&gt;&lt;/p&gt;

&lt;h3&gt;the object store&lt;/h3&gt;

&lt;p&gt;Git stores all your data in an &quot;object store&quot;.  There are 4 types of objects
in this store: files (called &quot;blobs&quot;), trees (which are directories+files),
commits, and tags.  All objects are referenced by a 160-bit SHA.&lt;/p&gt;

&lt;p&gt;(Details, if you like: a blob is the lowest in the hierarchy.  One or more
blobs and trees make a tree.  A commit is a tree, plus the SHA of its parent
commit(s), the commit message, author/committer names and emails, and
timestamps.  Under normal usage, you don&#39;t need to deal with all this).&lt;/p&gt;

&lt;p&gt;&lt;a name=&quot;_what_is_a_repo_again_&quot;&gt;&lt;/a&gt;&lt;/p&gt;

&lt;h4&gt;what is a repo (again)&lt;/h4&gt;

&lt;p&gt;Earlier, we saw that a repo was a graph of commits.  At the file system level,
however, it is basically a directory called &lt;code&gt;.git&lt;/code&gt; which looks somewhat like
this&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;$ ls -al .git
total 40
drwxrwxr-x 7 sitaram sitaram 4096 Sep 14 18:54 ./
drwx------ 3 sitaram sitaram 4096 Sep 14 18:54 ../
drwxrwxr-x 2 sitaram sitaram 4096 Sep 14 18:54 branches/
-rw-rw-r-- 1 sitaram sitaram   92 Sep 14 18:54 config
-rw-rw-r-- 1 sitaram sitaram   73 Sep 14 18:54 description
-rw-rw-r-- 1 sitaram sitaram   23 Sep 14 18:54 HEAD
drwxrwxr-x 2 sitaram sitaram 4096 Sep 14 18:54 hooks/
drwxrwxr-x 2 sitaram sitaram 4096 Sep 14 18:54 info/
drwxrwxr-x 4 sitaram sitaram 4096 Sep 14 18:54 objects/
drwxrwxr-x 4 sitaram sitaram 4096 Sep 14 18:54 refs/
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;a name=&quot;_objects_and_branches_tags&quot;&gt;&lt;/a&gt;&lt;/p&gt;

&lt;h4&gt;objects and branches/tags&lt;/h4&gt;

&lt;p&gt;&lt;font color=&quot;gray&quot;&gt;&lt;/p&gt;

&lt;p&gt;Hg folks should read this section carefully.  Among various crazy notions Hg
has is one that encodes the branch name within the commit object in some way.
Unfortunately, Hg&#39;s vaunted &quot;ease of use&quot; (a.k.a &quot;we support Windows better
than git&quot;, which in an ideal world would be a negative, but in this world
sadly it is not) has caused enormous takeup, and dozens of otherwise excellent
developers have been brain-washed into thinking that is the only/right way.&lt;/p&gt;

&lt;p&gt;I hope this section gives at least a few of them a &quot;light-bulb&quot; moment.&lt;/p&gt;

&lt;p&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p&gt;The really, &lt;strong&gt;really&lt;/strong&gt; important thing to understand is that the object store
doesn&#39;t care where the commit came from or what &quot;branch&quot; it was part of when
it entered the object store.  Once it&#39;s there, it&#39;s there!&lt;/p&gt;

&lt;p&gt;Think back to these three diagrams.  The first is before you did a fetch.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;.gv
&quot;[ . . . ]&quot; .. 9
[] [y] HEAD
[g] master
[o] &quot;origin/master&quot;
[o] &quot;sitas-repo/master&quot;
9 -- &quot;origin/master&quot;
9 -- &quot;sitas-repo/master&quot;
9 -- master .. HEAD
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;The next two figures are after &lt;code&gt;git fetch sitas-repo&lt;/code&gt; and &lt;code&gt;git merge
sitas-repo/master&lt;/code&gt;, respectively.  The fetch command added two new commits (10
and 11) to your object store, along with any other objects those commits
reference.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;.gv
.he &quot;[ . . . ]&quot; .. 9 .. 10 .. 11
[] [y] HEAD
[g] master
[o] &quot;origin/master&quot;
[o] &quot;sitas-repo/master&quot;
9 -- &quot;origin/master&quot;
11 -- &quot;sitas-repo/master&quot;
9 -- master .. HEAD

.gv
.he &quot;[ . . . ]&quot; .. 9 .. 10 .. 11
[] [y] HEAD
[g] master
[o] &quot;origin/master&quot;
[o] &quot;sitas-repo/master&quot;
9 -- &quot;origin/master&quot;
11 -- &quot;sitas-repo/master&quot;
11 -- master .. HEAD
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;However, note that commits 10 and 11 did not change in any way simply because
they are now in &lt;strong&gt;your local &quot;master&quot; branch&lt;/strong&gt;.  They continue to have the
same SHA values and the object store does not change as a result of this
command at all.&lt;/p&gt;

&lt;p&gt;All you did was move a pointer from one node to another.  Which is why the
linked list analogy works so well in understanding git as a DAG.&lt;/p&gt;

&lt;p&gt;&lt;a name=&quot;_advanced_operations&quot;&gt;&lt;/a&gt;&lt;/p&gt;

&lt;h3&gt;advanced operations&lt;/h3&gt;

&lt;p&gt;We&#39;ll now show some advanced operations with the aid of this same tree.&lt;/p&gt;

&lt;p&gt;&lt;a name=&quot;_merging&quot;&gt;&lt;/a&gt;&lt;/p&gt;

&lt;h4&gt;merging&lt;/h4&gt;

&lt;p&gt;First, let&#39;s do merging.  The merge you saw earlier was what is called a
&quot;fast-forward&quot; merge, because your local master did not have any commits that
the remote branch you were merging did not have.&lt;/p&gt;

&lt;p&gt;In practice, this is rare, especially on an active project with many
developers.  So let&#39;s see what that looks like.  The starting point was this:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;.gv
&quot;[ . . . ]&quot; .. 9
[] [y] HEAD
[g] master
[o] &quot;origin/master&quot;
[o] &quot;sitas-repo/master&quot;
9 -- &quot;origin/master&quot;
9 -- &quot;sitas-repo/master&quot;
9 -- master .. HEAD
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Now, you made some changes on your local master.  Meanwhile, sitas-repo has
had some changes which you got by doing a fetch:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;.gv
.he &quot;[ . . . ]&quot; .. 9 .. 12 .. 13
9 .. 10
.he 10 .. 11
[] [y] HEAD
[g] master
[o] &quot;origin/master&quot;
[o] &quot;sitas-repo/master&quot;
9 -- &quot;origin/master&quot;
11 -- &quot;sitas-repo/master&quot;
13 -- master .. HEAD
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;When you merge, the end result will usually look like this:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;.gv
&quot;[ . . . ]&quot; .. 9 .. 10 .. 11 .. 14
9 .. 12 .. 13 .. 14
[] [y] HEAD
[g] master
[o] &quot;origin/master&quot;
[o] &quot;sitas-repo/master&quot;
9 -- &quot;origin/master&quot;
11 -- &quot;sitas-repo/master&quot;
14 -- master .. HEAD
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;a name=&quot;_cherry_pick&quot;&gt;&lt;/a&gt;&lt;/p&gt;

&lt;h4&gt;cherry-pick&lt;/h4&gt;

&lt;p&gt;A cherry-pick is not very commonly done -- in well designed workflows it
should actually be rare.  However, it&#39;s a good way to illustrate an important
concept in git.&lt;/p&gt;

&lt;p&gt;We said before that a commit represents a certain set of files and
directories, but since most commits have only one parent, you can think of a
commit as representing a set of changes too.  (In fact, most older VCSs do
this).&lt;/p&gt;

&lt;p&gt;Let&#39;s say one of your collaborators (this mythical &quot;Sita&quot; again!) made a whole
bunch of changes to his cpoy of the repo.  You don&#39;t like most of these
changes, except one specific change which you would like to bring in to your
repo.&lt;/p&gt;

&lt;p&gt;The starting point is this:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;.gv
&quot;[ . . . ]&quot; .. 9 .. 12
.he 12 .. 13 .. 14
.he 9 .. 10 .. 11
[] [y] HEAD
[g] master
[o] &quot;origin/master&quot;
[o] &quot;sitas-repo/master&quot;
9 -- &quot;origin/master&quot;
14 -- &quot;sitas-repo/master&quot;
11 -- master .. HEAD
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;In this, sitas-repo has 3 commits on his master (12, 13, and 14) and you are
only interested in the change that commit 13 made.&lt;/p&gt;

&lt;p&gt;Don&#39;t worry about the meaning of the &lt;code&gt;~1&lt;/code&gt; for now (although you ought to be
able to guess!), but here&#39;s the command you might run:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;git cherry-pick sitas-repo/master~1
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;This results in the following commit graph.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;.gv
&quot;[ . . . ]&quot; .. 9 .. 12
.he 12 .. 13 .. 14
.he 9 .. 10 .. 11 .. &quot;13a&quot;
[] [y] HEAD
[g] master
[o] &quot;origin/master&quot;
[o] &quot;sitas-repo/master&quot;
9 -- &quot;origin/master&quot;
14 -- &quot;sitas-repo/master&quot;
&quot;13a&quot; -- master .. HEAD
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Note that I&#39;ve called the new commit &quot;13a&quot;.  This is to reflect the fact that,
while the &lt;em&gt;change&lt;/em&gt; made is the same as in the original commit 13, the &lt;em&gt;SHA&lt;/em&gt;
will not be the same anymore (new parent commit, new &quot;tree&quot;, new committer
name/email, commit time, etc).&lt;/p&gt;

&lt;p&gt;&lt;a name=&quot;_rebasing&quot;&gt;&lt;/a&gt;&lt;/p&gt;

&lt;h4&gt;rebasing&lt;/h4&gt;

&lt;p&gt;Instead of merging, let&#39;s say you wanted to rebase your commits on top of
Sita&#39;s commits.&lt;/p&gt;

&lt;p&gt;First of all, what is rebasing?  It&#39;s basically transplanting a series of
changes from one point in the graph to another point.&lt;/p&gt;

&lt;p&gt;So if you guessed that a rebase was (in principle) a series of cherry-picks,
you&#39;d be pretty close, at least from a concept point.&lt;/p&gt;

&lt;p&gt;So let&#39;s use a similar example as in the merge example before, but instead of
sitas-repo, the new commits are in &quot;origin&quot; (which is the &quot;main&quot; server for
this project).  You haad your own commits, and you did a &lt;code&gt;git fetch origin&lt;/code&gt;
which brought in the latest commits from &quot;origin&quot;, so it looks like:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;.gv
.he &quot;[ . . . ]&quot; .. 9 .. 10 .. 11
9 .. 12
.he 12 .. 13
[] [y] HEAD
[g] master
[o] &quot;origin/master&quot;
13 -- &quot;origin/master&quot;
11 -- master .. HEAD
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Now, instead of merging &quot;origin/master&quot; into your local master, you want to
rebase your commits on top of &quot;origin/master&quot;.  That is, you want to pretend
your local changes were made &lt;em&gt;after&lt;/em&gt; commit 13 on the origin.  So you run &lt;code&gt;git
rebase origin/master&lt;/code&gt;, and this is the result:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;.gv
&quot;[ . . . ]&quot; .. 9 .. 10 .. 11
9 .. 12 .. 13 .. &quot;10a&quot; .. &quot;11a&quot;
[] [y] HEAD
[g] master
[o] &quot;origin/master&quot;
13 -- &quot;origin/master&quot;
&quot;11a&quot; -- master .. HEAD
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Note that again, we&#39;re ignoring command syntax and nuances here.  This is
about concepts.  Also again, note that the SHAs of the 2 commits have changed,
since they now have new parents, trees, etc., so we represent that by
suffixing an &quot;a&quot;.&lt;/p&gt;

&lt;p&gt;Note the &lt;em&gt;dangling commits&lt;/em&gt; 10 and 11.  No branch is now pointing to them, so
they&#39;re basically wasted disk space.  (They can be examined and reclaimed
using the &#39;reflog&#39;, or if left alone they will eventually get garbage
collected).&lt;/p&gt;

&lt;p&gt;Unlike cherry-pick, a rebase is quite often done in real life.  Rebase also
has some other forms.  This form is one, but the most common is when a
developer wants to re-arrange his own local commits in a more logical sequence
before publishing/pushing them.  (I often do the eqvt of changing this:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;.gv
22 .. 23 .. &quot;22delta&quot; .. 24
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;where &quot;22delta&quot; is a minor fixup to &quot;22&quot;, into&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;.gv
&quot;22a&quot; .. &quot;23a&quot; .. &quot;24a&quot;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;using &quot;git rebase -i&quot;.&lt;/p&gt;

&lt;p&gt;Notice that since commit 22 changes its SHA, all its child commits -- now
rebased -- will also have new SHAs.  This is why you should (almost) never
rebase branches that have already been published.&lt;/p&gt;

&lt;p&gt;&lt;a name=&quot;_the_confusion_about_checkout_versus_reset&quot;&gt;&lt;/a&gt;&lt;/p&gt;

&lt;h3&gt;the confusion about checkout versus reset&lt;/h3&gt;

&lt;p&gt;&lt;strong&gt;Please note&lt;/strong&gt; &lt;font color=&quot;gray&quot;&gt;that this section completely ignores the
myriad options available to both these commands, especially the ones that
pertain to the index and the working tree.  All we&#39;re trying to do is show
what the commands do to the branch and &lt;code&gt;HEAD&lt;/code&gt;, nothing else.  As such, this is
not a complete discussion of those two commands, but only about one aspect of
them.&lt;/p&gt;

&lt;p&gt;In fact, the major reason these two sometimes get confused is that people
eventually learn that &lt;code&gt;git checkout -f&lt;/code&gt; and &lt;code&gt;git reset --hard&lt;/code&gt; do the same
thing, and then extrapolate that to other options.  Just remember that both
those are specific cases of two quite different commands that just happen to
&quot;meet&quot; there, in some sense.&lt;/font&gt;&lt;/p&gt;

&lt;p&gt;The basic difference is very simple:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;checkout changes what your current branch is (i.e., it changes where HEAD
is pointing to)&lt;/li&gt;
&lt;li&gt;reset changes which commit the current branch is pointing to&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Here&#39;re some pictures that show you what&#39;s happening.  (Note that commits
below 6 and 7 are omitted for brevity).&lt;/p&gt;

&lt;p&gt;The first picture is the common starting point.  The next two show the effect
of a checkout and a reset, respectively.  Notice which line is moving in each
picture, compared to the starting point.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;.gv starting point
&quot;starting point for both
checkout and reset operations&quot;
[] [y] HEAD
[g] master
[g] devel
6 -- devel
7 -- master
master -- HEAD

.gv
&quot; &quot;

.gv
&quot;git checkout devel&quot;
[] [y] HEAD
[g] master
[g] devel
6 -- devel
7 -- master
.ie master .. HEAD
.le devel -- HEAD

.gv
&quot; &quot;

.gv
&quot;git reset devel&quot;
[] [y] HEAD
[g] master
[g] devel
6 -- devel
.ie 7 .. master
.le 6 -- master
master -- HEAD
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;As you can see, your current branch, when you start, is &quot;master&quot; (indicated by
where HEAD is pointing).&lt;/p&gt;

&lt;p&gt;A &quot;checkout&quot; changes what is your current branch -- it is now &quot;devel&quot;, and so
any new commits you make now will go on devel, not master.&lt;/p&gt;

&lt;p&gt;On the other hand, a reset changes what commit your current branch points to.
Your branch is still master, but now it is pointing to what could potentially
be a &lt;em&gt;completely&lt;/em&gt; different history.&lt;/p&gt;

&lt;p&gt;(Notice that, like in the rebase example, there is now a dangling commit --
one that cannot be reached by any branch.  It is still accessible using the
&#39;reflog&#39; and will eventually get garbage collected)&lt;/p&gt;

&lt;p&gt;&lt;a name=&quot;_detached_HEAD_and_all_that&quot;&gt;&lt;/a&gt;&lt;/p&gt;

&lt;h3&gt;detached HEAD and all that&lt;/h3&gt;

&lt;p&gt;All this time you have seen HEAD pointing to a branch name, and the branch
itself pointing to a commit.  Then, when you make a commit, the branch moves
to the new commit (although HEAD still continue to point to the branch name).
If you want to recap, here&#39;s a look at just the part of the tree that concerns
us, in a simple before/after display:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;.gv
&quot;BEFORE COMMIT&quot;
.he &quot;[ . . . ] &quot; .. 3 .. 7
[] [y] HEAD
[g] master
7 -- master .. HEAD
[y] &quot;v1.0&quot;
3 -- &quot;v1.0&quot;
[o] &quot;origin/master&quot;
3 -- &quot;origin/master&quot;

.gv
&quot;AFTER COMMIT&quot;
.he &quot;[ . . . ] &quot; .. 3 .. 7 .. 8
[] [y] HEAD
[g] master
8 -- master .. HEAD
[y] &quot;v1.0&quot;
3 -- &quot;v1.0&quot;
[o] &quot;origin/master&quot;
3 -- &quot;origin/master&quot;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Now see what happens when you &lt;code&gt;git checkout v1.0&lt;/code&gt;:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;.gv
.he &quot;[ . . . ] &quot; .. 3 .. 7
[] [y] HEAD
[g] master
7 -- master
[y] &quot;v1.0&quot;
3 -- &quot;v1.0&quot;
3 -- HEAD
[o] &quot;origin/master&quot;
3 -- &quot;origin/master&quot;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Notice the subtle difference?  HEAD is no longer a &lt;strong&gt;symbolic&lt;/strong&gt; ref (i.e.,
pointing to a real branch).  Instead, it is pointing directly to a commit.&lt;/p&gt;

&lt;p&gt;In real terms, this is literally what happens.  When you had &quot;master&quot; checked
out, the contents of HEAD (it&#39;s just a file in .git) are simply&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;ref: refs/heads/master
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;If you &lt;code&gt;git checkout devel&lt;/code&gt; (which is a local branch), it becomes&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;ref: refs/heads/devel
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;However, remember what we said earlier?  Only branches can move, tags cannot.
So when you &lt;code&gt;git checkout v1.0&lt;/code&gt;, HEAD now contains&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;90fed7792746a9a33e24059fb171f6bbb6ffebe6
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;or some such hash.  If it did what it did for local branches, it would imply
the tag would move, right?  Which it shouldn&#39;t -- wouldn&#39;t be much of a tag if
it moved!&lt;/p&gt;

&lt;p&gt;So from this point on, if you make a commit, only HEAD changes, nothing else,
since it is no longer &quot;attached&quot; to any local branch name&quot;&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;.gv
.he &quot;[ . . . ] &quot; .. 3 .. 7
3 .. 8
[] [y] HEAD
[g] master
7 .. master
8 .. HEAD
[y] &quot;v1.0&quot;
3 -- &quot;v1.0&quot;
[o] &quot;origin/master&quot;
3 -- &quot;origin/master&quot;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;The reason this is considered dangerous is that, if you now do &lt;code&gt;git checkout
master&lt;/code&gt;, you get this:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;.gv
.he &quot;[ . . . ] &quot; .. 3 .. 7
3 .. 8
[] [y] HEAD
[g] master
7 .. master .. HEAD
[y] &quot;v1.0&quot;
3 -- &quot;v1.0&quot;
[o] &quot;origin/master&quot;
3 -- &quot;origin/master&quot;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Notice what happened to your new commit 8?  It&#39;s dangling.  Unreachable.
(Except by the reflog, of course, but beginners can get shaken up!)&lt;/p&gt;

&lt;p&gt;&lt;a name=&quot;_other_ways_to_detach_your_HEAD&quot;&gt;&lt;/a&gt;&lt;/p&gt;

&lt;h4&gt;other ways to detach your HEAD&lt;/h4&gt;

&lt;p&gt;The most common way to get into a detached HEAD state is to check out a remote
branch (like &lt;code&gt;git checkout origin/branch&lt;/code&gt;), without realising that you need to
make a local copy before you make commits on it.&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;gray&quot;&gt;(Side note: the correct syntax to create and checkout a
local branch starting from a remote branch used to be &lt;code&gt;git checkout -t -b
branch origin/branch&lt;/code&gt;, but modern gits will do the right thing if you simply
say &lt;code&gt;git checkout branch&lt;/code&gt;; yaay for progress!)&lt;/font&gt;&lt;/p&gt;

&lt;p&gt;The reason &lt;code&gt;git checkout origin/branch&lt;/code&gt; creates a detached HEAD is that, while
remote branches can move, they can only do so as a result of a &lt;code&gt;git fetch&lt;/code&gt; or
equivalent.  After all, they are meant to track what the &lt;em&gt;remote&lt;/em&gt; has, so it
wouldn&#39;t make sense for them to acquire &lt;em&gt;local&lt;/em&gt; commits!&lt;/p&gt;

&lt;p&gt;Here are various ways to detach HEAD:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;git checkout origin/master  # (described above)
git checkout master^        # parent of master
git checkout HEAD~2         # grandparent of current HEAD
git checkout tagname        # since you cant commit to a tag!
git checkout &amp;lt;SHA&amp;gt;          # hex digits forming a full or partial SHA
git checkout master^0       # (see note below)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;These will all make the file called &lt;code&gt;HEAD&lt;/code&gt; contain the actual (40-hex-digit)
SHA of the corresponding commit instead of some string like &lt;code&gt;ref:
refs/heads/branch&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;That last one (&lt;code&gt;git checkout master^0&lt;/code&gt;) is interesting.  The &lt;code&gt;master^0&lt;/code&gt;
notation means &quot;the actual commit that master points to&quot;, so it&#39;s just like
saying &lt;code&gt;git checkout &amp;lt;SHA&amp;gt;&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;&lt;a name=&quot;_re_attaching_the_HEAD&quot;&gt;&lt;/a&gt;&lt;/p&gt;

&lt;h4&gt;re-attaching the HEAD&lt;/h4&gt;

&lt;p&gt;Modern git will warn you about losing commits on a detached HEAD if you&#39;re at
the command line, and tell you how to recover (immediately).&lt;/p&gt;

&lt;p&gt;Recovery is quite easy.  If you realised you&#39;re on a detached HEAD &lt;em&gt;before&lt;/em&gt;
you switched to some other branch:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;git checkout -b newbranch
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;If you switched, possibly made some commits, and &lt;em&gt;then&lt;/em&gt; realised you lost some
commits on a detached HEAD, you need to check the reflog to find the lost HEAD
and switch to that using some command like:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;git branch newbranch HEAD@{1}
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;a name=&quot;_the_reflog&quot;&gt;&lt;/a&gt;&lt;/p&gt;

&lt;h4&gt;the reflog&lt;/h4&gt;

&lt;p&gt;The reflog can show you all the values that HEAD has taken in the past.
Here&#39;s a simulated example.  I cloned a repo that had a master and a &#39;foo&#39;
branch.  I then checked out &lt;code&gt;origin/foo&lt;/code&gt;, ignored all the warnings, and made
two commits on what I thought was the &quot;foo&quot; branch.  Then I switched back to
master and made two normal commits on master before I realised that I had
&#39;lost&#39; two commits.&lt;/p&gt;

&lt;p&gt;At this point, running &lt;code&gt;git reflog show&lt;/code&gt; gives me the following (the most
recent HEAD value is first):&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;86a8ee0 HEAD@{0}: commit: my second commit on master
e42c4d0 HEAD@{1}: commit: my first commit on master
58c1539 HEAD@{2}: checkout: moving from e2558a9d1527e5a76b39ffede1dc5ca9c650de01 to master
e2558a9 HEAD@{3}: commit: second commit on foo
1c9dfa0 HEAD@{4}: commit: first commit on foo
802f184 HEAD@{5}: checkout: moving from master to origin/foo
58c1539 HEAD@{6}: clone: from /tmp/tmp.lv5IqjK0ZI/b
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;That &lt;code&gt;moving from &amp;lt;SHA&amp;gt;...&lt;/code&gt; is usually a sign that some commits may have been
lost.  In this case you can run &lt;code&gt;git branch newbranch HEAD@{3}&lt;/code&gt; or &lt;code&gt;git branch
newbranch e2558a9&lt;/code&gt; to save those commits.  (Notice that the SHA value of
&lt;code&gt;HEAD@{3}&lt;/code&gt; is the same one mentioned in the &lt;code&gt;moving from &amp;lt;SHA&amp;gt;...&lt;/code&gt; message on
the line above it).&lt;/p&gt;
&lt;/html&gt;
</pre>
</div>
<div title="common-problems" modifier="Sitaram" created="200906302348">
<pre>
&lt;html&gt;
&lt;h1&gt;&lt;a name=&quot;common_problems_and_gotchas&quot;&gt;common problems and gotchas&lt;/a&gt;&lt;/h1&gt;

&lt;hr /&gt;

&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#common_problems_and_gotchas&quot;&gt;common problems and gotchas&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#_windows_keeping_files_open_in_an_editor&quot;&gt;(windows) keeping files open in an editor&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#_Not_currently_on_any_branch_&quot;&gt;&quot;Not currently on any branch&quot;?&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#simple_gotchas_at_the_command_line&quot;&gt;simple gotchas at the command line&lt;/a&gt;&lt;br&gt;&lt;/p&gt;

&lt;hr /&gt;

&lt;h3&gt;&lt;a name=&quot;_windows_keeping_files_open_in_an_editor&quot;&gt;(windows) keeping files open in an editor&lt;/a&gt;&lt;/h3&gt;

&lt;p&gt;Windows does not allow you to overwrite or delete a file that is open in an
editor.  As a result, operations such as &lt;code&gt;git pull&lt;/code&gt;, &lt;code&gt;merge&lt;/code&gt;,
&lt;code&gt;rebase&lt;/code&gt;, etc., may experience weird problems if they attempt to update
one of the files you have kept open.&lt;/p&gt;

&lt;p&gt;If you get funky errors while doing any git operations, close all editors and
try again!&lt;/p&gt;

&lt;h3&gt;&lt;a name=&quot;_Not_currently_on_any_branch_&quot;&gt;&quot;Not currently on any branch&quot;?&lt;/a&gt;&lt;/h3&gt;

&lt;p&gt;In the graphical tool &lt;code&gt;gitk&lt;/code&gt;, any &quot;branch&quot; that has a leading part in
yellow is a &lt;strong&gt;remote&lt;/strong&gt; branch.  Do not checkout such a branch until you get a
little more familiar with git.  It is &lt;strong&gt;not a local branch&lt;/strong&gt;, so checking it
out makes no sense.  For normal users, the GUI should prevent this, but it
doesn&#39;t, so I&#39;m mentioning it.  (Think of it like a link to an XLS on a
website -- you can click the link and open it and edit it, but you can&#39;t save
it back to where it came from!)&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;you will recognise you are in such a branch by one of these symptoms&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;code&gt;gitk&lt;/code&gt; does not show any branch name in &lt;strong&gt;bold&lt;/strong&gt; when you quit and
restart it&lt;/li&gt;
&lt;li&gt;&lt;code&gt;git gui&lt;/code&gt; says &lt;code&gt;current branch: HEAD&lt;/code&gt; at the top left&lt;/li&gt;
&lt;li&gt;&lt;code&gt;git status&lt;/code&gt; says &lt;code&gt;Not currently on any branch&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;you are able to commit your changes but when you push them to the
remote server nothing seems to happen&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;to fix this:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;first give that branch a name to better deal with it for later
troubleshooting: &lt;code&gt;git checkout -b some_new_name&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;then you figure out how to merge those changes into one of the main
branches&lt;/li&gt;
&lt;li&gt;then you push&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Update: I have since written about this in &lt;a href=&quot;../concepts/detached-head.html&quot;&gt;more depth
here&lt;/a&gt;.&lt;/p&gt;

&lt;h3&gt;&lt;a name=&quot;simple_gotchas_at_the_command_line&quot;&gt;simple gotchas at the command line&lt;/a&gt;&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;git log rev&lt;/code&gt; and &lt;code&gt;git diff rev&lt;/code&gt; go in different directions.  Log shows
backward from the rev given, while diff goes forward from rev to the
working directory.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;many commands inherit options from lower level programs and their man
pages will appear incomplete.  Read carefully to see what other commands&#39;
options are applicable to this one.  For example, &lt;code&gt;git-log&lt;/code&gt; inherits from
&lt;code&gt;git-rev-list&lt;/code&gt; and &lt;code&gt;git-diff-tree&lt;/code&gt;.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;using &lt;code&gt;cp -a&lt;/code&gt; copy instead of &lt;code&gt;git clone&lt;/code&gt; will screw the timestamps.  A
subsequent &lt;code&gt;git add .&lt;/code&gt; will make it look like every file has changed, in
terms of just the time stamp.  &lt;em&gt;Fix this by using &lt;code&gt;git status&lt;/code&gt;, which
updates the index for such cases as a side effect.&lt;/em&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;confused by &lt;code&gt;HEAD^&lt;/code&gt;, &lt;code&gt;HEAD~1&lt;/code&gt;, etc.?  &lt;code&gt;man git-rev-parse&lt;/code&gt; has a good
diagram.  And remember the reflog is quite different and has a different
syntax (&lt;code&gt;HEAD@{2&lt;/code&gt;}).&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;cloning a repo: the following two commands are different; see
&lt;a href=&quot;http://kerneltrap.org/mailarchive/git/2007/10/1/326757&quot;&gt;http://kerneltrap.org/mailarchive/git/2007/10/1/326757&lt;/a&gt; (summary: the
second one uses the git protocol, and makes no assumptions about the
original and the clone being on the same file system or even machine)&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;git clone foo bar           # versus
# FIXME: fix this after permanent conversion to MD is over; should be
# a triple-slash after the &quot;file:&quot;
git clone file:/*foo bar
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;git ls-tree&lt;/code&gt; does not seem to work well when not at the root of
&lt;code&gt;$GIT_WORK_TREE&lt;/code&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/html&gt;
</pre>
</div>
<div title="use-git" modifier="Sitaram" created="200906302348">
<pre>
&lt;html&gt;
&lt;h1&gt;&lt;a name=&quot;_user_overview_on_using_git_especially_with_the_GUI_tools&quot;&gt;(user) overview on using git, especially with the GUI tools&lt;/a&gt;&lt;/h1&gt;

&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#_user_overview_on_using_git_especially_with_the_GUI_tools&quot;&gt;(user) overview on using git, especially with the GUI tools&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#launching_and_using_git_the_command_line&quot;&gt;launching and using git -- the command line&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#launching_and_using_git_the_GUI_interfaces&quot;&gt;launching and using git -- the GUI interfaces&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#_git_gui_&quot;&gt;&lt;code&gt;git gui&lt;/code&gt;&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#_gitk_&quot;&gt;&lt;code&gt;gitk&lt;/code&gt;&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#where_you_really_need_the_command_line&quot;&gt;where you &lt;em&gt;really&lt;/em&gt; need the command line&lt;/a&gt;&lt;br&gt;&lt;/p&gt;

&lt;hr /&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;sup&gt;These are generic instructions that may also eventually go on a public
    website somewhere.  Anything that is CAPITALISED in the notes below must
    be replaced as appropriate to (y)our internal environment.  Contact me for
    details.  -- Sitaram Chamarty&lt;/sup&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h3&gt;&lt;a name=&quot;launching_and_using_git_the_command_line&quot;&gt;launching and using git -- the command line&lt;/a&gt;&lt;/h3&gt;

&lt;p&gt;Git has a command line interface and two different GUI interfaces.&lt;/p&gt;

&lt;p&gt;The command line interface allows you to do pretty much anything, and is
really the most convenient once you get used to it.  You can get to the
command line in one of the following ways:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;click the &quot;git&quot; or &quot;git bash&quot; icon on your desktop/taskbar or wherever the
install put it.  This will start with the &quot;git bash shell&quot; set to whatever
your &quot;HOME&quot; directory is.  From there you can navigate (using the &lt;code&gt;cd&lt;/code&gt;
command) to wherever your repository is.&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;the &quot;git bash shell&quot; is almost a complete unix shell.  So directories
like &lt;code&gt;E:\some\path&lt;/code&gt; are accessed as &lt;code&gt;/e/some/path&lt;/code&gt;.&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;if your repository is in &lt;code&gt;E:\Myname\projects\projectname&lt;/code&gt;, open
&lt;code&gt;E:\Myname\projects&lt;/code&gt; in the file manager, right click on
&lt;code&gt;projectname&lt;/code&gt;, and choose &quot;git bash here&quot;.  This will open the &quot;git
bash&quot; command line positioned at that directory.  &lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h3&gt;&lt;a name=&quot;launching_and_using_git_the_GUI_interfaces&quot;&gt;launching and using git -- the GUI interfaces&lt;/a&gt;&lt;/h3&gt;

&lt;p&gt;The two GUI tools are very powerful; if you don&#39;t like the command line, you
can quite easily stick to them and get by for most purposes.  Briefly, the GUI
tools are:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;code&gt;git gui&lt;/code&gt; to stage and unstage files, commit, and push&lt;/li&gt;
&lt;li&gt;&lt;code&gt;gitk&lt;/code&gt; to get a bird&#39;s eye view your current branch, or &lt;code&gt;gitk
--all&lt;/code&gt; to view all branches, local and remote&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;sup&gt;(&lt;em&gt;staging&lt;/em&gt; a file means getting a file ready to commit -- only files that
are staged will be committed; this allows you to keep some changes &quot;pending&quot;,
without committing them)&lt;/sup&gt;&lt;/p&gt;

&lt;p&gt;Git&#39;s GUI interfaces let you do almost anything that you &lt;strong&gt;normally&lt;/strong&gt; need to
do -- all the simple straightforward things as well as some sophisticated
things.  Here&#39;s how to launch them:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;you can launch these GUIs from the &quot;git bash&quot; command line (type
&lt;code&gt;gitk&lt;/code&gt; or &lt;code&gt;git gui&lt;/code&gt;)&lt;/li&gt;
&lt;li&gt;you can right click on a directory containing a repository and choose &quot;git
GUI here&quot;; this launches &lt;code&gt;git gui&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;if you already have one GUI open, you can launch the other one from the
menus (&quot;Repository -&gt; Visualise History&quot;, or &quot;File -&gt; Start Git GUI&quot;)&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;You might be wondering why there are two GUIs...&lt;/p&gt;

&lt;h4&gt;&lt;a name=&quot;_git_gui_&quot;&gt;&lt;code&gt;git gui&lt;/code&gt;&lt;/a&gt;&lt;/h4&gt;

&lt;p&gt;&lt;code&gt;git gui&lt;/code&gt; shows you the current state of your work area with respect to
the currently checked-out branch.  In the top left pane, it shows you what
files are changed with respect to the last commit.  In the bottom left pane it
shows you what files have been marked &quot;ready for commit&quot; -- only these changes
will go into the next commit if you commit now.&lt;/p&gt;

&lt;p&gt;(As I said above, git allows you to keep some changes &quot;pending&quot;, without
committing them.  The &quot;ready to commit&quot; part is called the &quot;index&quot;, &quot;staging
area&quot;, or &quot;cache&quot; in the documentation, so the bottom left pane is showing you
what is in the &quot;index&quot;.  Check out &lt;a href=&quot;../concepts/uses-of-index.html&quot;&gt;why the index is
useful&lt;/a&gt; for more).&lt;/p&gt;

&lt;p&gt;In either case, the changes made to the currently selected file are shown on
the right pane.&lt;/p&gt;

&lt;p&gt;There are a lot of things you can do in this GUI, but here are the basic
things:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;you can click on the icon to the left of each file name to move it back
and forth between the two areas (&quot;staged, ready for commit&quot; &amp;lt;-&gt; &quot;unstaged,
not to be committed right now&quot;)&lt;/li&gt;
&lt;li&gt;you can also type in a suitable commit message and click the &quot;commit&quot;
button.  This commits the change to your local repository&lt;/li&gt;
&lt;li&gt;you can also &quot;push&quot; the changes to some central repository so that others
can pull them&lt;/li&gt;
&lt;/ul&gt;

&lt;h4&gt;&lt;a name=&quot;_gitk_&quot;&gt;&lt;code&gt;gitk&lt;/code&gt;&lt;/a&gt;&lt;/h4&gt;

&lt;p&gt;&lt;code&gt;gitk&lt;/code&gt; (or &lt;code&gt;gitk --all&lt;/code&gt;, which is what I use more often) shows you a
visual tree of all the commits that have happened on this repository.  It is a
very powerful tool, allowing you to do all sorts of things like&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;create a new branch&lt;/li&gt;
&lt;li&gt;checkout (switch to) a different branch&lt;/li&gt;
&lt;li&gt;delete a branch&lt;/li&gt;
&lt;li&gt;create a tag&lt;/li&gt;
&lt;li&gt;pick commits from some other branch to apply to the current branch&lt;/li&gt;
&lt;li&gt;show differences between any two commits&lt;/li&gt;
&lt;li&gt;traverse the tree of commits&lt;/li&gt;
&lt;li&gt;search for commits based on all sorts of criteria&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;A word of warning: resist the urge to &quot;checkout&quot; a branch if its name starts
with &quot;remotes&quot;.  This is &lt;strong&gt;not a local branch&lt;/strong&gt; so checking it out makes no
sense.  Ideally, the GUI should prevent this, but it doesn&#39;t, so I&#39;m
mentioning it explicitly.  (Think of it like a link to an XLS on a website --
you can click the link and open it and edit it, but you can&#39;t save it back to
where it came from!)&lt;/p&gt;

&lt;h4&gt;&lt;a name=&quot;where_you_really_need_the_command_line&quot;&gt;where you &lt;em&gt;really&lt;/em&gt; need the command line&lt;/a&gt;&lt;/h4&gt;

&lt;p&gt;One common task that is needlessly complex in both the GUIs is &lt;code&gt;git pull&lt;/code&gt;.
In a properly setup repository that has been cloned from the project master or
something like that, getting the latest changes is just a matter of typing
&lt;code&gt;git pull&lt;/code&gt;.  In &lt;code&gt;git gui&lt;/code&gt;, described above, this takes 4 steps,
although there is a reason for that complexity :-)&lt;/p&gt;
&lt;/html&gt;
</pre>
</div>
<div title="gitk" modifier="Sitaram" created="201110051936">
<pre>
&lt;html&gt;
&lt;h1&gt;&lt;a name=&quot;the_missing_gitk_documentation&quot;&gt;the missing gitk documentation&lt;/a&gt;&lt;/h1&gt;

&lt;p&gt;&lt;sup&gt;&lt;/p&gt;

&lt;p&gt;&lt;code&gt;gitk&lt;/code&gt; is a very powerful GUI tool.  It&#39;s one of those rare beasts where the
pretty stuff is not just a crutch for the command-line-ignorant -- it actually
does really useful things that just cannot be done in a CLI.&lt;/p&gt;

&lt;p&gt;Sadly, it is woefully undocumented.  Scratch that, it&#39;s almost &lt;em&gt;completely&lt;/em&gt;
undocumented.&lt;/p&gt;

&lt;p&gt;This is my attempt to do something about that.  Strictly speaking, you can
explore the UI and find all these features yourself, and indeed, if you find
any that are not listed here, please &lt;a href=&quot;mailto:sitaramc@gmail.com&quot;&gt;email me&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#the_missing_gitk_documentation&quot;&gt;the missing gitk documentation&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#colors_and_bold&quot;&gt;colors and bold&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#repository_operations&quot;&gt;repository operations&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#the_main_menu&quot;&gt;the main menu&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#browsing_the_commit_list_top_pane_&quot;&gt;browsing the commit list (top pane)&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#browsing_the_diff&quot;&gt;browsing the diff&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#running_a_diff_between_two_arbitrary_commits&quot;&gt;running a diff between two arbitrary commits&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#searching_for_commits&quot;&gt;searching for commits&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#navigating_the_commit_tree&quot;&gt;navigating the commit tree&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#some_other_tricks&quot;&gt;some other tricks&lt;/a&gt;&lt;br&gt;&lt;/p&gt;

&lt;p&gt;&lt;/sup&gt;&lt;/p&gt;

&lt;h3&gt;&lt;a name=&quot;colors_and_bold&quot;&gt;colors and bold&lt;/a&gt;&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;local branch names are in a green background.&lt;/li&gt;
&lt;li&gt;remote branch names are in a mixed orange/green background.  (&lt;a href=&quot;../concepts/detached-head.html&quot;&gt;&lt;strong&gt;DO NOT
checkout remote branches&lt;/strong&gt;&lt;/a&gt;!)&lt;/li&gt;
&lt;li&gt;the currently checked out branch name is in bold.&lt;/li&gt;
&lt;li&gt;tags are on a yellow background.&lt;/li&gt;
&lt;/ul&gt;

&lt;h3&gt;&lt;a name=&quot;repository_operations&quot;&gt;repository operations&lt;/a&gt;&lt;/h3&gt;

&lt;p&gt;All these are from the commit list (the top pane):&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;right clicking on a commit message&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;create a tag&lt;/li&gt;
&lt;li&gt;create a new branch&lt;/li&gt;
&lt;li&gt;reset the current branch to this commit (soft/mixed/hard)&lt;/li&gt;
&lt;li&gt;cherry-pick this current onto the current branch&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;right clicking on a branch name&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;checkout the branch (please heed the warning above and &lt;a href=&quot;../concepts/detached-head.html&quot;&gt;&lt;strong&gt;DO NOT
checkout remote branches&lt;/strong&gt;&lt;/a&gt;!)&lt;/li&gt;
&lt;li&gt;remove the branch&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h3&gt;&lt;a name=&quot;the_main_menu&quot;&gt;the main menu&lt;/a&gt;&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;reload: if you&#39;re doing stuff on the command line in another screen, and
want those changes reflected in gitk, hit &lt;code&gt;F5&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;&lt;code&gt;F5&lt;/code&gt; updates the refs and shows you their new values &lt;em&gt;while still showing
you the old ones&lt;/em&gt;.  It is most useful after operations like rebase,
because you can compare the previous branch head with the new one.&lt;/p&gt;

&lt;p&gt;(&lt;code&gt;Ctrl-F5&lt;/code&gt;, on the other hand, is a total refresh, throwing away
everything that was previously shown.)&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;list/choose references: to quickly go to a particular reference, hit &lt;code&gt;F2&lt;/code&gt;.
If there are too many, you can specify a glob pattern in the box at the
bottom to subset the list.  Clicking on a reference takes the main window
to that reference.  The list window will stay open so you can click on
other refs.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h3&gt;&lt;a name=&quot;browsing_the_commit_list_top_pane_&quot;&gt;browsing the commit list (top pane)&lt;/a&gt;&lt;/h3&gt;

&lt;p&gt;Many of these functions also have character key bindings.  For example &quot;n&quot;
acts the same as a &quot;down arrow&quot;.  I&#39;m not listing those; if you need them,
look in the source code for a series of &lt;code&gt;bindkey&lt;/code&gt; statements and match them up
with the others.  It&#39;s not hard, and you don&#39;t need to know Tcl.  (I don&#39;t).&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;up/down arrow keys, pageup/down: obvious&lt;/li&gt;
&lt;li&gt;left/right arrow keys: previous/next commit in browse history (think web
browser&#39;s back/forward)&lt;/li&gt;
&lt;li&gt;shift-up/down: find previous/next match (see &lt;a href=&quot;#sfc&quot;&gt;searching for commits&lt;/a&gt;
below)&lt;/li&gt;
&lt;/ul&gt;

&lt;h3&gt;&lt;a name=&quot;browsing_the_diff&quot;&gt;browsing the diff&lt;/a&gt;&lt;/h3&gt;

&lt;p&gt;At any time, the bottom left pane shows a &quot;diff&quot;, usually of the current
commit shown in the top pane.  The bottom right pane (by default) shows a list
of files in this &quot;diff&quot;.&lt;/p&gt;

&lt;p&gt;&lt;a name=&quot;bcpc&quot;&gt;&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;spacebar: move forward 1 page in the diff view&lt;/li&gt;
&lt;li&gt;backspace/delete: ditto, but backward&lt;/li&gt;
&lt;li&gt;&quot;f&quot;: move to next file in the diff.  Both the bottom left and right panes
will show a change when you do this.&lt;/li&gt;
&lt;li&gt;&quot;b&quot;: ditto, but previous file&lt;/li&gt;
&lt;li&gt;click a file in the bottom right pane: scrolls the left pane to show that
file&#39;s changes&lt;/li&gt;
&lt;/ul&gt;

&lt;h4&gt;&lt;a name=&quot;running_a_diff_between_two_arbitrary_commits&quot;&gt;running a diff between two arbitrary commits&lt;/a&gt;&lt;/h4&gt;

&lt;ul&gt;
&lt;li&gt;left click on the &quot;new&quot; commit&lt;/li&gt;
&lt;li&gt;navigate using the scrollbar (no keyboard shortcut, AFAICT) to some other
commit&lt;/li&gt;
&lt;li&gt;&lt;em&gt;right-click&lt;/em&gt; and choose &quot;Diff this -&gt; selected&quot;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Now you can browse that diff using the keyboard or mouse.  Note that any
movement that selects a different commit (like pressing an arrow key) will
change the view to show that commit, so while examining this &quot;diff&quot;, stick to
&lt;a href=&quot;#bcpc&quot;&gt;these keys&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;&lt;a name=&quot;sfc&quot;&gt;&lt;/p&gt;

&lt;h3&gt;&lt;a name=&quot;searching_for_commits&quot;&gt;searching for commits&lt;/a&gt;&lt;/h3&gt;

&lt;p&gt;Here&#39;re some ways to search for commits.  The commits that result will become
highlighted in bold, so you can see them in the context of their surrounding
changes.  You can navigate between matches using the shift-up/down-arrow keys.&lt;/p&gt;

&lt;p&gt;There is a widget to the left of the search box that controls what type of
search you do.  By default it is set to &quot;containing:&quot;, which searches the
commit message.&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;searching on commit message: just hit &lt;code&gt;&quot;/&quot;&lt;/code&gt; and type in any text.  This
will match all commits where the commit message contained the text you
typed.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;searching by filename: navigate to some commit that affected the file.
Right click the filename in the bottom right pane and choose &quot;Highlight
this only&quot;.  If you want to add more files to the search in an &quot;OR&quot; type
match, right click some other file (doesn&#39;t have to be the same commit),
and choose &quot;Highlight this too&quot;.&lt;/p&gt;

&lt;p&gt;Notice that when you do this, the search type widget changes from
&quot;containing:&quot; to &quot;touching paths:&quot;.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;searching by changed text: set the search type widget to &quot;adding/removing
string:&quot;, then type in a search text.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Now that you&#39;ve understood that widget, take a look at the others on the right
also; they&#39;re fairly self-explanatory.  Note that the last widget (All fields,
Headlines, Comments, Author, Committer) is only valid when the type of search
widget shows &quot;containing:&quot;.&lt;/p&gt;

&lt;h3&gt;&lt;a name=&quot;navigating_the_commit_tree&quot;&gt;navigating the commit tree&lt;/a&gt;&lt;/h3&gt;

&lt;p&gt;There are several ways to navigate the tree quickly.&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;the diff pane always shows all the parents and children of the current
commit.  Click on any of the hashes to go there.  Some of the text from
the commit message of those hashes is also shown, to give you an idea of
what that is.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;the diff pane also shows all the branches to which this commit belongs.
Click any of them to go to the head of that branch.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;when the commit graph gets really complex, the line connecting two commits
is broken.  Click on any line segment (not on a dot or a dangling
arrowhead) and the diff pane changes to show details for that line segment
-- all parents and children are shown.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;as above, but if you click on the &lt;em&gt;arrowhead&lt;/em&gt;, you will be taken to the
portion of the tree where the other end of the arrowhead would go to.
Your &quot;current&quot; commit is still the same; this is just a way of
&quot;connecting&quot; two pieces of the graph that are otherwise too far away.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&quot;Follows:&quot; and &quot;Precedes:&quot; show the nearest tag before and after the
commit for each branch that the commit is a part of.  For example, if you
find the commit for a bugfix or a feature you want, this will tell you the
minimum version you should upgrade to.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h3&gt;&lt;a name=&quot;some_other_tricks&quot;&gt;some other tricks&lt;/a&gt;&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;expand the diff view by using the spin control that says &quot;Lines of
context&quot;; the default value is 3.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;find the &quot;origin&quot; of any line visible in the &quot;diff&quot; pane by right clicking
and choosing &quot;Show origin of this line&quot;.  This does not make sense for
lines prefixed by a plus sign of course.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;go to a specific commit by SHA: click on a commit, hit TAB twice to get
the focus onto the SHA1 field, then type in the first few characters of
the SHA you want.&lt;/p&gt;

&lt;p&gt;If you click in the field with a mouse, it deselects the text within the
field, and (for some reason), shift-select is disabled so you have to hold
down the delete key to delete the entire field before you start typing in
the new hash.  Irritating, but it&#39;s only the mouse use, not keyboard use,
so it&#39;s ok, I guess.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/html&gt;
</pre>
</div>
<div title="DOs-and-DONTs" modifier="Sitaram" created="200907232049">
<pre>
&lt;html&gt;
&lt;h1&gt;&lt;a name=&quot;DOs_and_DONTs&quot;&gt;DOs and DONTs&lt;/a&gt;&lt;/h1&gt;

&lt;p&gt;&lt;sup&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#DOs_and_DONTs&quot;&gt;DOs and DONTs&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#DOs&quot;&gt;DOs&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#setting_up_your_gitconfig&quot;&gt;setting up your gitconfig&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#your_global_gitconfig&quot;&gt;your global gitconfig&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#_admin_every_bare_repository&quot;&gt;(admin) every bare repository&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#write_useful_readable_commit_messages&quot;&gt;write useful, readable, commit messages&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#DONTs&quot;&gt;DONTs&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#actions_whose_results_can_be_confusing&quot;&gt;actions whose results can be confusing&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#do_not_checkout_remote_branches&quot;&gt;do not checkout &quot;remote&quot; branches&lt;/a&gt;&lt;br&gt;
&lt;/sup&gt;&lt;/p&gt;

&lt;hr /&gt;

&lt;h2&gt;&lt;a name=&quot;DOs&quot;&gt;DOs&lt;/a&gt;&lt;/h2&gt;

&lt;h3&gt;&lt;a name=&quot;setting_up_your_gitconfig&quot;&gt;setting up your gitconfig&lt;/a&gt;&lt;/h3&gt;

&lt;h4&gt;&lt;a name=&quot;your_global_gitconfig&quot;&gt;your global gitconfig&lt;/a&gt;&lt;/h4&gt;

&lt;p&gt;This is &lt;code&gt;$HOME/.gitconfig&lt;/code&gt;.  Whenever you add the &lt;code&gt;--global&lt;/code&gt; option to the
&lt;code&gt;git config&lt;/code&gt; command, it acts on the global gitconfig file.&lt;/p&gt;

&lt;p&gt;Setup your identity&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;git config --global user.email your.name@your.com
git config --global user.name &quot;your name&quot;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Setup the push default: choose one of these.  New users should take the first
one, but the traditional default has always been the second one, so I&#39;m used
to that&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;git config --global push.default nothing
git config --global push.default matching
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Setup to edit files from within &quot;git gui&quot;; replace &quot;gvim -f&quot; with whatever you
prefer&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;git config --global guitool.Edit.cmd &#39;gvim -f $FILENAME&#39;
git config --global guitool.Edit.noconsole yes
git config --global guitool.Edit.needsfile yes
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;If you intend to use the command line more than the GUI, please do check out
&lt;a href=&quot;../tools/my.gitconfig.txt&quot;&gt;my gitconfig&lt;/a&gt; for many useful examples that will
save you lots of time and trouble.&lt;/p&gt;

&lt;h4&gt;&lt;a name=&quot;_admin_every_bare_repository&quot;&gt;(admin) every bare repository&lt;/a&gt;&lt;/h4&gt;

&lt;p&gt;&lt;sup&gt;&lt;a href=&quot;../concepts/bare.html&quot;&gt;What is a bare repo?&lt;/a&gt;&lt;/sup&gt;&lt;/p&gt;

&lt;p&gt;Make sure all updates are logged and remote deletion of branches is disabled.
If this is a &quot;git server&quot; (all repos are bare), you should seriously consider
just adding the &lt;code&gt;--global&lt;/code&gt; option to the two commands below, so you don&#39;t have
to remember to do this on each repo.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;git config core.logAllRefUpdates true
git config receive.denyDeletes true
&lt;/code&gt;&lt;/pre&gt;

&lt;h3&gt;&lt;a name=&quot;write_useful_readable_commit_messages&quot;&gt;write useful, readable, commit messages&lt;/a&gt;&lt;/h3&gt;

&lt;p&gt;A good description of this is at &lt;a href=&quot;http://www.tpope.net/node/106&quot;&gt;http://www.tpope.net/node/106&lt;/a&gt;.  But
briefly, try and stick to the following guidelines:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;the first line of the commit message (often called a &quot;subject&quot;) should be
a &lt;em&gt;summary&lt;/em&gt; of the entire commit&lt;/li&gt;
&lt;li&gt;it should not be more than about 70 characters long&lt;/li&gt;
&lt;li&gt;it should include any reference info (like bug number, issue number, etc)
if applicable&lt;/li&gt;
&lt;li&gt;the rest of the message (&quot;body&quot;) can be pretty much anything, but leave a
blank line between the &quot;subject&quot; and the &quot;body&quot;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Git uses the &quot;subject&quot; part in many places and it is very useful to have a
short, meaningful subject line for each commit.&lt;/p&gt;

&lt;h2&gt;&lt;a name=&quot;DONTs&quot;&gt;DONTs&lt;/a&gt;&lt;/h2&gt;

&lt;h3&gt;&lt;a name=&quot;actions_whose_results_can_be_confusing&quot;&gt;actions whose results can be confusing&lt;/a&gt;&lt;/h3&gt;

&lt;h4&gt;&lt;a name=&quot;do_not_checkout_remote_branches&quot;&gt;do not checkout &quot;remote&quot; branches&lt;/a&gt;&lt;/h4&gt;

&lt;p&gt;When running &lt;code&gt;gitk&lt;/code&gt; (the graphical history viewer) do NOT be tempted to right
click and checkout any branch whose name starts with &quot;remotes/&quot;.&lt;/p&gt;

&lt;p&gt;Helpfully, these branches are colored partly orange and partly green.
(Branches that are safe to checkout are colored fully green.)&lt;/p&gt;

&lt;p&gt;The problem with checking out a &quot;remotes&quot; branch is that any commits you make
on top of them can get lost when you checkout some other branch.  See the
article on a &lt;a href=&quot;../concepts/detached-head.html&quot;&gt;detached head&lt;/a&gt;.&lt;/p&gt;
&lt;/html&gt;
</pre>
</div>
<div title="simple-git-session" modifier="Sitaram" created="201110051936">
<pre>
&lt;html&gt;
&lt;h1&gt;simple git session&lt;/h1&gt;

&lt;p&gt;This is a transcript of a simple git session, using local files as the
&quot;transport&quot; medium.  We use a &quot;bare&quot; repo, in a directory called &quot;b&quot;, as the
&quot;server&quot;, and working clones in directories called &quot;c&quot; and &quot;c2&quot;.&lt;/p&gt;

&lt;p&gt;That is, we simply use the local file system as the transport protocol.
People familiar with URLs on a browser might recognise this as eqvt to
&lt;code&gt;file:///full/path/to/something&lt;/code&gt;, and indeed that is exactly what git treats
it as.&lt;/p&gt;

&lt;p&gt;Using ssh or http merely changes&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;the URL used&lt;/li&gt;
&lt;li&gt;the authentication required and permissions granted by the server&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;What &lt;strong&gt;does NOT change&lt;/strong&gt; is the behaviour of most git commands!&lt;/p&gt;

&lt;p&gt;This means you can play with git to your heart&#39;s content in some temporary
directory.  There&#39;s no danger of messing up a real repo, or of getting
side-tracked by connectivity or permissions or even speed issues, which might
happen if you tried this with a real server.&lt;/p&gt;

&lt;hr /&gt;

&lt;p&gt;Notes: Blank lines placed before each command for clarity.&lt;/p&gt;

&lt;hr /&gt;

&lt;pre&gt;&lt;code&gt;$ mkdir simple-demo

$ cd simple-demo

$ git init --bare b
Initialized empty Git repository in /home/sitaram/t/simple-demo/b/
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;This is your &quot;server&quot; repo.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;$ git clone b c
Cloning into c...
done.
warning: You appear to have cloned an empty repository.
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;That is actually the same as &lt;code&gt;git clone file://$PWD/b c&lt;/code&gt;, where that
&lt;code&gt;file://...&lt;/code&gt; stuff is a URL, as discussed above.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;$ cd c

$ touch file;git add file;git commit -m &#39;added file&#39;
[master (root-commit) fe2f9d5] added file
 0 files changed, 0 insertions(+), 0 deletions(-)
 create mode 100644 file
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Now it&#39;s time to push the changes to the &quot;server&quot;.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;$ git push
No refs in common and none specified; doing nothing.
Perhaps you should specify a branch such as &#39;master&#39;.
fatal: The remote end hung up unexpectedly
error: failed to push some refs to &#39;/home/sitaram/t/simple-demo/b&#39;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;This is a common mistake, not realising that the first push needs an explicit
branch name because your clone and the server have &quot;no refs in common&quot;
(meaning no branches or tags), which is true, since the server is an empty
repo, containing &lt;em&gt;nothing&lt;/em&gt; at all right now.  When the two repos have no refs
in common, &quot;git push&quot; doesn&#39;t know what to do, so you have to be specific:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;$ git push origin master
Counting objects: 3, done.
Writing objects: 100% (3/3), 209 bytes, done.
Total 3 (delta 0), reused 0 (delta 0)
Unpacking objects: 100% (3/3), done.
To /home/sitaram/t/simple-demo/b
 * [new branch]      master -&amp;gt; master
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Now we go out of this clone and make a new one:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;$ cd ..

$ git clone b c2
Cloning into c2...
done.

$ cd c2

$ git log
commit fe2f9d5a80968856916b03395dd9b9f6d08d73a6
Author: Sitaram Chamarty &amp;lt;sitaram@atc.tcs.com&amp;gt;
Date:   Sat Oct 16 15:17:46 2010 +0530

    added file
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;And hey -- there&#39;s the commit you made in directory &quot;c&quot; and pushed up to the
server!&lt;/p&gt;

&lt;p&gt;So now you make some changes here and push them to the &quot;server&quot;:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;$ touch file2;git add file2; git commit -m &#39;added file2&#39;
[master 48eed78] added file2
 0 files changed, 0 insertions(+), 0 deletions(-)
 create mode 100644 file2

$ git push
Counting objects: 3, done.
Delta compression using up to 2 threads.
Compressing objects: 100% (2/2), done.
Writing objects: 100% (2/2), 237 bytes, done.
Total 2 (delta 0), reused 0 (delta 0)
Unpacking objects: 100% (2/2), done.
To /home/sitaram/t/simple-demo/b
   fe2f9d5..48eed78  master -&amp;gt; master
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;And back in &quot;c&quot; you see how things look, and do other gittish things:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;$ cd ../c

$ git fetch
remote: Counting objects: 3, done.
remote: Compressing objects: 100% (2/2), done.
remote: Total 2 (delta 0), reused 0 (delta 0)
Unpacking objects: 100% (2/2), done.
From /home/sitaram/t/simple-demo/b
   fe2f9d5..48eed78  master     -&amp;gt; origin/master

$ git status
# On branch master
# Your branch is behind &#39;origin/master&#39; by 1 commit, and can be fast-forwarded.
#
nothing to commit (working directory clean)

$ git pull
Updating fe2f9d5..48eed78
Fast-forward
 0 files changed, 0 insertions(+), 0 deletions(-)
 create mode 100644 file2

$ git status
# On branch master
nothing to commit (working directory clean)

$ git log
commit 48eed784d1f57f1fbae6bd75d171608d6730b30b
Author: Sitaram Chamarty &amp;lt;sitaram@atc.tcs.com&amp;gt;
Date:   Sat Oct 16 15:18:52 2010 +0530

    added file2

commit fe2f9d5a80968856916b03395dd9b9f6d08d73a6
Author: Sitaram Chamarty &amp;lt;sitaram@atc.tcs.com&amp;gt;
Date:   Sat Oct 16 15:17:46 2010 +0530

    added file
&lt;/code&gt;&lt;/pre&gt;

&lt;hr /&gt;

&lt;p&gt;There... was that so hard?&lt;/p&gt;
&lt;/html&gt;
</pre>
</div>
<div title="intro" modifier="Sitaram" created="201110051936">
<pre>
&lt;html&gt;
&lt;h1&gt;a very basic intro to version control and git&lt;/h1&gt;

&lt;h1&gt;why&lt;/h1&gt;

&lt;p&gt;../images/projects-sans-vcs.png&lt;/p&gt;

&lt;h1&gt;what is a VCS&lt;/h1&gt;

&lt;h1&gt;why use a VCS&lt;/h1&gt;

&lt;ul&gt;
&lt;li&gt;reversibility or rollback@@, aka C-Y-A!
&lt;ul&gt;
&lt;li&gt;linear (on the time axis)@@, simple to implement&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;concurrency
&lt;ul&gt;
&lt;li&gt;non-linear@@, all the complexity is here&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;annotation&lt;/li&gt;
&lt;/ul&gt;

&lt;h1&gt;creating a repository&lt;/h1&gt;

&lt;ul&gt;
&lt;li&gt;how hard is it?&lt;/li&gt;
&lt;/ul&gt;

&lt;h1&gt;an empty directory&lt;/h1&gt;

&lt;p&gt;intro-images/empty.png&lt;/p&gt;

&lt;h1&gt;add some files&lt;/h1&gt;

&lt;p&gt;intro-images/sampleproj.png&lt;/p&gt;

&lt;h1&gt;&#39;git init&#39; -- done!&lt;/h1&gt;

&lt;p&gt;intro-images/init-done.png&lt;/p&gt;

&lt;h1&gt;how about on windows?&lt;/h1&gt;

&lt;p&gt;intro-images/empty-windows.png&lt;/p&gt;

&lt;h1&gt;making a repository&lt;/h1&gt;

&lt;p&gt;intro-images/init-win1.png&lt;/p&gt;

&lt;h1&gt;making a repository&lt;/h1&gt;

&lt;p&gt;intro-images/init-win2.png&lt;/p&gt;

&lt;h1&gt;making a repository&lt;/h1&gt;

&lt;p&gt;intro-images/init-win3.png&lt;/p&gt;

&lt;h1&gt;done!&lt;/h1&gt;

&lt;p&gt;intro-images/init-win4.png&lt;/p&gt;

&lt;h1&gt;just checking...&lt;/h1&gt;

&lt;p&gt;intro-images/init-done-win1.png&lt;/p&gt;

&lt;h1&gt;yup -- works fine!&lt;/h1&gt;

&lt;p&gt;intro-images/init-done-win2.png&lt;/p&gt;

&lt;h1&gt;CLI on windows?&lt;/h1&gt;

&lt;p&gt;intro-images/init-winb1.png&lt;/p&gt;

&lt;h1&gt;a bash shell&lt;/h1&gt;

&lt;p&gt;intro-images/init-winb2.png&lt;/p&gt;

&lt;h1&gt;&#39;git init&#39; -- done!&lt;/h1&gt;

&lt;p&gt;intro-images/init-done-winb.png&lt;/p&gt;

&lt;h1&gt;what is a &#39;work tree&#39;&lt;/h1&gt;

&lt;p&gt;intro-images/worktree.png&lt;/p&gt;

&lt;h1&gt;what is a &#39;repo&#39;&lt;/h1&gt;

&lt;ul&gt;
&lt;li&gt;A repository is just
&lt;ul&gt;
&lt;li&gt;a work tree, @@plus&lt;/li&gt;
&lt;li&gt;a special &#39;.git&#39; directory at the top level of the work tree.&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;NEVER FIDDLE WITH THIS DIRECTORY UNLESS YOU KNOW WHAT YOU ARE DOING!&lt;/li&gt;
&lt;li&gt;YOU HAVE BEEN WARNED!&lt;/li&gt;
&lt;/ul&gt;

&lt;h1&gt;repository&lt;/h1&gt;

&lt;p&gt;intro-images/repo.png&lt;/p&gt;

&lt;h1&gt;(what&#39;s inside &#39;.git&#39;?)&lt;/h1&gt;

&lt;p&gt;intro-images/inside-dotgit.png&lt;/p&gt;

&lt;h1&gt;you said &#39;non-linear&#39;&lt;/h1&gt;

&lt;p&gt;l:intro-images/worktree-symbol.png&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;sure...&lt;/li&gt;
&lt;li&gt;a repository keeps snapshots of the work tree...&lt;/li&gt;
&lt;li&gt;...at different points in time&lt;/li&gt;
&lt;/ul&gt;

&lt;h1&gt;snap&lt;/h1&gt;

&lt;p&gt;intro-images/repo-1.png&lt;/p&gt;

&lt;h1&gt;snapshots&lt;/h1&gt;

&lt;p&gt;intro-images/repo-2.png&lt;/p&gt;

&lt;h1&gt;snapshots of the work tree&lt;/h1&gt;

&lt;p&gt;intro-images/repo-3.png&lt;/p&gt;

&lt;h1&gt;at different&lt;/h1&gt;

&lt;p&gt;intro-images/repo-4.png&lt;/p&gt;

&lt;h1&gt;at different points&lt;/h1&gt;

&lt;p&gt;intro-images/repo-5.png&lt;/p&gt;

&lt;h1&gt;at different points in time&lt;/h1&gt;

&lt;p&gt;intro-images/repo-6.png&lt;/p&gt;

&lt;h1&gt;what is a commit&lt;/h1&gt;

&lt;p&gt;remember those snapshots?  Yup -- they&#39;re all commits!&lt;/p&gt;

&lt;p&gt;Here, to refresh your memory:&lt;/p&gt;

&lt;p&gt;h50%:intro-images/repo-6.png&lt;/p&gt;

&lt;h1&gt;what is a repo again?&lt;/h1&gt;

&lt;ul&gt;
&lt;li&gt;a work tree + .git?  @@sure, but also...&lt;/li&gt;
&lt;li&gt;a bunch of commits laid out as a &#39;graph&#39;
&lt;ul&gt;
&lt;li&gt;a &quot;directed acyclic graph&quot;, if you&#39;re interested&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h1&gt;DAG&lt;/h1&gt;

&lt;p&gt;intro-images/dag.png&lt;/p&gt;

&lt;h1&gt;what is a branch&lt;/h1&gt;

&lt;ul&gt;
&lt;li&gt;since a graph is sort of the same as a tree (for our purposes)
&lt;ul&gt;
&lt;li&gt;it has branches&lt;/li&gt;
&lt;li&gt;and those branches have names&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h1&gt;branches&lt;/h1&gt;

&lt;p&gt;intro-images/dag-br.png&lt;/p&gt;

&lt;h1&gt;what is a tag&lt;/h1&gt;

&lt;ul&gt;
&lt;li&gt;when you checkout a branch and then commit, the branch is now pointing at
the new &#39;snapshot&#39;.  @@This means...&lt;/li&gt;
&lt;li&gt;...the branch &#39;tip&#39; keeps moving with every commit&lt;/li&gt;
&lt;li&gt;But sometimes you want to mark a point in your development
&lt;ul&gt;
&lt;li&gt;with some sort of a permanent label&lt;/li&gt;
&lt;li&gt;that stays right there, even if you add commits on top&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h1&gt;tags&lt;/h1&gt;

&lt;p&gt;intro-images/dag-br-tag.png&lt;/p&gt;

&lt;h1&gt;general VCS concepts&lt;/h1&gt;

&lt;ul&gt;
&lt;li&gt;&quot;project&quot;: minimum set of source code (and related files) needed
to &lt;strong&gt;build&lt;/strong&gt; the software&lt;/li&gt;
&lt;li&gt;in a CVCS (Centralised VCS)
&lt;ul&gt;
&lt;li&gt;each project will have exactly one &quot;repository&quot;&lt;/li&gt;
&lt;li&gt;on some central server&lt;/li&gt;
&lt;li&gt;and each developer will checkout the project
&lt;ul&gt;
&lt;li&gt;from the server to his workstation&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h1&gt;a DVCS is different&lt;/h1&gt;

&lt;ul&gt;
&lt;li&gt;each project will have one &quot;central&quot; repository
&lt;ul&gt;
&lt;li&gt;(maybe; see next slide)&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;but each repository can have many &quot;clones&quot;&lt;/li&gt;
&lt;li&gt;so each developer has a clone on his workstation
&lt;ul&gt;
&lt;li&gt;a complete copy of the repository&lt;/li&gt;
&lt;li&gt;plus his own work/changes&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h1&gt;central repo in a DVCS?&lt;/h1&gt;

&lt;ul&gt;
&lt;li&gt;the developers can push and pull from each other directly
&lt;ul&gt;
&lt;li&gt;because they&#39;re also repositories just like the &quot;central&quot; one&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;so do we still need a &quot;central&quot; repo?
&lt;ul&gt;
&lt;li&gt;not really@@; that&#39;s only an administrative decision now&lt;/li&gt;
&lt;li&gt;not a technical requirement&lt;/li&gt;
&lt;li&gt;but it makes managing projects easier&lt;/li&gt;
&lt;li&gt;so yes, we still have central repos for most projects&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h1&gt;what is a &#39;remote&#39;&lt;/h1&gt;

&lt;ul&gt;
&lt;li&gt;when you clone, the repo you cloned from is a &#39;remote&#39; for you&lt;/li&gt;
&lt;li&gt;every remote has a name (a user-friendly name you choose)&lt;/li&gt;
&lt;li&gt;(special case for clone: the &#39;remote&#39; has a special name: &#39;origin&#39;)
&lt;ul&gt;
&lt;li&gt;much nicer than using the full URL, like&lt;/li&gt;
&lt;li&gt;&lt;code&gt;ssh://sitaram@git.server/repos/myproj.git&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;bad picture coming up...&lt;/li&gt;
&lt;/ul&gt;

&lt;h1&gt;remotes&lt;/h1&gt;

&lt;p&gt;(ok that&#39;s not a bad picture; it&#39;s HORRIBLE picture!)&lt;/p&gt;

&lt;p&gt;intro-images/remote.png&lt;/p&gt;

&lt;h1&gt;git concepts&lt;/h1&gt;

&lt;ul&gt;
&lt;li&gt;repo
&lt;ul&gt;
&lt;li&gt;self-contained; remove &quot;.git&quot; at the top and it&#39;s all gone&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;branch
&lt;ul&gt;
&lt;li&gt;an active line of development&lt;/li&gt;
&lt;li&gt;a repo can track any number of branches&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;master
&lt;ul&gt;
&lt;li&gt;name of default branch in a new git project&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h1&gt;concept detail: branches&lt;/h1&gt;

&lt;ul&gt;
&lt;li&gt;easy and inexpensive&lt;/li&gt;
&lt;li&gt;can have separate branches for separate features&lt;/li&gt;
&lt;li&gt;many being worked on &quot;simultaneously&quot;!&lt;/li&gt;
&lt;li&gt;you can switch rapidly between branches&lt;/li&gt;
&lt;li&gt;boosts individual productivity as well as team productivity&lt;/li&gt;
&lt;li&gt;almost all existing VCSs suck at this&lt;/li&gt;
&lt;/ul&gt;

&lt;h1&gt;individual productivity?&lt;/h1&gt;

&lt;ul&gt;
&lt;li&gt;concurrency&lt;/li&gt;
&lt;li&gt;makes context switching trivial&lt;/li&gt;
&lt;/ul&gt;

&lt;h1&gt;git concepts (cont&#39;d)&lt;/h1&gt;

&lt;ul&gt;
&lt;li&gt;working tree
&lt;ul&gt;
&lt;li&gt;is associated with only one branch at any time&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;head
&lt;ul&gt;
&lt;li&gt;the tip of a branch&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;HEAD
&lt;ul&gt;
&lt;li&gt;the tip of the branch associated with your working tree; this is where
commits go&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h1&gt;git concepts (cont&#39;d)&lt;/h1&gt;

&lt;ul&gt;
&lt;li&gt;index: holding area for changes approved for commit
&lt;ul&gt;
&lt;li&gt;git tracks content, not files&lt;/li&gt;
&lt;li&gt;lets you select some files to commit while postponing others&lt;/li&gt;
&lt;li&gt;lets you keep uncommited changes hanging around&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h1&gt;some more git concepts&lt;/h1&gt;

&lt;ul&gt;
&lt;li&gt;commit ancestry&lt;/li&gt;
&lt;li&gt;commit ancestry as a DAG
&lt;ul&gt;
&lt;li&gt;the essence of git is to build and traverse this DAG&lt;/li&gt;
&lt;li&gt;http://sitaramc.github.com/gcs/index.html&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;universal public identifier (a SHA-1 hash)
&lt;ul&gt;
&lt;li&gt;every file, directory, and commit has a unique hash&lt;/li&gt;
&lt;li&gt;check the integrity of an entire repo by comparing just one 160-bit
value (40 hex digits)&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h1&gt;workflow&lt;/h1&gt;

&lt;ul&gt;
&lt;li&gt;far better than anything I can try:
&lt;ul&gt;
&lt;li&gt;http://nathanj.github.com/gitguide&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;so I&#39;ll just describe things at a high level&lt;/li&gt;
&lt;/ul&gt;

&lt;h1&gt;one-time setup&lt;/h1&gt;

&lt;ul&gt;
&lt;li&gt;per developer
&lt;ul&gt;
&lt;li&gt;set up your name and email address&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;per developer per project
&lt;ul&gt;
&lt;li&gt;&#39;git init&#39; (the first guy)&lt;/li&gt;
&lt;li&gt;&#39;git clone ...&#39; (the others)&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h1&gt;err... clone?  from where?&lt;/h1&gt;

&lt;ul&gt;
&lt;li&gt;git servers and protocols (note: git does NO access control!)
&lt;ul&gt;
&lt;li&gt;ssh (RW, access control by ssh)&lt;/li&gt;
&lt;li&gt;file protocol (RW, access control by OS)&lt;/li&gt;
&lt;li&gt;git protocol (RO, access control by OS/firewall etc)
&lt;ul&gt;
&lt;li&gt;needs git daemon to be started first&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;old style http (RO, access control by Apache)
&lt;ul&gt;
&lt;li&gt;RW possible but painful; requires WebDAV&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;new style http (RW, access control by apache)
&lt;ul&gt;
&lt;li&gt;requires git 1.6.6 or better on both server and client&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h1&gt;many users/repos?&lt;/h1&gt;

&lt;ul&gt;
&lt;li&gt;just install &#39;gitolite&#39; and be done!&lt;/li&gt;
&lt;li&gt;gitolite can provide fine-grained access control&lt;/li&gt;
&lt;li&gt;works over sshd or apache
&lt;ul&gt;
&lt;li&gt;sshd (or httpd) authenticates the user&lt;/li&gt;
&lt;li&gt;passes the username to gitolite&lt;/li&gt;
&lt;li&gt;gitolite uses the authenticated username, looks at the config file, and
makes the authorisation decision&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h1&gt;normal workflow activities&lt;/h1&gt;

&lt;ul&gt;
&lt;li&gt;checkout a branch&lt;/li&gt;
&lt;li&gt;edit files&lt;/li&gt;
&lt;li&gt;review your changes (&#39;git diff&#39;, or &#39;git gui&#39;)&lt;/li&gt;
&lt;li&gt;review other people&#39;s changes or your older commits (&#39;gitk&#39; -- a very
powerful GUI tool)&lt;/li&gt;
&lt;li&gt;stage and commit them&lt;/li&gt;
&lt;/ul&gt;

&lt;h1&gt;normal workflow activities&lt;/h1&gt;

&lt;ul&gt;
&lt;li&gt;push your commits to the server&lt;/li&gt;
&lt;li&gt;push failed?  maybe your teammates committed something recently?
&lt;ul&gt;
&lt;li&gt;pull from the server first&lt;/li&gt;
&lt;li&gt;their changes get merged into your local repo&lt;/li&gt;
&lt;li&gt;then you push...&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h1&gt;clean and dirty work tree&lt;/h1&gt;

&lt;ul&gt;
&lt;li&gt;clean: all changes committed to local repo&lt;/li&gt;
&lt;li&gt;dirty: some files changed, and changes not yet committed&lt;/li&gt;
&lt;li&gt;PULL IS BEST DONE ON A CLEAN TREE!&lt;/li&gt;
&lt;/ul&gt;

&lt;h1&gt;clean tree - CLI&lt;/h1&gt;

&lt;p&gt;intro-images/clean-cli.png&lt;/p&gt;

&lt;h1&gt;clean tree - GUI&lt;/h1&gt;

&lt;p&gt;intro-images/clean-gui.png&lt;/p&gt;

&lt;h1&gt;dirty tree - CLI&lt;/h1&gt;

&lt;p&gt;intro-images/dirty-cli.png&lt;/p&gt;

&lt;h1&gt;dirty tree - GUI&lt;/h1&gt;

&lt;p&gt;intro-images/dirty-gui.png&lt;/p&gt;

&lt;h1&gt;staging from the GUI&lt;/h1&gt;

&lt;p&gt;intro-images/staging-gui.png&lt;/p&gt;

&lt;h1&gt;staged files - CLI&lt;/h1&gt;

&lt;p&gt;intro-images/staged-cli.png&lt;/p&gt;

&lt;h1&gt;committing from the GUI&lt;/h1&gt;

&lt;p&gt;intro-images/commit-gui.png&lt;/p&gt;

&lt;h1&gt;clean again!&lt;/h1&gt;

&lt;p&gt;intro-images/clean-again.png&lt;/p&gt;

&lt;h1&gt;conflicts&lt;/h1&gt;

&lt;ul&gt;
&lt;li&gt;what is a conflict&lt;/li&gt;
&lt;li&gt;how do you resolve it?&lt;/li&gt;
&lt;/ul&gt;

&lt;h1&gt;advanced workflow activities&lt;/h1&gt;

&lt;ul&gt;
&lt;li&gt;cherry-pick -- pick up specific changes from another branch or repo and
make those changes happen in your repo&lt;/li&gt;
&lt;li&gt;rebase -- move commits around@@; sort of like
&lt;ul&gt;
&lt;li&gt;cut off a branch where it connects to the trunk of a tree...&lt;/li&gt;
&lt;li&gt;...and graft it somewhere else&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;bisect&lt;/li&gt;
&lt;/ul&gt;

&lt;h1&gt;...and we&#39;re done!&lt;/h1&gt;
&lt;/html&gt;
</pre>
</div>
<div title="real-blame" modifier="Sitaram" created="201110051936">
<pre>
&lt;html&gt;
&lt;h1&gt;&lt;a name=&quot;who_pushed_this_particular_commit_&quot;&gt;who pushed this particular commit?&lt;/a&gt;&lt;/h1&gt;

&lt;p&gt;&lt;sup&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#who_pushed_this_particular_commit_&quot;&gt;who pushed this particular commit?&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#WARNING_THIS_DOCUMENT_IS_OBSOLETE&quot;&gt;WARNING: THIS DOCUMENT IS OBSOLETE&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#one_time_setup&quot;&gt;one-time setup&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#investigation&quot;&gt;investigation&lt;/a&gt;&lt;br&gt;&lt;/p&gt;

&lt;p&gt;&lt;/sup&gt;&lt;/p&gt;

&lt;hr /&gt;

&lt;h2&gt;&lt;a name=&quot;WARNING_THIS_DOCUMENT_IS_OBSOLETE&quot;&gt;WARNING: THIS DOCUMENT IS OBSOLETE&lt;/a&gt;&lt;/h2&gt;

&lt;p&gt;Just install gitolite -- it&#39;ll produce a much better log than anything you&#39;ll
get from this document.  See the &quot;better logging&quot; section of
&lt;a href=&quot;http://github.com/sitaramc/gitolite/blob/master/doc/3-faq-tips-etc.mkd&quot;&gt;http://github.com/sitaramc/gitolite/blob/master/doc/3-faq-tips-etc.mkd&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;I&#39;m keeping this document around only to show you how difficult this is
without gitolite ;-)&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;Gitolite is at &lt;a href=&quot;http://github.com/sitaramc/gitolite&quot;&gt;http://github.com/sitaramc/gitolite&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;... and now, on to the document&lt;/p&gt;

&lt;hr /&gt;

&lt;p&gt;Someone on IRC postulated that git does not track who pushed a series of
commits into a server, and could allow one dev to blame some other dev by
pushing stuff with the victim&#39;s name/email as the author/committer.&lt;/p&gt;

&lt;p&gt;The first answer to this of course is that you can force everything to happen
with gpg-signed tags -- the project pulls only gpg-signed tags, and if you
signed a tag (which in turn stamps the entire commit DAG upto that point) then
you&#39;d better know what you&#39;re doing!&lt;/p&gt;

&lt;p&gt;However, we don&#39;t always sign like this; it makes it cumbersome and it
requires all the devs to conform to this discipline, and is too big a price to
pay for something that may never happen.  We need something that&#39;ll just sit
in the background, saving enough info for us to track &quot;after the fact&quot;, should
it ever become necessary.&lt;/p&gt;

&lt;h3&gt;&lt;a name=&quot;one_time_setup&quot;&gt;one-time setup&lt;/a&gt;&lt;/h3&gt;

&lt;p&gt;So, the short answer, for a gitosis-administered central repo, is this:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;(as root) in &lt;code&gt;/etc/ssh/sshd_config&lt;/code&gt;, add the following lines (or change
INFO to VERBOSE if that&#39;s already present)&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;# Logging
SyslogFacility AUTH
LogLevel VERBOSE
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;(as the &quot;git&quot; user) in each repository of interest (or globally, by adding
&lt;code&gt;--global&lt;/code&gt;; highly recommended for servers), do the following.  The second command is useful even in
general, but in this case the relevance is that deleting a branch wipes
out its reflog too, so you want to prevent that:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;git config core.logAllRefUpdates true
git config receive.denyDeletes true
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;That&#39;s it.  Of course, if your system logs get deleted after about 4 weeks or
so, you may want to keep &lt;code&gt;auth.log&lt;/code&gt; out of it or do something to preserve
those logs for a longer period of time.&lt;/p&gt;

&lt;h3&gt;&lt;a name=&quot;investigation&quot;&gt;investigation&lt;/a&gt;&lt;/h3&gt;

&lt;p&gt;So let&#39;s say you look at the reflog and find you want to know who pushed a
particular commit[1]&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;git@git:~/repositories/testing.git$ git reflog
582b3ad... HEAD@{0}: push
f0a5fc1...
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;You&#39;re interested in &lt;code&gt;582b3ad&lt;/code&gt;, so you do the following (note that the output
line below is wrapped for the purposes of this page):&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;git@git:~/repositories/testing.git$ grep -r &#39; 582b3&#39; logs
logs/HEAD:f0a5fc1171c967a7af975fc454a25a599066565b
    582b3ad0219d922a9aed6f5cbb3f4f9a5741df6b git master user
    &amp;lt;git@my.domain.com&amp;gt; 1238837842 +0530      push
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;There&#39;s a timestamp in there, that &lt;code&gt;1238837842&lt;/code&gt; thing, which you have to
decode:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;$ perl -le &#39;print scalar(localtime $ARGV[0])&#39; 1238837842
Sat Apr  4 15:07:22 2009
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Come Watson, the game is afoot...&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;root@git:/var/log# grep Apr..4.15:07 auth.log
Apr  4 15:07:19 git sshd[23765]: Connection from 172.25.149.2 port 56889
Apr  4 15:07:20 git sshd[23765]: Failed none for git from 172.25.149.2 port 56889 ssh2
Apr  4 15:07:20 git sshd[23765]: Found matching RSA key: fc:c1:48:1e:06:31:97:a4:8b:fc:37:b2:76:14:c7:53
Apr  4 15:07:21 git sshd[23765]: Found matching RSA key: fc:c1:48:1e:06:31:97:a4:8b:fc:37:b2:76:14:c7:53
Apr  4 15:07:21 git sshd[23765]: Accepted publickey for git from 172.25.149.2 port 56889 ssh2
Apr  4 15:07:21 git sshd[23768]: pam_unix(sshd:session): session opened for user git by (uid=0)
Apr  4 15:07:22 git sshd[23768]: Connection closed by 172.25.149.2
Apr  4 15:07:22 git sshd[23768]: pam_unix(sshd:session): session closed for user git
Apr  4 15:07:22 git sshd[23768]: Closing connection to 172.25.149.2
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Now go to a clone of the gitosis-admin directory, and do this (I&#39;ve removed
the &lt;code&gt;&amp;gt;&lt;/code&gt; signs that normally form &lt;code&gt;$PS2&lt;/code&gt; so you can copy-paste this):&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;$ cd keydir
$ for i in *.pub
do
    cat $i | while read r
    do
        echo &quot;$r&quot; &amp;gt; /tmp/junk.pubkey
        ssh-keygen -l -f /tmp/junk.pubkey |grep fc.c1.48 &amp;amp;&amp;amp;
            echo ===== $i matched =====
    done
done
2048 fc:c1:48:1e:06:31:97:a4:8b:fc:37:b2:76:14:c7:53 /tmp/junk.pubkey (RSA)
===== sitaram.pub matched =====
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;And we&#39;ve nailed him :-)&lt;/p&gt;

&lt;p&gt;&lt;sup&gt;
PS: a note on that shell snippet: you need to do it this way because a gitosis
pubkey file can contain more than one pubkey (for the same user of course) in
it.  Typically this is because of using different machines or whatever.  If
you pass such a file to &lt;code&gt;ssh-keygen -l&lt;/code&gt; it&#39;ll only compute the fingerprint of
the first pubkey in the file.  I found this out quite luckily -- I&#39;d
completely forgotten about the multiple keys per file thing...!
&lt;/sup&gt;&lt;/p&gt;

&lt;hr /&gt;

&lt;p&gt;&lt;sup&gt;
[1] The reflog stores only the &quot;tip&quot; of a series of commits, so if the
suspicious commit is in the middle of a series which was pushed all at once,
you have some extra work.&lt;/p&gt;

&lt;p&gt;The basic idea is, you take the second SHA in each reflog line, check
if it is a descendent of the commit you want, note the timestamp if so, and
then choose the earliest among them to go check in &lt;code&gt;auth.log&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;I&#39;ll write a script to do this if someone asks... right now I can&#39;t be
bothered :-)
&lt;/sup&gt;&lt;/p&gt;
&lt;/html&gt;
</pre>
</div>
<div title="ignore-upstream-commit" modifier="Sitaram" created="201110051936">
<pre>
&lt;html&gt;
&lt;h1&gt;ignoring an upstream commit permanently&lt;/h1&gt;

&lt;p&gt;(untested)&lt;/p&gt;

&lt;p&gt;...as usual, doener on irc, circa 2009-07-15 10:00&lt;/p&gt;

&lt;hr /&gt;

&lt;h5&gt;problem&lt;/h5&gt;

&lt;pre&gt;&lt;code&gt;A---B---C---D---E (master)
 \
  X---X---V---X (upstream)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;You try to merge upstream to master and get a shitload of conflicts.&lt;/p&gt;

&lt;p&gt;&quot;gitk --merge&quot; tells you that commit V is &quot;guilty&quot; and is just a variation of,
let&#39;s say, B (doesn&#39;t matter), that differs enough to cause those conflicts.&lt;/p&gt;

&lt;p&gt;You decide that you don&#39;t want V&#39;s version of the changes, now or in future.
That is, though you will keep merging from upstream, you don&#39;t want to see &quot;V&quot;
ever again.&lt;/p&gt;

&lt;h5&gt;assumption&lt;/h5&gt;

&lt;p&gt;You never have to push this upstream; it&#39;s your private copy (think &quot;customer
specific branch&quot;)&lt;/p&gt;

&lt;h5&gt;caveats&lt;/h5&gt;

&lt;p&gt;Eventually, something upstream will patch something from V, and since you
don&#39;t have that particular set of code, you&#39;ll get a patch that cannot be
applied.  At that point you can repeat this method to discard &lt;em&gt;that&lt;/em&gt; commit,
or fix the conflicts somehow and move on.&lt;/p&gt;

&lt;h5&gt;the hard solution&lt;/h5&gt;

&lt;p&gt;Fix all the conflicts and commit.  For people still living in other version
control systems :-)&lt;/p&gt;

&lt;h5&gt;the easy solution&lt;/h5&gt;

&lt;p&gt;Create a branch from upstream where you revert V and merge that to master&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;git checkout -b tmp upstream
git revert V        # produces commit &quot;R&quot;
git checkout master
git merge tmp       # please also use -m to document this properly!
git branch -d tmp

A---B---C---D---E---M (master)
 \                 /
  \               R
   \             /
    X---X---V---X (upstream)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Next update from upstream will lead to:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;git merge upstream

A---B---C---D---E---M---M2 (master)
 \                 /   /
  \               R   /
   \             /   /
    X---X---V---X---X (upstream)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;(and so on; you&#39;ve essentially eliminated &quot;V&quot; forever in your branch).&lt;/p&gt;

&lt;p&gt;Note: doener calls this ugly, but I like this much better than the next one.
First, this only uses porcelain, no plumbing.  Second, the extra commit &quot;R&quot;
makes it clear that something happened, even if the merge commit at &quot;M&quot; was
not properly commented.&lt;/p&gt;

&lt;h5&gt;the hackish, low-level solution&lt;/h5&gt;

&lt;p&gt;Don&#39;t use this if, like me, you&#39;re not comfortable with plumbing.  This
section is just for the record, and because the idea is very cool.
Personally, I never use plumbing -- too many commands, too hard for me to
understand, even more difficult (for me) to explain.&lt;/p&gt;

&lt;p&gt;Create a branch from upstream, and revert V&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;git checkout -b tmp upstream
git revert V
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Merge master to that:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;git merge master
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Hopefully, the revert as well as the merge went pretty much conflict-free now.
So you have the merge result that you want in tmp.&lt;/p&gt;

&lt;p&gt;Now, create the real merge:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;git checkout master
git merge upstream
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;This will cause conflicts again, but instead of fixing them, you just re-use
the merge result that you already have:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;git read-tree -u --reset tmp    # This reads the tree of the previous merge and
                                # puts it into the index and  working tree

git commit
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;This leads to&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;A---B---C---D---E---M (master)
 \                 /
  X---X---V---X---- (upstream)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;And the next update then gives:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;A---B---C---D---E---M---M (master)
 \                 /   /
  X---X---V---X-------X (upstream)
&lt;/code&gt;&lt;/pre&gt;
&lt;/html&gt;
</pre>
</div>
<div title="workflow-integ-devs" modifier="Sitaram" created="201110051936">
<pre>
&lt;html&gt;
&lt;h1&gt;&lt;a name=&quot;dev_integ_workflow&quot;&gt;dev/integ workflow&lt;/a&gt;&lt;/h1&gt;

&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#dev_integ_workflow&quot;&gt;dev/integ workflow&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#workflow&quot;&gt;workflow&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#branches&quot;&gt;branches&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#assumptions_startup_&quot;&gt;assumptions / startup:&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#developer_workflow&quot;&gt;developer workflow&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#integrator&quot;&gt;integrator&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#gitolite_advanced_features_supporing_this_flow&quot;&gt;gitolite advanced features supporing this flow&lt;/a&gt;&lt;br&gt;&lt;/p&gt;

&lt;hr /&gt;

&lt;h2&gt;&lt;a name=&quot;workflow&quot;&gt;workflow&lt;/a&gt;&lt;/h2&gt;

&lt;p&gt;This is one possible workflow for dev/integ using gitolite.  It assumes that
there is one &quot;integrator&quot; and N developers &quot;dev1&quot;, ... &quot;devN&quot;.&lt;/p&gt;

&lt;h3&gt;&lt;a name=&quot;branches&quot;&gt;branches&lt;/a&gt;&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;integ&lt;/code&gt; -- a branch that is &lt;code&gt;R&lt;/code&gt; (readonly) for devs, &lt;code&gt;RW+&lt;/code&gt; for integrator.
This branch will always be kept in a compilable, basically runnable, state
by the integrator.  The history of this branch will be kept reasonably
clean.&lt;/p&gt;

&lt;p&gt;Each developer will start a new piece of work or task using &lt;code&gt;integ&lt;/code&gt; as a
starting point, and making sure that when he submits his work it builds
upon this stable point.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;dev/dev1/&lt;/code&gt;, &lt;code&gt;dev/dev2/&lt;/code&gt;, ... &lt;code&gt;dev/devN/&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;branches under the &lt;code&gt;dev/devX/&lt;/code&gt; hierarchy belong to the developer called
&lt;code&gt;devX&lt;/code&gt;.  He submits his work to the integrator by pushing to one such
branch and emailing the integrator the branch name (say
&lt;code&gt;dev/sitaram/issue3423&lt;/code&gt; or &lt;code&gt;dev/someone-else/bugfix-2321&lt;/code&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;master -- a branch that is even more sacred than &lt;code&gt;integ&lt;/code&gt;.  Its usage and
role are optional in the below described flow, but it can be used to
filter &lt;code&gt;integ&lt;/code&gt; even more, maybe based on some EQA (External Quality
Assurance) perhaps.  If so, it&#39;s name can be changed to reflect that&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h3&gt;&lt;a name=&quot;assumptions_startup_&quot;&gt;assumptions / startup:&lt;/a&gt;&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;a repo is created&lt;/li&gt;
&lt;li&gt;the code is kept in a branch called &lt;code&gt;integ&lt;/code&gt;, even if it is bare minimum
code in the beginning&lt;/li&gt;
&lt;/ul&gt;

&lt;h3&gt;&lt;a name=&quot;developer_workflow&quot;&gt;developer workflow&lt;/a&gt;&lt;/h3&gt;

&lt;p&gt;We use a sample developer called dev5 in the examples below.&lt;/p&gt;

&lt;p&gt;dev5 gets some work/spec/issue to work on.  He is given, or chooses, a short
name for the work he is doing.  Examples:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;xyz-module-error-23
bugfix-2321
issue-3394
add-vorbis-support
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;In the rest of this example we will use &lt;code&gt;issue-3394&lt;/code&gt;&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;dev clones the repo, if not already cloned&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;git clone [...]
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;fetch and checkout the current &lt;code&gt;integ&lt;/code&gt; branch, making the new &lt;code&gt;issue-3394&lt;/code&gt;
branch from it&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;git fetch origin
git checkout -b issue-3394 origin/integ

---o---o---I
(o, o = previous commits, irrelevant to us)
I = origin/integ = issue-3394
(current branch is issue-3394)
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;(&lt;strong&gt;LOOP POINT&lt;/strong&gt;) work on this branch&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;git checkout issue-3394
# (edit/compile/test)
git add, git commit
# repeat as needed
# the last step should be a &quot;test&quot;, ideally

---o---o---I---a---b---c---d
I = origin/integ
a,b,c = intermediate commits
d = issue-3394
(current branch is issue-3394)
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;now he&#39;s ready to send.  In the meantime, &lt;code&gt;integ&lt;/code&gt; may have moved ahead, and he
has to make it work against that:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;fetch integ again and rebase&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;git fetch origin

---o---o---I---J---K
K = origin/integ now

git checkout issue-3394         # if not already done
git rebase origin/integ
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;what does this rebase do?  It takes this:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;---o---o---I---J---K
             \
              \
               a---b---c---d
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;and moves the &quot;a, b, c, d&quot; on top of K:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;---o---o---I---J---K---a&#39;---b&#39;---c&#39;---d&#39;
(a&#39;,b&#39;,c&#39;,d&#39; are rebased versions of a,b,c,d)
(K = origin/integ, d&#39; = issue-3394)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;There is a reason for doing it this way.  Dev5 is the one who knows the
new code best, and he should be integrating it with the latest version of
&lt;code&gt;integ&lt;/code&gt; at any time he submits.  And since &lt;code&gt;issue-3394&lt;/code&gt; is a private
branch, he can rebase it as often as he likes.&lt;/p&gt;

&lt;p&gt;[SIDE NOTE] why do we use rebase instead of merge here?&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;this is not a hard and fast rule -- you can use merge if you like.  Feel
free to experiment and see what works best for your team, because a lot
also depends on their level of comfort with the process&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;However, in my opinion, work that has not been pushed out &lt;em&gt;and&lt;/em&gt; accepted
upstream should ideally be rebased against new upstream.  The main
difference is that, if the &lt;em&gt;acceptance&lt;/em&gt; of the work goes through a few
iterations (let&#39;s say it is rejected and partially redone 2-3 times),
using rebases is easier to do, and also will result in a cleaner looking
&lt;em&gt;final&lt;/em&gt; commit list.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;retest one more time, to make sure the new &lt;code&gt;J&lt;/code&gt; and &lt;code&gt;K&lt;/code&gt; commits have not
caused a problem for &lt;code&gt;issue-3394&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;if the test fails, he has to fix his commits (a&#39;, b&#39;, c&#39;, d&#39;) or add some
new commits (maybe e, f) and make it work.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;when test OK, push &lt;code&gt;issue-3394&lt;/code&gt; under your own hierarchy (each time he
comes back to &quot;LOOP POINT&quot; because something was rejected by code review
or integ testing, the &lt;code&gt;v1&lt;/code&gt; will increase -- &lt;code&gt;v2&lt;/code&gt;, &lt;code&gt;v3&lt;/code&gt;, etc)&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;git push origin issue-3394:dev/dev5/issue-3394/v1
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;send email to integrator asking him to pull and test
&lt;code&gt;dev/dev5/issue-3394/v1&lt;/code&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h3&gt;&lt;a name=&quot;integrator&quot;&gt;integrator&lt;/a&gt;&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;receive mail from dev5 saying &lt;code&gt;issue-3394&lt;/code&gt; is done and ready&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;clone repo if not already done&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;fetch, make a test branch for testing &lt;code&gt;issue-3394&lt;/code&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;git fetch origin
git checkout -b test_issue-3394 origin/dev/dev5/issue-3394
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;test, or do whatever he wants to do initially (maybe code review).  If he
doesn&#39;t like it, send it back for more work.  &lt;strong&gt;dev5 then restarts his
process from the point marked &quot;LOOP POINT&quot; in his workflow above&lt;/strong&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;if it is OK so far, &lt;strong&gt;test merge&lt;/strong&gt; it with the current &lt;em&gt;integ&lt;/em&gt; branch.
Ideally, this should be a &lt;strong&gt;fast forward&lt;/strong&gt;, because dev5 &lt;em&gt;already&lt;/em&gt; did
this.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;git checkout -b test_integ_issue-3394 integ
git merge origin/dev/dev5/issue-3394
# this should be a fast forward, ideally
# make some final tests
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;If something went wrong, no problem; just delete the test branch and email
dev5 saying what the problems are.  For dev5, work again starts at &quot;LOOP
POINT&quot;&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;git branch -D test_integ_issue-3394
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;However, if the tests were all ok, move integ forward and delete test
merge branch&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;git checkout integ
git merge origin/dev/dev5/issue-3394
git branch -D test_integ_issue-3394
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;This issue (3394) is now closed, unless there is a regression later.  It
has been integrated successfully, and dev5 can be assigned some other
task.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h2&gt;&lt;a name=&quot;gitolite_advanced_features_supporing_this_flow&quot;&gt;gitolite advanced features supporing this flow&lt;/a&gt;&lt;/h2&gt;

&lt;p&gt;Here&#39;s a typical gitolite conf file:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;@myteam = dev1 dev2 ... devN

repo myrepo
    RW+                 = integrator
    RW+ dev/USER/       = @myteam
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;That&#39;s it?  How does, say &lt;code&gt;dev5&lt;/code&gt; (assuming he is a member of &lt;code&gt;@myteam&lt;/code&gt;), get
access to write to &lt;code&gt;dev/dev5/something&lt;/code&gt;?&lt;/p&gt;

&lt;p&gt;That is a unique feature of gitolite :-)  When a rule has the string &lt;code&gt;/USER/&lt;/code&gt;
in the &quot;refex&quot; (see gitolite documentation for details), it replaces it with
the name of the user invoking the push.  This is effectively the same as
manually adding one line like this&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;    RW+ dev/sitaram/    = sitaram
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;for each member of &lt;code&gt;@myteam&lt;/code&gt;.&lt;/p&gt;
&lt;/html&gt;
</pre>
</div>
<div title="special-branch-fixups" modifier="Sitaram" created="201110051936">
<pre>
&lt;html&gt;
&lt;h1&gt;&lt;a name=&quot;fixing_up_common_and_customer_branches&quot;&gt;fixing-up common and customer branches&lt;/a&gt;&lt;/h1&gt;

&lt;p&gt;&lt;sup&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#fixing_up_common_and_customer_branches&quot;&gt;fixing-up common and customer branches&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#The_basic_rules&quot;&gt;The basic rules&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#Terminology&quot;&gt;Terminology&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#The_nitty_gritty&quot;&gt;The nitty gritty&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#Before_you_start&quot;&gt;Before you start&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#Separating_common_and_special_&quot;&gt;Separating &#39;common&#39; and &#39;special&#39;&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#utcb&quot;&gt;Updating and testing the &#39;common&#39; branch&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#Merging_common_into_special_&quot;&gt;Merging &#39;common&#39; into &#39;special&#39;&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#Fixing_up_special_&quot;&gt;Fixing up &#39;special&#39;&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#Final_sanity_check&quot;&gt;Final sanity check&lt;/a&gt;&lt;br&gt;
&lt;/sup&gt;&lt;/p&gt;

&lt;hr /&gt;

&lt;p&gt;The following document explains how to maintain a &#39;common&#39; branch,
with one or more &#39;customer specific&#39; branches that hang off of the
common branch.  The inspiration was a question about maintaining
&#39;work&#39; and &#39;home&#39; configurations which differ slightly from a
&#39;common&#39; configuration, which leads to the same sort of problem.&lt;/p&gt;

&lt;p&gt;In an ideal  world, you&#39;d keep &#39;common&#39; development in the &#39;common&#39; branch,
and &#39;customer specific&#39; development in the corresponding customer branches.
In the real world, often the separation was not done properly in advance,
(maybe it was not known, or maybe for initial testing reasons it had to be
done in one branch, or whatever), and so you now have a mix of &#39;common&#39; and
&#39;special&#39; changes all together.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;This article describes one way to &#39;fix up&#39; such a mixed development into the
proper form&lt;/strong&gt;.&lt;/p&gt;

&lt;h3&gt;&lt;a name=&quot;The_basic_rules&quot;&gt;The basic rules&lt;/a&gt;&lt;/h3&gt;

&lt;p&gt;The basic rules are best described by Junio in
&lt;a href=&quot;http://permalink.gmane.org/gmane.comp.version-control.git/110489&quot;&gt;http://permalink.gmane.org/gmane.comp.version-control.git/110489&lt;/a&gt;&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;You make edits to common files only on the common branch.&lt;/li&gt;
&lt;li&gt;You merge from common to deployment, never the other way.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;This document shows how one might do that.  [Junio also helped
with comments on a previous draft of this text.  However, any
errors or other problems that remain are mine.]&lt;/p&gt;

&lt;h3&gt;&lt;a name=&quot;Terminology&quot;&gt;Terminology&lt;/a&gt;&lt;/h3&gt;

&lt;p&gt;We use the following terminology:&lt;/p&gt;

&lt;p&gt;&#39;common&#39; is the branch representing the base product.  All
regular customers get this version.&lt;/p&gt;

&lt;p&gt;&#39;special&#39; is a branch for a specific customer.  This customer
needs changes unique to his environment, which should not be
merged back into the common branch.  However, this branch must
regularly get the benefit of changes in the mainline &#39;common&#39;
branch.  (This is the genesis of the two rules above).&lt;/p&gt;

&lt;p&gt;If you have more than one special customer the same logic
will apply for each of them separately, although if you have
too many such customers you may also want to look at &lt;a href=&quot;http://gitster.livejournal.com/26540.html&quot;&gt;Never
merging back&lt;/a&gt;
for an additional tip on this.&lt;/p&gt;

&lt;h3&gt;&lt;a name=&quot;The_nitty_gritty&quot;&gt;The nitty gritty&lt;/a&gt;&lt;/h3&gt;

&lt;h4&gt;&lt;a name=&quot;Before_you_start&quot;&gt;Before you start&lt;/a&gt;&lt;/h4&gt;

&lt;p&gt;The history looks like this in the beginning:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;-----o          &amp;lt;- special branch (current)
    /
---o            &amp;lt;- common branch
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;The &#39;special&#39; branch has been tested for the feature you are
working on, and this represents a stable point in the development
to try and re-organise the code, separate out &#39;common&#39; code from
&#39;special&#39; code, etc.&lt;/p&gt;

&lt;p&gt;Before you start, make a temporary branch TEMP from
&#39;special&#39;; leave special where it was.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;git checkout -b TEMP special
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;You now make some changes for the special customer, which
also involve some &#39;common&#39; changes that need to be ported
back to the common branch.  The topology now looks like
this, where A, B, C, are changes that logically belong on
&#39;common&#39;, and 1, 2, 3, are changes that are specific to this
customer.&lt;/p&gt;

&lt;p&gt;Notice that the 2 sets of changes are intermixed because
that is how the development happened, and that there is even
one commit where common and special changes are mixed
(perhaps you realised this only later).&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;-----o--A--B1--2--3--C          &amp;lt;- &quot;TEMP&quot; branch (current)
    /
---o                            &amp;lt;- common
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Meanwhile, just to make things interesting, the common
branch has also had some other, unrelated changes which you
eventually want on the special branch as well.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;-----o--A--B1--2--3--C          &amp;lt;- &quot;TEMP&quot; branch (current)
    /                                            
---o--X--Y                      &amp;lt;- common
&lt;/code&gt;&lt;/pre&gt;

&lt;h4&gt;&lt;a name=&quot;Separating_common_and_special_&quot;&gt;Separating &#39;common&#39; and &#39;special&#39;&lt;/a&gt;&lt;/h4&gt;

&lt;p&gt;The first thing to do is to tease the tangled commits apart
using rebase.&lt;/p&gt;

&lt;p&gt;Using &lt;code&gt;git rebase -i special&lt;/code&gt;, get the topology into this
shape.  Note that we have split the &quot;B1&quot; commit into B and 1
separately.  &lt;code&gt;git help rebase&lt;/code&gt; has a very simple and clear
section on splitting commits, so I will not detail that
here.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;-----o--A--B--C--1--2--3        &amp;lt;- &quot;TEMP&quot; branch (current)
    /                                              
---o--X--Y                      &amp;lt;- common
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;At this point, the tree that results should be identical to the one you
started this exercise with, so ideally there should be no need to test.  You
can, if you wish, check that the trees are indeed the same&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;git diff TEMP@{1} TEMP
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;The &lt;code&gt;@{1}&lt;/code&gt; notation specifies the shape of the TEMP branch before the rebase
started.&lt;/p&gt;

&lt;h4&gt;&lt;a name=&quot;utcb&quot;&gt;Updating and testing the &#39;common&#39; branch&lt;/a&gt;&lt;/h4&gt;

&lt;p&gt;Now switch to the &#39;common&#39; branch and cherry pick the
changes that belong on &#39;common&#39;.  The simplest way to cherry
pick is gitk.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;git checkout common
gitk
# and cherry pick first A, then B, then C, in order
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;At this point, your TEMP branch has still not changed from when you started
this re-organisation.  However, you have now introduced 3 new commits onto
the &#39;common&#39; branch, so that set of changes needs to be tested to make sure
things are fine.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;-----o--A--B--C--1--2--3        &amp;lt;- &quot;TEMP&quot; branch
    /                                              
---o--X--Y--A&#39;--B&#39;--C&#39;          &amp;lt;- common (current)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Be sure you test the new functionality before proceeding.  This test will
likely be different from your tests on the TEMP branch, because only part of
the new code in TEMP goes to &#39;common&#39;.  If the test failed or required fixups,
do them in the context of the &#39;common&#39; case only, right here on the &#39;common&#39;
branch.  &lt;strong&gt;Note that this affects the rebase coming up later!&lt;/strong&gt;&lt;/p&gt;

&lt;h4&gt;&lt;a name=&quot;Merging_common_into_special_&quot;&gt;Merging &#39;common&#39; into &#39;special&#39;&lt;/a&gt;&lt;/h4&gt;

&lt;p&gt;Once that test is done, merge from &#39;common&#39; to &#39;special&#39;&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;git checkout special
git merge common
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;which results in the following topology:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;       A--B--C--1--2--3     &amp;lt;- TEMP
      /
 ----o-----------------o    &amp;lt;- special (current)
    /                 /
---o--X--Y--A&#39;--B&#39;--C&#39;
&lt;/code&gt;&lt;/pre&gt;

&lt;h4&gt;&lt;a name=&quot;Fixing_up_special_&quot;&gt;Fixing up &#39;special&#39;&lt;/a&gt;&lt;/h4&gt;

&lt;p&gt;Now all we need is to get commits 1, 2, and 3 onto &#39;special&#39;.  Although this
is easiest done by using &#39;rebase&#39;, that will only work if your &lt;a href=&quot;#utcb&quot;&gt;updating and
testing on &#39;common&#39;&lt;/a&gt; did not cause any changes or fixups (that is, the
changes A, B, and C are still identical to the changes A&#39;, B&#39;, and C&#39;.&lt;/p&gt;

&lt;p&gt;In the general case, therefore, cherry-pick is better, as long as you make
sure you don&#39;t miss any commits:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;gitk
# and cherry pick first 1, then 2, then 3, in order
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;This gives you the following topology (in which we have ignored the TEMP
branch)&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;                         1&#39;--2&#39;--3&#39;     &amp;lt;- special (current)
                        /
 ----o-----------------o
    /                 /
---o--X--Y--A&#39;--B&#39;--C&#39;
&lt;/code&gt;&lt;/pre&gt;

&lt;h4&gt;&lt;a name=&quot;Final_sanity_check&quot;&gt;Final sanity check&lt;/a&gt;&lt;/h4&gt;

&lt;p&gt;At this point you should &lt;em&gt;definitely&lt;/em&gt; re-test all the changes you made, to
make sure nothing got missed out.  If there were no &#39;X&#39; and &#39;Y&#39; commits on
the &#39;commits&#39; branch, you could try&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;git diff TEMP special
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;to check that the tree is still the same as before.  But again, in the
general case, you probably will have commits &#39;X&#39; and &#39;Y&#39; included so it is
necessary to re-test.&lt;/p&gt;

&lt;p&gt;Once all this is done, you don&#39;t need TEMP anymore, and can delete it:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;git branch -d TEMP
&lt;/code&gt;&lt;/pre&gt;
&lt;/html&gt;
</pre>
</div>
<div title="ignore-rules" modifier="Sitaram" created="200905090638">
<pre>
&lt;html&gt;
&lt;h1&gt;rules for .gitignore and the like&lt;/h1&gt;

&lt;p&gt;Those of you who have read the manual for gitignore will have noticed that,
while the rules for precedence of the various files (pattern sources) are very
clear, the rules for the actual exclusion patterns are somewhat less so.
They&#39;re certainly accurate, but newcomers have to read very carefully if they
want to do anything moderately complex with their exclude rules.&lt;/p&gt;

&lt;p&gt;One day (2009-02-18, ~16:00 IST, to be precise), &#39;doener&#39; (Bj&Atilde;&para;rn Steinbrink)
came up with some much simpler rules that said the same thing, and -- building
on the insight that his rules gave me -- I came up with these:&lt;/p&gt;

&lt;hr /&gt;

&lt;p&gt;Note that rule 1 merely &lt;em&gt;modifies&lt;/em&gt; rules 2 and 3, it does not supercede or
preclude them.&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;If your pattern ends with a slash, it matches only directories (and their
contents)&lt;/li&gt;
&lt;li&gt;If there is no slash otherwise, it matches that name, at any depth in the
tree&lt;/li&gt;
&lt;li&gt;If there is a slash anywhere else, it matches that name, relative to the
.gitignore (or &lt;code&gt;$GIT_WORK_TREE&lt;/code&gt; if the pattern is from one of the other
pattern sources like &lt;code&gt;.git/info/exclude&lt;/code&gt; etc)&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;The wildcards (&lt;code&gt;*&lt;/code&gt; and &lt;code&gt;?&lt;/code&gt;) do not match slashes, but otherwise the patterns
are normal shell globs as defined by fnmatch(3) with the &lt;code&gt;FNM_PATHNAME&lt;/code&gt; flag
set.&lt;/p&gt;

&lt;hr /&gt;

&lt;p&gt;&lt;font size=-1&gt;Just for completeness, the pattern source priorities are, highest to lowest:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;command line&lt;/li&gt;
&lt;li&gt;the deepest .gitignore that applies to this path&lt;/li&gt;
&lt;li&gt;shallower .gitignore files until you get to &lt;code&gt;$GIT_WORK_TREE&lt;/code&gt;
&lt;ul&gt;
&lt;li&gt;patterns in .gitignore files are relative to the location of the
gitignore file, not to the &lt;code&gt;$GIT_WORK_TREE&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;$GIT_DIR/info/exclude&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;core.excludesfile&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;/font&gt;&lt;/p&gt;
&lt;/html&gt;
</pre>
</div>
<div title="backup-repo" modifier="Sitaram" created="200905090638">
<pre>
&lt;html&gt;
&lt;h1&gt;backing up a repo by just: git push backup&lt;/h1&gt;

&lt;p&gt;This is, like many things in this directory, by doener, on irc circa
2009-03-25 19:24 Wed IST&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;mkdir -p ~/backups/projectX.git
cd ~/backups/projectX.git
git init --bare
# see notes below for these two
git config core.logAllRefUpdates true
git config receive.denyDeletes true

cd /path/to/projectX
git remote add -t dont_fetch_from_the_backup --mirror backup ~/backups/projectX.git
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Here is some documentation (paraphrased from the irc chat log).&lt;/p&gt;

&lt;p&gt;It creates a bare repo to store the backup, adds a remote to the &quot;work&quot; repo
and then pushes.  The &lt;code&gt;--mirror&lt;/code&gt; bit makes the remote act as a mirror (i.e.
&quot;git push&quot; will default to &lt;code&gt;--mirrror&lt;/code&gt; for this remote) The &lt;code&gt;-t
dont_fetch_from_the_backup&lt;/code&gt; is there because, normally, with &lt;code&gt;--mirror&lt;/code&gt; you
get a bidirectional mirror setup, i.e. fetch is set to &lt;code&gt;refs/*:refs/*&lt;/code&gt;, and
you don&#39;t want an accidental fetch to kill your work.  Of course simply
unsetting &lt;code&gt;remote.backup.fetch&lt;/code&gt; would also do, but the error message for the
invalid ref reminds you you shouldn&#39;t be doing that.&lt;/p&gt;

&lt;p&gt;My additions:  I hope that by adding the two config variables above, I can
allow non-fast forward pushes, letting the reflog act as a safety net as
usual.  The reflog does not protect from a deleted branch, hence we disallow
that (that is rare enough that I can do it manually if I need to).&lt;/p&gt;
&lt;/html&gt;
</pre>
</div>
<div title="special-branches" modifier="Sitaram" created="201110051936">
<pre>
&lt;html&gt;
&lt;h1&gt;customer branches&lt;/h1&gt;

&lt;!-- http://colabti.org/irclogger/irclogger_log/git?date=2009-08-15#l585 --&gt;

&lt;p&gt;Here&#39;s a question that someone asked (both question and response have been
heavily edited):&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;Hello. I have a Ruby on Rails application. This is currently managed using
  GIT. I have another business that wants a customised copy of this site. Is
  it possible to use GIT to do this?&lt;/p&gt;

&lt;p&gt;Currently I have one site in directory &quot;custA&quot;. I want to make a copy in
  &quot;custB&quot; which is a branch. They are the same base system with customer
  specific modifications.  How does this work?&lt;/p&gt;

&lt;p&gt;For example, on custA, I make commits 1, 2, 3.  In custB, only commits 1
  and 3 are relevant.  Is it possible to pull only specific commits across?
  Would I be better served using a central repository and then using
  different branches, one for each site?&lt;/p&gt;

&lt;p&gt;What is the &quot;best&quot; way to do this using Git?&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;There are several issues actually being raised here, so we&#39;ll look at them one
at a time.&lt;/p&gt;

&lt;hr /&gt;

&lt;h4&gt;SVN-itis&lt;/h4&gt;

&lt;p&gt;The first thing to note is that the question reflects what I have started
calling &lt;code&gt;SVN-itis&lt;/code&gt; -- where &quot;branch&quot; and &quot;(sub)directory&quot; are conflated :-)&lt;/p&gt;

&lt;p&gt;Some &lt;a href=&quot;../concepts/0-terminology.html&quot;&gt;basic
terminology&lt;/a&gt; is
probably useful, if you&#39;re really new to git, or perhaps some info on
&lt;a href=&quot;../concepts/branches.html&quot;&gt;branches in git&lt;/a&gt;, but
neither of these quite manage a cure for SVN-itis.  So let&#39;s lay it out:&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;In git, there is &lt;strong&gt;no connection&lt;/strong&gt; between a branch and a subdirectory.
Subdirectories are whatever your project needs them to be, and branch names
are whatever you want them to be.  You can have a branch whose name happens to
be the same as that of one of your project directories, if you really need to.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;So &quot;custA&quot; is &lt;strong&gt;not&lt;/strong&gt; a directory.  Neither is &quot;custB&quot;; nor indeed any other
branch.  And if you have a directory called &quot;include&quot; or &quot;src&quot; or
&quot;Documentation&quot;, that does &lt;strong&gt;not&lt;/strong&gt; become a branch in your repo!&lt;/p&gt;

&lt;p&gt;When you checkout a branch called &quot;custA&quot;, your &quot;working tree&quot; is populated
with the customer &quot;A&quot; specific version of your code.  It&#39;s very likely that
the actual directory structure for this version is pretty much the same as,
say, for customer &quot;B&quot;, and both of them are similar to the directory structure
of the main branch.&lt;/p&gt;

&lt;h4&gt;cherry-pick versus merge&lt;/h4&gt;

&lt;p&gt;[also see &lt;code&gt;git help workflows&lt;/code&gt;]&lt;/p&gt;

&lt;p&gt;&quot;&lt;em&gt;Is it possible to pull only specific commits across?&lt;/em&gt;&quot;&lt;/p&gt;

&lt;p&gt;Well certainly yes; this is called &lt;strong&gt;cherry-picking&lt;/strong&gt;, and git can do that
from the command line, or from the GUI.  But it is &lt;strong&gt;not&lt;/strong&gt; the right thing to
do in this circumstance, or indeed many other similar ones.&lt;/p&gt;

&lt;p&gt;In terms of &quot;history&quot;, a cherry-pick is the same as &quot;take a diff of &lt;em&gt;that&lt;/em&gt;
commit versus it&#39;s parent, and apply that same change &lt;em&gt;here&lt;/em&gt; in &lt;em&gt;this&lt;/em&gt; branch,
and commit&quot;.  Git does not remember that you pulled this change in any way
whatsoever, and does not associate these two commits (the one you picked, and
the new one made here as a result) in any long term way to ease maintenance.
[Experts: &lt;em&gt;patch-id&lt;/em&gt; is not relevant here for this discussion so leave it
alone ok? :-)]&lt;/p&gt;

&lt;p&gt;Secondly, if the feature you implemented was spread across more than one
commit (as any non-trivial feature &lt;em&gt;should&lt;/em&gt;!), you have to remember to
cherry-pick &lt;em&gt;all&lt;/em&gt; of them.  In the &lt;em&gt;right order&lt;/em&gt;!  Miss one, or pick them in
the wrong order, and things go bad.&lt;/p&gt;

&lt;p&gt;When you &lt;strong&gt;merge&lt;/strong&gt; a branch, on the other hand, git remembers that you merged
it.  And since you only deal with the tip of the branch, not individual
commits, it&#39;s git&#39;s job to make sure that they all come in, and in the right
order.  In particular, (as &lt;code&gt;git help workflows&lt;/code&gt; says), &lt;/p&gt;

&lt;pre&gt;&lt;code&gt;...a merge can carry over the changes from 1, 10, or 1000 commits with
equal ease, which in turn means the workflow scales much better...
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;So the long term way to do this is by merging.  Just remember that when you
merge a branch, &lt;em&gt;all&lt;/em&gt; the changes in that branch are brought in (merging is
&lt;em&gt;not&lt;/em&gt; a selective operation) so it is best to &lt;em&gt;create a different branch for
each logically separate set of changes&lt;/em&gt;.&lt;/p&gt;

&lt;h4&gt;customer specific branches&lt;/h4&gt;

&lt;p&gt;The idea is you use one common branch, and two (or as many as you need)
customer specific branches.  All common changes go into the master, and each
customer branch gets changes that pertain only to that customer.  Periodically
(when master is considered to be at a stable point), you&#39;ll merge changes from
master into the customer branch (&lt;code&gt;git checkout custA; git merge master&lt;/code&gt;).
This brings in newer &quot;common&quot; code into the customer branch. You will
&lt;strong&gt;never&lt;/strong&gt; merge the other way -- that would pollute master with
customer-specific code.&lt;/p&gt;

&lt;p&gt;When you make a delivery to customer A, you checkout the &quot;custA&quot; branch and
send that.  And of course similarly for other customers.&lt;/p&gt;

&lt;p&gt;Now let&#39;s say you acquire a new customer, &quot;C&quot;, and a bit later find a feature
that customers A and C want, but B doesn&#39;t.  You create (aka &quot;fork&quot;) a branch
off of master (&lt;code&gt;git checkout -b AC_feature master&lt;/code&gt;), code/test it, making
commits as you go, and then merge it into A and C (&lt;code&gt;git checkout A; git merge
AC_feature&lt;/code&gt; and similarly for customer C).  You do &lt;strong&gt;not&lt;/strong&gt; code it in A and
then rely on merging A into C, because that would get all of A into C.&lt;/p&gt;

&lt;p&gt;If, sometime later, you find a minor bug in that feature, you make the change
in the same branch (&lt;code&gt;git checkout AC_feature; edit/test/commit&lt;/code&gt;), and then you
merge it into &lt;code&gt;custA&lt;/code&gt; and &lt;code&gt;custC&lt;/code&gt; as above.&lt;/p&gt;

&lt;h4&gt;Summary&lt;/h4&gt;

&lt;p&gt;The main thing we&#39;re avoiding in all this is cherry-picking specific commits
because you only wanted a part of that code in this branch -- cherry-picking
is certainly doable, but it is not scalable and in the long term it&#39;s a pain.&lt;/p&gt;

&lt;p&gt;Of course, you do have to be disciplined about which branch you make each
commit in, in order to keep things properly separated.&lt;/p&gt;

&lt;p&gt;But &lt;a href=&quot;special-branch-fixups.html&quot;&gt;here&lt;/a&gt; is one way to fix up things if you did
not manage to do that for some reason.&lt;/p&gt;
&lt;/html&gt;
</pre>
</div>
<div title="whitespace-index-filter" modifier="Sitaram" created="201110051936">
<pre>
&lt;html&gt;
&lt;h1&gt;fixup whitespace errors&lt;/h1&gt;

&lt;p&gt;When you have whitespace errors in a repo and want to fix them all together,
here&#39;s what you do.  Written by doener circa 2009-07-12 19:23&lt;/p&gt;

&lt;p&gt;So let&#39;s say the following code is in &lt;code&gt;~/git-scripts/ws-fix.sh&lt;/code&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;#!/bin/bash

# from doener (who else!)
# to be called as an index-filter

if git rev-parse --quiet --verify $GIT_COMMIT^ &amp;gt;/dev/null
then
        against=$(map $(git rev-parse $GIT_COMMIT^))
        git reset -q $against -- .
else
        # Initial commit: diff against an empty tree object
        against=4b825dc642cb6eb9a060e54bf8d69288fbee4904
        git rm --cached -rfq --ignore-unmatch &#39;*&#39;
fi

git diff --full-index $against $GIT_COMMIT | git apply --cached --whitespace=fix
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Notes:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;the &lt;code&gt;map&lt;/code&gt; translates the original sha1 to the sha1 of the rewritten
commit.  The diff needs to go against the rewritten one, so that the patch
applies without conflicts/fuzz.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;run this like: &lt;code&gt;git filter-branch --index-filter &#39;. ~/git-scripts/ws-fix.sh&#39;&lt;/code&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;a pictorial representation of what this script does each time it is
called (also from doener a few minutes later when I still couldn&#39;t get
it!):&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;Original:

A---B---C---D---E

Rewritten so far: (1 == rewritten A, and so on)

1---2---3

To create 4 we do:

map D^ == map C == 3

so: git diff 3 D | git apply ....
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Other possibilities:&lt;/p&gt;

&lt;p&gt;If the whitespace problem causing conflicts is something like indentation
shift, etc., and is not amenable to &lt;code&gt;git apply --whitespace=fix&lt;/code&gt;, the
following may work.  We assume the &quot;remote&quot; version is the one with the
unnecessary indentation changes:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;git show :1:filename &amp;gt; filename
git diff -b :1:filename :3:filename | git apply
# (might need munging; the diff header has :1: and :3: in it...)
git merge-one-file :1:filename :2:filename $(git hash-object -w filename) filename
&lt;/code&gt;&lt;/pre&gt;
&lt;/html&gt;
</pre>
</div>
<div title="hg" modifier="Sitaram" created="200905090638">
<pre>
&lt;html&gt;
&lt;h1&gt;for people who think Hg is just as good&lt;/h1&gt;

&lt;p&gt;Hg is almost as good as git.  Linus pretty much says so in his famous
googletalk.&lt;/p&gt;

&lt;p&gt;Almost :-)&lt;/p&gt;

&lt;p&gt;Here&#39;re some links about Hg; detailed commentary from me may come later, but I
doubt I will have the time or the inclination.  It&#39;s not like this is SVN and
I have to strenuously keep you away from it -- go ahead and use Hg if you like
it and it fits your work style :-)&lt;/p&gt;

&lt;p&gt;Also, I have no intention of becoming an Hg expert to answer questions or
criticisms about this page.  If you think something is wrong, tell me and I&#39;d
be happy to update it.&lt;/p&gt;

&lt;h3&gt;Local branches&lt;/h3&gt;

&lt;p&gt;Hg does not permit a quick experimental branch just to test some wild idea
quickly.  Check out the &quot;Branch Management&quot; section in
&lt;a href=&quot;http://www.rockstarprogrammer.org/post/2008/apr/06/differences-between-mercurial-and-git/&quot;&gt;http://www.rockstarprogrammer.org/post/2008/apr/06/differences-between-mercurial-and-git/&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Read the last 3 paras of that section, at least.&lt;/p&gt;

&lt;!--

Also, because the branch name is in the changeset, the branch lives forever.
The only short-term branches are clone branches. That just doesn&#39;t encourage
quick experiments.

In git, a branch is just a head (see above). Making changes to a branch
actually moves the pointer to the new changeset. This head must be explicitly
shared across repositories.

In practice, this drops the cost down to approximately zero. You won&#39;t
accidentally push code you don&#39;t mean to. You won&#39;t have to be reminded of a
failed experiment for the rest of your life, and you won&#39;t have to fear
naming them in such a way that they don&#39;t collide with something someone else
has done somewhere else. 

--&gt;

&lt;h3&gt;Projects&lt;/h3&gt;

&lt;p&gt;Mozilla: quote from
&lt;a href=&quot;http://weblogs.mozillazine.org/preed/2007/04/version_control_system_shootou_1.html&quot;&gt;http://weblogs.mozillazine.org/preed/2007/04/version_control_system_shootou_1.html&lt;/a&gt;:&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;em&gt;&quot;As good, performant Win32 (and Mac and Linux) is a hard-requirement, Git
    lost in early Kombat rounds. This is unfortunate because (as we would soon
    find out), lots of issues with the other systems did &quot;just work&quot; in Git.&quot;&lt;/em&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h3&gt;Unsorted URLs&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;http://weblog.masukomi.org/2008/2/4/some-thoughts-about-git&quot;&gt;http://weblog.masukomi.org/2008/2/4/some-thoughts-about-git&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://texagon.blogspot.com/2008/02/use-mercurial-you-git.html?showComment=1202345880000#c900552130121547868&quot;&gt;http://texagon.blogspot.com/2008/02/use-mercurial-you-git.html?showComment=1202345880000#c900552130121547868&lt;/a&gt;: 
&lt;em&gt;I used to be more of a Mercurial guy, but there&#39;s just a moment (at least
there was for me) where it all clicks and Git makes sense. Having your
repository be just a giant DAG of commits is what you want -- forcing each
fork in the road to live in its own separate repository is a pain and
unnecessary.&lt;/em&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/html&gt;
</pre>
</div>
<div title="svn" modifier="Sitaram" created="201110051936">
<pre>
&lt;html&gt;
&lt;h1&gt;&lt;a name=&quot;for_people_who_think_SVN_is_good_enough_&quot;&gt;for people who think SVN is good enough ;-)&lt;/a&gt;&lt;/h1&gt;

&lt;p&gt;The official comparison is &lt;a href=&quot;http://git.or.cz/gitwiki/GitSvnComparsion&quot;&gt;here&lt;/a&gt;.
There is also a &lt;a href=&quot;http://git-scm.com/course/svn.html&quot;&gt;Git - SVN crash course&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;&lt;em&gt;Lots of SVN info is scattered in a few other files in this directory;
eventually it should all be pulled into this file.&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;&lt;sup&gt;as Churchill said, so much to do, and so little time in which to do it... (&lt;em&gt;sigh&lt;/em&gt;)&lt;/sup&gt;&lt;/p&gt;

&lt;p&gt;What follows is my understanding of the SVN scenario, from various sources.  I
personally have used SVN only briefly.  If there are errors in the SVN part of
this description please let &lt;a href=&quot;mailto:sitaramc@gmail.com&quot;&gt;me&lt;/a&gt; know.&lt;/p&gt;

&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#for_people_who_think_SVN_is_good_enough_&quot;&gt;for people who think SVN is good enough ;-)&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#briefly_&quot;&gt;briefly...&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#_and_a_bit_more_detail&quot;&gt;...and a bit more detail&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#_svn_update_on_very_active_projects&quot;&gt;&#39;svn update&#39; on very active projects&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#local_caching_and_repository_size&quot;&gt;local caching and repository size&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#some_links&quot;&gt;some links&lt;/a&gt;&lt;br&gt;&lt;/p&gt;

&lt;hr /&gt;

&lt;h3&gt;&lt;a name=&quot;briefly_&quot;&gt;briefly...&lt;/a&gt;&lt;/h3&gt;

&lt;p&gt;Git&#39;s advantages over SVN (all of them affect productivity and/or
maintainability, indicated in parens as &lt;strong&gt;P&lt;/strong&gt; or &lt;strong&gt;M&lt;/strong&gt;) are:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;strong&gt;(P)&lt;/strong&gt; handles merges automatically (in fact SVN doesn&#39;t really &quot;handle&quot;
merges; merge history must be manually recorded and managed, and it&#39;s
almost impossible to have 2 branches merging regularly in SVN without a
lot of pain for the integration team)&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;strong&gt;(M)&lt;/strong&gt; handles file renames correctly; helps in refactoring (in SVN, a
rename is handled as a delete of the old file plus an add of the new file,
and it is only tracked as such if you explicitly told svn about the
rename.  That is not the only brittle aspect; renames and merges don&#39;t mix
well, apparently.  Also, SVN may &lt;a href=&quot;http://en.wikipedia.org/wiki/Apache_Subversion#Current_limitations_and_problems&quot;&gt;become confused&lt;/a&gt; when files are
modified and renamed in the same commit.)&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;strong&gt;(P, M)&lt;/strong&gt; devs can create local branches without polluting the central server
-- experimental features can be developed and tested &quot;on the side&quot;, with
full revision control and granular commits.  If the experiment worked, you
bring it into the main repo (without losing the individual commits),
otherwise you toss it.  In SVN, a successful side project is forced to
enter the main project as one large chunk of code, which seriously affects
future maintainability.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;strong&gt;(P, M)&lt;/strong&gt; devs make lots of small commits instead of one humongous commit --
much easier for code review, debugging, cherry-picking, and merging with
other changes.  Merge-conflict resolution happens on much smaller units
instead of one huge chunk of code dumped on the repo!  In SVN, every
commit goes to the server, forcing commits to be large and monolithic, in
turn causing every merge to be a serious exercise rather than a couple of
minutes work.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;strong&gt;(P)&lt;/strong&gt; common VCS operations do not need network or server access, and are
blazingly fast.  SVN and other VCSs may take so long that a developer who
is, say, trying to trace the changes that caused a bug may feel it&#39;s
easier to go through the code himself than run a &#39;diff&#39; against the last
known good version!  That is, these VCSs have the tools but it&#39;s a pain to
use them!&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Git does a lot of things better than any other VCS:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;strong&gt;(P)&lt;/strong&gt; branching/merging is so bad in most other VCSs that lots of projects
forgo all the advantages of parallel development!  Or they have to have a
separate &quot;merge team&quot;, and they freeze development for a couple of days to
do the merge.  With git, merges (and therefore, merge conflicts, if any)
are (i) handled by the developer closest to the merged code, not an
upstream integrator who probably doesn&#39;t know the new code well, and (ii)
processed in many small chunks instead of one large chunk of code.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;strong&gt;(M)&lt;/strong&gt; git doesn&#39;t track files, it tracks content.  So if a piece of code
moved from one source file to another, and you look at the history of that
file visually, git will tell you that these lines came from that file over
there, and it&#39;ll also tell you the history of those lines before they came
here.  This is way beyond what any other VCS can imagine doing, and is a
real lifesaver for someone who picks up a complex project for maintenance
or a new team member is trying to understand the existing project.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h3&gt;&lt;a name=&quot;_and_a_bit_more_detail&quot;&gt;...and a bit more detail&lt;/a&gt;&lt;/h3&gt;

&lt;h4&gt;&lt;a name=&quot;_svn_update_on_very_active_projects&quot;&gt;&#39;svn update&#39; on very active projects&lt;/a&gt;&lt;/h4&gt;

&lt;p&gt;When you, as a developer, have made a fair number of changes on your
workstation, and wish to commit these to the SVN repo, you do an &#39;svn update&#39;.
This brings in the latest changes from the server.&lt;/p&gt;

&lt;p&gt;Unfortunately, if the other developers have also been very active, there could
be a lot of new/changed code.  All of those changes, in one fell swoop, are
now merged into your working copy, so conflicts are very likely.&lt;/p&gt;

&lt;p&gt;Worse, the &#39;svn update&#39; has managed to lose the separation between your local
changes and the updates that came from the server.  You now have exactly one
chance to resolve those conflicts and commit the result.  And you&#39;d better do
it fast -- before the upstream tree changes &lt;em&gt;again&lt;/em&gt;!&lt;/p&gt;

&lt;p&gt;[This is when an SVN newbie will realise he should have backed up his current
source tree using tar or zip ;-)]&lt;/p&gt;

&lt;p&gt;With git, you would not do the &lt;code&gt;git pull&lt;/code&gt; while you still have uncommitted
changes in your local repository.  This is a &lt;em&gt;distributed&lt;/em&gt; VCS, so you have a
local repository to take care of all that.&lt;/p&gt;

&lt;p&gt;So just commit all &lt;em&gt;your&lt;/em&gt; changes locally, and &lt;em&gt;then&lt;/em&gt; do a &lt;code&gt;git pull&lt;/code&gt;!&lt;/p&gt;

&lt;p&gt;Of course this will have the same conflicts as in SVN and you still have to do
a manual conflict resolution, &lt;em&gt;but&lt;/em&gt;:&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;your local changes are &lt;em&gt;cleanly&lt;/em&gt; saved, so if you botch up the manual
conflict resolution, you can go back to your last local commit and try
again.  As many times as you need to, really.&lt;/li&gt;
&lt;li&gt;if you do a &lt;code&gt;git pull --rebase&lt;/code&gt;, (which is closer to what SVN does
actually), then git will apply your local changes &lt;em&gt;one commit at a time&lt;/em&gt;
instead of the whole thing in one shot, making the conflict resolution
also go in small, easily digestible chunks.&lt;/li&gt;
&lt;li&gt;in rare cases, the &#39;upstream&#39; has changed so much that a lot of your local
changes become invalid and you have to redo them.  With SVN -- you have to
throw the whole lot away and start again.  With git, you would have made a
series of small, granular, commits on your local tree, and this lets you
salvage the pieces that are still acceptable and redo only those that are
not.  Then you do your &lt;code&gt;git pull&lt;/code&gt; or &lt;code&gt;git pull --rebase&lt;/code&gt; again.&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;&lt;sup&gt;Basic idea from a post by Junio at
&lt;a href=&quot;http://article.gmane.org/gmane.comp.version-control.git/110671&quot;&gt;http://article.gmane.org/gmane.comp.version-control.git/110671&lt;/a&gt;&lt;/sup&gt;&lt;/p&gt;

&lt;h4&gt;&lt;a name=&quot;local_caching_and_repository_size&quot;&gt;local caching and repository size&lt;/a&gt;&lt;/h4&gt;

&lt;h5&gt;What extra information is cached locally?&lt;/h5&gt;

&lt;p&gt;When you do an &#39;svn checkout&#39;, you get a working copy of the revision you
checked out, plus svn saves away an extra copy of the same stuff.  This allows
you to do things like see what you changed with respect to the checked out
version.&lt;/p&gt;

&lt;p&gt;But if you need a diff between your copy and some other version, you need
network access.  If you need a diff between two checked-in revisions, again
you need network access.&lt;/p&gt;

&lt;p&gt;When you do a &lt;code&gt;git clone&lt;/code&gt;, however, git stores the complete history of all the
branches that the parent repository has!  So the only time you now need
network access is when you want to update the server, nothing else.&lt;/p&gt;

&lt;p&gt;This might make you think git&#39;s repositories are &lt;em&gt;huge&lt;/em&gt;!  Far from it; here&#39;s
&lt;a href=&quot;http://keithp.com/blogs/Repository_Formats_Matter/&quot;&gt;an example&lt;/a&gt; that uses the
Mozilla repository, with full history from 1998 or so:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;CVS repo: 2.7 GB&lt;/li&gt;
&lt;li&gt;imported to SVN: 8.2 GB&lt;/li&gt;
&lt;li&gt;imported to GIT: 450 MB!&lt;/li&gt;
&lt;li&gt;(a full checkout of just the source: 350 MB)&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;That&#39;s a ratio of almost 20:1 in size over SVN.&lt;/p&gt;

&lt;h3&gt;&lt;a name=&quot;some_links&quot;&gt;some links&lt;/a&gt;&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;http://markmcb.com/2008/10/18/3-reasons-to-switch-to-git-from-subversion/&quot;&gt;http://markmcb.com/2008/10/18/3-reasons-to-switch-to-git-from-subversion/&lt;/a&gt;:
the first example, &#39;Endless, Easy, Non-File-System-Based, Local Branches&#39;,
is particularly powerful and convincing&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://developers.slashdot.org/comments.pl?sid=1079921&amp;amp;cid=26321869&quot;&gt;http://developers.slashdot.org/comments.pl?sid=1079921&amp;amp;cid=26321869&lt;/a&gt; from
somewhere in the trenches&lt;/li&gt;
&lt;/ul&gt;

&lt;hr /&gt;
&lt;/html&gt;
</pre>
</div>
<div title="git-links" modifier="Sitaram" created="201110051936">
<pre>
&lt;html&gt;
&lt;h1&gt;&lt;a name=&quot;git_URLs_galore&quot;&gt;git -- URLs galore&lt;/a&gt;&lt;/h1&gt;

&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#git_URLs_galore&quot;&gt;git -- URLs galore&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#the_chief_penguin_wrangler_speaks_&quot;&gt;the chief penguin wrangler speaks :-)&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#basic_stuff_concepts&quot;&gt;basic stuff/concepts&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#_for_SVN_and_other_Centralised_VCS_users&quot;&gt;...for SVN and other Centralised VCS users&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#tut&quot;&gt;detailed tutorials&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#advanced_stuff_best_practices&quot;&gt;advanced stuff/best practices&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#digging_into_git_troubleshooting&quot;&gt;digging into git/troubleshooting&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#opinions_discussion_DVCSs_in_general&quot;&gt;opinions/discussion/DVCSs in general&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#advocacy&quot;&gt;advocacy&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#other_VCSs_comparision_criticism_etc&quot;&gt;other VCSs -- comparision, criticism, etc&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#CVS&quot;&gt;CVS&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#SVN&quot;&gt;SVN&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#Visual_Source_font_size_5_un_font_Safe_and_TFS&quot;&gt;Visual Source &lt;font size=-5&gt;un&lt;/font&gt;Safe and TFS&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#Clearcase&quot;&gt;Clearcase&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#Hg&quot;&gt;Hg&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#darcs&quot;&gt;darcs&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#perforce&quot;&gt;perforce&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#funny_stuff&quot;&gt;funny stuff&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#git_and_I_&quot;&gt;git and I :)&lt;/a&gt;&lt;br&gt;&lt;/p&gt;

&lt;hr /&gt;

&lt;h3&gt;&lt;a name=&quot;the_chief_penguin_wrangler_speaks_&quot;&gt;the chief penguin wrangler speaks :-)&lt;/a&gt;&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;Linus on merging: &lt;a href=&quot;http://git.or.cz/gitwiki/LinusTalk200705Transcript&quot;&gt;http://git.or.cz/gitwiki/LinusTalk200705Transcript&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;linus explaining merging (what should be automatic and what should not) in
a mailing list &lt;a href=&quot;http://marc.info/?t=119198137100002&amp;amp;r=1&amp;amp;w=2&quot;&gt;http://marc.info/?t=119198137100002&amp;amp;r=1&amp;amp;w=2&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;some important comments on Linus&#39;s google-talk video, especially about
branching and merging:
&lt;a href=&quot;http://codicesoftware.blogspot.com/2007/05/linus-torvalds-on-git-and-scm.html&quot;&gt;http://codicesoftware.blogspot.com/2007/05/linus-torvalds-on-git-and-scm.html&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Linus on &quot;clean&quot; &quot;history&quot;
&lt;a href=&quot;http://www.mail-archive.com/dri-devel@lists.sourceforge.net/msg39091.html&quot;&gt;http://www.mail-archive.com/dri-devel@lists.sourceforge.net/msg39091.html&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://www.kernel.org/pub/software/scm/git/docs/howto/recover-corrupted-blob-object.txt&quot;&gt;http://www.kernel.org/pub/software/scm/git/docs/howto/recover-corrupted-blob-object.txt&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h3&gt;&lt;a name=&quot;basic_stuff_concepts&quot;&gt;basic stuff/concepts&lt;/a&gt;&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;http://sitaramc.github.com/gcs/index.html&quot;&gt;http://sitaramc.github.com/gcs/index.html&lt;/a&gt; -- my version of the classic
&quot;Git for Computer Scientists&quot;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://cworth.org/hgbook-git/tour/&quot;&gt;http://cworth.org/hgbook-git/tour/&lt;/a&gt; -- I cannot emphasise how useful this
URL has been in getting started!&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://git.or.cz/gitwiki/GitCheatSheet&quot;&gt;http://git.or.cz/gitwiki/GitCheatSheet&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;who says git is harder than SVN?  Try &lt;a href=&quot;http://git.or.cz/course/svn.html&quot;&gt;http://git.or.cz/course/svn.html&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;very nice, pictorial, explanation at
&lt;a href=&quot;http://www.kernel.org/~junio/200607-ols.pdf&quot;&gt;http://www.kernel.org/~junio/200607-ols.pdf&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h4&gt;&lt;a name=&quot;_for_SVN_and_other_Centralised_VCS_users&quot;&gt;...for SVN and other Centralised VCS users&lt;/a&gt;&lt;/h4&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;If you always wondered what exactly was meant by &quot;&lt;strong&gt;commit-then-merge
versus merge-then-commit&lt;/strong&gt;&quot;, take a couple of minutes to read
&lt;a href=&quot;http://www.ericsink.com/entries/dvcs_dag_1.html&quot;&gt;http://www.ericsink.com/entries/dvcs_dag_1.html&lt;/a&gt;.  You&#39;ll also understand
what a DAG (directed acyclic graph) is, in case you didn&#39;t know, with very
nice ilustrations at an easy reading pace.&lt;/p&gt;

&lt;p&gt;This site belongs to someone who is making a commercial version control
system, and is documenting his findings and thoughts very laboriously.
While I don&#39;t always agree with him, he (a) certainly writes well, and I
absolutely love his sense of humour, and (b) is refreshingly honest about
his biases in &lt;a href=&quot;http://www.ericsink.com/entries/dvcs_dag_2.html&quot;&gt;his followup blog
post&lt;/a&gt;.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a href=&quot;http://codeclimber.blogspot.com/2009/05/git-solves-all-your-branching-and.html&quot;&gt;http://codeclimber.blogspot.com/2009/05/git-solves-all-your-branching-and.html&lt;/a&gt;
talks about the reluctance to try branching when coming from a
painful-to-branch model like SVN.  The fact is, in git, branching is one
of those rare beasts: easy &lt;em&gt;and&lt;/em&gt; powerful.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a href=&quot;http://www.lwn.net/Articles/381796/&quot;&gt;http://www.lwn.net/Articles/381796/&lt;/a&gt; Subversion is unable to separate the
steps &quot;fix bug A&quot; and &quot;integrate with bugfixes B C D and E, having been
checked in while you&#39;ve been working on A&quot;. Mr. Corporate Manager wants
this feature.&lt;/p&gt;

&lt;p&gt;Subversion cannot do that unless you create a branch for everything.
&lt;em&gt;Poof&lt;/em&gt; your workflow is now an order of magnitude more complicated than
git or hg (which is IMHO even less complicated than SVN, once you let go
of the centralized-repo, poisoned-by-CVS mindset.)&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h3&gt;&lt;a name=&quot;tut&quot;&gt;detailed tutorials&lt;/a&gt;&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;about the best darn doc on using the 3 GUIs that come with git:
&lt;a href=&quot;http://nathanj.github.com/gitguide/tour.html&quot;&gt;http://nathanj.github.com/gitguide/tour.html&lt;/a&gt; has a Windows slant but
except for the &quot;installation&quot; pieces, the rest is just as applicable to
Linux&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;another &lt;em&gt;very useful&lt;/em&gt; resource is the &lt;a href=&quot;http://gitready.com/&quot;&gt;gitready&lt;/a&gt;
site, where you&#39;ll find lots of tips and techniques.  In particular, they
explain things very graphically (for example, if you always wondered what
rebase is, try &lt;a href=&quot;http://gitready.com/intermediate/2009/01/31/intro-to-rebase.html&quot;&gt;intro to
rebase&lt;/a&gt;,
then maybe &lt;a href=&quot;http://gitready.com/advanced/2009/02/11/pull-with-rebase.html&quot;&gt;pull with
rebase&lt;/a&gt; or
&lt;a href=&quot;http://gitready.com/advanced/2009/02/10/squashing-commits-with-rebase.html&quot;&gt;squashing commits with
rebase&lt;/a&gt;).&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h3&gt;&lt;a name=&quot;advanced_stuff_best_practices&quot;&gt;advanced stuff/best practices&lt;/a&gt;&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;release engineering, branches never-merged-back, etc.,
&lt;a href=&quot;http://gitster.livejournal.com/2009/01/14/&quot;&gt;http://gitster.livejournal.com/2009/01/14/&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Ingo Molnar (mingo) on reviewing merge commits versus rebased ones:
&lt;a href=&quot;http://lwn.net/Articles/409775/&quot;&gt;http://lwn.net/Articles/409775/&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Shawn on contrib/workdir/git-new-workdir:
&lt;a href=&quot;http://kerneltrap.org/mailarchive/git/2007/10/11/335637&quot;&gt;http://kerneltrap.org/mailarchive/git/2007/10/11/335637&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h3&gt;&lt;a name=&quot;digging_into_git_troubleshooting&quot;&gt;digging into git/troubleshooting&lt;/a&gt;&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;http://article.gmane.org/gmane.comp.version-control.git/46609&quot;&gt;http://article.gmane.org/gmane.comp.version-control.git/46609&lt;/a&gt; -- how
&lt;code&gt;git am -3&lt;/code&gt; works&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://www.kernel.org/pub/software/scm/git/docs/howto/recover-corrupted-blob-object.txt&quot;&gt;http://www.kernel.org/pub/software/scm/git/docs/howto/recover-corrupted-blob-object.txt&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h3&gt;&lt;a name=&quot;opinions_discussion_DVCSs_in_general&quot;&gt;opinions/discussion/DVCSs in general&lt;/a&gt;&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;a somewhat longer, more philosophical article on git:
&lt;a href=&quot;http://www.betaversion.org/~stefano/linotype/news/106/&quot;&gt;http://www.betaversion.org/~stefano/linotype/news/106/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;on tracking content instead of files: &lt;a href=&quot;http://marc.info/?l=git&amp;amp;m=116473016012824&quot;&gt;http://marc.info/?l=git&amp;amp;m=116473016012824&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;a more detailed version of the same:
&lt;a href=&quot;http://article.gmane.org/gmane.comp.version-control.git/217&quot;&gt;http://article.gmane.org/gmane.comp.version-control.git/217&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;descriptive article on the advantages of a DVCS and speculative branching
and low overhead repos and so on:
&lt;a href=&quot;http://griddlenoise.blogspot.com/2007/12/distributed-vcss-are-great-enablers-or.html&quot;&gt;http://griddlenoise.blogspot.com/2007/12/distributed-vcss-are-great-enablers-or.html&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;very informative comment on the advantages of a distributed system:
&lt;a href=&quot;http://weblogs.mozillazine.org/preed/2006/11/version_control_system_shootou.html#comment-486521&quot;&gt;http://weblogs.mozillazine.org/preed/2006/11/version_control_system_shootou.html#comment-486521&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://keithp.com/blogs/Repository_Formats_Matter/&quot;&gt;http://keithp.com/blogs/Repository_Formats_Matter/&lt;/a&gt;  -- discusses git
from a small project point of view; you can retain your central model even
with git&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a href=&quot;http://blogs.gnome.org/newren/2007/11/24/local-caching-a-major-distinguishing-difference-between-vcses/&quot;&gt;http://blogs.gnome.org/newren/2007/11/24/local-caching-a-major-distinguishing-difference-between-vcses/&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;on git being very liberal: &lt;a href=&quot;http://tomayko.com/writings/the-thing-about-git&quot;&gt;http://tomayko.com/writings/the-thing-about-git&lt;/a&gt;&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;Version control systems have traditionally required a lot of up-front
planning followed by constant interaction to get changes to the right
place at the right time and in the right order. And woe unto thee if a
rule is broken somewhere along the way, or you change your mind about
something, or you just want to fix this one thing real quick before
having to commit all the other crap in your working copy.&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h3&gt;&lt;a name=&quot;advocacy&quot;&gt;advocacy&lt;/a&gt;&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;features unique to git: &lt;a href=&quot;http://gitster.livejournal.com/16077.html&quot;&gt;http://gitster.livejournal.com/16077.html&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://lwn.net/Articles/317154/&quot;&gt;http://lwn.net/Articles/317154/&lt;/a&gt;: &lt;em&gt;git bisect &quot;is well-nigh
single-handedly responsible for reducing our average bugreport-to-fix time
from 4 days to 6 hours&quot;.&lt;/em&gt;&lt;/li&gt;
&lt;li&gt;on why git is so revolutionary.  This is actually the most &quot;concept-ish&quot;
of all the praising articles on git, and yet the most tangible because he
keeps on pumping us with examples of stuff he and others had done which
could ALL be replaced by git:
&lt;a href=&quot;http://www.advogato.org/person/apenwarr/diary/371.html&quot;&gt;http://www.advogato.org/person/apenwarr/diary/371.html&lt;/a&gt;.  Has stuff like &quot;I
wanted to build distributed filesystem, but git beat me to it; I wanted a
file backup system, but git beat me to it&quot;, etc., essentially saying that
git is a platform for building whatever you want, not just a VCS.  Or how
about a &quot;hash indexed backup system&quot; to store backups from different
systems efficiently?&lt;/li&gt;
&lt;/ul&gt;

&lt;h3&gt;&lt;a name=&quot;other_VCSs_comparision_criticism_etc&quot;&gt;other VCSs -- comparision, criticism, etc&lt;/a&gt;&lt;/h3&gt;

&lt;p&gt;look, don&#39;t expect too much praise for any of the other systems, except
possibly Hg -- and even that might be back-handed ;-)&lt;/p&gt;

&lt;h4&gt;&lt;a name=&quot;CVS&quot;&gt;CVS&lt;/a&gt;&lt;/h4&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;http://stackoverflow.com/questions/802573/difference-between-git-and-cvs/824241#824241&quot;&gt;http://stackoverflow.com/questions/802573/difference-between-git-and-cvs/824241#824241&lt;/a&gt;
-- no summary possible; it&#39;s very well written and covers a lot of ground.
It starts off with &quot;even if you use version control for single developer,
on single machine (single account), there are a few differences between
Git and CVS&quot;, listing 10 points there :-)  A &quot;must read&quot;.&lt;/li&gt;
&lt;/ul&gt;

&lt;h4&gt;&lt;a name=&quot;SVN&quot;&gt;SVN&lt;/a&gt;&lt;/h4&gt;

&lt;p&gt;...but also see the &lt;a href=&quot;../other-stuff/svn.html&quot;&gt;main article on subversion&lt;/a&gt; for
a lot more; SVN is the most used VCS in terms of what potential git users are
&lt;em&gt;currently&lt;/em&gt; using, so it has its own page.&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;http://blog.mwolson.org/tech/why_i_dislike_subversion.html&quot;&gt;http://blog.mwolson.org/tech/why_i_dislike_subversion.html&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h4&gt;&lt;a name=&quot;Visual_Source_font_size_5_un_font_Safe_and_TFS&quot;&gt;Visual Source &lt;font size=-5&gt;un&lt;/font&gt;Safe and TFS&lt;/a&gt;&lt;/h4&gt;

&lt;ul&gt;
&lt;li&gt;data integrity issues in VSS:
&lt;a href=&quot;http://www.developsense.com/testing/VSSDefects.html&quot;&gt;http://www.developsense.com/testing/VSSDefects.html&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;from &lt;a href=&quot;http://martinfowler.com/bliki/VersionControlTools.html&quot;&gt;http://martinfowler.com/bliki/VersionControlTools.html&lt;/a&gt;: &lt;em&gt;Before I
finish with those behind the threshold, I just want to say a few things
about a particularly awful tool: Visual Source Safe, or as I call it:
Visual Source Shredder. We see this less often now, thank goodness, but if
you are using it we&#39;d strongly suggest you get off it. Now. Not just is it
a pain to use, I&#39;ve heard too many tales of repository corruption to trust
it with anything more valuable than foo.txt.&lt;/em&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;TFS rant &lt;a href=&quot;http://developers.slashdot.org/comments.pl?sid=1872398&amp;amp;cid=34258672&quot;&gt;http://developers.slashdot.org/comments.pl?sid=1872398&amp;amp;cid=34258672&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h4&gt;&lt;a name=&quot;Clearcase&quot;&gt;Clearcase&lt;/a&gt;&lt;/h4&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;http://creativekarma.com/ee.php/weblog/comments/why_clearcase_sucks/&quot;&gt;http://creativekarma.com/ee.php/weblog/comments/why_clearcase_sucks/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://evilparty.org/~orc/2004/08/03/001/index.html&quot;&gt;http://evilparty.org/~orc/2004/08/03/001/index.html&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://selenic.com/pipermail/mercurial/2007-April/012864.html&quot;&gt;http://selenic.com/pipermail/mercurial/2007-April/012864.html&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://www.digitaltorque.ca/2006/12/18/clearcase-making-easy-things-hard/&quot;&gt;http://www.digitaltorque.ca/2006/12/18/clearcase-making-easy-things-hard/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://www.germane-software.com:8080/ser/aikido/clearcase-sucks&quot;&gt;http://www.germane-software.com:8080/ser/aikido/clearcase-sucks&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://www.littleredbat.net/mk/blog/story/63/&quot;&gt;http://www.littleredbat.net/mk/blog/story/63/&lt;/a&gt; -- git to the rescue :-)&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://www.trolocsis.com/wp/2007/04/18/the-joys-of-clearcase/&quot;&gt;http://www.trolocsis.com/wp/2007/04/18/the-joys-of-clearcase/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://codicesoftware.blogspot.com/2008/04/break-up-clearcase-bad-love-affair.html&quot;&gt;http://codicesoftware.blogspot.com/2008/04/break-up-clearcase-bad-love-affair.html&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://permalink.gmane.org/gmane.comp.version-control.git/132311&quot;&gt;http://permalink.gmane.org/gmane.comp.version-control.git/132311&lt;/a&gt; -- on
CC&#39;s speed&lt;/li&gt;
&lt;/ul&gt;

&lt;h4&gt;&lt;a name=&quot;Hg&quot;&gt;Hg&lt;/a&gt;&lt;/h4&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;http://weblog.masukomi.org/2008/2/4/some-thoughts-about-git&quot;&gt;http://weblog.masukomi.org/2008/2/4/some-thoughts-about-git&lt;/a&gt; (cf Hg)&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://weblogs.mozillazine.org/preed/2007/04/version_control_system_shootou_1.html&quot;&gt;http://weblogs.mozillazine.org/preed/2007/04/version_control_system_shootou_1.html&lt;/a&gt;
:-)&lt;/li&gt;
&lt;/ul&gt;

&lt;h4&gt;&lt;a name=&quot;darcs&quot;&gt;darcs&lt;/a&gt;&lt;/h4&gt;

&lt;p&gt;All this is moot -- the GHC (Glasgow Haskell Compiler) people themselves moved
from Darcs to git :-)&lt;/p&gt;

&lt;p&gt;Think about it.  Darcs was the poster child of &quot;mainstream&quot; use of Haskell
(i.e., outside the ivory towers).  And the people who maintain the standard
Haskell compiler decided it was too slow or something.&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;http://blog.moertel.com/articles/2007/12/10/how-i-stopped-missing-darcs-and-started-loving-git#comment-856&quot;&gt;http://blog.moertel.com/articles/2007/12/10/how-i-stopped-missing-darcs-and-started-loving-git#comment-856&lt;/a&gt;
a very cogent comparision with Darcs from someone who used Darcs for 3
years and git for 1 year&lt;/li&gt;
&lt;/ul&gt;

&lt;h4&gt;&lt;a name=&quot;perforce&quot;&gt;perforce&lt;/a&gt;&lt;/h4&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;http://kb.perforce.com/UserTasks/WorkingDisconnected&quot;&gt;http://kb.perforce.com/UserTasks/WorkingDisconnected&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://luqui.org/blog/archives/2007/02/19/perforce-sucks/&quot;&gt;http://luqui.org/blog/archives/2007/02/19/perforce-sucks/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;very interesting stuff.  SVN guys will like this :-)
&lt;a href=&quot;http://www.harukizaemon.com/2006/09/no-really-perforce-does-suck.html&quot;&gt;http://www.harukizaemon.com/2006/09/no-really-perforce-does-suck.html&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h3&gt;&lt;a name=&quot;funny_stuff&quot;&gt;funny stuff&lt;/a&gt;&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;http://changelog.complete.org/posts/698-If-Version-Control-Systems-were-Airlines.html&quot;&gt;http://changelog.complete.org/posts/698-If-Version-Control-Systems-were-Airlines.html&lt;/a&gt;
-- esp the last 2 &quot;airlines&quot;.  No wonder I like git so much :-)&lt;/li&gt;
&lt;/ul&gt;

&lt;h3&gt;&lt;a name=&quot;git_and_I_&quot;&gt;git and I :)&lt;/a&gt;&lt;/h3&gt;

&lt;p&gt;http://colabti.org/irclogger/irclogger_log/git?date=2009-08-08#l839&lt;/p&gt;
&lt;/html&gt;
</pre>
</div>
<div title="gittalk" modifier="Sitaram" created="201110051936">
<pre>
&lt;html&gt;
&lt;h1&gt;presentation on git, a DVCS&lt;/h1&gt;

&lt;h1&gt;why&lt;/h1&gt;

&lt;p&gt;../images/projects-sans-vcs.png&lt;/p&gt;

&lt;h1&gt;why use a VCS&lt;/h1&gt;

&lt;ul&gt;
&lt;li&gt;reversibility or rollback@@, aka C-Y-A!
&lt;ul&gt;
&lt;li&gt;linear (on the time axis)@@, simple to implement&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;concurrency
&lt;ul&gt;
&lt;li&gt;non-linear@@, all the complexity is here&lt;/li&gt;
&lt;li&gt;make or break productivity
&lt;ul&gt;
&lt;li&gt;individual productivity also@@, if it can make context switching
trivial&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;annotation&lt;/li&gt;
&lt;/ul&gt;

&lt;h1&gt;VCSs in common use&lt;/h1&gt;

&lt;ul&gt;
&lt;li&gt;open source
&lt;ul&gt;
&lt;li&gt;CVS&lt;/li&gt;
&lt;li&gt;SVN (Subversion)&lt;/li&gt;
&lt;li&gt;Darcs/TLA/Bazaar/Monotone@@, Mercurial, Git&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;proprietary
&lt;ul&gt;
&lt;li&gt;VSS@@, Clearcase@@@@, Perforce&lt;/li&gt;
&lt;li&gt;Bitkeeper&lt;/li&gt;
&lt;li&gt;others??&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h1&gt;&quot;distributed&quot;?&lt;/h1&gt;

&lt;ul&gt;
&lt;li&gt;every dev has his/her own repository
&lt;ul&gt;
&lt;li&gt;on their own workstation&lt;/li&gt;
&lt;li&gt;no single point of failure/contention&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;all repos are (usually) &quot;clones&quot; of the central repository&lt;/li&gt;
&lt;li&gt;easy to work offline
&lt;ul&gt;
&lt;li&gt;e.g., long weekend+laptop :-)&lt;/li&gt;
&lt;li&gt;commits made while offline retain their identity&lt;/li&gt;
&lt;li&gt;they don&#39;t get collapsed into one big commit&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;commit-then-merge, not merge-then-commit&lt;/li&gt;
&lt;/ul&gt;

&lt;h2&gt;disconnected operation&lt;/h2&gt;

&lt;ul&gt;
&lt;li&gt;local caching: how much is cached locally when you check out?
&lt;ul&gt;
&lt;li&gt;CVS: working copy of specific version, plus info about what version
was checked out&lt;/li&gt;
&lt;li&gt;SVN: CVS, plus extra copy of the specified version&lt;/li&gt;
&lt;li&gt;BZR/HG: SVN, plus complete history of current branch&lt;/li&gt;
&lt;li&gt;GIT: BZR/HG, plus complete history of ALL branches!&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h2&gt;notes on above&lt;/h2&gt;

&lt;ul&gt;
&lt;li&gt;CVS: Anything other than edit needs network access, even a diff between
your working copy and the currently checked out version&lt;/li&gt;
&lt;li&gt;SVN: Diffs between working copy and any other version need network&lt;/li&gt;
&lt;li&gt;BZR/HG: Comparing to a different branch or switching to it needs network&lt;/li&gt;
&lt;li&gt;VSS
&lt;ul&gt;
&lt;li&gt;no network access except via &quot;shares&quot;, so local teams only&lt;/li&gt;
&lt;li&gt;no atomic commits!&lt;/li&gt;
&lt;li&gt;no merge tracking&lt;/li&gt;
&lt;li&gt;repository corruption&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h1&gt;what&#39;s different about git?&lt;/h1&gt;

&lt;ul&gt;
&lt;li&gt;cryptographically secure integrity checks builtin&lt;/li&gt;
&lt;li&gt;fast
&lt;ul&gt;
&lt;li&gt;most operations are local&lt;/li&gt;
&lt;li&gt;network operations are highly optimised&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ideal&lt;/strong&gt; for distributed teams&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;easy to setup/deploy
&lt;ul&gt;
&lt;li&gt;server requires minimal hardware&lt;/li&gt;
&lt;li&gt;no license costs&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h1&gt;what&#39;s different about git? (cont&#39;d)&lt;/h1&gt;

&lt;ul&gt;
&lt;li&gt;very small repo size
&lt;ul&gt;
&lt;li&gt;Mozilla repo in CVS: 2.7 GB&lt;/li&gt;
&lt;li&gt;imported to SVN 8.2 GB&lt;/li&gt;
&lt;li&gt;imported to GIT: 450 MB!&lt;/li&gt;
&lt;li&gt;(a full checkout is 350 MB)&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;very, very, cheap branching&lt;/li&gt;
&lt;li&gt;excellent merging&lt;/li&gt;
&lt;/ul&gt;

&lt;h1&gt;caveats about git&lt;/h1&gt;

&lt;ul&gt;
&lt;li&gt;no partial checkouts -- it&#39;s the whole project or nothing
&lt;ul&gt;
&lt;li&gt;but you can use the &quot;submodule&quot; mechanism if you know in advance what
pieces will be separately needed&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;will not track
&lt;ul&gt;
&lt;li&gt;permissions and ownership, except the &quot;x&quot; (executable) bit
&lt;ul&gt;
&lt;li&gt;in unix terms, only cares about the first &quot;x&quot; in rwxrwxrwx&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;empty directories&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;not optimised for tracking &lt;strong&gt;very large&lt;/strong&gt; binary files (movies, etc.)&lt;/li&gt;
&lt;/ul&gt;

&lt;h1&gt;history&lt;/h1&gt;

&lt;ul&gt;
&lt;li&gt;initially designed as a file system!&lt;/li&gt;
&lt;li&gt;originally only a backend@@, now all in one&lt;/li&gt;
&lt;li&gt;reputation for being hard to use@@, now no longer valid&lt;/li&gt;
&lt;li&gt;focus on large projects with many developers
&lt;ul&gt;
&lt;li&gt;but that doesn&#39;t mean small projects can&#39;t use it&lt;/li&gt;
&lt;li&gt;remember: multi-tasking&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h1&gt;working with git&lt;/h1&gt;

&lt;ul&gt;
&lt;li&gt;CLI is the most powerful&lt;/li&gt;
&lt;li&gt;don&#39;t like the CLI?
&lt;ul&gt;
&lt;li&gt;3 excellent GUI tools come with git&lt;/li&gt;
&lt;li&gt;very powerful; for an excellent intro to these tools, see
http://nathanj.github.com/gitguide&lt;/li&gt;
&lt;li&gt;plugins: Eclipse and VS plugins available&lt;/li&gt;
&lt;li&gt;but you miss many features &lt;strong&gt;unique&lt;/strong&gt; to git if you only use these
plugins&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h1&gt;some mindset changes needed...&lt;/h1&gt;

&lt;ul&gt;
&lt;li&gt;learn to make many fine-grained commits rather than a few large ones&lt;/li&gt;
&lt;li&gt;commit locally before performing any remote operations
&lt;ul&gt;
&lt;li&gt;example, in the typical &quot;svn update&quot; scenario, if your changes are not
yet ready to be sent to the server, you can either
&lt;ul&gt;
&lt;li&gt;avoid doing the update&lt;/li&gt;
&lt;li&gt;do it and pray :-)&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;in git, you just commit locally before doing the &quot;git pull&quot;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h1&gt;normal workflow - CVCSs&lt;/h1&gt;

&lt;p&gt;../images/flow-CVCS.png&lt;/p&gt;

&lt;h1&gt;normal workflow - most DVCSs&lt;/h1&gt;

&lt;p&gt;../images/flow-DVCS.png&lt;/p&gt;

&lt;h1&gt;normal workflow - Git&lt;/h1&gt;

&lt;p&gt;../images/flow-Git.png&lt;/p&gt;

&lt;h1&gt;something unique to git&lt;/h1&gt;

&lt;ul&gt;
&lt;li&gt;index
&lt;ul&gt;
&lt;li&gt;a staging area for the next commit&lt;/li&gt;
&lt;li&gt;stuff gets sent here when you &quot;add&quot;&lt;/li&gt;
&lt;li&gt;when you &quot;commit&quot;, the current index is turned into a real commit
object&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;helps in reviewing changes&lt;/li&gt;
&lt;li&gt;helps when fixing conflicts during a complex merge&lt;/li&gt;
&lt;/ul&gt;

&lt;h1&gt;problems in SVN&lt;/h1&gt;

&lt;ul&gt;
&lt;li&gt;slow on large repositories&lt;/li&gt;
&lt;li&gt;.SVN directories all over the place
&lt;ul&gt;
&lt;li&gt;often as large as the entire git repo!&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;refactor/rename support missing&lt;/li&gt;
&lt;li&gt;branching is fine...
&lt;ul&gt;
&lt;li&gt;but merging...?&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h1&gt;problems in SVN (cont&#39;d)&lt;/h1&gt;

&lt;ul&gt;
&lt;li&gt;merge tracking not very well done
&lt;ul&gt;
&lt;li&gt;does not record who did the branch (attributes all changes to the dev
who did the merge)&lt;/li&gt;
&lt;li&gt;does not record &quot;merge-only&quot; changes separately from the two branches&lt;/li&gt;
&lt;li&gt;can make repeated merges very difficult
&lt;ul&gt;
&lt;li&gt;SVN mergeinfo has many limitations&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;merges can be slow&lt;/li&gt;
&lt;li&gt;large merges can be painful&lt;/li&gt;
&lt;/ul&gt;

&lt;h1&gt;branching in most older VCSs&lt;/h1&gt;

&lt;ul&gt;
&lt;li&gt;branching is considered advanced and people avoid it
&lt;ul&gt;
&lt;li&gt;either the tool has no branching,&lt;/li&gt;
&lt;li&gt;or has really bad merging&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;and branching is useless without good merging&lt;/li&gt;
&lt;li&gt;so lots of parallelism goes unused
&lt;ul&gt;
&lt;li&gt;or you need &quot;SCM admins&quot; to do the merge!&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h1&gt;problems in SVN (cont&#39;d)&lt;/h1&gt;

&lt;ul&gt;
&lt;li&gt;lack of local commits
&lt;ul&gt;
&lt;li&gt;you don&#39;t want to &quot;break the build&quot;&lt;/li&gt;
&lt;li&gt;so you keep lots of uncommitted changes outside the VCS&lt;/li&gt;
&lt;li&gt;and do one big checkin when you&#39;re ready&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h1&gt;productivity advantages of git&lt;/h1&gt;

&lt;ul&gt;
&lt;li&gt;history tracking handled much better; makes repeated merges a breeze
&lt;ul&gt;
&lt;li&gt;all &quot;commits&quot; identified by a SHA-1 checksum
&lt;ul&gt;
&lt;li&gt;this is what gives it the cryptographically secure integrity
check)&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;a branch is just a pointer to some commit&lt;/li&gt;
&lt;li&gt;every commit records its parent commit&#39;s sha&lt;/li&gt;
&lt;li&gt;a merge is just a commit with more than one parent commit&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;so, every commit knows all of its ancestors
&lt;ul&gt;
&lt;li&gt;regardless of repository, branch, etc&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h1&gt;Linus on merging&lt;/h1&gt;

&lt;ul&gt;
&lt;li&gt;merging is the most important activity
&lt;ul&gt;
&lt;li&gt;&quot;I merge 22,000 files several times a day, and I get unhappy if a
merge takes more than 5 seconds&quot; -- Linus&lt;/li&gt;
&lt;li&gt;the linux kernel has 22000 files and has averaged 4.5 merges/day over
the last 2 years&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h1&gt;Linus on merging (cont&#39;d)&lt;/h1&gt;

&lt;ul&gt;
&lt;li&gt;make it fast and painless
&lt;ul&gt;
&lt;li&gt;...and people will start using it every day&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;merge often, merge early&lt;/li&gt;
&lt;li&gt;otherwise you have huge conflicts to resolve later!&lt;/li&gt;
&lt;/ul&gt;

&lt;h2&gt;Linus on merging (cont&#39;d)&lt;/h2&gt;

&lt;pre&gt;&lt;code&gt;http://git.or.cz/gitwiki/LinusTalk200705Transcript

If you can do something really fast, really well, people will start using
it differently. One of the things I wanted to make sure is that merges go
really really quickly because I want people to merge often and merge
early, because as it turns out it becomes easier to merge. If you merge
every day, suddenly you never get to the point where you have huge
conflicts that are hard to resolve. So if you actually make branching and
merging easy, you actually avoid a whole class of problems that you
otherwise have a really really hard time avoiding.
&lt;/code&gt;&lt;/pre&gt;

&lt;h1&gt;productivity advantages of git (cont&#39;d)&lt;/h1&gt;

&lt;ul&gt;
&lt;li&gt;complex merges handled much better; frees devs from worrying about it most
of the time
&lt;ul&gt;
&lt;li&gt;merges involving renames&lt;/li&gt;
&lt;li&gt;criss-cross merges&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;encourages many small commits instead of few large commits
&lt;ul&gt;
&lt;li&gt;easier code reviews&lt;/li&gt;
&lt;li&gt;easier debugging&lt;/li&gt;
&lt;li&gt;easier cherry picking&lt;/li&gt;
&lt;li&gt;easier merging/rebasing (conflict resolution happens in much smaller
units)&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h1&gt;productivity advantages of git (cont&#39;d)&lt;/h1&gt;

&lt;ul&gt;
&lt;li&gt;encourages creating local branches
&lt;ul&gt;
&lt;li&gt;no need to pollute the central server&lt;/li&gt;
&lt;li&gt;experimental code can be developed &quot;on the side&quot;
&lt;ul&gt;
&lt;li&gt;if it works, promote it to the central server, with the full
history of commits intact&lt;/li&gt;
&lt;li&gt;otherwise, delete it; no need to immortalise failed experiments on
the central server :-)&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;branch &lt;strong&gt;names&lt;/strong&gt; are also local
&lt;ul&gt;
&lt;li&gt;we can all have a branch called &quot;my-test&quot; or &quot;test&quot; or whatever,
without worrying about &quot;is someone else using the same branch
name?&quot;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h1&gt;productivity advantages of git (cont&#39;d)&lt;/h1&gt;

&lt;ul&gt;
&lt;li&gt;encourages using the tools available
&lt;ul&gt;
&lt;li&gt;important vcs operations (like &quot;diff&quot;) do not need network access&lt;/li&gt;
&lt;li&gt;blazingly fast
&lt;ul&gt;
&lt;li&gt;even against a very old revision&lt;/li&gt;
&lt;li&gt;or a version in some other branch&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;centralised VCSs take too long
&lt;ul&gt;
&lt;li&gt;painful to use&lt;/li&gt;
&lt;li&gt;so programmers avoid them (?)&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h2&gt;above stuff mostly from&lt;/h2&gt;

&lt;ul&gt;
&lt;li&gt;http://www.bitkeeper.com/Comparisons.html has subsections like
http://www.bitkeeper.com/Comparisons.CVS.html and so on&lt;/li&gt;
&lt;li&gt;excellent resource, but knowing Mr McVoy, a little NaCl may be useful :)&lt;/li&gt;
&lt;/ul&gt;

&lt;h1&gt;maintainability -- refactor/rename support&lt;/h1&gt;

&lt;ul&gt;
&lt;li&gt;in most VCSs, renaming a file
&lt;ul&gt;
&lt;li&gt;is treated as a copy+delete&lt;/li&gt;
&lt;li&gt;loses history (?)&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;how about...
&lt;ul&gt;
&lt;li&gt;rename + move + edit a file in one branch&lt;/li&gt;
&lt;li&gt;while making some bugfixes to it in another?&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;git handles this without any fuss -- demo 09&lt;/li&gt;
&lt;/ul&gt;

&lt;h1&gt;demo 09 in pictures&lt;/h1&gt;

&lt;p&gt;../images/demo-09-01.png&lt;/p&gt;

&lt;h1&gt;demo 09 in pictures&lt;/h1&gt;

&lt;p&gt;../images/demo-09-02.png&lt;/p&gt;

&lt;h1&gt;demo 09 in pictures&lt;/h1&gt;

&lt;p&gt;../images/demo-09-03.png&lt;/p&gt;

&lt;h1&gt;demo 09 in pictures&lt;/h1&gt;

&lt;p&gt;../images/demo-09-04.png&lt;/p&gt;

&lt;h1&gt;demo 09 in pictures&lt;/h1&gt;

&lt;p&gt;../images/demo-09-05.png&lt;/p&gt;

&lt;h1&gt;demo 09 in pictures&lt;/h1&gt;

&lt;p&gt;../images/demo-09-06.png&lt;/p&gt;

&lt;h1&gt;demo 09 in pictures&lt;/h1&gt;

&lt;p&gt;../images/demo-09-07.png&lt;/p&gt;

&lt;h1&gt;demo 09 in pictures&lt;/h1&gt;

&lt;p&gt;../images/demo-09-08.png&lt;/p&gt;

&lt;h1&gt;demo 09 in pictures&lt;/h1&gt;

&lt;p&gt;../images/demo-09-09.png&lt;/p&gt;

&lt;h1&gt;demo 09 in pictures&lt;/h1&gt;

&lt;p&gt;../images/demo-09-10.png&lt;/p&gt;

&lt;h1&gt;demo 09 in pictures&lt;/h1&gt;

&lt;p&gt;../images/demo-09-11.png&lt;/p&gt;

&lt;h1&gt;maintainability: code movement detection&lt;/h1&gt;

&lt;ul&gt;
&lt;li&gt;example
&lt;ul&gt;
&lt;li&gt;move an important function with lots of history to some other file&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;what would other VCSs do to the &lt;strong&gt;history&lt;/strong&gt;?&lt;/li&gt;
&lt;li&gt;next 5 slides show code movement
&lt;ul&gt;
&lt;li&gt;displayed using &quot;git gui blame&quot;, one of the 3 GUI tools that come with
git&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h1&gt;code movement detection in pictures&lt;/h1&gt;

&lt;p&gt;../images/gui-blame-1.png&lt;/p&gt;

&lt;h1&gt;code movement detection in pictures&lt;/h1&gt;

&lt;p&gt;../images/gui-blame-2.png&lt;/p&gt;

&lt;h1&gt;code movement detection in pictures&lt;/h1&gt;

&lt;p&gt;../images/gui-blame-3.png&lt;/p&gt;

&lt;h1&gt;code movement detection in pictures&lt;/h1&gt;

&lt;p&gt;../images/gui-blame-4.png&lt;/p&gt;

&lt;h1&gt;code movement detection in pictures&lt;/h1&gt;

&lt;p&gt;../images/gui-blame-5.png&lt;/p&gt;

&lt;h1&gt;maintainability: code movement detection (cont&#39;d)&lt;/h1&gt;

&lt;ul&gt;
&lt;li&gt;this is &lt;strong&gt;way&lt;/strong&gt; beyond what any other VCS can even dream of&lt;/li&gt;
&lt;li&gt;great help for new people trying to understand existing code base&lt;/li&gt;
&lt;li&gt;here&#39;s a secret...
&lt;ul&gt;
&lt;li&gt;the information you see is not &lt;strong&gt;stored&lt;/strong&gt; in the repository&lt;/li&gt;
&lt;li&gt;it is &lt;strong&gt;computed&lt;/strong&gt; on demand, dynamically!&lt;/li&gt;
&lt;li&gt;which means you can get the same tracability for all your existing
code
&lt;ul&gt;
&lt;li&gt;simply by converting to git!&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h1&gt;maintainability: revision history viewer&lt;/h1&gt;

&lt;ul&gt;
&lt;li&gt;git has another GUI to show you the version history graph
&lt;ul&gt;
&lt;li&gt;very intuitive, shows merges etc very nicely&lt;/li&gt;
&lt;li&gt;lots of &quot;right click&quot; options in various places, to help track things
down...&lt;/li&gt;
&lt;li&gt;(one small example follows; there are many, many, more features --
there is not enough time to talk about more!)&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h1&gt;revision history viewer&lt;/h1&gt;

&lt;p&gt;../images/gitk-1.png&lt;/p&gt;

&lt;h1&gt;revision history viewer&lt;/h1&gt;

&lt;p&gt;../images/gitk-2.png&lt;/p&gt;

&lt;h1&gt;revision history viewer&lt;/h1&gt;

&lt;p&gt;../images/gitk-3.png&lt;/p&gt;

&lt;h1&gt;git concepts&lt;/h1&gt;

&lt;ul&gt;
&lt;li&gt;repo
&lt;ul&gt;
&lt;li&gt;self-contained; remove &quot;.git&quot; and it&#39;s all gone&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;branch
&lt;ul&gt;
&lt;li&gt;active line of development&lt;/li&gt;
&lt;li&gt;a repo can track any number of branches&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;master
&lt;ul&gt;
&lt;li&gt;default branch in a new git project&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h1&gt;concept detail: branches&lt;/h1&gt;

&lt;ul&gt;
&lt;li&gt;easy and inexpensive&lt;/li&gt;
&lt;li&gt;can have separate branches for separate features&lt;/li&gt;
&lt;li&gt;many being worked on &quot;simultaneously&quot;!&lt;/li&gt;
&lt;li&gt;you can switch rapidly between branches&lt;/li&gt;
&lt;li&gt;boosts individual productivity as well as team productivity&lt;/li&gt;
&lt;li&gt;almost all existing VCSs suck at this&lt;/li&gt;
&lt;/ul&gt;

&lt;h1&gt;git concepts (cont&#39;d)&lt;/h1&gt;

&lt;ul&gt;
&lt;li&gt;working tree
&lt;ul&gt;
&lt;li&gt;is associated with only one branch&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;head
&lt;ul&gt;
&lt;li&gt;the tip of a branch&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;HEAD
&lt;ul&gt;
&lt;li&gt;the tip of the branch associated with your working tree; this is where
commits go&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h1&gt;git concepts (cont&#39;d)&lt;/h1&gt;

&lt;ul&gt;
&lt;li&gt;index: holding area for changes approved for commit
&lt;ul&gt;
&lt;li&gt;git tracks content, not files&lt;/li&gt;
&lt;li&gt;lets you select some files to commit while postponing others&lt;/li&gt;
&lt;li&gt;lets you keep uncommited changes hanging around&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;remote&lt;/li&gt;
&lt;li&gt;origin&lt;/li&gt;
&lt;/ul&gt;

&lt;h1&gt;some more git concepts&lt;/h1&gt;

&lt;ul&gt;
&lt;li&gt;commit ancestry&lt;/li&gt;
&lt;li&gt;commit ancestry as a DAG
&lt;ul&gt;
&lt;li&gt;the essence of git is to build and traverse this DAG&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h2&gt;life savers&lt;/h2&gt;

&lt;h1&gt;CVS/SVN equivalence&lt;/h1&gt;

&lt;pre&gt;&lt;code&gt;    CVS                  GIT
    ---                  ---
    checkout             clone
    update               pull
    checkin              commit + push
    add                  add
    remove               rm
    ???                  mv
&lt;/code&gt;&lt;/pre&gt;

&lt;h1&gt;cool stuff&lt;/h1&gt;

&lt;ul&gt;
&lt;li&gt;the reflog, reachability, and garbage collection&lt;/li&gt;
&lt;li&gt;demo 10 -- cherry picking&lt;/li&gt;
&lt;li&gt;rebase&lt;/li&gt;
&lt;li&gt;bisect&lt;/li&gt;
&lt;li&gt;stash&lt;/li&gt;
&lt;/ul&gt;

&lt;h1&gt;demo 10 in pictures&lt;/h1&gt;

&lt;p&gt;../images/demo-10-01.png&lt;/p&gt;

&lt;h1&gt;demo 10 in pictures&lt;/h1&gt;

&lt;p&gt;../images/demo-10-02.png&lt;/p&gt;

&lt;h1&gt;demo 10 in pictures&lt;/h1&gt;

&lt;p&gt;../images/demo-10-03.png&lt;/p&gt;

&lt;h1&gt;rebase -- what and why&lt;/h1&gt;

&lt;ul&gt;
&lt;li&gt;what&lt;/li&gt;
&lt;li&gt;why
&lt;ul&gt;
&lt;li&gt;parallel and serial branching&lt;/li&gt;
&lt;li&gt;getting the best out of bisect&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h1&gt;rebase -- when and how&lt;/h1&gt;

&lt;ul&gt;
&lt;li&gt;killing off an old commit&lt;/li&gt;
&lt;li&gt;re-arranging your commits interactively -- demo 11&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;when not to use it!&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;origin has moved
&lt;ul&gt;
&lt;li&gt;demo 12 -- parallel branch using merge&lt;/li&gt;
&lt;li&gt;demo 13 -- serial branch using rebase&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;same, but after some of your changes have gone upstream
&lt;ul&gt;
&lt;li&gt;and they have DIFFERENT SHA1s now!!&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h1&gt;demo 11 in pictures&lt;/h1&gt;

&lt;p&gt;../images/demo-11-01.png&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;and now we do:
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;git rebase -i HEAD~8&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h1&gt;demo 11 in pictures&lt;/h1&gt;

&lt;p&gt;../images/demo-11-02.png&lt;/p&gt;

&lt;h1&gt;demo 11 in pictures&lt;/h1&gt;

&lt;p&gt;../images/demo-11-03.png&lt;/p&gt;

&lt;h1&gt;demo 11 in pictures&lt;/h1&gt;

&lt;p&gt;../images/demo-11-04.png&lt;/p&gt;

&lt;h1&gt;demo 11 in pictures&lt;/h1&gt;

&lt;p&gt;../images/demo-11-05.png&lt;/p&gt;

&lt;h1&gt;demo 11 in pictures&lt;/h1&gt;

&lt;p&gt;../images/demo-11-06.png&lt;/p&gt;

&lt;h1&gt;demo 12 (normal merge)&lt;/h1&gt;

&lt;p&gt;../images/demo-12-01.png&lt;/p&gt;

&lt;h1&gt;demo 12 (normal merge)&lt;/h1&gt;

&lt;p&gt;../images/demo-12-02.png&lt;/p&gt;

&lt;h1&gt;demo 12 (normal merge)&lt;/h1&gt;

&lt;p&gt;../images/demo-12-03.png&lt;/p&gt;

&lt;h1&gt;demo 12 (normal merge)&lt;/h1&gt;

&lt;p&gt;../images/demo-12-04.png&lt;/p&gt;

&lt;h1&gt;demo 12 (normal merge)&lt;/h1&gt;

&lt;p&gt;../images/demo-12-05.png&lt;/p&gt;

&lt;h1&gt;demo 13 (rebase)&lt;/h1&gt;

&lt;p&gt;../images/demo-13-01.png&lt;/p&gt;

&lt;h1&gt;demo 13 (rebase)&lt;/h1&gt;

&lt;p&gt;../images/demo-13-02.png&lt;/p&gt;

&lt;h1&gt;demo 13 (rebase)&lt;/h1&gt;

&lt;p&gt;../images/demo-13-03.png&lt;/p&gt;

&lt;h1&gt;odds and ends&lt;/h1&gt;

&lt;ul&gt;
&lt;li&gt;only one &quot;.git&quot; dir at the top&lt;/li&gt;
&lt;li&gt;patches and repo updates can be ftp-d or mailed&lt;/li&gt;
&lt;li&gt;multi-protocol transport
&lt;ul&gt;
&lt;li&gt;http, ssh, git&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;all copies of a repo have the same history
&lt;ul&gt;
&lt;li&gt;universal public identifier (a SHA-1 hash)&lt;/li&gt;
&lt;li&gt;entire 2 year history of linux kernel is half the current full size&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h1&gt;summary: what is git optimised for&lt;/h1&gt;

&lt;ul&gt;
&lt;li&gt;distributed development&lt;/li&gt;
&lt;li&gt;large file sets&lt;/li&gt;
&lt;li&gt;complex merges&lt;/li&gt;
&lt;li&gt;speculative, trial branches&lt;/li&gt;
&lt;li&gt;EXTREME SPEED -- very fast and very robust&lt;/li&gt;
&lt;/ul&gt;

&lt;h1&gt;Thank you&lt;/h1&gt;

&lt;hr /&gt;

&lt;h3&gt;Questions?&lt;/h3&gt;

&lt;hr /&gt;

&lt;hr /&gt;
&lt;/html&gt;
</pre>
</div>
<div title="vss2git" modifier="Sitaram" created="201110051936">
<pre>
&lt;html&gt;
&lt;h1&gt;&lt;a name=&quot;converting_Visual_Source_Shredder_to_GIT&quot;&gt;converting Visual Source Shredder to GIT&lt;/a&gt;&lt;/h1&gt;

&lt;p&gt;[Thanks to http://martinfowler.com/bliki/VersionControlTools.html for the
new expansion of VSS]&lt;/p&gt;

&lt;p&gt;This is a 2 step process.  For large values of 2, as they say :)  But the nice
thing is it can all be done in Linux; no need to use a Windows machine as long
as you have a copy of the full VSS repo.&lt;/p&gt;

&lt;p&gt;&lt;sup&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#converting_Visual_Source_Shredder_to_GIT&quot;&gt;converting Visual Source Shredder to GIT&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#build_vss2svn&quot;&gt;build vss2svn&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#run_vss2svn&quot;&gt;run vss2svn&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#load_the_SVN_dump_file&quot;&gt;load the SVN dump file&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#convert_svn_to_git&quot;&gt;convert svn to git&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#checking_the_results&quot;&gt;checking the results&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#tags&quot;&gt;tags&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#deleted_files&quot;&gt;deleted files&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#that_damn_CRLF_thing&quot;&gt;that damn CRLF thing&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#bottom_line&quot;&gt;bottom line&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#alternative_method_using_perl_on_windows&quot;&gt;alternative method using perl on windows&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#Appendices&quot;&gt;Appendices&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#perlmodinstalls&quot;&gt;installing the perl modules&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#libboostpatch&quot;&gt;patch for libboost 1.36&lt;/a&gt;&lt;br&gt;
&lt;/sup&gt;&lt;/p&gt;

&lt;hr /&gt;

&lt;h3&gt;&lt;a name=&quot;build_vss2svn&quot;&gt;build vss2svn&lt;/a&gt;&lt;/h3&gt;

&lt;p&gt;The base for all this is &lt;a href=&quot;http://www.pumacode.org/projects/vss2svn&quot;&gt;http://www.pumacode.org/projects/vss2svn&lt;/a&gt;.  What I
did is the following:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;download the latest vss2svn (this includes ssphys also):&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;svn checkout http://svn.pumacode.org/repos/vss2svn/trunk/ vss2svn
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;follow all the instuctions to install all the various perl modules needed,
copied &lt;a href=&quot;#perlmodinstalls&quot;&gt;here&lt;/a&gt; just in case.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;install libboost-devel; ssphys needs it to build.  On my current system
(Mandriva 2009), the version was 1.36.  I got a compile error which I
fixed by running &lt;a href=&quot;#libboostpatch&quot;&gt;this patch&lt;/a&gt; (don&#39;t ask me how I found
this -- I compared the nearest boost libraries with each other and
determined that this only seemed to be a name change, and that too &lt;em&gt;only&lt;/em&gt;
in 1.36 -- very weird, but anyway...)&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;build and install vss2svn (again, instructions from the main site
reproduced here for convenience):&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;cd vss2svn
perl Build.PL
./Build
sudo ./Build install
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;And that should be that...&lt;/p&gt;

&lt;h3&gt;&lt;a name=&quot;run_vss2svn&quot;&gt;run vss2svn&lt;/a&gt;&lt;/h3&gt;

&lt;p&gt;This should be easy enough, for most normal repos.  You need to get the entire
VSS repo onto your system (the one that contains something called
&#39;srcsafe.ini&#39;).  Put that in some &quot;work&quot; directory, and do this:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;vss2svn.pl --vssdir PATH_TO_VSS_REPO --revtimerange 60
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;I have no idea how to deal with labels etc., properly in this command, but the
basic stuff should work fine.&lt;/p&gt;

&lt;h3&gt;&lt;a name=&quot;load_the_SVN_dump_file&quot;&gt;load the SVN dump file&lt;/a&gt;&lt;/h3&gt;

&lt;p&gt;The previous step should produce just an SVN dump file, which you need to
load, and that gives you an SVN repo.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;svnadmin create svnrepo
svnadmin load svnrepo &amp;lt; SVN_DUMPFILE
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;You may want to checkout this repo and at least see what &quot;projects&quot; it has,
because I do not know any other way of doing this if you don&#39;t already know
(from the VSS side).&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;mkdir svnco
svn checkout file://$PWD/svnrepo svnco
&lt;/code&gt;&lt;/pre&gt;

&lt;h3&gt;&lt;a name=&quot;convert_svn_to_git&quot;&gt;convert svn to git&lt;/a&gt;&lt;/h3&gt;

&lt;p&gt;This is, naturally, the easiest of all, especially if you don&#39;t intend to go
back :)&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;mkdir gitrepo
cd gitrepo
git svn clone file://PATH_TO_SVN_REPO
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Of course, if you have used the VSS repo to store multiple projects, this will
not work right -- VSS/SVN can happpily dump unrelated projects in one
repository (or subdirectories masquerading as projects for that matter),
whereas in git each project is in its own repository.&lt;/p&gt;

&lt;p&gt;So do it this way:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;git svn clone file://PATH_TO_SVN_REPO/projectname
    # for each project
&lt;/code&gt;&lt;/pre&gt;

&lt;h3&gt;&lt;a name=&quot;checking_the_results&quot;&gt;checking the results&lt;/a&gt;&lt;/h3&gt;

&lt;h4&gt;&lt;a name=&quot;tags&quot;&gt;tags&lt;/a&gt;&lt;/h4&gt;

&lt;p&gt;Tags (labels in VSS) don&#39;t seem to carry across properly.&lt;/p&gt;

&lt;p&gt;&lt;sup&gt;[rant] My idea of a tag is a symbolic name for a certain revision, so if you
check it out you should see approximately the same number of files that the
repo had around that time frame.  What I actually see is that the number of
files representing the various tags (as seen from an SVN checkout) range from
5% to 75% of the actual number of files in the repo!  So -- until I see a VSS
repo where the tags are actually used (and I mean &lt;em&gt;used&lt;/em&gt;, as in, &quot;these tags
do get &lt;em&gt;checked out&lt;/em&gt; when needed; they&#39;re not just for show!&quot;) I&#39;m not going
to worry about it.&lt;/sup&gt;&lt;/p&gt;

&lt;h4&gt;&lt;a name=&quot;deleted_files&quot;&gt;deleted files&lt;/a&gt;&lt;/h4&gt;

&lt;p&gt;I&#39;ve also not tested if renamed/deleted files etc also work OK, but I think
they ought to.&lt;/p&gt;

&lt;h4&gt;&lt;a name=&quot;that_damn_CRLF_thing&quot;&gt;that damn CRLF thing&lt;/a&gt;&lt;/h4&gt;

&lt;p&gt;When you do it this way, you don&#39;t have an opportunity to fix the CRLFs as
they go in -- they&#39;ll all go into the repo as CRLF.  If you try to force it on
the &quot;git svn clone&quot; itself (by prepping a blank git repo with &lt;code&gt;git config
core.autocrlf input&lt;/code&gt; and then svn-cloning into that), you get checksum errors!&lt;/p&gt;

&lt;p&gt;You have to do this after the fact.  Here&#39;s the sequence:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;git config --unset core.autocrlf
git checkout branch
git config core.autocrlf input
git filter-branch --tree-filter &#39;find . -type f -print0|xargs -0 touch&#39; HEAD
git config --unset core.autocrlf
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;The first &#39;unset&#39; is just a precaution.  If you do a checkout with autocrlf
set to input, the work tree will immediately look dirty, so the filter-branch
will refuse to run.  So you checkout under &quot;default&quot; conditions, then set the
autocrlf config, then run the tree filter.&lt;/p&gt;

&lt;p&gt;The last &#39;unset&#39; is required; you really don&#39;t want autocrlf to be anything on
a Unix box.&lt;/p&gt;

&lt;p&gt;Note: in theory, a dummy filter that does nothing &lt;em&gt;should&lt;/em&gt; work.  But it seems
to miss a lot of files, which still go in with CRLFs.  Doing an explicit touch
seems to be the only way.  I have no idea why this is so.&lt;/p&gt;

&lt;h4&gt;&lt;a name=&quot;bottom_line&quot;&gt;bottom line&lt;/a&gt;&lt;/h4&gt;

&lt;p&gt;Anyway, your bottom line should be:&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;&lt;em&gt;confirm that the tip is OK&lt;/em&gt;: make sure that the actual trees generated at
the tip of the git repository match those in a fresh &quot;get&quot; from the
corresponding project in VSS&lt;/li&gt;
&lt;li&gt;&lt;em&gt;try to confirm past history is OK&lt;/em&gt;: if possible, make the same check for
a couple of intermediate revisions also&lt;/li&gt;
&lt;li&gt;&lt;em&gt;save the VSS repo&lt;/em&gt; in a read-only location for future reference, should
there ever (much later in time) be a question on the accuracy of the
history at some revision that was not explicitly checked during the
migration.&lt;/li&gt;
&lt;/ol&gt;

&lt;h3&gt;&lt;a name=&quot;alternative_method_using_perl_on_windows&quot;&gt;alternative method using perl on windows&lt;/a&gt;&lt;/h3&gt;

&lt;p&gt;There is another method, achieved by hacking a perl script that was supposed
to convert &lt;a href=&quot;http://www.riseup.com/~brettw/dev/VSS2Subversion.html&quot;&gt;to SVN&lt;/a&gt;, to
make it go &lt;a href=&quot;../tools/vss2git.pl&quot;&gt;to git&lt;/a&gt; instead.  Pros and cons:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;(+) no CRLF problem&lt;/li&gt;
&lt;li&gt;(+) easier to use: you just need msysgit and this program, no messing
around with all these dependencies for vss2svn (but then, you can execute
vss2svn the same way too -- they have a standalone windows executable)&lt;/li&gt;
&lt;li&gt;(-) &lt;strong&gt;NOT&lt;/strong&gt; very reliable; please double check your data if you really
care about history.  Deep down beyond a point where some files were
deleted, I found mismatches with a VSS &quot;get&quot; directory.&lt;/li&gt;
&lt;li&gt;(-) leaves vssver.scc and other junk lying around&lt;/li&gt;
&lt;li&gt;(-) definitely can&#39;t handle deletes&lt;/li&gt;
&lt;li&gt;(-) timestamps only to the nearest minute&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;One reason why I&#39;m keeping this around is if a VSS repo is corrupt enough (and
it seems that happens quite often) then maybe only the original VSS can read
it.  To recover usable data from such an instance may be a futile attempt but
no harm keeping two tools around...!&lt;/p&gt;

&lt;hr /&gt;

&lt;h3&gt;&lt;a name=&quot;Appendices&quot;&gt;Appendices&lt;/a&gt;&lt;/h3&gt;

&lt;p&gt;&lt;font size=-1&gt;&lt;/p&gt;

&lt;h4&gt;&lt;a name=&quot;perlmodinstalls&quot;&gt;installing the perl modules&lt;/a&gt;&lt;/h4&gt;

&lt;p&gt;Note: I &lt;em&gt;did&lt;/em&gt; indeed have to install DBD::SQLite2 manually.  Also, Text::Glob
had to be installed using &lt;code&gt;perl -MCPAN -e shell&lt;/code&gt; followed by &lt;code&gt;install
Text::Glob&lt;/code&gt;; for some reason the &quot;-e install ...&quot; thing didn&#39;t work&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;for m in Module::Build XML::Simple Time::CTime DBD::SQLite2 DBI Tie::IxHash Text::Glob Data::UUID; do
   perl -MCPAN -e &quot;install $m&quot;
done

# SQLite2 failed to install, even with &quot;force install ...&quot;, so:
cd ~/.cpan/build/DBD-SQLite2-0.33
# May need to create the makefile...
# perl Makefile.PL
make install

# the Config:Ini module is not in CPAN, so:
wget http://backpan.perl.org/authors/id/A/AV/AVATAR/Config-Ini-1.08.tar.gz
tar xzf Config-Ini-1.08.tar.gz 
cd Config-Ini-1.08
perl Makefile.PL
make
make install
&lt;/code&gt;&lt;/pre&gt;

&lt;h4&gt;&lt;a name=&quot;libboostpatch&quot;&gt;patch for libboost 1.36&lt;/a&gt;&lt;/h4&gt;

&lt;pre&gt;&lt;code&gt;commit 4a3a283593bf8a991e0553e3ac3252c75a1349db
Author: Sitaram Chamarty &amp;lt;sitaramc@gmail.com&amp;gt;
Date:   Thu Apr 16 09:27:00 2009 +0530

    (touch wood) fixed up a weird incompatibility with my *specific* version of boost

diff --git a/vss2svn/ssphys/SSPhysLib/SSItemInfoObject.cpp b/vss2svn/ssphys/SSPhysLib/SSItemInfoObject.cpp
index 7d88a8e..0cd12ea 100644
--- a/vss2svn/ssphys/SSPhysLib/SSItemInfoObject.cpp
+++ b/vss2svn/ssphys/SSPhysLib/SSItemInfoObject.cpp
@@ -162,7 +162,7 @@ std::string SSItemInfoObject::GetDataFileName () const
   std::string fileName = GetFile ()-&amp;gt;GetFileName () + GetLatestExt ();
   boost::filesystem::path fpath(fileName, boost::filesystem::native);

-  if (!boost::filesystem::exists(fpath) &amp;amp;&amp;amp; fpath.has_leaf() &amp;amp;&amp;amp; fpath.has_branch_path())
+  if (!boost::filesystem::exists(fpath) &amp;amp;&amp;amp; fpath.has_filename() &amp;amp;&amp;amp; fpath.has_parent_path())
   {
     std::string lcLeaf = fpath.leaf();
     std::string ucLeaf = fpath.leaf();
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;/font&gt;&lt;/p&gt;
&lt;/html&gt;
</pre>
</div>
<div title="git-lfy" modifier="Sitaram" created="200906120748">
<pre>
&lt;html&gt;
&lt;h1&gt;git -- a distributed version control system&lt;/h1&gt;

&lt;p&gt;&lt;sup&gt;[Please note that this article was written in June 2008.  Although I have
kept the article largely the same, I have updated the text in one or two
places to reflect more accurate/relevant information]&lt;/sup&gt;.&lt;/p&gt;

&lt;p&gt;Git is a distributed version control system that has been around for 3 years
now. It is fast, stable, and, best of all, quite unobtrusive. While early
adopters to git faced a steep learning curve, a number of tutorials (see
http://git.or.cz/) and user friendly commands, including a GUI, have now made
using git easy.  This article is aimed at developers, so, rather than repeat
things which you can easily find for yourself at the site mentioned above, I
will instead illustrate the concepts behind git, and give you a sense of why
it is so exciting.&lt;/p&gt;

&lt;p&gt;Here&#39;s a taste: Figure 1 is a screenshot from the GUI version of what SVN
folks would know as &lt;em&gt;svn blame&lt;/em&gt;.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../images/gitlfy-fig1-gui-blame.gif&quot; alt=&quot;Figure 1&quot; title=&quot;Figure 1: Git GUI blame&quot; /&gt;&lt;/p&gt;

&lt;p&gt;As you can see, git says that the function called &lt;code&gt;find_tree_entry&lt;/code&gt; was
originally written in &lt;code&gt;sha1_name.c&lt;/code&gt; and later moved to &lt;code&gt;tree-walk.c&lt;/code&gt;
(this file).  However, no programmer &lt;em&gt;told&lt;/em&gt; git all this -- it inferred it by
looking at the revisions.  That&#39;s an amazing level of traceability in a world
where most current VCSs can&#39;t handle even a simple file-rename without being
explicitly told, such as with the &lt;code&gt;svn rename&lt;/code&gt; command!&lt;/p&gt;

&lt;h3&gt;Some history and background&lt;/h3&gt;

&lt;p&gt;The reason git is able to work this, and many other, bits of magic is because
it tackles the problem from the point of view of a file system designer.
Git&#39;s object store was designed to be a &lt;em&gt;content-addressable&lt;/em&gt; file system
(git even has an &lt;em&gt;fsck&lt;/em&gt; command!), and the data model actually tracks
content, not files.&lt;/p&gt;

&lt;p&gt;Git was created in April 2005, by Linus Torvalds, due to a frustrating state
of affairs with Bitkeeper, the VCS that was being used by the Linux kernel
folks at that time. The problems with Bitkeeper were non-technical, and we
will not go into them here, except to say that the workflows of Bitkeeper were
a large part of the inspiration behind Git.&lt;/p&gt;

&lt;p&gt;Git development was very rapid -- it became self-hosting in just 4 days of
development, but remember that&#39;s in &quot;Linus-days&quot; :-),  and in about 2.5 months
it was helping Linus manage Linux kernel development.  Currently, apart from
the Linux kernel and related projects, it is used by several projects, for
example Wine, x.org, OLPC, Ruby on Rails, VLC, and Samba.  [&lt;em&gt;Update: recent
high-profile additions are Perl, and GNOME&lt;/em&gt;]&lt;/p&gt;

&lt;p&gt;Git has two really &lt;em&gt;key&lt;/em&gt; strengths: it is very smart at merging, so that the
developers can do as much parallel development as they wish to, and it is
extremely fast, so it never gets in your way.&lt;/p&gt;

&lt;p&gt;I must add, at this point, a plug for the one webpage that helped me more than
anything else to understand the git model quickly and easily. It is called
&quot;Git for Computer Scientists&quot;, and it is at
&lt;a href=&quot;http://eagain.net/articles/git-for-computer-scientists/&quot;&gt;http://eagain.net/articles/git-for-computer-scientists/&lt;/a&gt;.  I consider this
essential reading for anyone trying to understood the git object store.&lt;/p&gt;

&lt;h3&gt;Merging -- git&#39;s first and biggest strength&lt;/h3&gt;

&lt;p&gt;The most basic function of a VCS is to give us a way to rollback to a known
state, should we really mess up whatever we are working on. In that sense, a
VCS is notionally the same as backup software: a check-in is like a &quot;save&quot; and
a check-out is like a &quot;restore&quot;.&lt;/p&gt;

&lt;p&gt;That function is important, but it is also boring. The real fun starts when
you consider how well a VCS enables &lt;em&gt;parallel development&lt;/em&gt;. This is where
the project workflow changes from a long sequence of &lt;em&gt;sequential&lt;/em&gt; changes,
to a much more efficient model where many people are &lt;em&gt;simultaneously&lt;/em&gt;
working on the same set of files, and doing different things to them.&lt;/p&gt;

&lt;p&gt;Some really old VCSs solve this by not allowing any concurrency at all: you
have to &lt;em&gt;lock&lt;/em&gt; any file which you want to edit, and until you release the
lock no one else can edit it.  This is horribly inefficient in terms of
programmer time, and one wonders why such VSSs are still in use at all!&lt;/p&gt;

&lt;p&gt;To be fair, most recent VCSs do allow &lt;em&gt;branching&lt;/em&gt;, with varying degrees of
ease of use and speed.  But as Douglas Adam&#39;s said in one of his novels, &acirc;&#128;&#156;it&#39;s
not the fall that kills you, it&#39;s the sudden stop at the end&acirc;&#128;&#157;.  Similarly,
branching is not the problem; the real test of a VCS is how well it manages to
&lt;em&gt;merge&lt;/em&gt; those branches later! Almost any recent/decent system can manage to
merge when the changes are not anywhere near each other. But what if, for
example, one developer is making changes to a file, and another one, perhaps
responsible for a much larger refactoring effort, renames and moves that file
to some other directory?&lt;/p&gt;

&lt;p&gt;Git handles such situations much better than any of the old style VCSs. It
currently has 5 different merge strategies that you can use (don&#39;t worry -- you
don&#39;t have to think about them if you don&#39;t want to!) and it&#39;s designed so
that if some new strategy to handle merging is discovered, it can be added in
very easily.&lt;/p&gt;

&lt;p&gt;The end result is a tremendous boost to a team&#39;s productivity, as people
realise that a lot of the &lt;em&gt;manual&lt;/em&gt; co-ordination and sequencing that was
till now considered a necessity, is in fact not needed. Also, and this is not
obvious, parallelism is just as useful for a &lt;em&gt;single developer&lt;/em&gt; working on a
system: ask yourself if you&#39;ve ever postponed a small, quick, change because
you were in the middle of a much larger activity, or had to plan your work
carefully to avoid having two separate tasks interfere with each other.&lt;/p&gt;

&lt;p&gt;In real life, it&#39;s often impossible to cleanly finish one job before starting
another, yet most current VCSs force you to do exactly that, if you want to
retain your sanity. With git, on the other hand, you can even create a
separate branch for each issue you&#39;re handling (bugfix, enhancement,
whatever), and work on them almost simultaneously, switching from one to the
other as you wish, secure in the knowledge that when it&#39;s time to merge, git
will do the right thing.&lt;/p&gt;

&lt;p&gt;In addition, git has excellent GUI tools to visualise this sort of branching
easily. Figure 2, for example, is from the development tree of a project
called &lt;em&gt;cobbler.&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../images/gitlfy-fig2-branch-visual.gif&quot; alt=&quot;Figure 2&quot; title=&quot;Figure 2: Branch visualisation&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Merging is a very big priority for Linus Torvalds. He says, &quot;I merge 22,000
files several times a day, and I get unhappy if a merge takes more than 5
seconds&quot; (http://git.or.cz/gitwiki/LinusTalk200705Transcript).  During the
first 2 years of git, the Linux kernel has &quot;averaged
4.5 merges per day, every single day&quot; (same URL).&lt;/p&gt;

&lt;p&gt;The idea behind this is simple: making many small merges at regular intervals
(and resolving any conflicts if needed) is much easier than dealing with all
of them together -- you &lt;em&gt;have to&lt;/em&gt; divide and conquer.&lt;/p&gt;

&lt;p&gt;Another situation in which good branching and merging helps is, for instance,
when a relatively stable product needs to have more than one major &quot;feature&quot;
added or enhanced simultaneously.  With a less powerful VCS, the team will
either develop the features one by one in order to avoid merging problems, or
develop each in complete isolation and prepare for a some very difficult,
frustrating, manual merging as each feature reaches stability. (In systems
like these, especially in the corporate world, you have special people whose
job it is to integrate branches from different development streams!)&lt;/p&gt;

&lt;p&gt;The truth is, though, that most other VCSs consider reliable merging to be so
difficult that branching is hardly ever used in non-trivial situations. As a
result, lots of inherent parallelism that could have been exploited goes
unused.&lt;/p&gt;

&lt;p&gt;Even where merging is available, systems like SVN have quite a few problems
with how it is implemented. For a good description of these issues take a look
at &lt;a href=&quot;http://git.or.cz/gitwiki/GitSvnComparsion&quot;&gt;http://git.or.cz/gitwiki/GitSvnComparsion&lt;/a&gt;.  Although SVN is working on
these issues, I am convinced that once the productivity gains of a
&lt;em&gt;distributed&lt;/em&gt; VCS become well known, SVN will eventually fade. SVN&#39;s aims
have always been to fix the problems in CVS rather than do anything
revolutionary, but today, in 2008, merely fixing problems in a system designed
more than 15 years ago is too little, too late.&lt;/p&gt;

&lt;h3&gt;Rebasing instead of merging&lt;/h3&gt;

&lt;p&gt;Merging is very nice, but for long-lived branches, the frequent merges tend to
make the history look like Figure 3 (note: this is not a real project!). When
this branch is eventually merged into the mainline (like when it is deemed
stable enough), this &quot;stitching pattern&quot; remains.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;../images/gitlfy-fig3-stitching-pattern.gif&quot; alt=&quot;Figure 3&quot; title=&quot;Figure 3: Stitching pattern&quot; /&gt;&lt;/p&gt;

&lt;p&gt;For some projects it may be easier to make all the branch work look as if it
was done &lt;em&gt;on top of&lt;/em&gt; the current mainline commit. This is called
&lt;em&gt;rebasing&lt;/em&gt;.  While the branch is under development, instead of doing a
&lt;code&gt;git pull&lt;/code&gt; (this is somewhat like a &lt;code&gt;cvs update&lt;/code&gt;) from the mainline,
you&#39;d do a &lt;code&gt;git pull --rebase&lt;/code&gt; (there are other ways to do this; this is
just the simplest). Each time you do that, git re-applies all your commits on
top of the new tip of the mainline, and the history remains linear.  When your
branch is finally stable enough to be merged into the mainline, your changes
can be pushed as a &lt;em&gt;linear&lt;/em&gt; set of updates on top of the current tip, rather
than a parallel set of updates followed by a merge.&lt;/p&gt;

&lt;p&gt;The biggest advantage of rebasing instead of normal merging is when you try
and track down a bug using &lt;code&gt;git bisect&lt;/code&gt;, which we will discuss later.&lt;/p&gt;

&lt;h3&gt;Speed -- git&#39;s second big feature&lt;/h3&gt;

&lt;p&gt;The other explicit design goal was speed, which has been one of the pain
points of earlier VCSs. Centralised VCSs can take minutes to do a simple
&lt;em&gt;diff&lt;/em&gt;, or tens of minutes to create a branch. It is also quite frustrating
to have to schedule a code-freeze and set aside a day or two to do a merge. (I
believe this is quite normal in centralised VCSs, especially the more
mainframe-ish ones -- consider yourself lucky if you don&#39;t know which one I am
talking about!) With git, on the other hand, it&#39;s common to hear people say
that it&#39;s so fast they sometimes wonder if it did anything at all!&lt;/p&gt;

&lt;p&gt;It&#39;s not just local commands that are optimised. Even the protocol for
exchanging revisions is very efficient, and can quickly and easily figure out
what data needs to be sent, including compressing and sending deltas.&lt;/p&gt;

&lt;p&gt;While git is really good at digging through a repository breadth first
(meaning all files at this revision, then all files at the parent revision,
etc), it is not optimised for the case where you wish to view history in a
depth-first manner (meaning all revisions for one file first, then all
revisions for perhaps some other file).  The logic is that we&#39;re more likely
to want to examine the entire tree for the current and the previous few
revisions -- the further a revision is from our current one, the less
interesting it usually is for normal work.&lt;/p&gt;

&lt;h3&gt;Distributed and disconnected&lt;/h3&gt;

&lt;p&gt;The fact that git is a distributed VCS means that you have your own repository
on your machine. Coupled with the excellent branch/merge in git, this allows
you, for instance, to quickly create a branch for some experimental code that
may or may not work, test things out, and either discard or reuse the changes
later. With a centralised system, you are much more limited in what you can do
in these situations -- you usually resort to the classic &quot;tar/zip&quot; method of
saving and restoring your work.&lt;/p&gt;

&lt;p&gt;If you work offline a lot, it&#39;s a lot more useful to be able to commit each
change separately, and have these commits &lt;em&gt;kept&lt;/em&gt; separate, rather than be
forced to commit all your offline work as one huge commit when you reconnect.
Keeping commits to a fine granularity makes code reviews easier, but even more
important, finding the source of a bug becomes much easier, as we will see
later.&lt;/p&gt;

&lt;p&gt;The reason git is good at distributed operation is because, when you do a
&lt;code&gt;git clone&lt;/code&gt;, it brings down and caches the entire repository -- the full
history of all the branches is now available on your machine. Even Mercurial,
the next best among the new breed of VCSs, brings down only the current
branch.&lt;/p&gt;

&lt;p&gt;(This might lead you to worry that disk space is an issue. It is not -- git&#39;s
pack format is quite efficient, and many months of revisions often end up
taking little more than the space that a full checkout takes.)&lt;/p&gt;

&lt;p&gt;A good analysis of how much each VCS caches on a checkout, and its
implications, is at
http://blogs.gnome.org/newren/2007/11/24/local-caching-a-major-distinguishing-difference-between-vcses/&lt;/p&gt;

&lt;h3&gt;Cool features -- git bisect&lt;/h3&gt;

&lt;p&gt;Git has a command called &lt;code&gt;bisect&lt;/code&gt; (this is one of those &quot;aaaah, why didn&#39;t
I think of it?&quot; things!) that is very nice. The idea is this: say you find a
bug in version 1.6, which didn&#39;t exist in version 1.5. If the commit history
between these two revisions consisted of just a few large commits, you&#39;ll have
to go through all the changes in these commits manually to find the bug.  In
the git model, however, the commit history would have a few hundred small
commits.&lt;/p&gt;

&lt;p&gt;So you tell &lt;code&gt;git bisect&lt;/code&gt; that version 1.5 is &quot;good&quot;, and 1.6 is &quot;bad&quot;. Git
then finds a commit about half-way between them and checks it out for you. You
test it, and tell git whether this was &quot;good&quot; or &quot;bad&quot;, and git then finds you
another version to test based on your answer. Essentially, git is using binary
search to zero in on the &lt;em&gt;specific change&lt;/em&gt; that caused your bug, which is
only possible and useful if commits are small.&lt;/p&gt;

&lt;p&gt;The real power of &lt;code&gt;git bisect&lt;/code&gt; is that, if your testing can be automated
with a command that returns &quot;0&quot; for &quot;good&quot; and some non-zero value for &quot;bad&quot;,
then git will essentially do all this by itself! Who says finding the source
of a bug is a programmer&#39;s job? Let the machines take over!&lt;/p&gt;

&lt;h3&gt;Summary&lt;/h3&gt;

&lt;p&gt;I hope this has whetted your interest in git.  There&#39;s not enough space in
this article to go into all the other wonderful things about git, like git
stash (save &lt;em&gt;unfinished&lt;/em&gt; work to temporarily do something else), interactive
rebasing (reorder commits, combine two commits into one, split one commit into
many, etc.), cherry picking (pick and choose specific commits from some other
branch to apply to the current one), and so on.  I should also mention that
all routine functions can be done from the GUI tools available, although the
command lines are not very complex either.&lt;/p&gt;

&lt;p&gt;There are a lot of programmers who do not like their current version control
system, or regard it as a necessary evil, a burden that must be borne because
it&#39;s better than not having one at all.  Bitkeeper changed all that for Linus:
in his words, Bitkeeper was the system that taught him &quot;why there&#39;s a point to
them and how you actually do things&quot;
(http://en.wikipedia.org/wiki/Git_%28software%29).&lt;/p&gt;

&lt;p&gt;And for many people today, that privilege might well belong to git. I hope it
does, for you.&lt;/p&gt;

&lt;p&gt;[Endnote: much, though not all, of what I said about git here, applies to
&lt;em&gt;Mercurial&lt;/em&gt; also. Mercurial, aka &lt;em&gt;Hg&lt;/em&gt;, appears to be the closest thing to
git in terms of power and features, and was chosen by the Mozilla developers
over git only because git did not, at that time, have good enough Windows
support.  I have a couple of young friends at Synovel, a Hyderabad company
focused on open source collaboration solutions (they make &lt;em&gt;Spicebird&lt;/em&gt;), who
swear by Hg, and I anticipate many good-natured arguments with them about
git/Hg, sort of like vim/emacs or perl/python!  As long as they&#39;re all open
source, the more the merrier, I say...]&lt;/p&gt;

&lt;hr /&gt;

&lt;p&gt;&lt;sup&gt;This article first appeared in Linux For You, an Indian magazine for open
source enthusiasts, in July 2008.  It is released under the Creative Commons
Attribution Sharealike license.&lt;/sup&gt;&lt;/p&gt;
&lt;/html&gt;
</pre>
</div>
<div title="git-workflows" modifier="Sitaram" created="201110051936">
<pre>
&lt;html&gt;
&lt;h1&gt;&lt;a name=&quot;git_suggested_workflow_for_large_projects&quot;&gt;git -- suggested workflow for large projects&lt;/a&gt;&lt;/h1&gt;

&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#git_suggested_workflow_for_large_projects&quot;&gt;git -- suggested workflow for large projects&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#assumptions&quot;&gt;assumptions&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#roles&quot;&gt;roles&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#typical_workflow&quot;&gt;typical workflow&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#developer&quot;&gt;developer&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#feature_guy&quot;&gt;feature guy&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#release_manager&quot;&gt;release manager&lt;/a&gt;&lt;br&gt;&lt;/p&gt;

&lt;hr /&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;sup&gt;&lt;strong&gt;WARNING: I have not checked out all the commands -- there could be
    errors!  The first time you use it, please try them on a sandbox!&lt;/strong&gt;  Also,
    note that a lot of this can be done from the GUI also, if you wish.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;blockquote&gt;
  &lt;blockquote&gt;
  &lt;p&gt;&lt;strong&gt;&lt;em&gt;YOU HAVE BEEN WARNED&lt;/em&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;/blockquote&gt;&lt;/p&gt;

&lt;p&gt;&lt;/blockquote&gt;&lt;/p&gt;

&lt;p&gt;This is essentially a modification and simplification of the typical
    workflow that Linux and other projects using DVCSs use.&lt;/sup&gt;&lt;/p&gt;

&lt;p&gt;&lt;/blockquote&gt;&lt;/p&gt;

&lt;h3&gt;&lt;a name=&quot;assumptions&quot;&gt;assumptions&lt;/a&gt;&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;the team needs to manage multiple projects&lt;/li&gt;
&lt;li&gt;the team has one &quot;server&quot;, in the sense that it is &quot;on&quot; most of the time
(doesn&#39;t have to be big and powerful; can even be someone&#39;s desktop)&lt;/li&gt;
&lt;li&gt;each developer has a copy of git on his desktop, and knows some basic
commands or at least the GUI stuff&lt;/li&gt;
&lt;/ul&gt;

&lt;h3&gt;&lt;a name=&quot;roles&quot;&gt;roles&lt;/a&gt;&lt;/h3&gt;

&lt;p&gt;Every project has the following loosely defined roles.  If it&#39;s a small
project the same person may take on multiple roles.&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;1 release manager.  In $COMPANY terms, this is the PL&lt;/li&gt;
&lt;li&gt;1 quality guy (maybe the same as the release manager)&lt;/li&gt;
&lt;li&gt;(optional) M feature guys, one for each major &quot;feature&quot; in the project, if
any.  In $COMPANY terms, this is like the ML&lt;/li&gt;
&lt;li&gt;N developers&lt;/li&gt;
&lt;/ul&gt;

&lt;h3&gt;&lt;a name=&quot;typical_workflow&quot;&gt;typical workflow&lt;/a&gt;&lt;/h3&gt;

&lt;p&gt;Here&#39;s a typical workflow, assuming a starting point from the &quot;master&quot; branch
on the master server.  This assumes that the people on the project have ssh
(write) access to the repo -- it is not the &quot;please pull...&quot; mode that open
source projects use on the internet.&lt;/p&gt;

&lt;h4&gt;&lt;a name=&quot;developer&quot;&gt;developer&lt;/a&gt;&lt;/h4&gt;

&lt;p&gt;One-time:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;clone from master&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;git clone ssh://sita@master.server.com/path/to/repo.git
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;create your work branch and switch to it&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;git checkout -b sita-work master
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Regular:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;switch to your work branch; assumed for the rest of this section&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;git checkout sita-work
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;work work work/commit/test etc&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;...
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;keep up-to-date with changes on the server&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;git fetch origin

# destroys history but OK if you haven&#39;t published your commits yet
git rebase origin/master

# preserves history, but not always pretty; mandatory if you have
# published your changes somewhere already
git merge origin/master

# make sure you re-test all your changes after this operation, in case
# some upstream change has affected your code
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;keep sending your changes upstream&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;git push origin sita-work
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Irregular:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;emergency fix ordered for bug 123 on v2.3&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;git stash
git fetch origin v2.3
git checkout -b sita-v2.3-bug123 origin/v2.3
# work work work test commit test commit etc
git push origin sita-v2.3-bug123
# email release manager to pull/test the above branch and merge into
# master if OK
# go back to your work
git checkout sita-work
git stash pop --index
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;(wild idea strikes you; so wild you don&#39;t even want to risk putting it in
next)&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;git checkout -b wildidea sita-work
(work work work/commit/test etc)
git checkout sita-work

# is wildidea useful?
git merge wildidea  # should be a &quot;fast-forward&quot;

# useful or not, you can get rid of temp branch now
git branch -d wildidea
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h4&gt;&lt;a name=&quot;feature_guy&quot;&gt;feature guy&lt;/a&gt;&lt;/h4&gt;

&lt;p&gt;This will be a mix between the developers workflow and the release manager&#39;s
workflow.&lt;/p&gt;

&lt;h4&gt;&lt;a name=&quot;release_manager&quot;&gt;release manager&lt;/a&gt;&lt;/h4&gt;

&lt;p&gt;When doing your own development, you do the same thing as the developer
described above&lt;/p&gt;

&lt;p&gt;Regular:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;keep up-to-date with changes on the server (not needed if you are the only
release manager)&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;...same as for developer workflow above...
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;pull stuff from developers&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;git checkout next
git tag -f savenext
git fetch origin dev-work
git merge origin/dev-work
# test it
# test ok?
    git checkout master
    git merge origin/dev-work
    # test again just to make sure
# test not ok?
    # discard changes
    git reset --hard savenext
    # send dev a problem report and ask him to resubmit
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;make sure next &gt; master &gt; maint is preserved&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;git checkout master
git merge vX.Y      # for each vX.Y that has seen any recent activity
# test...

git checkout next
git merge master
# test...
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;submit code to the master server&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;git checkout master
# test
# test ok?  tag it
git tag ready-`date -I`     # or something appropriate
git push origin ready-`date -I`&quot;
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;make a release&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;git checkout master
# test again?
git tag v3.7
git push origin v3.7
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/html&gt;
</pre>
</div>
<div title="eg" modifier="Sitaram" created="200906302348">
<pre>
&lt;html&gt;
&lt;h1&gt;&lt;a name=&quot;notes_on_eg_Elijah_Newren_s_easy_git_&quot;&gt;notes on &quot;eg&quot; (Elijah Newren&#39;s &quot;easy git&quot;)&lt;/a&gt;&lt;/h1&gt;

&lt;p&gt;&lt;sup&gt;&lt;a href=&quot;http://www.gnome.org/~newren/eg/&quot;&gt;eg&lt;/a&gt; is a single file wrapper for &lt;code&gt;git&lt;/code&gt;
that provides much more user-friendly options and more sensible defaults for
many commands.  It&#39;s a great tool, the documentation is top class, the focus
on consistency and layering etc., is very nice, and clearly a lot of TLC has
gone into making it.&lt;/p&gt;

&lt;p&gt;I&#39;m not sure I like the whole package, but the nice thing is that eg co-exists
quite happily with normal git, so you can mix and match -- use only those eg
commands that you like, and ignore the others.&lt;/p&gt;

&lt;p&gt;In this note, I explain some of the eg commands, and their advantages (or
lack) compared to plain git.  This is essentially my personal notes on &quot;eg&quot;,
describing what I like, what I don&#39;t, etc., focusing mainly on commands where
the behaviour is &lt;em&gt;significantly&lt;/em&gt; different from plain git.&lt;/sup&gt;&lt;/p&gt;

&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#notes_on_eg_Elijah_Newren_s_easy_git_&quot;&gt;notes on &quot;eg&quot; (Elijah Newren&#39;s &quot;easy git&quot;)&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#really_useful_commands&quot;&gt;really useful commands&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#_eg_revert_and_eg_cherry_pick_&quot;&gt;&lt;code&gt;eg revert&lt;/code&gt; and &lt;code&gt;eg cherry-pick&lt;/code&gt;&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#other_commands&quot;&gt;other commands&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#not_so_useful_commands&quot;&gt;not (so) useful commands&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#_eg_diff_&quot;&gt;&lt;code&gt;eg diff&lt;/code&gt;&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#other_commands&quot;&gt;other commands&lt;/a&gt;&lt;br&gt;&lt;/p&gt;

&lt;h3&gt;&lt;a name=&quot;really_useful_commands&quot;&gt;really useful commands&lt;/a&gt;&lt;/h3&gt;

&lt;h4&gt;&lt;a name=&quot;_eg_revert_and_eg_cherry_pick_&quot;&gt;&lt;code&gt;eg revert&lt;/code&gt; and &lt;code&gt;eg cherry-pick&lt;/code&gt;&lt;/a&gt;&lt;/h4&gt;

&lt;p&gt;&lt;code&gt;eg revert&lt;/code&gt; eliminates a lot of the confusion between plain git&#39;s various
ways of getting at old content.  This command&#39;s help text has the longest
description of the differences from plain git.  At the same time, git&#39;s own
&quot;revert&quot; command is done in eg by &lt;code&gt;eg cherry-pick -R&lt;/code&gt;, which actually
makes a lot of sense.&lt;/p&gt;

&lt;p&gt;The most important feature that &quot;eg revert&quot; provides is &lt;code&gt;eg revert --in REV
FILE&lt;/code&gt;.  This reverts the change to FILE made in revision REV.  It&#39;s a
partial revert of an earlier commit.  This does not actually have a single
command equivalent in plain git, and it is done by piping a suitable &lt;code&gt;git
diff&lt;/code&gt; to &lt;code&gt;git apply -R&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;The second variation is &lt;code&gt;eg revert --since REV FILE&lt;/code&gt;, which reverts FILE
to the content it had in revision REV.  This is plain git&#39;s checkout paths
mode.&lt;/p&gt;

&lt;h4&gt;&lt;a name=&quot;other_commands&quot;&gt;other commands&lt;/a&gt;&lt;/h4&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;eg info&lt;/code&gt; is pretty cool :-)&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;eg publish&lt;/code&gt; is neat too; as the man page says, normal git makes it
quite annoying (I wish you could clone from an empty repo -- that by
itself would make things a lot easier)&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;eg bundle create&lt;/code&gt; adds &lt;code&gt;--all HEAD&lt;/code&gt; to the normal command.  eg
also provides &lt;code&gt;eg bundle create-update new.bdl old.bdl&lt;/code&gt; which is
functionally the same as&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;git bundle create new.bdl --all HEAD --not \
    $(git ls-remote old.bdl | cut -f1)
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h3&gt;&lt;a name=&quot;not_so_useful_commands&quot;&gt;not (so) useful commands&lt;/a&gt;&lt;/h3&gt;

&lt;h4&gt;&lt;a name=&quot;_eg_diff_&quot;&gt;&lt;code&gt;eg diff&lt;/code&gt;&lt;/a&gt;&lt;/h4&gt;

&lt;p&gt;&lt;code&gt;eg diff&lt;/code&gt; shows changes against HEAD, not the index.  I prefer the normal
git behaviour, for reasons cited in
&lt;a href=&quot;../concepts/uses-of-index.html&quot;&gt;uses of index&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;code&gt;eg diff&lt;/code&gt;&#39;s second change from normal git (see
&lt;a href=&quot;http://www.gnome.org/~newren/eg/documentation/diff.html&quot;&gt;http://www.gnome.org/~newren/eg/documentation/diff.html&lt;/a&gt;) seems logical on the
face of it, but I&#39;m not buying.  &lt;code&gt;diff&lt;/code&gt; and &lt;code&gt;log&lt;/code&gt; are inherently
different commands with different purposes and outputs, and it&#39;s meaningless
to try and synchronise their syntax.&lt;/p&gt;

&lt;p&gt;To start with, these points are fundamental:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;the older revision is (normally) specified on the left side (LHS)&lt;/li&gt;
&lt;li&gt;&quot;diff&quot; only works on two &lt;em&gt;endpoint&lt;/em&gt; commits, regardless of how many
commits exist in between those endpoints&lt;/li&gt;
&lt;li&gt;however, &quot;log&quot; works on all the in between commits also&lt;/li&gt;
&lt;li&gt;normal, everyday, usage is &lt;code&gt;git diff A..B&lt;/code&gt;, meaning &quot;changes from A to
B&quot;, and &lt;code&gt;git log A..B&lt;/code&gt;, meaning &quot;commits in B but not in A&quot;.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;To those simple rules, add just one more (easy enough to remember): the
&quot;&lt;code&gt;...&lt;/code&gt;&quot; operator always involves the common ancestor somehow.&lt;/p&gt;

&lt;p&gt;With those rules in mind, you can keep track of what the double-dot and
triple-dot mean very easily.&lt;/p&gt;

&lt;p&gt;Consider &lt;code&gt;git diff A...B&lt;/code&gt;:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;since the &quot;&lt;code&gt;...&lt;/code&gt;&quot; is used, the common ancestor is involved&lt;/li&gt;
&lt;li&gt;since diff can only deal with 2 end points, one of A or B has to make way
for the common ancestor&lt;/li&gt;
&lt;li&gt;since the common ancestor is older than A and B, clearly it has to appear
on the left side, so A loses :-)&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;And this becomes &lt;code&gt;git diff CA(A,B)..B&lt;/code&gt;, where CA(A,B) is the common
ancestor of A and B.  Easy enough?&lt;/p&gt;

&lt;p&gt;Now look at &lt;code&gt;git log A...B&lt;/code&gt;&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;again, the &quot;&lt;code&gt;...&lt;/code&gt;&quot; is used, so the common ancestor is involved&lt;/li&gt;
&lt;li&gt;since log is not constrained to only 2 endpoints like diff is, you don&#39;t
have to discard A or B&lt;/li&gt;
&lt;li&gt;so you show the commits between the common ancestor and A, &lt;em&gt;as well as&lt;/em&gt;
between the common ancestor and B&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;So: &lt;code&gt;git log CA(A,B)..A&lt;/code&gt; PLUS &lt;code&gt;git log CA(A,B)..B&lt;/code&gt;&lt;/p&gt;

&lt;h4&gt;&lt;a name=&quot;other_commands&quot;&gt;other commands&lt;/a&gt;&lt;/h4&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;eg log&lt;/code&gt; doesn&#39;t seem to add much value compared to &lt;code&gt;--decorate&lt;/code&gt;,
plus it eats up the colors&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;eg commit&lt;/code&gt; attempts to simplify the many combinations you can have
(untracked, tracked+changed, tracked+changed+staged, etc) but I don&#39;t
think it succeeds very well (this is a subjective opinion, not fact!).
But really, if the command line options to stage and unstage confuse you,
just use &lt;code&gt;git gui&lt;/code&gt;, where the icons and the two panes on the left tell
you all you want to know.  Couldn&#39;t be simpler than that.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/html&gt;
</pre>
</div>
<div title="server-sizing" modifier="Sitaram" created="200907190723">
<pre>
&lt;html&gt;
&lt;h1&gt;&lt;a name=&quot;sizing_a_server_for_git&quot;&gt;sizing a server for git&lt;/a&gt;&lt;/h1&gt;

&lt;p&gt;&lt;sup&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#sizing_a_server_for_git&quot;&gt;sizing a server for git&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#bandwidth_usage_&quot;&gt;bandwidth usage:&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#CPU_usage&quot;&gt;CPU usage&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#memory&quot;&gt;memory&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#disk&quot;&gt;disk&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#repack&quot;&gt;stressing out a git server&lt;/a&gt;&lt;br&gt;
&lt;/sup&gt;&lt;/p&gt;

&lt;hr /&gt;

&lt;p&gt;How big a server do you need to host git repos?  These are my current thoughts
on this, and they&#39;re essentially what I sent in an internal email to someone
at work who asked about that as well as network bandwidth concerns when the
server is used from multiple sites over a WAN.&lt;/p&gt;

&lt;p&gt;Note: the specific question also asked how many &quot;concurrent&quot; users a git
server with a given spec could handle.  However, a typical developer will only
interact with the git server on average 2-6 times a day, with each interaction
lasting at most for a few seconds.  That&#39;s it!&lt;/p&gt;

&lt;p&gt;This is why &quot;concurrent users&quot; is not a meaningful measure, unless everyone
hits &quot;push&quot; or &quot;pull&quot; at exactly the same time  :-) &lt;/p&gt;

&lt;p&gt;Anyway, here are some details, from the point of view of a typical
&quot;enterprise&quot; use of a VCS.  Be sure to read the last section on the &lt;a href=&quot;#repack&quot;&gt;one
operation&lt;/a&gt; that &lt;em&gt;can&lt;/em&gt; stress out a git server.&lt;/p&gt;

&lt;h3&gt;&lt;a name=&quot;bandwidth_usage_&quot;&gt;bandwidth usage:&lt;/a&gt;&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;the initial clone (like when a new team member joins the project)
transfers data about the size of the repository.  This is highly
compressed but it could still be large.&lt;/p&gt;

&lt;p&gt;Just as a point of reference, I pulled down the entire Linux kernel
repository just now.  It was 310 MB and took about 20 minutes to come in
on my home DSL line here.&lt;/p&gt;

&lt;p&gt;Please note this is about 4 years and 3 months worth of changes on a
project with hundreds of active developers; you have to ask yourself if
your project is really that large.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;after the initial clone, regular updates (git pull/fetch) take very little
time.&lt;/p&gt;

&lt;p&gt;Again, to give you a point of reference, I had an older copy of the linux
kernel tree that was last updated 6 days ago.  I just pulled down those 6
days worth of changes, and the actual data trasferred was about 400 KB
(yes, &lt;strong&gt;kilo&lt;/strong&gt; bytes, for 6 days of changes in a very active project)&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;if you&#39;re worried that the initial clone will be a killer when an entire
remote site (with, say, 50 people) joins the repository, don&#39;t worry.  Git
has ways to get around that also, if you are worried about it.&lt;/p&gt;

&lt;p&gt;There&#39;s a command called &quot;git bundle&quot; which lets you package up the entire
repository into one file, which you can transfer one time to the other
site.  At the other site, they share that bundle file on their LAN
(instead of each person essentially getting the same file on the WAN), and
clone from it.  After the clone is done, you make a one-line change to the
config file (change the URL to point to the real server instead of a local
file!) and it&#39;s done.&lt;/p&gt;

&lt;p&gt;What all this means is, for the cost of one extra command on the server
and one extra command on each client, you have &quot;seeded&quot; an entire site
with just one download  :-) &lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h3&gt;&lt;a name=&quot;CPU_usage&quot;&gt;CPU usage&lt;/a&gt;&lt;/h3&gt;

&lt;p&gt;Git does take some CPU time to pack up a repository, especially to supply an
initial clone.  Even in the initial clone, on a decent dual-core machine it
will be as fast as the hard disk can read the repository data, which means
pretty fast.  On subsequent pull/push operations, it is very fast.&lt;/p&gt;

&lt;p&gt;The CPU-bound operations in day to day git operations are&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;compressing each file (aka &quot;blob&quot;) using zlib&lt;/li&gt;
&lt;li&gt;computing deltas (differences) between objects to optimise sending data
when someone clones or pulls&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Zlib is quite efficiently coded, and besides, is so widely used in so many
other parts of a modern operating system, that it is not much of an issue.&lt;/p&gt;

&lt;p&gt;Computing deltas is definitely more CPU hungry (as well as memory hungry), but
-- except on the initial clone -- it happens incrementally so any
decent/recent dual-core CPU should be able to handle it very fast.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;hr /&gt;

&lt;p&gt;&lt;sup&gt;Further details on this, courtesy charon on #git:&lt;/p&gt;

&lt;p&gt;Even when computing deltas to send, git reuses packs.  This means that
    objects that are already packed are not delta compressed again --
    send-pack just uses the existing delta-compressed form.  Anyway it doesn&#39;t
    really send the &lt;em&gt;entire&lt;/em&gt; pack, only the parts that are relevant, so this
    works fine.&lt;/p&gt;

&lt;p&gt;As a result, cpu usage on the server is now mostly in the &quot;counting
    objects&quot; phase (i.e., figuring out what to send), which is not much of a
    load.&lt;/sup&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h3&gt;&lt;a name=&quot;memory&quot;&gt;memory&lt;/a&gt;&lt;/h3&gt;

&lt;p&gt;A machine with about 512 MB &lt;strong&gt;&lt;em&gt;free&lt;/em&gt;&lt;/strong&gt; RAM will probably work fine for most
development style repositories.  In practice this means about 1 GB total RAM,
assuming no other big programs are running.  Note that all this is transient
use -- there is no &quot;long running background process&quot; in a normal git install
that sits around hogging memory.  If no one is accessing the repository
(push/pull/clone), then no memory is used.&lt;/p&gt;

&lt;p&gt;The only time you get into memory problems under normal use is if you have
files that are really large, like more than 50 MB or so.  (We&#39;re not talking
about total repo size here; we&#39;re talking one individual file).  If you have
any such files in the repo (or worse, many such files), it may be a good idea
to run some benchmarks first.  [I&#39;m being very conservative here; in practice
I&#39;m sure much larger files can be used without trouble but at some point it
will cause problems.  That may be 100MB, or 250MB, or whatever but it will
happen...]&lt;/p&gt;

&lt;p&gt;Otherwise there&#39;s nothing inherently in git to gobble up memory except the
&lt;a href=&quot;#repack&quot;&gt;repack&lt;/a&gt; operation mentioned in the last section.&lt;/p&gt;

&lt;h3&gt;&lt;a name=&quot;disk&quot;&gt;disk&lt;/a&gt;&lt;/h3&gt;

&lt;p&gt;As I mentioned in one of my presentations, git takes about 1/20th the size of
an SVN repository, so this should not be a concern.  However, this does assume
the &quot;repack&quot; operation referred to below is being run at least once a month or
so.&lt;/p&gt;

&lt;h3&gt;&lt;a name=&quot;repack&quot;&gt;stressing out a git server&lt;/a&gt;&lt;/h3&gt;

&lt;p&gt;The only time git does anything that seriously stresses the machine (in &lt;strong&gt;&lt;em&gt;all
respects&lt;/em&gt;&lt;/strong&gt;, not just CPU) is a &quot;repack&quot; operation that (by default) runs very
rarely.  You can, if you wish, set a config variable to make it never happen
automatically, and just do it manually about once a month, or by cron at 4am
on Sunday, or whatever suits you.&lt;/p&gt;

&lt;p&gt;I tried a full repack of the linux kernel tree on my desktop, and it took
approximately 700 MB of RAM, 5:20 minutes elapsed time, and 7:04 minutes of
CPU time (CPU time is more than elapsed time because parts of this repacking
are multi-threaded).&lt;/p&gt;

&lt;p&gt;So -- if you schedule it at night or Sunday morning or whatever, you&#39;ll be
fine.  Don&#39;t worry about it...&lt;/p&gt;
&lt;/html&gt;
</pre>
</div>
<div title="cvs2git" modifier="Sitaram" created="201110051936">
<pre>
&lt;html&gt;
&lt;h1&gt;&lt;a name=&quot;converting_CVS_to_git&quot;&gt;converting CVS to git&lt;/a&gt;&lt;/h1&gt;

&lt;p&gt;&lt;sup&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#converting_CVS_to_git&quot;&gt;converting CVS to git&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#step_1_make_a_dump_file&quot;&gt;step 1 -- make a dump file&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#step_2_import_into_git&quot;&gt;step 2 -- import into git&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#patch&quot;&gt;Appendix&lt;/a&gt;&lt;br&gt;
&lt;/sup&gt;&lt;/p&gt;

&lt;hr /&gt;

&lt;p&gt;Update 2009-10-08: It has been pointed out that cvsimport, which I recommend
against using below, can do incremental imports.  If this is important to you
(it wasn&#39;t, to me, and it never will be), then this document is probably no
use to you.  Sorry...&lt;/p&gt;

&lt;hr /&gt;

&lt;p&gt;First: do &lt;strong&gt;NOT&lt;/strong&gt; use the builtin &lt;code&gt;git cvsimport&lt;/code&gt; unless your repository is
very simple and linear.  Problems I had using it on a moderately complex repo
include missing tags, branches grafted to the wrong place (by comparing with a
&lt;code&gt;--simplify-by-decoration&lt;/code&gt; tree later), missing commits (which is what
originally made me start investigating), and even missing files in the root of
the repo!!&lt;/p&gt;

&lt;p&gt;It&#39;s been too long since I last used CVS to figure this out, and cvs2svn
seemed to deal with a lot more nuances, so I used that instead.&lt;/p&gt;

&lt;h3&gt;&lt;a name=&quot;step_1_make_a_dump_file&quot;&gt;step 1 -- make a dump file&lt;/a&gt;&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;download cvs2svn version 2.1 or higher from somewhere within
&lt;a href=&quot;http://cvs2svn.tigris.org/cvs2git.html&quot;&gt;http://cvs2svn.tigris.org/cvs2git.html&lt;/a&gt;. DO NOT BE DISTRACTED BY THE
MISLEADING REFERENCES TO A MYTHICAL &lt;code&gt;cvs2git&lt;/code&gt; COMMAND IN THAT PAGE :)  As
of the time I tried this, it didn&#39;t exist.  Maybe now it does...&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;expand it somewhere, and cd there&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;in there, create an options file from the original, like shown in the
&lt;a href=&quot;#patch&quot;&gt;patch&lt;/a&gt; at the end of this file (change accordingly of course;
this diff only shows where you should make the changes, not what)&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;IMPORTANT WARNING&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;DO NOT USE the &lt;code&gt;test-data/main-cvsrepos/cvs2svn-git.options&lt;/code&gt; file as a
starting point.  Though the intermediate files were about 3X smaller when
I used it, there were lots of inaccuracies w.r.t the $id type stuff, and
for some older tags whole files were missing, compared to the
corresponding CVS checkout.  The &lt;code&gt;-inline&lt;/code&gt; version seems to work fine; no
errors on any of the 30 or so tags I checked on a project that had about 5
years of work in CVS.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;run&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;./cvs2svn --options=my.c2soptions
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;when it completes, check the &lt;code&gt;cvs2svn-tmp&lt;/code&gt; directory for a rather large
file called git-dump.dat&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h3&gt;&lt;a name=&quot;step_2_import_into_git&quot;&gt;step 2 -- import into git&lt;/a&gt;&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;make an empty directory, cd to it, git init, then run&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;cat ~-/cvs2svn-tmp/git-dump.dat | git fast-import
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;if you used the non-inline options file, or wanted to test that as well,
there would be &lt;em&gt;two&lt;/em&gt; files in the cvs2svn-tmp directory, and the command
would now be:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;cat ~-/cvs2svn-tmp/git-{blob,dump}.dat | git fast-import
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h3&gt;&lt;a name=&quot;patch&quot;&gt;Appendix&lt;/a&gt;&lt;/h3&gt;

&lt;p&gt;These are the changes I made to the options file:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;diff --git 1/test-data/main-cvsrepos/cvs2svn-git-inline.options 2/my.c2soptions.inline
index 635f9cd..a5a4018 100644
--- 1/test-data/main-cvsrepos/cvs2svn-git-inline.options
+++ 2/my.c2soptions.inline
@@ -39,7 +39,7 @@ ctx.cross_branch_commits = False
 # record the original author (for example, the creation of a branch).
 # This should be a simple (unix-style) username, but it can be
 # translated into a git-style name by the author_transforms map.
-ctx.username = &#39;cvs2svn&#39;
+ctx.username = &#39;someone&#39;

 # CVS uses unix login names as author names whereas git requires
 # author names to be of the form &quot;foo &amp;lt;bar&amp;gt;&quot;.  The default is to set
@@ -59,7 +59,7 @@ author_transforms={

     # This one will be used for commits for which CVS doesn&#39;t record
     # the original author, as explained above.
-    &#39;cvs2svn&#39; : (&#39;cvs2svn&#39;, &#39;admin@example.com&#39;),
+    &#39;someone&#39; : (&#39;someone&#39;, &#39;someone@my.company.com&#39;),
     }

 # This is the main option that causes cvs2svn to output to git rather
@@ -115,7 +115,7 @@ run_options.add_project(
     # The path to the part of the CVS repository (*not* a CVS working
     # copy) that should be converted.  This may be a subdirectory
     # (i.e., a module) within a larger CVS repository.
-    r&#39;test-data/main-cvsrepos&#39;,
+    r&#39;../cvsroot/myproj&#39;,

     # See cvs2svn-example.options for more documention about symbol
     # transforms that can be set using this option.
&lt;/code&gt;&lt;/pre&gt;
&lt;/html&gt;
</pre>
</div>
<div title="repo-sec" modifier="Sitaram" created="201110051936">
<pre>
&lt;html&gt;
&lt;h1&gt;repository security&lt;/h1&gt;

&lt;p&gt;&lt;sup&gt;Someone asked me how they could control read/write access to portions of the
repository (this is in a corporate setting, needless to say).  This is my take
on this.&lt;/sup&gt;&lt;/p&gt;

&lt;hr /&gt;

&lt;p&gt;&lt;strong&gt;&lt;em&gt;update 2009-09-02&lt;/em&gt;&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;The old version of this document basically said that, while by default a
repository is either full access, or no access, it&#39;s possible to implement
restrictions by writing special hooks etc., and tried to describe how to do
that.&lt;/p&gt;

&lt;p&gt;All that has now been superceded.  There is now a very nice, scalable,
managable, solution to this problem.&lt;/p&gt;

&lt;p&gt;Just &lt;a href=&quot;../0-installing/9-gitolite-basics.html&quot;&gt;read about&lt;/a&gt; and
&lt;a href=&quot;http://github.com/sitaramc/gitolite&quot;&gt;install&lt;/a&gt; gitolite.  It gives you:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;per-branch permissions&lt;/li&gt;
&lt;li&gt;logging of all accesses and pushes, including &quot;who&quot; and &quot;when&quot;
&lt;ul&gt;
&lt;li&gt;logging includes the &quot;before&quot; SHA&lt;/li&gt;
&lt;li&gt;very useful for force pushes (non-fast forward pushes), where the
&quot;before&quot; SHA is very likely to become unreachable after the operation
completes&lt;/li&gt;
&lt;li&gt;force pushes marked specially in the log for easy identification&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;personal branches for devs to store stuff&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;For a corporate environment (who else would be asking about branch-level
restrictions?) this is vastly better than the old standby, gitosis.&lt;/p&gt;

&lt;hr /&gt;

&lt;p&gt;As a result, I deleted the old version of this document.  Almost :-)&lt;/p&gt;

&lt;p&gt;The following two, somewhat unrelated, paras still seem useful.  I&#39;m leaving
them in, at the cost of some coherency, until I find a better place to move
them:&lt;/p&gt;

&lt;hr /&gt;

&lt;p&gt;&lt;strong&gt;Terminology&lt;/strong&gt;:   Before we dig into the main topic, I want to get some
terminology clear.  I&#39;ve noticed that sometimes people used to certain VCSs
use the word &quot;repository&quot; to mean something more than one project, like
perhaps the entire &quot;server&quot;.  A &quot;repository&quot; in git is the source code and
history for &lt;strong&gt;one&lt;/strong&gt; &quot;project&quot;.&lt;/p&gt;

&lt;hr /&gt;

&lt;p&gt;&lt;strong&gt;Side bar&lt;/strong&gt;: from a configuration management perspective, the SHA that git
uses is a &lt;strong&gt;powerful&lt;/strong&gt; way of ensuring that the code is &lt;strong&gt;precisely&lt;/strong&gt; what one
has signed off on.  This goes well beyond all current ways of recording a
baseline known to ISO9000/CMM5 type quality regimes.  Just record the first
10-12 digits of the SHA in the CR (Configuration Register)!  Anyone can
checkout that particular commit from the repository to get exactly the same
code; every single byte in every single file will be identical.  No need to
mess around with checking versions of individual components, dates, time
stamps, and what not.&lt;/p&gt;
&lt;/html&gt;
</pre>
</div>
<div title="git-server" modifier="Sitaram" created="201110131454">
<pre>
&lt;html&gt;
&lt;h1&gt;&lt;a name=&quot;setting_up_your_own_git_server&quot;&gt;setting up your own git server&lt;/a&gt;&lt;/h1&gt;

&lt;p&gt;&lt;code&gt;git&lt;/code&gt; is a &lt;em&gt;distributed&lt;/em&gt; version control system (DVCS), and every developer
thus has his/her own repository.  A central server is therefore not a
technical requirement, but more of a practical and/or administrative one, if
at least as a place for the &quot;official&quot; version of your repo.&lt;/p&gt;

&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#setting_up_your_own_git_server&quot;&gt;setting up your own git server&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#_sidebar_a_couple_of_definitions_&quot;&gt;(sidebar: a couple of definitions)&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#protocols_that_git_uses&quot;&gt;protocols that git uses&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#ssh_setup_for_&quot;&gt;ssh setup for...&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#_just_yourself&quot;&gt;...just yourself&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#_just_yourself_and_a_few_others_with_total_trust_&quot;&gt;...just yourself and a few others, with &quot;total trust&quot;&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#_any_number_of_people_but_without_total_trust_&quot;&gt;...any number of people but without &quot;total trust&quot;&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#gitolite_and_others_tools_for_authorisation&quot;&gt;gitolite and others tools for authorisation&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#side_note_setting_limits_on_yourself&quot;&gt;side note: setting limits on yourself&lt;/a&gt;&lt;br&gt;
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;a href=&quot;#appendix_A_compiling_tips&quot;&gt;appendix A: compiling tips&lt;/a&gt;&lt;br&gt;&lt;/p&gt;

&lt;hr /&gt;

&lt;p&gt;&lt;a name=&quot;_sidebar_a_couple_of_definitions_&quot;&gt;&lt;/a&gt;&lt;/p&gt;

&lt;h3&gt;&lt;a name=&quot;_sidebar_a_couple_of_definitions_&quot;&gt;(sidebar: a couple of definitions)&lt;/a&gt;&lt;/h3&gt;

&lt;p&gt;In order for some of the following to make sense, we need to define the words
&quot;authentication&quot; and &quot;authorisation&quot;.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;strong&gt;Authentication&lt;/strong&gt; is the process of verifying that you are who you claim
  to be.  An authentication system will establish that I am the user
  &quot;sitaram&quot; on my work system.  The one behind gmail will similarly
  establish that I am &quot;sitaramc&quot;.  And so on...&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Authorisation&lt;/strong&gt; is the process of asking what you want to do and
  deciding if you&#39;re allowed to do it or not.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;a name=&quot;_protocols_that_git_uses&quot;&gt;&lt;/a&gt;&lt;/p&gt;

&lt;h3&gt;&lt;a name=&quot;protocols_that_git_uses&quot;&gt;protocols that git uses&lt;/a&gt;&lt;/h3&gt;

&lt;p&gt;&lt;font color=&quot;gray&quot;&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Sidenote on URLs and &quot;remotes&quot;&lt;/strong&gt;: regardless of what protocol a server uses,
the client-side git commands work pretty much the same, once a &quot;remote&quot; has
been defined with the appropriate URL.&lt;/p&gt;

&lt;p&gt;For most common usage patterns, you only need the URL in the &lt;code&gt;git clone&lt;/code&gt;
command, which automatically sets up a &quot;remote&quot; called &lt;code&gt;origin&lt;/code&gt; that points to
the URL you just used.&lt;/p&gt;

&lt;p&gt;Sometimes you will need to manually add a new remote using &lt;code&gt;git remote&lt;/code&gt; if you
have another server to deal with.  See &lt;code&gt;man git-remote&lt;/code&gt; for details.&lt;/p&gt;

&lt;p&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p&gt;Git uses the following protocols to access remote repositories; example URLs
are given in parentheses:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;strong&gt;ssh&lt;/strong&gt; (&lt;code&gt;ssh://user@my.server/path/to/repo&lt;/code&gt;).  Authentication is handled
by ssh.  See the section on &quot;gitolite and other tools&quot; for authorisation.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;strong&gt;http/https&lt;/strong&gt;: (&lt;code&gt;http://my.server/path/to/repo&lt;/code&gt;).  Authentication is
handled by the web server.  Authorisation &lt;em&gt;can&lt;/em&gt; be handled by gitolite if
you&#39;re using &quot;smart http&quot; (see &#39;man git-http-backend&#39;).&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;strong&gt;local file system&lt;/strong&gt;: (&lt;code&gt;file:///path/to/repo&lt;/code&gt;).  Authentication is not
relevant (you&#39;re already logged in).&lt;/p&gt;

&lt;p&gt;Authorisation is handled by OS file-system permissions, but there&#39;s a
little twist.  Using OS permissions, or even filesystem ACLs, you can only
get repo-level granularity for reads and writes (i.e., you can say Alice
can read the repo, Bob can read and write, and Carol cannot do either, but
that;s it).&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;strong&gt;git&lt;/strong&gt;: (&lt;code&gt;git://my.server/path/to/repo&lt;/code&gt;).  This is an &lt;em&gt;UNAUTHENTICATED&lt;/em&gt;
protocol, useful only for allowing clones of publicly accessible repos.
If they can reach port 9418 on your server, they can get it.  Pushes are
disabled by default, and -- needless to say -- you must &lt;em&gt;NEVER&lt;/em&gt; enable
them!&lt;/p&gt;

&lt;p&gt;This protocol is handled by the special &#39;git-daemon&#39; program, which you
can run either directly or via inetd/xinetd.  Please see its man page etc
for details.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;This document will concentrate on ssh access.  I&#39;m not too familiar with http,
even though gitolite supports &quot;smart http&quot;.  The other 2 modes have been dealt
with and/or are pretty simple.&lt;/p&gt;

&lt;p&gt;&lt;a name=&quot;_ssh_setup_for_&quot;&gt;&lt;/a&gt;&lt;/p&gt;

&lt;h3&gt;&lt;a name=&quot;ssh_setup_for_&quot;&gt;ssh setup for...&lt;/a&gt;&lt;/h3&gt;

&lt;p&gt;&lt;a name=&quot;_just_yourself&quot;&gt;&lt;/a&gt;&lt;/p&gt;

&lt;h4&gt;&lt;a name=&quot;_just_yourself&quot;&gt;...just yourself&lt;/a&gt;&lt;/h4&gt;

&lt;p&gt;When you have a setup just for yourself, things are quite simple.  You setup a
bare repo on the server, add a remote to the repo on your workstation (or
clone &lt;em&gt;from&lt;/em&gt; the server).  So first you do:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;# on your userid on the server
git init --bare reponame
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Then, if you don&#39;t already have an existing repo on your workstation, you do:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;# on your workstation
git clone yourname@server:path/to/reponame
cd reponame
# start work
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;or, if you have a local repo on which you already did some work:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;# on your workstation
cd reponame
git remote add origin yourname@server:path/to/reponame
# start work
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Authentication is either by password or public key; it doesn&#39;t matter.
Authorisation is not done; you get access to everything.&lt;/p&gt;

&lt;p&gt;&lt;a name=&quot;_just_yourself_and_some_other_with_total_trust_&quot;&gt;&lt;/a&gt;&lt;/p&gt;

&lt;h4&gt;&lt;a name=&quot;_just_yourself_and_a_few_others_with_total_trust_&quot;&gt;...just yourself and a few others, with &quot;total trust&quot;&lt;/a&gt;&lt;/h4&gt;

&lt;p&gt;(total trust means anyone can do anything to any repo and you trust all of
them to do the right thing and not do the wrong thing).&lt;/p&gt;

&lt;p&gt;Now you will need to create a common userid on the server (unless you&#39;re
willing to give them all access to &lt;em&gt;your&lt;/em&gt; userid on the server).&lt;/p&gt;

&lt;p&gt;Let&#39;s say this common id is &quot;git&quot;.  Everyone should know the password, or you
can collect their public keys and add all of them to &lt;code&gt;~/.ssh/authorized_keys&lt;/code&gt;
on the server to have some means of adding and removing users without changing
passwords and communicating the new one to everyone.&lt;/p&gt;

&lt;p&gt;The git commands are the same as in the previous section.&lt;/p&gt;

&lt;p&gt;Note the phrase &quot;total trust&quot; -- you will not know who pushed what if you do
this, but for small, close-knit, teams it does not matter.&lt;/p&gt;

&lt;p&gt;&lt;a name=&quot;_any_number_of_people_but_without_total_trust_&quot;&gt;&lt;/a&gt;&lt;/p&gt;

&lt;h4&gt;&lt;a name=&quot;_any_number_of_people_but_without_total_trust_&quot;&gt;...any number of people but without &quot;total trust&quot;&lt;/a&gt;&lt;/h4&gt;

&lt;p&gt;With any other situation, it&#39;s best if you just install gitolite or something
similar.  You need authorisation; just authentication will not do any more.&lt;/p&gt;

&lt;p&gt;&lt;a name=&quot;_authorisation_gitolite_and_others&quot;&gt;&lt;/a&gt;&lt;/p&gt;

&lt;h3&gt;&lt;a name=&quot;gitolite_and_others_tools_for_authorisation&quot;&gt;gitolite and others tools for authorisation&lt;/a&gt;&lt;/h3&gt;

&lt;p&gt;There are many situations where you need to establish limits on what someone
can do.  When you have a number of developers, with varying levels of
experience and expertise, accessing a number of repos, and different branches
in different repos have different levels of &quot;importance&quot;, you need some
serious authorisation tool.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://github.com/sitaramc/gitolite&quot;&gt;Gitolite&lt;/a&gt; is the best such tool I know (blame author bias if you don&#39;t
agree!).  It comes with a &lt;a href=&quot;http://sitaramc.github.com/gitolite/README.html#_quick_install&quot;&gt;quick install&lt;/a&gt; section, plus lots and lots of
&lt;a href=&quot;http://sitaramc.github.com/gitolite&quot;&gt;documentation&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Other tools exist, but they are all web-based.  Google for &quot;gitorious&quot; or
&quot;gerrit code review&quot;, for access control tools.  For open source projects or
if you don&#39;t mind paying a small amount of money, Github is very nice.
(Gitolite&#39;s primary host is Github, and I have no other relationship with them
than being a free user).&lt;/p&gt;

&lt;p&gt;&lt;a name=&quot;_side_note_setting_limits_on_yourself&quot;&gt;&lt;/a&gt;&lt;/p&gt;

&lt;h4&gt;&lt;a name=&quot;side_note_setting_limits_on_yourself&quot;&gt;side note: setting limits on yourself&lt;/a&gt;&lt;/h4&gt;

&lt;p&gt;Strictly speaking, you might need to set limits on even &lt;em&gt;yourself&lt;/em&gt;.  Let&#39;s say
you have a bad habit of running &lt;code&gt;git push -f&lt;/code&gt;, and you want to protect from a
shoot-yourself-in-the-foot episode.&lt;/p&gt;

&lt;p&gt;One way to do this is to run &lt;code&gt;git config receive.denyNonFastForwards true&lt;/code&gt; on
the repo (server-side, not client-side).  This blocks rewind pushes, which is
great, but it does so for the &lt;em&gt;entire&lt;/em&gt; repo; you can&#39;t choose to protect only
certain important branches this way.  Using something like gitolite makes this
possible.&lt;/p&gt;

&lt;p&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p&gt;&lt;a name=&quot;_appendix_A_compiling_tips&quot;&gt;&lt;/a&gt;&lt;/p&gt;

&lt;h3&gt;&lt;a name=&quot;appendix_A_compiling_tips&quot;&gt;appendix A: compiling tips&lt;/a&gt;&lt;/h3&gt;

&lt;p&gt;If you&#39;re not able to install git using your system&#39;s normal install
mechanisms, you may end up having to compile it.&lt;/p&gt;

&lt;p&gt;You may find that setting &lt;code&gt;NO_CURL&lt;/code&gt;, &lt;code&gt;NO_EXPAT&lt;/code&gt;, and &lt;code&gt;NO_TCLTK&lt;/code&gt; may help if
you are missing dependencies.  The first two will prevent http-pull/push from
being built, but I never use those protocols anyway, so I don&#39;t care :-)  The
third one will prevent the GUI tools from being built, which does not matter
on a server&lt;/p&gt;
&lt;/html&gt;
</pre>
</div>
<div title="GettingStarted" modifier="Sitaram" modified="200802191637" created="200802191543" changecount="15">
<pre>Hello,

You've come across my customised copy of Tiddlywiki.  This file contains most of my notes on pretty much anything that I am willing to make public.  To start //''using it''//, type something in the search box to the right and hit enter.

A Tiddlywiki (TW for short) is a great way to create a personalised repository of information, and it's very easy to edit and access.  It's unique in that the code //and// data are in a single HTML file which you can transport very easily, and use wherever you have a decent web browser like Firefox.  ''Everything you do with a TW is from a normal browser, and involves just one HTML file''.  Even editing tiddlers and saving the file!

!!How I use it

You may notice that ''this'' TW contains full HTML in most of its tiddlers, instead of the much simpler TW syntax, and you may be wondering why I am doing that.  [[Click here to find out why|Why is this TW different?]]:

And if you want to know more about TW, do a google search for &quot;tiddlywiki&quot;.
</pre>
</div>
<div title="SparklinePlugin" created="200710140259" tags="systemConfig excludeLists excludeSearch">
<pre>/***
|''Name:''|SparklinePlugin|
|''Description:''|Sparklines macro|
***/
//{{{
if(!version.extensions.SparklinePlugin) {
version.extensions.SparklinePlugin = {installed:true};

//--
//-- Sparklines
//--

config.macros.sparkline = {};
config.macros.sparkline.handler = function(place,macroName,params)
{
	var data = [];
	var min = 0;
	var max = 0;
	var v;
	for(var t=0; t&lt;params.length; t++) {
		v = parseInt(params[t]);
		if(v &lt; min)
			min = v;
		if(v &gt; max)
			max = v;
		data.push(v);
	}
	if(data.length &lt; 1)
		return;
	var box = createTiddlyElement(place,&quot;span&quot;,null,&quot;sparkline&quot;,String.fromCharCode(160));
	box.title = data.join(&quot;,&quot;);
	var w = box.offsetWidth;
	var h = box.offsetHeight;
	box.style.paddingRight = (data.length * 2 - w) + &quot;px&quot;;
	box.style.position = &quot;relative&quot;;
	for(var d=0; d&lt;data.length; d++) {
		var tick = document.createElement(&quot;img&quot;);
		tick.border = 0;
		tick.className = &quot;sparktick&quot;;
		tick.style.position = &quot;absolute&quot;;
		tick.src = &quot;data:image/gif,GIF89a%01%00%01%00%91%FF%00%FF%FF%FF%00%00%00%C0%C0%C0%00%00%00!%F9%04%01%00%00%02%00%2C%00%00%00%00%01%00%01%00%40%02%02T%01%00%3B&quot;;
		tick.style.left = d*2 + &quot;px&quot;;
		tick.style.width = &quot;2px&quot;;
		v = Math.floor(((data[d] - min)/(max-min)) * h);
		tick.style.top = (h-v) + &quot;px&quot;;
		tick.style.height = v + &quot;px&quot;;
		box.appendChild(tick);
	}
};


}
//}}}</pre>
</div>
<div title="TestTiddler" modifier="Sitaram" created="200802191638" changecount="1">
<pre>Testing</pre>
</div>
<div title="Why is this TW different?" modifier="Sitaram" created="200802191629" changecount="1">
<pre>You may notice that ''this'' TW contains full HTML in most of its tiddlers, instead of the much simpler TW syntax, and may be wondering why I am doing that.  Here's why:

At one time I actually had all this information in TW, but I soon got tired of editing it within a web browser, (I'm more of a //vi// guy!).  So now I maintain all this info in plain files on my system, and periodically create this TW from those files with a small perl program.

TW is still the best way to browse my notes, and search them, while keeping all of them as one file for convenience.  I just don't use the editing part anymore, that's all, but that doesn't mean you shouldn't.

Anyway, if you want to know more about TW, do a google search for &quot;tiddlywiki&quot;.</pre>
</div>
<div title="YourSearchPlugin" modifier="UdoBorkowski" modified="200703160027" created="200601161427" tags="Plugin UdoBorkowski YourSearchProject systemConfig" server.type="file" server.host="tiddlywiki.abego-software.de" server.page.revision="200703160027">
<pre>/***
|''Name:''|YourSearchPlugin|
|''Version:''|2.1.1 (2007-03-11)|
|''Source:''|http://tiddlywiki.abego-software.de/#YourSearchPlugin ([[del.icio.us|http://del.icio.us/post?url=http://tiddlywiki.abego-software.de/index.html%23YourSearchPlugin]])|
|''Author:''|UdoBorkowski (ub [at] abego-software [dot] de)|
|''Licence:''|[[BSD open source license (abego Software)|http://www.abego-software.de/legal/apl-v10.html]]|
|''Copyright:''|&amp;copy; 2005-2006 [[abego Software|http://www.abego-software.de]]|
|''~CoreVersion:''|2.1.0|
|''Browser:''|Firefox 1.0.4+; Firefox 1.5; ~InternetExplorer 6.0|
!About YourSearch
YourSearch gives you a bunch of new features to simplify and speed up your daily searches in TiddlyWiki. It seamlessly integrates into the standard TiddlyWiki search: just start typing into the 'search' field and explore!

For more information see [[Help|YourSearch Help]].
!Compatibility
This plugin requires TiddlyWiki 2.1. 
Check the [[archive|http://tiddlywiki.abego-software.de/archive]] for ~YourSearchPlugins supporting older versions of TiddlyWiki.
!Source Code
***/
/***
This plugin's source code is compressed (and hidden). Use this [[link|http://tiddlywiki.abego-software.de/archive/YourSearchPlugin/Plugin-YourSearch-src.2.1.1.js]] to get the readable source code.
***/
///%
if(!version.extensions.YourSearchPlugin){version.extensions.YourSearchPlugin={major:2,minor:1,revision:1,source:&quot;http://tiddlywiki.abego-software.de/#YourSearchPlugin&quot;,licence:&quot;[[BSD open source license (abego Software)|http://www.abego-software.de/legal/apl-v10.html]]&quot;,copyright:&quot;Copyright (c) abego Software GmbH, 2005-2007 (www.abego-software.de)&quot;};if(!window.abego){window.abego={};}if(!Array.forEach){Array.forEach=function(_1,_2,_3){for(var i=0,len=_1.length;i&lt;len;i++){_2.call(_3,_1[i],i,_1);}};Array.prototype.forEach=function(_5,_6){for(var i=0,len=this.length;i&lt;len;i++){_5.call(_6,this[i],i,this);}};}abego.toInt=function(s,_9){if(!s){return _9;}var n=parseInt(s);return (n==NaN)?_9:n;};abego.createEllipsis=function(_b){var e=createTiddlyElement(_b,&quot;span&quot;);e.innerHTML=&quot;&amp;hellip;&quot;;};abego.shallowCopy=function(_d){if(!_d){return _d;}var _e={};for(var n in _d){_e[n]=_d[n];}return _e;};abego.copyOptions=function(_10){return !_10?{}:abego.shallowCopy(_10);};abego.countStrings=function(_11,s){if(!s){return 0;}var len=s.length;var n=0;var _15=0;while(1){var i=_11.indexOf(s,_15);if(i&lt;0){return n;}n++;_15=i+len;}return n;};abego.getBracedText=function(_17,_18,_19){if(!_18){_18=0;}var re=/\{([^\}]*)\}/gm;re.lastIndex=_18;var m=re.exec(_17);if(m){var s=m[1];var _1d=abego.countStrings(s,&quot;{&quot;);if(!_1d){if(_19){_19.lastIndex=re.lastIndex;}return s;}var len=_17.length;for(var i=re.lastIndex;i&lt;len&amp;&amp;_1d;i++){var c=_17.charAt(i);if(c==&quot;{&quot;){_1d++;}else{if(c==&quot;}&quot;){_1d--;}}}if(!_1d){if(_19){_19.lastIndex=i-1;}return _17.substring(m.index+1,i-1);}}};abego.select=function(_21,_22,_23,_24){if(!_24){_24=[];}_21.forEach(function(t){if(_22.call(_23,t)){_24.push(t);}});return _24;};abego.TiddlerFilterTerm=function(_26,_27){if(!_27){_27={};}var _28=_26;if(!_27.textIsRegExp){_28=_26.escapeRegExp();if(_27.fullWordMatch){_28=&quot;\\b&quot;+_28+&quot;\\b&quot;;}}var _29=new RegExp(_28,&quot;m&quot;+(_27.caseSensitive?&quot;&quot;:&quot;i&quot;));this.tester=new abego.MultiFieldRegExpTester(_29,_27.fields,_27.withExtendedFields);};abego.TiddlerFilterTerm.prototype.test=function(_2a){return this.tester.test(_2a);};abego.parseNewTiddlerCommandLine=function(s){var m=/(.*?)\.(?:\s+|$)([^#]*)(#.*)?/.exec(s);if(!m){m=/([^#]*)()(#.*)?/.exec(s);}if(m){var r;if(m[3]){var s2=m[3].replace(/#/g,&quot;&quot;);r=s2.parseParams(&quot;tag&quot;);}else{r=[[]];}var _2f=m[2]?m[2].trim():&quot;&quot;;r.push({name:&quot;text&quot;,value:_2f});r[0].text=[_2f];return {title:m[1].trim(),params:r};}else{return {title:s.trim(),params:[[]]};}};abego.parseTiddlerFilterTerm=function(_30,_31,_32){var re=/\s*(?:(?:\{([^\}]*)\})|(?:(=)|([#%!])|(?:(\w+)\s*\:(?!\/\/))|(?:(?:(&quot;(?:(?:\\&quot;)|[^&quot;])+&quot;)|(?:\/((?:(?:\\\/)|[^\/])+)\/)|(\w+\:\/\/[^\s]+)|([^\s\)\-\&quot;]+)))))/mg;var _34={&quot;!&quot;:&quot;title&quot;,&quot;%&quot;:&quot;text&quot;,&quot;#&quot;:&quot;tags&quot;};var _35={};var _36;re.lastIndex=_31;while(1){var i=re.lastIndex;var m=re.exec(_30);if(!m||m.index!=i){throw &quot;Word or String literal expected&quot;;}if(m[1]){var _39={};var _3a=abego.getBracedText(_30,0,_39);if(!_3a){throw &quot;Invalid {...} syntax&quot;;}var f=Function(&quot;tiddler&quot;,&quot;return (&quot;+_3a+&quot;);&quot;);return {func:f,lastIndex:_39.lastIndex,markRE:null};}if(m[2]){_36=true;}else{if(m[3]){_35[_34[m[3]]]=1;}else{if(m[4]){_35[m[4]]=1;}else{var _3c=m[6];var _3d=m[5]?window.eval(m[5]):m[6]?m[6]:m[7]?m[7]:m[8];var _3e=abego.copyOptions(_3e);_3e.fullWordMatch=_36;_3e.textIsRegExp=_3c;var _3f=[];for(var n in _35){_3f.push(n);}if(_3f.length==0){_3e.fields=_3e.defaultFields;}else{_3e.fields=_3f;_3e.withExtendedFields=false;}var _41=new abego.TiddlerFilterTerm(_3d,_3e);var _42=_3c?_3d:_3d.escapeRegExp();if(_42&amp;&amp;_36){_42=&quot;\\b&quot;+_42+&quot;\\b&quot;;}return {func:function(_43){return _41.test(_43);},lastIndex:re.lastIndex,markRE:_42?&quot;(?:&quot;+_42+&quot;)&quot;:null};}}}}};abego.BoolExp=function(s,_45,_46){this.s=s;var _47=_46&amp;&amp;_46.defaultOperationIs_OR;var _48=/\s*(?:(\-|not)|(\())/gi;var _49=/\s*\)/g;var _4a=/\s*(?:(and|\&amp;\&amp;)|(or|\|\|))/gi;var _4b=/\s*[^\)\s]/g;var _4c=/\s*(\-|not)?(\s*\()?/gi;var _4d;var _4e=function(_4f){_4c.lastIndex=_4f;var m=_4c.exec(s);var _51;var _52;if(m&amp;&amp;m.index==_4f){_4f=_4c.lastIndex;_51=m[1];if(m[2]){var e=_4d(_4f);_49.lastIndex=e.lastIndex;if(!_49.exec(s)){throw &quot;Missing ')'&quot;;}_52={func:e.func,lastIndex:_49.lastIndex,markRE:e.markRE};}}if(!_52){_52=_45(s,_4f,_46);}if(_51){_52.func=(function(f){return function(_55){return !f(_55);};})(_52.func);_52.markRE=null;}return _52;};_4d=function(_56){var _57=_4e(_56);while(1){var l=_57.lastIndex;_4a.lastIndex=l;var m=_4a.exec(s);var _5a;var _5b;if(m&amp;&amp;m.index==l){_5a=!m[1];_5b=_4e(_4a.lastIndex);}else{try{_5b=_4e(l);}catch(e){return _57;}_5a=_47;}_57.func=(function(_5c,_5d,_5e){return _5e?function(_5f){return _5c(_5f)||_5d(_5f);}:function(_60){return _5c(_60)&amp;&amp;_5d(_60);};})(_57.func,_5b.func,_5a);_57.lastIndex=_5b.lastIndex;if(!_57.markRE){_57.markRE=_5b.markRE;}else{if(_5b.markRE){_57.markRE=_57.markRE+&quot;|&quot;+_5b.markRE;}}}};var _61=_4d(0);this.evalFunc=_61.func;if(_61.markRE){this.markRegExp=new RegExp(_61.markRE,_46.caseSensitive?&quot;mg&quot;:&quot;img&quot;);}};abego.BoolExp.prototype.exec=function(){return this.evalFunc.apply(this,arguments);};abego.BoolExp.prototype.getMarkRegExp=function(){return this.markRegExp;};abego.BoolExp.prototype.toString=function(){return this.s;};abego.MultiFieldRegExpTester=function(re,_63,_64){this.re=re;this.fields=_63?_63:[&quot;title&quot;,&quot;text&quot;,&quot;tags&quot;];this.withExtendedFields=_64;};abego.MultiFieldRegExpTester.prototype.test=function(_65){var re=this.re;for(var i=0;i&lt;this.fields.length;i++){var s=store.getValue(_65,this.fields[i]);if(typeof s==&quot;string&quot;&amp;&amp;re.test(s)){return this.fields[i];}}if(this.withExtendedFields){return store.forEachField(_65,function(_69,_6a,_6b){return typeof _6b==&quot;string&quot;&amp;&amp;re.test(_6b)?_6a:null;},true);}return null;};abego.TiddlerQuery=function(_6c,_6d,_6e,_6f,_70){if(_6e){this.regExp=new RegExp(_6c,_6d?&quot;mg&quot;:&quot;img&quot;);this.tester=new abego.MultiFieldRegExpTester(this.regExp,_6f,_70);}else{this.expr=new abego.BoolExp(_6c,abego.parseTiddlerFilterTerm,{defaultFields:_6f,caseSensitive:_6d,withExtendedFields:_70});}this.getQueryText=function(){return _6c;};this.getUseRegExp=function(){return _6e;};this.getCaseSensitive=function(){return _6d;};this.getDefaultFields=function(){return _6f;};this.getWithExtendedFields=function(){return _70;};};abego.TiddlerQuery.prototype.test=function(_71){if(!_71){return false;}if(this.regExp){return this.tester.test(_71);}return this.expr.exec(_71);};abego.TiddlerQuery.prototype.filter=function(_72){return abego.select(_72,this.test,this);};abego.TiddlerQuery.prototype.getMarkRegExp=function(){if(this.regExp){return &quot;&quot;.search(this.regExp)&gt;=0?null:this.regExp;}return this.expr.getMarkRegExp();};abego.TiddlerQuery.prototype.toString=function(){return (this.regExp?this.regExp:this.expr).toString();};abego.PageWiseRenderer=function(){this.firstIndexOnPage=0;};merge(abego.PageWiseRenderer.prototype,{setItems:function(_73){this.items=_73;this.setFirstIndexOnPage(0);},getMaxPagesInNavigation:function(){return 10;},getItemsCount:function(_74){return this.items?this.items.length:0;},getCurrentPageIndex:function(){return Math.floor(this.firstIndexOnPage/this.getItemsPerPage());},getLastPageIndex:function(){return Math.floor((this.getItemsCount()-1)/this.getItemsPerPage());},setFirstIndexOnPage:function(_75){this.firstIndexOnPage=Math.min(Math.max(0,_75),this.getItemsCount()-1);},getFirstIndexOnPage:function(){this.firstIndexOnPage=Math.floor(this.firstIndexOnPage/this.getItemsPerPage())*this.getItemsPerPage();return this.firstIndexOnPage;},getLastIndexOnPage:function(){return Math.min(this.getFirstIndexOnPage()+this.getItemsPerPage()-1,this.getItemsCount()-1);},onPageChanged:function(_76,_77){},renderPage:function(_78){if(_78.beginRendering){_78.beginRendering(this);}try{if(this.getItemsCount()){var _79=this.getLastIndexOnPage();var _7a=-1;for(var i=this.getFirstIndexOnPage();i&lt;=_79;i++){_7a++;_78.render(this,this.items[i],i,_7a);}}}finally{if(_78.endRendering){_78.endRendering(this);}}},addPageNavigation:function(_7c){if(!this.getItemsCount()){return;}var _7d=this;var _7e=function(e){if(!e){var e=window.event;}var _81=abego.toInt(this.getAttribute(&quot;page&quot;),0);var _82=_7d.getCurrentPageIndex();if(_81==_82){return;}var _83=_81*_7d.getItemsPerPage();_7d.setFirstIndexOnPage(_83);_7d.onPageChanged(_81,_82);};var _84;var _85=this.getCurrentPageIndex();var _86=this.getLastPageIndex();if(_85&gt;0){_84=createTiddlyButton(_7c,&quot;Previous&quot;,&quot;Go to previous page (Shortcut: Alt-'&lt;')&quot;,_7e,&quot;prev&quot;);_84.setAttribute(&quot;page&quot;,(_85-1).toString());_84.setAttribute(&quot;accessKey&quot;,&quot;&lt;&quot;);}for(var i=-this.getMaxPagesInNavigation();i&lt;this.getMaxPagesInNavigation();i++){var _88=_85+i;if(_88&lt;0){continue;}if(_88&gt;_86){break;}var _89=(i+_85+1).toString();var _8a=_88==_85?&quot;currentPage&quot;:&quot;otherPage&quot;;_84=createTiddlyButton(_7c,_89,&quot;Go to page %0&quot;.format([_89]),_7e,_8a);_84.setAttribute(&quot;page&quot;,(_88).toString());}if(_85&lt;_86){_84=createTiddlyButton(_7c,&quot;Next&quot;,&quot;Go to next page (Shortcut: Alt-'&gt;')&quot;,_7e,&quot;next&quot;);_84.setAttribute(&quot;page&quot;,(_85+1).toString());_84.setAttribute(&quot;accessKey&quot;,&quot;&gt;&quot;);}}});abego.LimitedTextRenderer=function(){var _8b=40;var _8c=4;var _8d=function(_8e,_8f,_90){var n=_8e.length;if(n==0){_8e.push({start:_8f,end:_90});return;}var i=0;for(;i&lt;n;i++){var _93=_8e[i];if(_93.start&lt;=_90&amp;&amp;_8f&lt;=_93.end){var r;var _95=i+1;for(;_95&lt;n;_95++){r=_8e[_95];if(r.start&gt;_90||_8f&gt;_93.end){break;}}var _96=_8f;var _97=_90;for(var j=i;j&lt;_95;j++){r=_8e[j];_96=Math.min(_96,r.start);_97=Math.max(_97,r.end);}_8e.splice(i,_95-i,{start:_96,end:_97});return;}if(_93.start&gt;_90){break;}}_8e.splice(i,0,{start:_8f,end:_90});};var _99=function(_9a){var _9b=0;for(var i=0;i&lt;_9a.length;i++){var _9d=_9a[i];_9b+=_9d.end-_9d.start;}return _9b;};var _9e=function(c){return (c&gt;=&quot;a&quot;&amp;&amp;c&lt;=&quot;z&quot;)||(c&gt;=&quot;A&quot;&amp;&amp;c&lt;=&quot;Z&quot;)||c==&quot;_&quot;;};var _a0=function(s,_a2){if(!_9e(s[_a2])){return null;}for(var i=_a2-1;i&gt;=0&amp;&amp;_9e(s[i]);i--){}var _a4=i+1;var n=s.length;for(i=_a2+1;i&lt;n&amp;&amp;_9e(s[i]);i++){}return {start:_a4,end:i};};var _a6=function(s,_a8,_a9){var _aa;if(_a9){_aa=_a0(s,_a8);}else{if(_a8&lt;=0){return _a8;}_aa=_a0(s,_a8-1);}if(!_aa){return _a8;}if(_a9){if(_aa.start&gt;=_a8-_8c){return _aa.start;}if(_aa.end&lt;=_a8+_8c){return _aa.end;}}else{if(_aa.end&lt;=_a8+_8c){return _aa.end;}if(_aa.start&gt;=_a8-_8c){return _aa.start;}}return _a8;};var _ab=function(s,_ad){var _ae=[];if(_ad){var _af=0;var n=s.length;var _b1=0;do{_ad.lastIndex=_af;var _b2=_ad.exec(s);if(_b2){if(_af&lt;_b2.index){var t=s.substring(_af,_b2.index);_ae.push({text:t});}_ae.push({text:_b2[0],isMatch:true});_af=_b2.index+_b2[0].length;}else{_ae.push({text:s.substr(_af)});break;}}while(true);}else{_ae.push({text:s});}return _ae;};var _b4=function(_b5){var _b6=0;for(var i=0;i&lt;_b5.length;i++){if(_b5[i].isMatch){_b6++;}}return _b6;};var _b8=function(s,_ba,_bb,_bc,_bd){var _be=Math.max(Math.floor(_bd/(_bc+1)),_8b);var _bf=Math.max(_be-(_bb-_ba),0);var _c0=Math.min(Math.floor(_bb+_bf/3),s.length);var _c1=Math.max(_c0-_be,0);_c1=_a6(s,_c1,true);_c0=_a6(s,_c0,false);return {start:_c1,end:_c0};};var _c2=function(_c3,s,_c5){var _c6=[];var _c7=_b4(_c3);var pos=0;for(var i=0;i&lt;_c3.length;i++){var t=_c3[i];var _cb=t.text;if(t.isMatch){var _cc=_b8(s,pos,pos+_cb.length,_c7,_c5);_8d(_c6,_cc.start,_cc.end);}pos+=_cb.length;}return _c6;};var _cd=function(s,_cf,_d0){var _d1=_d0-_99(_cf);while(_d1&gt;0){if(_cf.length==0){_8d(_cf,0,_a6(s,_d0,false));return;}else{var _d2=_cf[0];var _d3;var _d4;if(_d2.start==0){_d3=_d2.end;if(_cf.length&gt;1){_d4=_cf[1].start;}else{_8d(_cf,_d3,_a6(s,_d3+_d1,false));return;}}else{_d3=0;_d4=_d2.start;}var _d5=Math.min(_d4,_d3+_d1);_8d(_cf,_d3,_d5);_d1-=(_d5-_d3);}}};var _d6=function(_d7,s,_d9,_da,_db){if(_da.length==0){return;}var _dc=function(_dd,s,_df,_e0,_e1){var t;var _e3;var pos=0;var i=0;var _e6=0;for(;i&lt;_df.length;i++){t=_df[i];_e3=t.text;if(_e0&lt;pos+_e3.length){_e6=_e0-pos;break;}pos+=_e3.length;}var _e7=_e1-_e0;for(;i&lt;_df.length&amp;&amp;_e7&gt;0;i++){t=_df[i];_e3=t.text.substr(_e6);_e6=0;if(_e3.length&gt;_e7){_e3=_e3.substr(0,_e7);}if(t.isMatch){createTiddlyElement(_dd,&quot;span&quot;,null,&quot;marked&quot;,_e3);}else{createTiddlyText(_dd,_e3);}_e7-=_e3.length;}if(_e1&lt;s.length){abego.createEllipsis(_dd);}};if(_da[0].start&gt;0){abego.createEllipsis(_d7);}var _e8=_db;for(var i=0;i&lt;_da.length&amp;&amp;_e8&gt;0;i++){var _ea=_da[i];var len=Math.min(_ea.end-_ea.start,_e8);_dc(_d7,s,_d9,_ea.start,_ea.start+len);_e8-=len;}};this.render=function(_ec,s,_ee,_ef){if(s.length&lt;_ee){_ee=s.length;}var _f0=_ab(s,_ef);var _f1=_c2(_f0,s,_ee);_cd(s,_f1,_ee);_d6(_ec,s,_f0,_f1,_ee);};};(function(){function alertAndThrow(msg){alert(msg);throw msg;}if(version.major&lt;2||(version.major==2&amp;&amp;version.minor&lt;1)){alertAndThrow(&quot;YourSearchPlugin requires TiddlyWiki 2.1 or newer.\n\nCheck the archive for YourSearch plugins\nsupporting older versions of TiddlyWiki.\n\nArchive: http://tiddlywiki.abego-software.de/archive&quot;);}abego.YourSearch={};var _f3;var _f4;var _f5=function(_f6){_f3=_f6;};var _f7=function(){return _f3?_f3:[];};var _f8=function(){return _f3?_f3.length:0;};var _f9=4;var _fa=10;var _fb=2;var _fc=function(s,re){var m=s.match(re);return m?m.length:0;};var _100=function(_101,_102){var _103=_102.getMarkRegExp();if(!_103){return 1;}var _104=_101.title.match(_103);var _105=_104?_104.length:0;var _106=_fc(_101.getTags(),_103);var _107=_104?_104.join(&quot;&quot;).length:0;var _108=_101.title.length&gt;0?_107/_101.title.length:0;var rank=_105*_f9+_106*_fb+_108*_fa+1;return rank;};var _10a=function(_10b,_10c,_10d,_10e,_10f,_110){_f4=null;var _111=_10b.reverseLookup(&quot;tags&quot;,_110,false);try{var _112=[];if(config.options.chkSearchInTitle){_112.push(&quot;title&quot;);}if(config.options.chkSearchInText){_112.push(&quot;text&quot;);}if(config.options.chkSearchInTags){_112.push(&quot;tags&quot;);}_f4=new abego.TiddlerQuery(_10c,_10d,_10e,_112,config.options.chkSearchExtendedFields);}catch(e){return [];}var _113=_f4.filter(_111);var _114=abego.YourSearch.getRankFunction();for(var i=0;i&lt;_113.length;i++){var _116=_113[i];var rank=_114(_116,_f4);_116.searchRank=rank;}if(!_10f){_10f=&quot;title&quot;;}var _118=function(a,b){var _11b=a.searchRank-b.searchRank;if(_11b==0){if(a[_10f]==b[_10f]){return (0);}else{return (a[_10f]&lt;b[_10f])?-1:+1;}}else{return (_11b&gt;0)?-1:+1;}};_113.sort(_118);return _113;};var _11c=80;var _11d=50;var _11e=250;var _11f=50;var _120=25;var _121=10;var _122=&quot;yourSearchResult&quot;;var _123=&quot;yourSearchResultItems&quot;;var _124;var _125;var _126;var _127;var _128;var _129=function(){if(version.extensions.YourSearchPlugin.styleSheetInited){return;}version.extensions.YourSearchPlugin.styleSheetInited=true;setStylesheet(store.getTiddlerText(&quot;YourSearchStyleSheet&quot;),&quot;yourSearch&quot;);};var _12a=function(){return _125!=null&amp;&amp;_125.parentNode==document.body;};var _12b=function(){if(_12a()){document.body.removeChild(_125);}};var _12c=function(e){_12b();var _12e=this.getAttribute(&quot;tiddlyLink&quot;);if(_12e){var _12f=this.getAttribute(&quot;withHilite&quot;);var _130=highlightHack;if(_12f&amp;&amp;_12f==&quot;true&quot;&amp;&amp;_f4){highlightHack=_f4.getMarkRegExp();}story.displayTiddler(this,_12e);highlightHack=_130;}return (false);};var _131=function(){if(!_126){return;}var root=_126;var _133=findPosX(root);var _134=findPosY(root);var _135=root.offsetHeight;var _136=_133;var _137=_134+_135;var _138=findWindowWidth();if(_138&lt;_125.offsetWidth){_125.style.width=(_138-100)+&quot;px&quot;;_138=findWindowWidth();}var _139=_125.offsetWidth;if(_136+_139&gt;_138){_136=_138-_139-30;}if(_136&lt;0){_136=0;}_125.style.left=_136+&quot;px&quot;;_125.style.top=_137+&quot;px&quot;;_125.style.display=&quot;block&quot;;};var _13a=function(){if(_125){window.scrollTo(0,ensureVisible(_125));}if(_126){window.scrollTo(0,ensureVisible(_126));}};var _13b=function(){_131();_13a();};var _13c;var _13d;var _13e=new abego.PageWiseRenderer();var _13f=function(_140){this.itemHtml=store.getTiddlerText(&quot;YourSearchItemTemplate&quot;);if(!this.itemHtml){alertAndThrow(&quot;YourSearchItemTemplate not found&quot;);}this.place=document.getElementById(_123);if(!this.place){this.place=createTiddlyElement(_140,&quot;div&quot;,_123);}};merge(_13f.prototype,{render:function(_141,_142,_143,_144){_13c=_144;_13d=_142;var item=createTiddlyElement(this.place,&quot;div&quot;,null,&quot;yourSearchItem&quot;);item.innerHTML=this.itemHtml;applyHtmlMacros(item,null);refreshElements(item,null);},endRendering:function(_146){_13d=null;}});var _147=function(){if(!_125||!_126){return;}var html=store.getTiddlerText(&quot;YourSearchResultTemplate&quot;);if(!html){html=&quot;&lt;b&gt;Tiddler YourSearchResultTemplate not found&lt;/b&gt;&quot;;}_125.innerHTML=html;applyHtmlMacros(_125,null);refreshElements(_125,null);var _149=new _13f(_125);_13e.renderPage(_149);_13b();};_13e.getItemsPerPage=function(){var n=(config.options.chkPreviewText)?abego.toInt(config.options.txtItemsPerPageWithPreview,_121):abego.toInt(config.options.txtItemsPerPage,_120);return (n&gt;0)?n:1;};_13e.onPageChanged=function(){_147();};var _14b=function(){if(_126==null||!config.options.chkUseYourSearch){return;}if((_126.value==_124)&amp;&amp;_124&amp;&amp;!_12a()){if(_125&amp;&amp;(_125.parentNode!=document.body)){document.body.appendChild(_125);_13b();}else{abego.YourSearch.onShowResult(true);}}};var _14c=function(){_12b();_125=null;_124=null;};var _14d=function(self,e){while(e!=null){if(self==e){return true;}e=e.parentNode;}return false;};var _150=function(e){if(e.target==_126){return;}if(e.target==_127){return;}if(_125&amp;&amp;_14d(_125,e.target)){return;}_12b();};var _152=function(e){if(e.keyCode==27){_12b();}};addEvent(document,&quot;click&quot;,_150);addEvent(document,&quot;keyup&quot;,_152);var _154=function(text,_156,_157){_124=text;_f5(_10a(store,text,_156,_157,&quot;title&quot;,&quot;excludeSearch&quot;));abego.YourSearch.onShowResult();};var _158=function(_159,_15a,_15b,_15c,_15d,_15e){_129();_124=&quot;&quot;;var _15f=null;var _160=function(txt){if(config.options.chkUseYourSearch){_154(txt.value,config.options.chkCaseSensitiveSearch,config.options.chkRegExpSearch);}else{story.search(txt.value,config.options.chkCaseSensitiveSearch,config.options.chkRegExpSearch);}_124=txt.value;};var _162=function(e){_160(_126);return false;};var _164=function(e){if(!e){var e=window.event;}_126=this;switch(e.keyCode){case 13:if(e.ctrlKey&amp;&amp;_128&amp;&amp;_12a()){_128.onclick.apply(_128,[e]);}else{_160(this);}break;case 27:if(_12a()){_12b();}else{this.value=&quot;&quot;;clearMessage();}break;}if(String.fromCharCode(e.keyCode)==this.accessKey||e.altKey){_14b();}if(this.value.length&lt;3&amp;&amp;_15f){clearTimeout(_15f);}if(this.value.length&gt;2){if(this.value!=_124){if(!config.options.chkUseYourSearch||config.options.chkSearchAsYouType){if(_15f){clearTimeout(_15f);}var txt=this;_15f=setTimeout(function(){_160(txt);},500);}}else{if(_15f){clearTimeout(_15f);}}}if(this.value.length==0){_12b();}};var _168=function(e){this.select();clearMessage();_14b();};var args=_15d.parseParams(&quot;list&quot;,null,true);var _16b=getFlag(args,&quot;buttonAtRight&quot;);var _16c=getParam(args,&quot;sizeTextbox&quot;,this.sizeTextbox);var btn;if(!_16b){btn=createTiddlyButton(_159,this.label,this.prompt,_162);}var txt=createTiddlyElement(_159,&quot;input&quot;,null,null,null);if(_15b[0]){txt.value=_15b[0];}txt.onkeyup=_164;txt.onfocus=_168;txt.setAttribute(&quot;size&quot;,_16c);txt.setAttribute(&quot;accessKey&quot;,this.accessKey);txt.setAttribute(&quot;autocomplete&quot;,&quot;off&quot;);if(config.browser.isSafari){txt.setAttribute(&quot;type&quot;,&quot;search&quot;);txt.setAttribute(&quot;results&quot;,&quot;5&quot;);}else{txt.setAttribute(&quot;type&quot;,&quot;text&quot;);}if(_16b){btn=createTiddlyButton(_159,this.label,this.prompt,_162);}_126=txt;_127=btn;};var _16f=function(){_12b();var _170=_f7();var n=_170.length;if(n){var _172=[];for(var i=0;i&lt;n;i++){_172.push(_170[i].title);}story.displayTiddlers(null,_172);}};var _174=function(_175,_176,_177,_178){invokeMacro(_175,&quot;option&quot;,_176,_177,_178);var elem=_175.lastChild;var _17a=elem.onclick;elem.onclick=function(e){var _17c=_17a.apply(this,arguments);_147();return _17c;};return elem;};var _17d=function(s){var _17f=[&quot;''&quot;,&quot;{{{&quot;,&quot;}}}&quot;,&quot;//&quot;,&quot;&lt;&lt;&lt;&quot;,&quot;/***&quot;,&quot;***/&quot;];var _180=&quot;&quot;;for(var i=0;i&lt;_17f.length;i++){if(i!=0){_180+=&quot;|&quot;;}_180+=&quot;(&quot;+_17f[i].escapeRegExp()+&quot;)&quot;;}return s.replace(new RegExp(_180,&quot;mg&quot;),&quot;&quot;).trim();};var _182=function(){var i=_13c;return (i&gt;=0&amp;&amp;i&lt;=9)?(i&lt;9?(i+1):0):-1;};var _184=new abego.LimitedTextRenderer();var _185=function(_186,s,_188){_184.render(_186,s,_188,_f4.getMarkRegExp());};var _189=TiddlyWiki.prototype.saveTiddler;TiddlyWiki.prototype.saveTiddler=function(_18a,_18b,_18c,_18d,_18e,tags,_190){_189.apply(this,arguments);_14c();};var _191=TiddlyWiki.prototype.removeTiddler;TiddlyWiki.prototype.removeTiddler=function(_192){_191.apply(this,arguments);_14c();};config.macros.yourSearch={label:&quot;yourSearch&quot;,prompt:&quot;Gives access to the current/last YourSearch result&quot;,handler:function(_193,_194,_195,_196,_197,_198){if(_195.length==0){return;}var name=_195[0];var func=config.macros.yourSearch.funcs[name];if(func){func(_193,_194,_195,_196,_197,_198);}},tests:{&quot;true&quot;:function(){return true;},&quot;false&quot;:function(){return false;},&quot;found&quot;:function(){return _f8()&gt;0;},&quot;previewText&quot;:function(){return config.options.chkPreviewText;}},funcs:{itemRange:function(_19b){if(_f8()){var _19c=_13e.getLastIndexOnPage();var s=&quot;%0 - %1&quot;.format([_13e.getFirstIndexOnPage()+1,_19c+1]);createTiddlyText(_19b,s);}},count:function(_19e){createTiddlyText(_19e,_f8().toString());},query:function(_19f){if(_f4){createTiddlyText(_19f,_f4.toString());}},version:function(_1a0){var t=&quot;YourSearch %0.%1.%2&quot;.format([version.extensions.YourSearchPlugin.major,version.extensions.YourSearchPlugin.minor,version.extensions.YourSearchPlugin.revision]);var e=createTiddlyElement(_1a0,&quot;a&quot;);e.setAttribute(&quot;href&quot;,&quot;http://tiddlywiki.abego-software.de/#YourSearchPlugin&quot;);e.innerHTML=&quot;&lt;font color=\&quot;black\&quot; face=\&quot;Arial, Helvetica, sans-serif\&quot;&gt;&quot;+t+&quot;&lt;font&gt;&quot;;},copyright:function(_1a3){var e=createTiddlyElement(_1a3,&quot;a&quot;);e.setAttribute(&quot;href&quot;,&quot;http://www.abego-software.de&quot;);e.innerHTML=&quot;&lt;font color=\&quot;black\&quot; face=\&quot;Arial, Helvetica, sans-serif\&quot;&gt;&amp;copy; 2005-2006 &lt;b&gt;&lt;font color=\&quot;red\&quot;&gt;abego&lt;/font&gt;&lt;/b&gt; Software&lt;font&gt;&quot;;},newTiddlerButton:function(_1a5){if(_f4){var r=abego.parseNewTiddlerCommandLine(_f4.getQueryText());var btn=config.macros.newTiddler.createNewTiddlerButton(_1a5,r.title,r.params,&quot;new tiddler&quot;,&quot;Create a new tiddler based on search text. (Shortcut: Ctrl-Enter; Separators: '.', '#')&quot;,null,&quot;text&quot;);var _1a8=btn.onclick;btn.onclick=function(){_12b();_1a8.apply(this,arguments);};_128=btn;}},linkButton:function(_1a9,_1aa,_1ab,_1ac,_1ad,_1ae){if(_1ab&lt;2){return;}var _1af=_1ab[1];var text=_1ab&lt;3?_1af:_1ab[2];var _1b1=_1ab&lt;4?text:_1ab[3];var _1b2=_1ab&lt;5?null:_1ab[4];var btn=createTiddlyButton(_1a9,text,_1b1,_12c,null,null,_1b2);btn.setAttribute(&quot;tiddlyLink&quot;,_1af);},closeButton:function(_1b4,_1b5,_1b6,_1b7,_1b8,_1b9){var _1ba=createTiddlyButton(_1b4,&quot;close&quot;,&quot;Close the Search Results (Shortcut: ESC)&quot;,_12b);},openAllButton:function(_1bb,_1bc,_1bd,_1be,_1bf,_1c0){var n=_f8();if(n==0){return;}var _1c2=n==1?&quot;open tiddler&quot;:&quot;open all %0 tiddlers&quot;.format([n]);var _1c3=createTiddlyButton(_1bb,_1c2,&quot;Open all found tiddlers (Shortcut: Alt-O)&quot;,_16f);_1c3.setAttribute(&quot;accessKey&quot;,&quot;O&quot;);},naviBar:function(_1c4,_1c5,_1c6,_1c7,_1c8,_1c9){_13e.addPageNavigation(_1c4);},&quot;if&quot;:function(_1ca,_1cb,_1cc,_1cd,_1ce,_1cf){if(_1cc.length&lt;2){return;}var _1d0=_1cc[1];var _1d1=(_1d0==&quot;not&quot;);if(_1d1){if(_1cc.length&lt;3){return;}_1d0=_1cc[2];}var test=config.macros.yourSearch.tests[_1d0];var _1d3=false;try{if(test){_1d3=test(_1ca,_1cb,_1cc,_1cd,_1ce,_1cf)!=_1d1;}else{_1d3=(!eval(_1d0))==_1d1;}}catch(ex){}if(!_1d3){_1ca.style.display=&quot;none&quot;;}},chkPreviewText:function(_1d4,_1d5,_1d6,_1d7,_1d8,_1d9){var _1da=_1d6.slice(1).join(&quot; &quot;);var elem=_174(_1d4,&quot;chkPreviewText&quot;,_1d7,_1d9);elem.setAttribute(&quot;accessKey&quot;,&quot;P&quot;);elem.title=&quot;Show text preview of found tiddlers (Shortcut: Alt-P)&quot;;return elem;}}};config.macros.foundTiddler={label:&quot;foundTiddler&quot;,prompt:&quot;Provides information on the tiddler currently processed on the YourSearch result page&quot;,handler:function(_1dc,_1dd,_1de,_1df,_1e0,_1e1){var name=_1de[0];var func=config.macros.foundTiddler.funcs[name];if(func){func(_1dc,_1dd,_1de,_1df,_1e0,_1e1);}},funcs:{title:function(_1e4,_1e5,_1e6,_1e7,_1e8,_1e9){if(!_13d){return;}var _1ea=_182();var _1eb=_1ea&gt;=0?&quot;Open tiddler (Shortcut: Alt-%0)&quot;.format([_1ea.toString()]):&quot;Open tiddler&quot;;var btn=createTiddlyButton(_1e4,null,_1eb,_12c,null);btn.setAttribute(&quot;tiddlyLink&quot;,_13d.title);btn.setAttribute(&quot;withHilite&quot;,&quot;true&quot;);_185(btn,_13d.title,_11c);if(_1ea&gt;=0){btn.setAttribute(&quot;accessKey&quot;,_1ea.toString());}},tags:function(_1ed,_1ee,_1ef,_1f0,_1f1,_1f2){if(!_13d){return;}_185(_1ed,_13d.getTags(),_11d);},text:function(_1f3,_1f4,_1f5,_1f6,_1f7,_1f8){if(!_13d){return;}_185(_1f3,_17d(_13d.text),_11e);},field:function(_1f9,_1fa,_1fb,_1fc,_1fd,_1fe){if(!_13d){return;}var name=_1fb[1];var len=_1fb.length&gt;2?abego.toInt(_1fb[2],_11f):_11f;var v=store.getValue(_13d,name);if(v){_185(_1f9,_17d(v),len);}},number:function(_202,_203,_204,_205,_206,_207){var _208=_182();if(_208&gt;=0){var text=&quot;%0)&quot;.format([_208.toString()]);createTiddlyElement(_202,&quot;span&quot;,null,&quot;shortcutNumber&quot;,text);}}}};var opts={chkUseYourSearch:true,chkPreviewText:true,chkSearchAsYouType:true,chkSearchInTitle:true,chkSearchInText:true,chkSearchInTags:true,chkSearchExtendedFields:true,txtItemsPerPage:_120,txtItemsPerPageWithPreview:_121};for(var n in opts){if(config.options[n]==undefined){config.options[n]=opts[n];}}config.shadowTiddlers.AdvancedOptions+=&quot;\n&lt;&lt;option chkUseYourSearch&gt;&gt; Use 'Your Search' //([[more options|YourSearch Options]]) ([[help|YourSearch Help]])// &quot;;config.shadowTiddlers[&quot;YourSearch Help&quot;]=&quot;!Field Search\nWith the Field Search you can restrict your search to certain fields of a tiddler, e.g&quot;+&quot; only search the tags or only the titles. The general form is //fieldname//'':''//textToSearch// (e.&quot;+&quot;g. {{{title:intro}}}). In addition one-character shortcuts are also supported for the standard field&quot;+&quot;s {{{title}}}, {{{text}}} and {{{tags}}}:\n|!What you want|!What you type|!Example|\n|Search ''titles &quot;+&quot;only''|start word with ''!''|{{{!jonny}}} (shortcut for {{{title:jonny}}})|\n|Search ''contents/text &quot;+&quot;only''|start word with ''%''|{{{%football}}} (shortcut for {{{text:football}}})|\n|Search ''tags only&quot;+&quot;''|start word with ''#''|{{{#Plugin}}} (shortcut for {{{tags:Plugin}}})|\n\nUsing this feature you may&quot;+&quot; also search the extended fields (\&quot;Metadata\&quot;) introduced with TiddlyWiki 2.1, e.g. use {{{priority:1&quot;+&quot;}}} to find all tiddlers with the priority field set to \&quot;1\&quot;.\n\nYou may search a word in more than one&quot;+&quot; field. E.g. {{{!#Plugin}}} (or {{{title:tags:Plugin}}} in the \&quot;long form\&quot;) finds tiddlers containin&quot;+&quot;g \&quot;Plugin\&quot; either in the title or in the tags (but does not look for \&quot;Plugin\&quot; in the text). \n\n!Boole&quot;+&quot;an Search\nThe Boolean Search is useful when searching for multiple words.\n|!What you want|!What you &quot;+&quot;type|!Example|\n|''All words'' must exist|List of words|{{{jonny jeremy}}} (or {{{jonny and jeremy}}}&quot;+&quot;)|\n|''At least one word'' must exist|Separate words by ''or''|{{{jonny or jeremy}}}|\n|A word ''must &quot;+&quot;not exist''|Start word with ''-''|{{{-jonny}}} (or {{{not jonny}}})|\n\n''Note:'' When you specify two&quot;+&quot; words, separated with a space, YourSearch finds all tiddlers that contain both words, but not neces&quot;+&quot;sarily next to each other. If you want to find a sequence of word, e.g. '{{{John Brown}}}', you need&quot;+&quot; to put the words into quotes. I.e. you type: {{{\&quot;john brown\&quot;}}}.\n\nUsing parenthesis you may change &quot;+&quot;the default \&quot;left to right\&quot; evaluation of the boolean search. E.g. {{{not (jonny or jeremy)}}} finds&quot;+&quot; all tiddlers that contain neither \&quot;jonny\&quot; nor \&quot;jeremy. In contrast to this {{{not jonny or jeremy}}&quot;+&quot;} (i.e. without parenthesis) finds all tiddlers that either don't contain \&quot;jonny\&quot; or that contain \&quot;j&quot;+&quot;eremy\&quot;.\n\n!'Exact Word' Search\nBy default a search result all matches that 'contain' the searched tex&quot;+&quot;t. E.g. if you search for {{{Task}}} you will get all tiddlers containing 'Task', but also '~Complet&quot;+&quot;edTask', '~TaskForce' etc.\n\nIf you only want to get the tiddlers that contain 'exactly the word' you&quot;+&quot; need to prefix it with a '='. E.g. typing '=Task' will find the tiddlers that contain the word 'Tas&quot;+&quot;k', ignoring words that just contain 'Task' as a substring.\n\n!~CaseSensitiveSearch and ~RegExpSearch&quot;+&quot;\nThe standard search options ~CaseSensitiveSearch and ~RegExpSearch are fully supported by YourSearc&quot;+&quot;h. However when ''~RegExpSearch'' is on Filtered and Boolean Search are disabled.\n\nIn addition you m&quot;+&quot;ay do a \&quot;regular expression\&quot; search even with the ''~RegExpSearch'' set to false by directly enterin&quot;+&quot;g the regular expression into the search field, framed with {{{/.../}}}. \n\nExample: {{{/m[ae][iy]er/&quot;+&quot;}}} will find all tiddlers that contain either \&quot;maier\&quot;, \&quot;mayer\&quot;, \&quot;meier\&quot; or \&quot;meyer\&quot;.\n\n!~JavaScript E&quot;+&quot;xpression Filtering\nIf you are familiar with JavaScript programming and know some TiddlyWiki interna&quot;+&quot;ls you may also use JavaScript expression for the search. Just enter a JavaScript boolean expression&quot;+&quot; into the search field, framed with {{{ { ... } }}}. In the code refer to the variable tiddler and e&quot;+&quot;valuate to {{{true}}} when the given tiddler should be included in the result. \n\nExample: {{{ { tidd&quot;+&quot;ler.modified &gt; new Date(\&quot;Jul 4, 2005\&quot;)} }}} returns all tiddler modified after July 4th, 2005.\n\n!Com&quot;+&quot;bined Search\nYou are free to combine the various search options. \n\n''Examples''\n|!What you type|!Res&quot;+&quot;ult|\n|{{{!jonny !jeremy -%football}}}|all tiddlers with both {{{jonny}}} and {{{jeremy}}} in its tit&quot;+&quot;les, but no {{{football}}} in content.|\n|{{{#=Task}}}|All tiddlers tagged with 'Task' (the exact wor&quot;+&quot;d). Tags named '~CompletedTask', '~TaskForce' etc. are not considered.|\n\n!Access Keys\nYou are encour&quot;+&quot;aged to use the access keys (also called \&quot;shortcut\&quot; keys) for the most frequently used operations. F&quot;+&quot;or quick reference these shortcuts are also mentioned in the tooltip for the various buttons etc.\n\n|&quot;+&quot;!Key|!Operation|\n|{{{Alt-F}}}|''The most important keystroke'': It moves the cursor to the search in&quot;+&quot;put field so you can directly start typing your query. Pressing {{{Alt-F}}} will also display the pr&quot;+&quot;evious search result. This way you can quickly display multiple tiddlers using \&quot;Press {{{Alt-F}}}. S&quot;+&quot;elect tiddler.\&quot; sequences.|\n|{{{ESC}}}|Closes the [[YourSearch Result]]. When the [[YourSearch Resul&quot;+&quot;t]] is already closed and the cursor is in the search input field the field's content is cleared so &quot;+&quot;you start a new query.|\n|{{{Alt-1}}}, {{{Alt-2}}},... |Pressing these keys opens the first, second e&quot;+&quot;tc. tiddler from the result list.|\n|{{{Alt-O}}}|Opens all found tiddlers.|\n|{{{Alt-P}}}|Toggles the &quot;+&quot;'Preview Text' mode.|\n|{{{Alt-'&lt;'}}}, {{{Alt-'&gt;'}}}|Displays the previous or next page in the [[Your&quot;+&quot;Search Result]].|\n|{{{Return}}}|When you have turned off the 'as you type' search mode pressing the &quot;+&quot;{{{Return}}} key actually starts the search (as does pressing the 'search' button).|\n\n//If some of t&quot;+&quot;hese shortcuts don't work for you check your browser if you have other extensions installed that alr&quot;+&quot;eady \&quot;use\&quot; these shortcuts.//&quot;;config.shadowTiddlers[&quot;YourSearch Options&quot;]=&quot;|&gt;|!YourSearch Options|\n|&gt;|&lt;&lt;option chkUseYourSearch&gt;&gt; Use 'Your Search'|\n|!|&lt;&lt;option chkPreviewText&quot;+&quot;&gt;&gt; Show Text Preview|\n|!|&lt;&lt;option chkSearchAsYouType&gt;&gt; 'Search As You Type' Mode (No RETURN required&quot;+&quot; to start search)|\n|!|Default Search Filter:&lt;&lt;option chkSearchInTitle&gt;&gt;Title ('!')     &lt;&lt;option chk&quot;+&quot;SearchInText&gt;&gt;Text ('%')     &lt;&lt;option chkSearchInTags&gt;&gt;Tags ('#')    &lt;&lt;option chkSearchExtendedFiel&quot;+&quot;ds&gt;&gt;Extended Fields&lt;html&gt;&lt;br&gt;&lt;font size=\&quot;-2\&quot;&gt;The fields of a tiddlers that are searched when you don&quot;+&quot;'t explicitly specify a filter in the search text &lt;br&gt;(Explictly specify fields using one or more '!&quot;+&quot;', '%', '#' or 'fieldname:' prefix before the word/text to find).&lt;/font&gt;&lt;/html&gt;|\n|!|Number of items &quot;+&quot;on search result page: &lt;&lt;option txtItemsPerPage&gt;&gt;|\n|!|Number of items on search result page with pre&quot;+&quot;view text: &lt;&lt;option txtItemsPerPageWithPreview&gt;&gt;|\n&quot;;config.shadowTiddlers[&quot;YourSearchStyleSheet&quot;]=&quot;/***\n!~YourSearchResult Stylesheet\n***/\n/*{{{*/\n.yourSearchResult {\n\tposition: absolute;\n\twidth: 800&quot;+&quot;px;\n\n\tpadding: 0.2em;\n\tlist-style: none;\n\tmargin: 0;\n\n\tbackground: #ffd;\n\tborder: 1px solid DarkGra&quot;+&quot;y;\n}\n\n/*}}}*/\n/***\n!!Summary Section\n***/\n/*{{{*/\n.yourSearchResult .summary {\n\tborder-bottom-width:&quot;+&quot; thin;\n\tborder-bottom-style: solid;\n\tborder-bottom-color: #999999;\n\tpadding-bottom: 4px;\n}\n\n.yourSea&quot;+&quot;rchRange, .yourSearchCount, .yourSearchQuery   {\n\tfont-weight: bold;\n}\n\n.yourSearchResult .summary .&quot;+&quot;button {\n\tfont-size: 10px;\n\n\tpadding-left: 0.3em;\n\tpadding-right: 0.3em;\n}\n\n.yourSearchResult .summa&quot;+&quot;ry .chkBoxLabel {\n\tfont-size: 10px;\n\n\tpadding-right: 0.3em;\n}\n\n/*}}}*/\n/***\n!!Items Area\n***/\n/*{{{*&quot;+&quot;/\n.yourSearchResult .marked {\n\tbackground: none;\n\tfont-weight: bold;\n}\n\n.yourSearchItem {\n\tmargin-to&quot;+&quot;p: 2px;\n}\n\n.yourSearchNumber {\n\tcolor: #808080;\n}\n\n\n.yourSearchTags {\n\tcolor: #008000;\n}\n\n.yourSearc&quot;+&quot;hText {\n\tcolor: #808080;\n\tmargin-bottom: 6px;\n}\n\n/*}}}*/\n/***\n!!Footer\n***/\n/*{{{*/\n.yourSearchFoote&quot;+&quot;r {\n\tmargin-top: 8px;\n\tborder-top-width: thin;\n\tborder-top-style: solid;\n\tborder-top-color: #999999;&quot;+&quot;\n}\n\n.yourSearchFooter a:hover{\n\tbackground: none;\n\tcolor: none;\n}\n/*}}}*/\n/***\n!!Navigation Bar\n***/&quot;+&quot;\n/*{{{*/\n.yourSearchNaviBar a {\n\tfont-size: 16px;\n\tmargin-left: 4px;\n\tmargin-right: 4px;\n\tcolor: bla&quot;+&quot;ck;\n\ttext-decoration: underline;\n}\n\n.yourSearchNaviBar a:hover {\n\tbackground-color: none;\n}\n\n.yourSe&quot;+&quot;archNaviBar .prev {\n\tfont-weight: bold;\n\tcolor: blue;\n}\n\n.yourSearchNaviBar .currentPage {\n\tcolor: #&quot;+&quot;FF0000;\n\tfont-weight: bold;\n\ttext-decoration: none;\n}\n\n.yourSearchNaviBar .next {\n\tfont-weight: bold&quot;+&quot;;\n\tcolor: blue;\n}\n/*}}}*/\n&quot;;config.shadowTiddlers[&quot;YourSearchResultTemplate&quot;]=&quot;&lt;!--\n{{{\n--&gt;\n&lt;span macro=\&quot;yourSearch if found\&quot;&gt;\n&lt;!-- The Summary Header ============================&quot;+&quot;================ --&gt;\n&lt;table class=\&quot;summary\&quot; border=\&quot;0\&quot; width=\&quot;100%\&quot; cellspacing=\&quot;0\&quot; cellpadding=\&quot;0\&quot;&gt;&quot;+&quot;&lt;tbody&gt;\n  &lt;tr&gt;\n\t&lt;td align=\&quot;left\&quot;&gt;\n\t\tYourSearch Result &lt;span class=\&quot;yourSearchRange\&quot; macro=\&quot;yourSearc&quot;+&quot;h itemRange\&quot;&gt;&lt;/span&gt;\n\t\t&amp;nbsp;of&amp;nbsp;&lt;span class=\&quot;yourSearchCount\&quot; macro=\&quot;yourSearch count\&quot;&gt;&lt;/span&gt;\n&quot;+&quot;\t\tfor&amp;nbsp;&lt;span class=\&quot;yourSearchQuery\&quot; macro=\&quot;yourSearch query\&quot;&gt;&lt;/span&gt;\n\t&lt;/td&gt;\n\t&lt;td class=\&quot;yourSea&quot;+&quot;rchButtons\&quot; align=\&quot;right\&quot;&gt;\n\t\t&lt;span macro=\&quot;yourSearch chkPreviewText\&quot;&gt;&lt;/span&gt;&lt;span class=\&quot;chkBoxLabel&quot;+&quot;\&quot;&gt;preview text&lt;/span&gt;\n\t\t&lt;span macro=\&quot;yourSearch newTiddlerButton\&quot;&gt;&lt;/span&gt;\n\t\t&lt;span macro=\&quot;yourSearch openAllButton\&quot;&gt;&lt;/span&gt;\n\t\t&lt;span macro=\&quot;yourSearch lin&quot;+&quot;kButton 'YourSearch Options' options 'Configure YourSearch'\&quot;&gt;&lt;/span&gt;\n\t\t&lt;span macro=\&quot;yourSearch linkB&quot;+&quot;utton 'YourSearch Help' help 'Get help how to use YourSearch'\&quot;&gt;&lt;/span&gt;\n\t\t&lt;span macro=\&quot;yourSearch clo&quot;+&quot;seButton\&quot;&gt;&lt;/span&gt;\n\t&lt;/td&gt;\n  &lt;/tr&gt;\n&lt;/tbody&gt;&lt;/table&gt;\n\n&lt;!-- The List of Found Tiddlers =================&quot;+&quot;=========================== --&gt;\n&lt;div id=\&quot;yourSearchResultItems\&quot; itemsPerPage=\&quot;25\&quot; itemsPerPageWithPr&quot;+&quot;eview=\&quot;10\&quot;&gt;&lt;/div&gt;\n\n&lt;!-- The Footer (with the Navigation) ===========================================&quot;+&quot;= --&gt;\n&lt;table class=\&quot;yourSearchFooter\&quot; border=\&quot;0\&quot; width=\&quot;100%\&quot; cellspacing=\&quot;0\&quot; cellpadding=\&quot;0\&quot;&gt;&lt;tbody&quot;+&quot;&gt;\n  &lt;tr&gt;\n\t&lt;td align=\&quot;left\&quot;&gt;\n\t\tResult page: &lt;span class=\&quot;yourSearchNaviBar\&quot; macro=\&quot;yourSearch naviBar&quot;+&quot;\&quot;&gt;&lt;/span&gt;\n\t&lt;/td&gt;\n\t&lt;td align=\&quot;right\&quot;&gt;&lt;span macro=\&quot;yourSearch version\&quot;&gt;&lt;/span&gt;, &lt;span macro=\&quot;yourSearc&quot;+&quot;h copyright\&quot;&gt;&lt;/span&gt;\n\t&lt;/td&gt;\n  &lt;/tr&gt;\n&lt;/tbody&gt;&lt;/table&gt;\n&lt;!-- end of the 'tiddlers found' case =========&quot;+&quot;================================== --&gt;\n&lt;/span&gt;\n\n\n&lt;!-- The \&quot;No tiddlers found\&quot; case =================&quot;+&quot;========================== --&gt;\n&lt;span macro=\&quot;yourSearch if not found\&quot;&gt;\n&lt;table class=\&quot;summary\&quot; border=&quot;+&quot;\&quot;0\&quot; width=\&quot;100%\&quot; cellspacing=\&quot;0\&quot; cellpadding=\&quot;0\&quot;&gt;&lt;tbody&gt;\n  &lt;tr&gt;\n\t&lt;td align=\&quot;left\&quot;&gt;\n\t\tYourSearch Resu&quot;+&quot;lt: No tiddlers found for &lt;span class=\&quot;yourSearchQuery\&quot; macro=\&quot;yourSearch query\&quot;&gt;&lt;/span&gt;.\n\t&lt;/td&gt;\n\t&lt;t&quot;+&quot;d class=\&quot;yourSearchButtons\&quot; align=\&quot;right\&quot;&gt;\n\t\t&lt;span macro=\&quot;yourSearch newTiddlerButton\&quot;&gt;&lt;/span&gt;\n\t\t&lt;span macro=\&quot;yourSearch linkButton 'YourSearch Options'&quot;+&quot; options 'Configure YourSearch'\&quot;&gt;&lt;/span&gt;\n\t\t&lt;span macro=\&quot;yourSearch linkButton 'YourSearch Help' help&quot;+&quot; 'Get help how to use YourSearch'\&quot;&gt;&lt;/span&gt;\n\t\t&lt;span macro=\&quot;yourSearch closeButton\&quot;&gt;&lt;/span&gt;\n\t&lt;/td&gt;\n  &lt;&quot;+&quot;/tr&gt;\n&lt;/tbody&gt;&lt;/table&gt;\n&lt;/span&gt;\n\n\n&lt;!--\n}}}\n--&gt;\n&quot;;config.shadowTiddlers[&quot;YourSearchItemTemplate&quot;]=&quot;&lt;!--\n{{{\n--&gt;\n&lt;span class='yourSearchNumber' macro='foundTiddler number'&gt;&lt;/span&gt;\n&lt;span class='yourSea&quot;+&quot;rchTitle' macro='foundTiddler title'/&gt;&lt;/span&gt;&amp;nbsp;-&amp;nbsp;\n&lt;span class='yourSearchTags' macro='found&quot;+&quot;Tiddler field tags 50'/&gt;&lt;/span&gt;\n&lt;span macro=\&quot;yourSearch if previewText\&quot;&gt;&lt;div class='yourSearchText' macro='fo&quot;+&quot;undTiddler field text 250'/&gt;&lt;/div&gt;&lt;/span&gt;\n&lt;!--\n}}}\n--&gt;&quot;;config.shadowTiddlers[&quot;YourSearch&quot;]=&quot;&lt;&lt;tiddler [[YourSearch Help]]&gt;&gt;&quot;;config.shadowTiddlers[&quot;YourSearch Result&quot;]=&quot;The popup-like window displaying the result of a YourSearch query.&quot;;config.macros.search.handler=_158;var _20c=function(){if(config.macros.search.handler!=_158){alert(&quot;Message from YourSearchPlugin:\n\n\nAnother plugin has disabled the 'Your Search' features.\n\n\nYou may &quot;+&quot;disable the other plugin or change the load order of \nthe plugins (by changing the names of the tidd&quot;+&quot;lers)\nto enable the 'Your Search' features.&quot;);}};setTimeout(_20c,5000);abego.YourSearch.getStandardRankFunction=function(){return _100;};abego.YourSearch.getRankFunction=function(){return abego.YourSearch.getStandardRankFunction();};abego.YourSearch.getCurrentTiddler=function(){return _13d;};abego.YourSearch.closeResult=function(){_12b();};abego.YourSearch.getFoundTiddlers=function(){return _f3;};abego.YourSearch.getQuery=function(){return _f4;};abego.YourSearch.onShowResult=function(_20d){highlightHack=_f4?_f4.getMarkRegExp():null;if(!_20d){_13e.setItems(_f7());}if(!_125){_125=createTiddlyElement(document.body,&quot;div&quot;,_122,&quot;yourSearchResult&quot;);}else{if(_125.parentNode!=document.body){document.body.appendChild(_125);}}_147();highlightHack=null;};})();}
//%/</pre>
</div>
</div>
<!--POST-STOREAREA-->
<!--POST-BODY-START-->
<!--POST-BODY-END-->
<script type="text/javascript">
//<![CDATA[
//
// Please note:
// 
// * This code is designed to be readable but for compactness it only includes brief comments. You can see fuller comments
//   in the project Subversion repository at http://svn.tiddlywiki.org/Trunk/core/
//
// * You should never need to modify this source code directly. TiddlyWiki is carefully designed to allow deep customisation
//   without changing the core code. Please consult the development group at http://groups.google.com/group/TiddlyWikiDev
// 

//--
//-- Configuration repository
//--

// Miscellaneous options
var config = {
	numRssItems: 20, // Number of items in the RSS feed
	animDuration: 400, // Duration of UI animations in milliseconds
	cascadeFast: 20, // Speed for cascade animations (higher == slower)
	cascadeSlow: 60, // Speed for EasterEgg cascade animations
	cascadeDepth: 5 // Depth of cascade animation
};

// Adaptors
config.adaptors = {};

// Backstage tasks
config.tasks = {};

// Annotations
config.annotations = {};

// Custom fields to be automatically added to new tiddlers
config.defaultCustomFields = {};

// Messages
config.messages = {
	messageClose: {},
	dates: {},
	tiddlerPopup: {}
};

// Options that can be set in the options panel and/or cookies
config.options = {
	chkRegExpSearch: false,
	chkCaseSensitiveSearch: false,
	chkAnimate: true,
	chkSaveBackups: true,
	chkAutoSave: false,
	chkGenerateAnRssFeed: false,
	chkSaveEmptyTemplate: false,
	chkOpenInNewWindow: true,
	chkToggleLinks: false,
	chkHttpReadOnly: true,
	chkForceMinorUpdate: false,
	chkConfirmDelete: true,
	chkInsertTabs: false,
	chkUsePreForStorage: true, // Whether to use <pre> format for storage
	chkDisplayStartupTime: false,
	txtBackupFolder: "",
	txtMainTab: "tabTimeline",
	txtMoreTab: "moreTabAll",
	txtMaxEditRows: "30",
	txtFileSystemCharSet: "UTF-8",
	txtTheme: ""
	};
config.optionsDesc = {};

// List of notification functions to be called when certain tiddlers are changed or deleted
config.notifyTiddlers = [
	{name: "StyleSheetLayout", notify: refreshStyles},
	{name: "StyleSheetColors", notify: refreshStyles},
	{name: "StyleSheet", notify: refreshStyles},
	{name: "StyleSheetPrint", notify: refreshStyles},
	{name: "PageTemplate", notify: refreshPageTemplate},
	{name: "SiteTitle", notify: refreshPageTitle},
	{name: "SiteSubtitle", notify: refreshPageTitle},
	{name: "ColorPalette", notify: refreshColorPalette},
	{name: null, notify: refreshDisplay}
];

// Default tiddler templates
var DEFAULT_VIEW_TEMPLATE = 1;
var DEFAULT_EDIT_TEMPLATE = 2;
config.tiddlerTemplates = {
	1: "ViewTemplate",
	2: "EditTemplate"
};

// More messages (rather a legacy layout that shouldn't really be like this)
config.views = {
	wikified: {
		tag: {}
	},
	editor: {
		tagChooser: {}
	}
};

// Backstage tasks
config.backstageTasks = ["save","sync","importTask","tweak","plugins"];

// Macros; each has a 'handler' member that is inserted later
config.macros = {
	today: {},
	version: {},
	search: {sizeTextbox: 15},
	tiddler: {},
	tag: {},
	tags: {},
	tagging: {},
	timeline: {},
	allTags: {},
	list: {
		all: {},
		missing: {},
		orphans: {},
		shadowed: {},
		touched: {},
		filter: {}
	},
	closeAll: {},
	permaview: {},
	saveChanges: {},
	slider: {},
	option: {},
	options: {},
	newTiddler: {},
	newJournal: {},
	tabs: {},
	gradient: {},
	message: {},
	view: {},
	edit: {},
	tagChooser: {},
	toolbar: {},
	plugins: {},
	refreshDisplay: {},
	importTiddlers: {},
	sync: {},
	annotations: {}
};

// Commands supported by the toolbar macro
config.commands = {
	closeTiddler: {},
	closeOthers: {},
	editTiddler: {},
	saveTiddler: {hideReadOnly: true},
	cancelTiddler: {},
	deleteTiddler: {hideReadOnly: true},
	permalink: {},
	references: {type: "popup"},
	jump: {type: "popup"},
	syncing: {type: "popup"},
	fields: {type: "popup"}
};

// Browser detection... In a very few places, there's nothing else for it but to know what browser we're using.
config.userAgent = navigator.userAgent.toLowerCase();
config.browser = {
	isIE: config.userAgent.indexOf("msie") != -1 && config.userAgent.indexOf("opera") == -1,
	isGecko: config.userAgent.indexOf("gecko") != -1,
	ieVersion: /MSIE (\d.\d)/i.exec(config.userAgent), // config.browser.ieVersion[1], if it exists, will be the IE version string, eg "6.0"
	isSafari: config.userAgent.indexOf("applewebkit") != -1,
	isBadSafari: !((new RegExp("[\u0150\u0170]","g")).test("\u0150")),
	firefoxDate: /gecko\/(\d{8})/i.exec(config.userAgent), // config.browser.firefoxDate[1], if it exists, will be Firefox release date as "YYYYMMDD"
	isOpera: config.userAgent.indexOf("opera") != -1,
	isLinux: config.userAgent.indexOf("linux") != -1,
	isUnix: config.userAgent.indexOf("x11") != -1,
	isMac: config.userAgent.indexOf("mac") != -1,
	isWindows: config.userAgent.indexOf("win") != -1
};

// Basic regular expressions
config.textPrimitives = {
	upperLetter: "[A-Z\u00c0-\u00de\u0150\u0170]",
	lowerLetter: "[a-z0-9_\\-\u00df-\u00ff\u0151\u0171]",
	anyLetter:   "[A-Za-z0-9_\\-\u00c0-\u00de\u00df-\u00ff\u0150\u0170\u0151\u0171]",
	anyLetterStrict: "[A-Za-z0-9\u00c0-\u00de\u00df-\u00ff\u0150\u0170\u0151\u0171]"
};
if(config.browser.isBadSafari) {
	config.textPrimitives = {
		upperLetter: "[A-Z\u00c0-\u00de]",
		lowerLetter: "[a-z0-9_\\-\u00df-\u00ff]",
		anyLetter:   "[A-Za-z0-9_\\-\u00c0-\u00de\u00df-\u00ff]",
		anyLetterStrict: "[A-Za-z0-9\u00c0-\u00de\u00df-\u00ff]"
	};
}
config.textPrimitives.sliceSeparator = "::";
config.textPrimitives.sectionSeparator = "##";
config.textPrimitives.urlPattern = "(?:file|http|https|mailto|ftp|irc|news|data):[^\\s'\"]+(?:/|\\b)";
config.textPrimitives.unWikiLink = "~";
config.textPrimitives.wikiLink = "(?:(?:" + config.textPrimitives.upperLetter + "+" +
	config.textPrimitives.lowerLetter + "+" +
	config.textPrimitives.upperLetter +
	config.textPrimitives.anyLetter + "*)|(?:" +
	config.textPrimitives.upperLetter + "{2,}" +
	config.textPrimitives.lowerLetter + "+))";

config.textPrimitives.cssLookahead = "(?:(" + config.textPrimitives.anyLetter + "+)\\(([^\\)\\|\\n]+)(?:\\):))|(?:(" + config.textPrimitives.anyLetter + "+):([^;\\|\\n]+);)";
config.textPrimitives.cssLookaheadRegExp = new RegExp(config.textPrimitives.cssLookahead,"mg");

config.textPrimitives.brackettedLink = "\\[\\[([^\\]]+)\\]\\]";
config.textPrimitives.titledBrackettedLink = "\\[\\[([^\\[\\]\\|]+)\\|([^\\[\\]\\|]+)\\]\\]";
config.textPrimitives.tiddlerForcedLinkRegExp = new RegExp("(?:" + config.textPrimitives.titledBrackettedLink + ")|(?:" +
	config.textPrimitives.brackettedLink + ")|(?:" +
	config.textPrimitives.urlPattern + ")","mg");
config.textPrimitives.tiddlerAnyLinkRegExp = new RegExp("("+ config.textPrimitives.wikiLink + ")|(?:" +
	config.textPrimitives.titledBrackettedLink + ")|(?:" +
	config.textPrimitives.brackettedLink + ")|(?:" +
	config.textPrimitives.urlPattern + ")","mg");

config.glyphs = {
	browsers: [
		function() {return config.browser.isIE;},
		function() {return true;}
	],
	currBrowser: null,
	codes: {
		downTriangle: ["\u25BC","\u25BE"],
		downArrow: ["\u2193","\u2193"],
		bentArrowLeft: ["\u2190","\u21A9"],
		bentArrowRight: ["\u2192","\u21AA"]
	}
};

//--
//-- Shadow tiddlers
//--

config.shadowTiddlers = {
	StyleSheet: "",
	MarkupPreHead: "",
	MarkupPostHead: "",
	MarkupPreBody: "",
	MarkupPostBody: "",
	TabTimeline: '<<timeline>>',
	TabAll: '<<list all>>',
	TabTags: '<<allTags excludeLists>>',
	TabMoreMissing: '<<list missing>>',
	TabMoreOrphans: '<<list orphans>>',
	TabMoreShadowed: '<<list shadowed>>',
	AdvancedOptions: '<<options>>',
	PluginManager: '<<plugins>>'
};

//--
//-- Translateable strings
//--

// Strings in "double quotes" should be translated; strings in 'single quotes' should be left alone

merge(config.options,{
	txtUserName: "YourName"});

merge(config.tasks,{
	save: {text: "save", tooltip: "Save your changes to this TiddlyWiki", action: saveChanges},
	sync: {text: "sync", tooltip: "Synchronise changes with other TiddlyWiki files and servers", content: '<<sync>>'},
	importTask: {text: "import", tooltip: "Import tiddlers and plugins from other TiddlyWiki files and servers", content: '<<importTiddlers>>'},
	tweak: {text: "tweak", tooltip: "Tweak the appearance and behaviour of TiddlyWiki", content: '<<options>>'},
	plugins: {text: "plugins", tooltip: "Manage installed plugins", content: '<<plugins>>'}
});

// Options that can be set in the options panel and/or cookies
merge(config.optionsDesc,{
	txtUserName: "Username for signing your edits",
	chkRegExpSearch: "Enable regular expressions for searches",
	chkCaseSensitiveSearch: "Case-sensitive searching",
	chkAnimate: "Enable animations",
	chkSaveBackups: "Keep backup file when saving changes",
	chkAutoSave: "Automatically save changes",
	chkGenerateAnRssFeed: "Generate an RSS feed when saving changes",
	chkSaveEmptyTemplate: "Generate an empty template when saving changes",
	chkOpenInNewWindow: "Open external links in a new window",
	chkToggleLinks: "Clicking on links to open tiddlers causes them to close",
	chkHttpReadOnly: "Hide editing features when viewed over HTTP",
	chkForceMinorUpdate: "Don't update modifier username and date when editing tiddlers",
	chkConfirmDelete: "Require confirmation before deleting tiddlers",
	chkInsertTabs: "Use the tab key to insert tab characters instead of moving between fields",
	txtBackupFolder: "Name of folder to use for backups",
	txtMaxEditRows: "Maximum number of rows in edit boxes",
	txtFileSystemCharSet: "Default character set for saving changes (Firefox/Mozilla only)"});

merge(config.messages,{
	customConfigError: "Problems were encountered loading plugins. See PluginManager for details",
	pluginError: "Error: %0",
	pluginDisabled: "Not executed because disabled via 'systemConfigDisable' tag",
	pluginForced: "Executed because forced via 'systemConfigForce' tag",
	pluginVersionError: "Not executed because this plugin needs a newer version of TiddlyWiki",
	nothingSelected: "Nothing is selected. You must select one or more items first",
	savedSnapshotError: "It appears that this TiddlyWiki has been incorrectly saved. Please see http://www.tiddlywiki.com/#DownloadSoftware for details",
	subtitleUnknown: "(unknown)",
	undefinedTiddlerToolTip: "The tiddler '%0' doesn't yet exist",
	shadowedTiddlerToolTip: "The tiddler '%0' doesn't yet exist, but has a pre-defined shadow value",
	tiddlerLinkTooltip: "%0 - %1, %2",
	externalLinkTooltip: "External link to %0",
	noTags: "There are no tagged tiddlers",
	notFileUrlError: "You need to save this TiddlyWiki to a file before you can save changes",
	cantSaveError: "It's not possible to save changes. Possible reasons include:\n- your browser doesn't support saving (Firefox, Internet Explorer, Safari and Opera all work if properly configured)\n- the pathname to your TiddlyWiki file contains illegal characters\n- the TiddlyWiki HTML file has been moved or renamed",
	invalidFileError: "The original file '%0' does not appear to be a valid TiddlyWiki",
	backupSaved: "Backup saved",
	backupFailed: "Failed to save backup file",
	rssSaved: "RSS feed saved",
	rssFailed: "Failed to save RSS feed file",
	emptySaved: "Empty template saved",
	emptyFailed: "Failed to save empty template file",
	mainSaved: "Main TiddlyWiki file saved",
	mainFailed: "Failed to save main TiddlyWiki file. Your changes have not been saved",
	macroError: "Error in macro <<\%0>>",
	macroErrorDetails: "Error while executing macro <<\%0>>:\n%1",
	missingMacro: "No such macro",
	overwriteWarning: "A tiddler named '%0' already exists. Choose OK to overwrite it",
	unsavedChangesWarning: "WARNING! There are unsaved changes in TiddlyWiki\n\nChoose OK to save\nChoose CANCEL to discard",
	confirmExit: "--------------------------------\n\nThere are unsaved changes in TiddlyWiki. If you continue you will lose those changes\n\n--------------------------------",
	saveInstructions: "SaveChanges",
	unsupportedTWFormat: "Unsupported TiddlyWiki format '%0'",
	tiddlerSaveError: "Error when saving tiddler '%0'",
	tiddlerLoadError: "Error when loading tiddler '%0'",
	wrongSaveFormat: "Cannot save with storage format '%0'. Using standard format for save.",
	invalidFieldName: "Invalid field name %0",
	fieldCannotBeChanged: "Field '%0' cannot be changed",
	loadingMissingTiddler: "Attempting to retrieve the tiddler '%0' from the '%1' server at:\n\n'%2' in the workspace '%3'"});

merge(config.messages.messageClose,{
	text: "close",
	tooltip: "close this message area"});

config.messages.backstage = {
	open: {text: "backstage", tooltip: "Open the backstage area to perform authoring and editing tasks"},
	close: {text: "close", tooltip: "Close the backstage area"},
	prompt: "backstage: ",
	decal: {
		edit: {text: "edit", tooltip: "Edit the tiddler '%0'"}
	}
};

config.messages.listView = {
	tiddlerTooltip: "Click for the full text of this tiddler",
	previewUnavailable: "(preview not available)"
};

config.messages.dates.months = ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November","December"];
config.messages.dates.days = ["Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"];
config.messages.dates.shortMonths = ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"];
config.messages.dates.shortDays = ["Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat"];
// suffixes for dates, eg "1st","2nd","3rd"..."30th","31st"
config.messages.dates.daySuffixes = ["st","nd","rd","th","th","th","th","th","th","th",
		"th","th","th","th","th","th","th","th","th","th",
		"st","nd","rd","th","th","th","th","th","th","th",
		"st"];
config.messages.dates.am = "am";
config.messages.dates.pm = "pm";

merge(config.messages.tiddlerPopup,{
	});

merge(config.views.wikified.tag,{
	labelNoTags: "no tags",
	labelTags: "tags: ",
	openTag: "Open tag '%0'",
	tooltip: "Show tiddlers tagged with '%0'",
	openAllText: "Open all",
	openAllTooltip: "Open all of these tiddlers",
	popupNone: "No other tiddlers tagged with '%0'"});

merge(config.views.wikified,{
	defaultText: "The tiddler '%0' doesn't yet exist. Double-click to create it",
	defaultModifier: "(missing)",
	shadowModifier: "(built-in shadow tiddler)",
	dateFormat: "DD MMM YYYY",
	createdPrompt: "created"});

merge(config.views.editor,{
	tagPrompt: "Type tags separated with spaces, [[use double square brackets]] if necessary, or add existing",
	defaultText: "Type the text for '%0'"});

merge(config.views.editor.tagChooser,{
	text: "tags",
	tooltip: "Choose existing tags to add to this tiddler",
	popupNone: "There are no tags defined",
	tagTooltip: "Add the tag '%0'"});

merge(config.messages,{
	sizeTemplates:
		[
		{unit: 1024*1024*1024, template: "%0\u00a0GB"},
		{unit: 1024*1024, template: "%0\u00a0MB"},
		{unit: 1024, template: "%0\u00a0KB"},
		{unit: 1, template: "%0\u00a0B"}
		]});

merge(config.macros.search,{
	label: "search",
	prompt: "Search this TiddlyWiki",
	accessKey: "F",
	successMsg: "%0 tiddlers found matching %1",
	failureMsg: "No tiddlers found matching %0"});

merge(config.macros.tagging,{
	label: "tagging: ",
	labelNotTag: "not tagging",
	tooltip: "List of tiddlers tagged with '%0'"});

merge(config.macros.timeline,{
	dateFormat: "DD MMM YYYY"});

merge(config.macros.allTags,{
	tooltip: "Show tiddlers tagged with '%0'",
	noTags: "There are no tagged tiddlers"});

config.macros.list.all.prompt = "All tiddlers in alphabetical order";
config.macros.list.missing.prompt = "Tiddlers that have links to them but are not defined";
config.macros.list.orphans.prompt = "Tiddlers that are not linked to from any other tiddlers";
config.macros.list.shadowed.prompt = "Tiddlers shadowed with default contents";
config.macros.list.touched.prompt = "Tiddlers that have been modified locally";

merge(config.macros.closeAll,{
	label: "close all",
	prompt: "Close all displayed tiddlers (except any that are being edited)"});

merge(config.macros.permaview,{
	label: "permaview",
	prompt: "Link to an URL that retrieves all the currently displayed tiddlers"});

merge(config.macros.saveChanges,{
	label: "save changes",
	prompt: "Save all tiddlers to create a new TiddlyWiki",
	accessKey: "S"});

merge(config.macros.newTiddler,{
	label: "new tiddler",
	prompt: "Create a new tiddler",
	title: "New Tiddler",
	accessKey: "N"});

merge(config.macros.newJournal,{
	label: "new journal",
	prompt: "Create a new tiddler from the current date and time",
	accessKey: "J"});

merge(config.macros.options,{
	wizardTitle: "Tweak advanced options",
	step1Title: "These options are saved in cookies in your browser",
	step1Html: "<input type='hidden' name='markList'></input><br><input type='checkbox' checked='false' name='chkUnknown'>Show unknown options</input>",
	unknownDescription: "//(unknown)//",
	listViewTemplate: {
		columns: [
			{name: 'Option', field: 'option', title: "Option", type: 'String'},
			{name: 'Description', field: 'description', title: "Description", type: 'WikiText'},
			{name: 'Name', field: 'name', title: "Name", type: 'String'}
			],
		rowClasses: [
			{className: 'lowlight', field: 'lowlight'}
			]}
	});

merge(config.macros.plugins,{
	wizardTitle: "Manage plugins",
	step1Title: "Currently loaded plugins",
	step1Html: "<input type='hidden' name='markList'></input>", // DO NOT TRANSLATE
	skippedText: "(This plugin has not been executed because it was added since startup)",
	noPluginText: "There are no plugins installed",
	confirmDeleteText: "Are you sure you want to delete these plugins:\n\n%0",
	removeLabel: "remove systemConfig tag",
	removePrompt: "Remove systemConfig tag",
	deleteLabel: "delete",
	deletePrompt: "Delete these tiddlers forever",
	listViewTemplate: {
		columns: [
			{name: 'Selected', field: 'Selected', rowName: 'title', type: 'Selector'},
			{name: 'Tiddler', field: 'tiddler', title: "Tiddler", type: 'Tiddler'},
			{name: 'Size', field: 'size', tiddlerLink: 'size', title: "Size", type: 'Size'},
			{name: 'Forced', field: 'forced', title: "Forced", tag: 'systemConfigForce', type: 'TagCheckbox'},
			{name: 'Disabled', field: 'disabled', title: "Disabled", tag: 'systemConfigDisable', type: 'TagCheckbox'},
			{name: 'Executed', field: 'executed', title: "Loaded", type: 'Boolean', trueText: "Yes", falseText: "No"},
			{name: 'Startup Time', field: 'startupTime', title: "Startup Time", type: 'String'},
			{name: 'Error', field: 'error', title: "Status", type: 'Boolean', trueText: "Error", falseText: "OK"},
			{name: 'Log', field: 'log', title: "Log", type: 'StringList'}
			],
		rowClasses: [
			{className: 'error', field: 'error'},
			{className: 'warning', field: 'warning'}
			]}
	});

merge(config.macros.toolbar,{
	moreLabel: "more",
	morePrompt: "Reveal further commands"
	});

merge(config.macros.refreshDisplay,{
	label: "refresh",
	prompt: "Redraw the entire TiddlyWiki display"
	});

merge(config.macros.importTiddlers,{
	readOnlyWarning: "You cannot import into a read-only TiddlyWiki file. Try opening it from a file:// URL",
	wizardTitle: "Import tiddlers from another file or server",
	step1Title: "Step 1: Locate the server or TiddlyWiki file",
	step1Html: "Specify the type of the server: <select name='selTypes'><option value=''>Choose...</option></select><br>Enter the URL or pathname here: <input type='text' size=50 name='txtPath'><br>...or browse for a file: <input type='file' size=50 name='txtBrowse'><br><hr>...or select a pre-defined feed: <select name='selFeeds'><option value=''>Choose...</option></select>",
	openLabel: "open",
	openPrompt: "Open the connection to this file or server",
	openError: "There were problems fetching the tiddlywiki file",
	statusOpenHost: "Opening the host",
	statusGetWorkspaceList: "Getting the list of available workspaces",
	step2Title: "Step 2: Choose the workspace",
	step2Html: "Enter a workspace name: <input type='text' size=50 name='txtWorkspace'><br>...or select a workspace: <select name='selWorkspace'><option value=''>Choose...</option></select>",
	cancelLabel: "cancel",
	cancelPrompt: "Cancel this import",
	statusOpenWorkspace: "Opening the workspace",
	statusGetTiddlerList: "Getting the list of available tiddlers",
	step3Title: "Step 3: Choose the tiddlers to import",
	step3Html: "<input type='hidden' name='markList'></input><br><input type='checkbox' checked='true' name='chkSync'>Keep these tiddlers linked to this server so that you can synchronise subsequent changes</input><br><input type='checkbox' name='chkSave'>Save the details of this server in a 'systemServer' tiddler called:</input> <input type='text' size=25 name='txtSaveTiddler'>",
	importLabel: "import",
	importPrompt: "Import these tiddlers",
	confirmOverwriteText: "Are you sure you want to overwrite these tiddlers:\n\n%0",
	step4Title: "Step 4: Importing %0 tiddler(s)",
	step4Html: "<input type='hidden' name='markReport'></input>", // DO NOT TRANSLATE
	doneLabel: "done",
	donePrompt: "Close this wizard",
	statusDoingImport: "Importing tiddlers",
	statusDoneImport: "All tiddlers imported",
	systemServerNamePattern: "%2 on %1",
	systemServerNamePatternNoWorkspace: "%1",
	confirmOverwriteSaveTiddler: "The tiddler '%0' already exists. Click 'OK' to overwrite it with the details of this server, or 'Cancel' to leave it unchanged",
	serverSaveTemplate: "|''Type:''|%0|\n|''URL:''|%1|\n|''Workspace:''|%2|\n\nThis tiddler was automatically created to record the details of this server",
	serverSaveModifier: "(System)",
	listViewTemplate: {
		columns: [
			{name: 'Selected', field: 'Selected', rowName: 'title', type: 'Selector'},
			{name: 'Tiddler', field: 'tiddler', title: "Tiddler", type: 'Tiddler'},
			{name: 'Size', field: 'size', tiddlerLink: 'size', title: "Size", type: 'Size'},
			{name: 'Tags', field: 'tags', title: "Tags", type: 'Tags'}
			],
		rowClasses: [
			]}
	});

merge(config.macros.sync,{
	listViewTemplate: {
		columns: [
			{name: 'Selected', field: 'selected', rowName: 'title', type: 'Selector'},
			{name: 'Tiddler', field: 'tiddler', title: "Tiddler", type: 'Tiddler'},
			{name: 'Server Type', field: 'serverType', title: "Server type", type: 'String'},
			{name: 'Server Host', field: 'serverHost', title: "Server host", type: 'String'},
			{name: 'Server Workspace', field: 'serverWorkspace', title: "Server workspace", type: 'String'},
			{name: 'Status', field: 'status', title: "Synchronisation status", type: 'String'},
			{name: 'Server URL', field: 'serverUrl', title: "Server URL", text: "View", type: 'Link'}
			],
		rowClasses: [
			],
		buttons: [
			{caption: "Sync these tiddlers", name: 'sync'}
			]},
	wizardTitle: "Synchronize with external servers and files",
	step1Title: "Choose the tiddlers you want to synchronize",
	step1Html: "<input type='hidden' name='markList'></input>", // DO NOT TRANSLATE
	syncLabel: "sync",
	syncPrompt: "Sync these tiddlers",
	hasChanged: "Changed while unplugged",
	hasNotChanged: "Unchanged while unplugged",
	syncStatusList: {
		none: {text: "...", color: "transparent"},
		changedServer: {text: "Changed on server", color: '#80ff80'},
		changedLocally: {text: "Changed while unplugged", color: '#80ff80'},
		changedBoth: {text: "Changed while unplugged and on server", color: '#ff8080'},
		notFound: {text: "Not found on server", color: '#ffff80'},
		putToServer: {text: "Saved update on server", color: '#ff80ff'},
		gotFromServer: {text: "Retrieved update from server", color: '#80ffff'}
		}
	});

merge(config.macros.annotations,{
	});

merge(config.commands.closeTiddler,{
	text: "close",
	tooltip: "Close this tiddler"});

merge(config.commands.closeOthers,{
	text: "close others",
	tooltip: "Close all other tiddlers"});

merge(config.commands.editTiddler,{
	text: "edit",
	tooltip: "Edit this tiddler",
	readOnlyText: "view",
	readOnlyTooltip: "View the source of this tiddler"});

merge(config.commands.saveTiddler,{
	text: "done",
	tooltip: "Save changes to this tiddler"});

merge(config.commands.cancelTiddler,{
	text: "cancel",
	tooltip: "Undo changes to this tiddler",
	warning: "Are you sure you want to abandon your changes to '%0'?",
	readOnlyText: "done",
	readOnlyTooltip: "View this tiddler normally"});

merge(config.commands.deleteTiddler,{
	text: "delete",
	tooltip: "Delete this tiddler",
	warning: "Are you sure you want to delete '%0'?"});

merge(config.commands.permalink,{
	text: "permalink",
	tooltip: "Permalink for this tiddler"});

merge(config.commands.references,{
	text: "references",
	tooltip: "Show tiddlers that link to this one",
	popupNone: "No references"});

merge(config.commands.jump,{
	text: "jump",
	tooltip: "Jump to another open tiddler"});

merge(config.commands.syncing,{
	text: "syncing",
	tooltip: "Control synchronisation of this tiddler with a server or external file",
	currentlySyncing: "<div>Currently syncing via <span class='popupHighlight'>'%0'</span> to:</"+"div><div>host: <span class='popupHighlight'>%1</span></"+"div><div>workspace: <span class='popupHighlight'>%2</span></"+"div>", // Note escaping of closing <div> tag
	notCurrentlySyncing: "Not currently syncing",
	captionUnSync: "Stop synchronising this tiddler",
	chooseServer: "Synchronise this tiddler with another server:",
	currServerMarker: "\u25cf ",
	notCurrServerMarker: "  "});

merge(config.commands.fields,{
	text: "fields",
	tooltip: "Show the extended fields of this tiddler",
	emptyText: "There are no extended fields for this tiddler",
	listViewTemplate: {
		columns: [
			{name: 'Field', field: 'field', title: "Field", type: 'String'},
			{name: 'Value', field: 'value', title: "Value", type: 'String'}
			],
		rowClasses: [
			],
		buttons: [
			]}});

merge(config.shadowTiddlers,{
	DefaultTiddlers: "GettingStarted",
	MainMenu: "GettingStarted",
	SiteTitle: "My TiddlyWiki",
	SiteSubtitle: "a reusable non-linear personal web notebook",
	SiteUrl: "http://www.tiddlywiki.com/",
	SideBarOptions: '<<search>><<closeAll>><<permaview>><<newTiddler>><<newJournal "DD MMM YYYY" "journal">><<saveChanges>><<slider chkSliderOptionsPanel OptionsPanel "options " "Change TiddlyWiki advanced options">>',
	SideBarTabs: '<<tabs txtMainTab "Timeline" "Timeline" TabTimeline "All" "All tiddlers" TabAll "Tags" "All tags" TabTags "More" "More lists" TabMore>>',
	TabMore: '<<tabs txtMoreTab "Missing" "Missing tiddlers" TabMoreMissing "Orphans" "Orphaned tiddlers" TabMoreOrphans "Shadowed" "Shadowed tiddlers" TabMoreShadowed>>'});

merge(config.annotations,{
	AdvancedOptions: "This shadow tiddler provides access to several advanced options",
	ColorPalette: "These values in this shadow tiddler determine the colour scheme of the ~TiddlyWiki user interface",
	DefaultTiddlers: "The tiddlers listed in this shadow tiddler will be automatically displayed when ~TiddlyWiki starts up",
	EditTemplate: "The HTML template in this shadow tiddler determines how tiddlers look while they are being edited",
	GettingStarted: "This shadow tiddler provides basic usage instructions",
	ImportTiddlers: "This shadow tiddler provides access to importing tiddlers",
	MainMenu: "This shadow tiddler is used as the contents of the main menu in the left-hand column of the screen",
	MarkupPreHead: "This tiddler is inserted at the top of the <head> section of the TiddlyWiki HTML file",
	MarkupPostHead: "This tiddler is inserted at the bottom of the <head> section of the TiddlyWiki HTML file",
	MarkupPreBody: "This tiddler is inserted at the top of the <body> section of the TiddlyWiki HTML file",
	MarkupPostBody: "This tiddler is inserted at the end of the <body> section of the TiddlyWiki HTML file immediately before the script block",
	OptionsPanel: "This shadow tiddler is used as the contents of the options panel slider in the right-hand sidebar",
	PageTemplate: "The HTML template in this shadow tiddler determines the overall ~TiddlyWiki layout",
	PluginManager: "This shadow tiddler provides access to the plugin manager",
	SideBarOptions: "This shadow tiddler is used as the contents of the option panel in the right-hand sidebar",
	SideBarTabs: "This shadow tiddler is used as the contents of the tabs panel in the right-hand sidebar",
	SiteSubtitle: "This shadow tiddler is used as the second part of the page title",
	SiteTitle: "This shadow tiddler is used as the first part of the page title",
	SiteUrl: "This shadow tiddler should be set to the full target URL for publication",
	StyleSheetColors: "This shadow tiddler contains CSS definitions related to the color of page elements. ''DO NOT EDIT THIS TIDDLER'', instead make your changes in the StyleSheet shadow tiddler.",
	StyleSheet: "This tiddler can contain custom CSS definitions",
	StyleSheetLayout: "This shadow tiddler contains CSS definitions related to the layout of page elements. ''DO NOT EDIT THIS TIDDLER'', instead make your changes in the StyleSheet shadow tiddler.",
	StyleSheetLocale: "This shadow tiddler contains CSS definitions related to the translation locale",
	StyleSheetPrint: "This shadow tiddler contains CSS definitions for printing",
	TabAll: "This shadow tiddler contains the contents of the 'All' tab in the right-hand sidebar",
	TabMore: "This shadow tiddler contains the contents of the 'More' tab in the right-hand sidebar",
	TabMoreMissing: "This shadow tiddler contains the contents of the 'Missing' tab in the right-hand sidebar",
	TabMoreOrphans: "This shadow tiddler contains the contents of the 'Orphans' tab in the right-hand sidebar",
	TabMoreShadowed: "This shadow tiddler contains the contents of the 'Shadowed' tab in the right-hand sidebar",
	TabTags: "This shadow tiddler contains the contents of the 'Tags' tab in the right-hand sidebar",
	TabTimeline: "This shadow tiddler contains the contents of the 'Timeline' tab in the right-hand sidebar",
	ViewTemplate: "The HTML template in this shadow tiddler determines how tiddlers look"
	});

//--
//-- Main
//--

var params = null; // Command line parameters
var store = null; // TiddlyWiki storage
var story = null; // Main story
var formatter = null; // Default formatters for the wikifier
config.parsers = {}; // Hashmap of alternative parsers for the wikifier
var anim = typeof Animator == "function" ? new Animator() : null; // Animation engine
var readOnly = false; // Whether we're in readonly mode
var highlightHack = null; // Embarrassing hack department...
var hadConfirmExit = false; // Don't warn more than once
var safeMode = false; // Disable all plugins and cookies
var showBackstage; // Whether to include the backstage area
var installedPlugins = []; // Information filled in when plugins are executed
var startingUp = false; // Whether we're in the process of starting up
var pluginInfo,tiddler; // Used to pass information to plugins in loadPlugins()

// Whether to use the JavaSaver applet
var useJavaSaver = config.browser.isSafari || config.browser.isOpera;

// Starting up
function main()
{
	var t10,t9,t8,t7,t6,t5,t4,t3,t2,t1,t0 = new Date();
	startingUp = true;
	window.onbeforeunload = function(e) {if(window.confirmExit) return confirmExit();};
	params = getParameters();
	if(params)
		params = params.parseParams("open",null,false);
	store = new TiddlyWiki();
	invokeParamifier(params,"oninit");
	story = new Story("tiddlerDisplay","tiddler");
	addEvent(document,"click",Popup.onDocumentClick);
	saveTest();
	loadOptionsCookie();
	for(var s=0; s<config.notifyTiddlers.length; s++)
		store.addNotification(config.notifyTiddlers[s].name,config.notifyTiddlers[s].notify);
	t1 = new Date();
	store.loadFromDiv("storeArea","store",true);
	t2 = new Date();
	loadShadowTiddlers();
	t3 = new Date();
	invokeParamifier(params,"onload");
	t4 = new Date();
	readOnly = (window.location.protocol == "file:") ? false : config.options.chkHttpReadOnly;
	showBackstage = !readOnly;
	var pluginProblem = loadPlugins();
	t5 = new Date();
	formatter = new Formatter(config.formatters);
	story.switchTheme(config.options.txtTheme);
	invokeParamifier(params,"onconfig");
	t6 = new Date();
	store.notifyAll();
	t7 = new Date();
	restart();
	t8 = new Date();
	if(pluginProblem) {
		story.displayTiddler(null,"PluginManager");
		displayMessage(config.messages.customConfigError);
	}
	for(var m in config.macros) {
		if(config.macros[m].init)
			config.macros[m].init();
	}
	t9 = new Date();
	if(showBackstage)
		backstage.init();
	t10 = new Date();
	if(config.options.chkDisplayStartupTime) {
		displayMessage("LoadFromDiv " + (t2-t1) + " ms");
		displayMessage("LoadShadows " + (t3-t2) + " ms");
		displayMessage("LoadPlugins " + (t5-t4) + " ms");
		displayMessage("Notify " + (t7-t6) + " ms");
		displayMessage("Restart " + (t8-t7) + " ms");
		displayMessage("Macro init " + (t9-t8) + " ms");
		displayMessage("Total: " + (t10-t0) + " ms");
	}
	startingUp = false;
}

// Restarting
function restart()
{
	invokeParamifier(params,"onstart");
	if(story.isEmpty()) {
		var tiddlers = store.filterTiddlers(store.getTiddlerText("DefaultTiddlers"));
		story.displayTiddlers(null,tiddlers);
	}
	window.scrollTo(0,0);
}

function saveTest()
{
	var s = document.getElementById("saveTest");
	if(s.hasChildNodes())
		alert(config.messages.savedSnapshotError);
	s.appendChild(document.createTextNode("savetest"));
}

function loadShadowTiddlers()
{
	var shadows = new TiddlyWiki();
	shadows.loadFromDiv("shadowArea","shadows",true);
	shadows.forEachTiddler(function(title,tiddler){config.shadowTiddlers[title] = tiddler.text;});
	delete shadows;
}

function loadPlugins()
{
	if(safeMode)
		return false;
	var tiddlers = store.getTaggedTiddlers("systemConfig");
	var toLoad = [];
	var nLoaded = 0;
	var map = {};
	var nPlugins = tiddlers.length;
	installedPlugins = [];
	for(var i=0; i<nPlugins; i++) {
		var p = getPluginInfo(tiddlers[i]);
		installedPlugins[i] = p;
		var n = p.Name;
		if(n)
			map[n] = p;
		n = p.Source;
		if(n)
			map[n] = p;
	}
	var visit = function(p) {
		if(!p || p.done)
			return;
		p.done = 1;
		var reqs = p.Requires;
		if(reqs) {
			reqs = reqs.readBracketedList();
			for(var i=0; i<reqs.length; i++)
				visit(map[reqs[i]]);
		}
		toLoad.push(p);
	};
	for(i=0; i<nPlugins; i++)
		visit(installedPlugins[i]);
	for(i=0; i<toLoad.length; i++) {
		p = toLoad[i];
		pluginInfo = p;
		tiddler = p.tiddler;
		if(isPluginExecutable(p)) {
			if(isPluginEnabled(p)) {
				p.executed = true;
				var startTime = new Date();
				try {
					if(tiddler.text)
						window.eval(tiddler.text);
					nLoaded++;
				} catch(ex) {
					p.log.push(config.messages.pluginError.format([exceptionText(ex)]));
					p.error = true;
				}
				pluginInfo.startupTime = String((new Date()) - startTime) + "ms";
			} else {
				nPlugins--;
			}
		} else {
			p.warning = true;
		}
	}
	return nLoaded != nPlugins;
}

function getPluginInfo(tiddler)
{
	var p = store.getTiddlerSlices(tiddler.title,["Name","Description","Version","Requires","CoreVersion","Date","Source","Author","License","Browsers"]);
	p.tiddler = tiddler;
	p.title = tiddler.title;
	p.log = [];
	return p;
}

// Check that a particular plugin is valid for execution
function isPluginExecutable(plugin)
{
	if(plugin.tiddler.isTagged("systemConfigForce"))
		return verifyTail(plugin,true,config.messages.pluginForced);
	if(plugin["CoreVersion"]) {
		var coreVersion = plugin["CoreVersion"].split(".");
		var w = parseInt(coreVersion[0]) - version.major;
		if(w == 0 && coreVersion[1])
			w = parseInt(coreVersion[1]) - version.minor;
		if(w == 0 && coreVersion[2])
		 	w = parseInt(coreVersion[2]) - version.revision;
		if(w > 0)
			return verifyTail(plugin,false,config.messages.pluginVersionError);
		}
	return true;
}

function isPluginEnabled(plugin)
{
	if(plugin.tiddler.isTagged("systemConfigDisable"))
		return verifyTail(plugin,false,config.messages.pluginDisabled);
	return true;
}

function verifyTail(plugin,result,message)
{
	plugin.log.push(message);
	return result;
}

function invokeMacro(place,macro,params,wikifier,tiddler)
{
	try {
		var m = config.macros[macro];
		if(m && m.handler)
			m.handler(place,macro,params.readMacroParams(),wikifier,params,tiddler);
		else
			createTiddlyError(place,config.messages.macroError.format([macro]),config.messages.macroErrorDetails.format([macro,config.messages.missingMacro]));
	} catch(ex) {
		createTiddlyError(place,config.messages.macroError.format([macro]),config.messages.macroErrorDetails.format([macro,ex.toString()]));
	}
}

//--
//-- Paramifiers
//--

function getParameters()
{
	var p = null;
	if(window.location.hash) {
		p = decodeURI(window.location.hash.substr(1));
		if(config.browser.firefoxDate != null && config.browser.firefoxDate[1] < "20051111")
			p = convertUTF8ToUnicode(p);
	}
	return p;
}

function invokeParamifier(params,handler)
{
	if(!params || params.length == undefined || params.length <= 1)
		return;
	for(var t=1; t<params.length; t++) {
		var p = config.paramifiers[params[t].name];
		if(p && p[handler] instanceof Function)
			p[handler](params[t].value);
	}
}

config.paramifiers = {};

config.paramifiers.start = {
	oninit: function(v) {
		safeMode = v.toLowerCase() == "safe";
	}
};

config.paramifiers.open = {
	onstart: function(v) {
		story.displayTiddler("bottom",v,null,false,null);
	}
};

config.paramifiers.story = {
	onstart: function(v) {
		var list = store.getTiddlerText(v,"").parseParams("open",null,false);
		invokeParamifier(list,"onstart");
	}
};

config.paramifiers.search = {
	onstart: function(v) {
		story.search(v,false,false);
	}
};

config.paramifiers.searchRegExp = {
	onstart: function(v) {
		story.prototype.search(v,false,true);
	}
};

config.paramifiers.tag = {
	onstart: function(v) {
		var tagged = store.getTaggedTiddlers(v,"title");
		story.displayTiddlers(null,tagged,null,false,null);
	}
};

config.paramifiers.newTiddler = {
	onstart: function(v) {
		if(!readOnly) {
			story.displayTiddler(null,v,DEFAULT_EDIT_TEMPLATE);
			story.focusTiddler(v,"text");
		}
	}
};

config.paramifiers.newJournal = {
	onstart: function(v) {
		if(!readOnly) {
			var now = new Date();
			var title = now.formatString(v.trim());
			story.displayTiddler(null,title,DEFAULT_EDIT_TEMPLATE);
			story.focusTiddler(title,"text");
		}
	}
};

config.paramifiers.readOnly = {
	onconfig: function(v) {
		var p = v.toLowerCase();
		readOnly = p == "yes" ? true : (p == "no" ? false : readOnly);
	}
};


config.paramifiers.theme = {
	onconfig: function(v) {
		story.switchTheme(v);
	}
};

//--
//-- Formatter helpers
//--

function Formatter(formatters)
{
	this.formatters = [];
	var pattern = [];
	for(var n=0; n<formatters.length; n++) {
		pattern.push("(" + formatters[n].match + ")");
		this.formatters.push(formatters[n]);
	}
	this.formatterRegExp = new RegExp(pattern.join("|"),"mg");
}

config.formatterHelpers = {

	createElementAndWikify: function(w)
	{
		w.subWikifyTerm(createTiddlyElement(w.output,this.element),this.termRegExp);
	},

	inlineCssHelper: function(w)
	{
		var styles = [];
		config.textPrimitives.cssLookaheadRegExp.lastIndex = w.nextMatch;
		var lookaheadMatch = config.textPrimitives.cssLookaheadRegExp.exec(w.source);
		while(lookaheadMatch && lookaheadMatch.index == w.nextMatch) {
			var s,v;
			if(lookaheadMatch[1]) {
				s = lookaheadMatch[1].unDash();
				v = lookaheadMatch[2];
			} else {
				s = lookaheadMatch[3].unDash();
				v = lookaheadMatch[4];
			}
			if (s=="bgcolor")
				s = "backgroundColor";
			styles.push({style: s, value: v});
			w.nextMatch = lookaheadMatch.index + lookaheadMatch[0].length;
			config.textPrimitives.cssLookaheadRegExp.lastIndex = w.nextMatch;
			lookaheadMatch = config.textPrimitives.cssLookaheadRegExp.exec(w.source);
		}
		return styles;
	},

	applyCssHelper: function(e,styles)
	{
		for(var t=0; t< styles.length; t++) {
			try {
				e.style[styles[t].style] = styles[t].value;
			} catch (ex) {
			}
		}
	},

	enclosedTextHelper: function(w)
	{
		this.lookaheadRegExp.lastIndex = w.matchStart;
		var lookaheadMatch = this.lookaheadRegExp.exec(w.source);
		if(lookaheadMatch && lookaheadMatch.index == w.matchStart) {
			var text = lookaheadMatch[1];
			if(config.browser.isIE)
				text = text.replace(/\n/g,"\r");
			createTiddlyElement(w.output,this.element,null,null,text);
			w.nextMatch = lookaheadMatch.index + lookaheadMatch[0].length;
		}
	},

	isExternalLink: function(link)
	{
		if(store.tiddlerExists(link) || store.isShadowTiddler(link)) {
			return false;
		}
		var urlRegExp = new RegExp(config.textPrimitives.urlPattern,"mg");
		if(urlRegExp.exec(link)) {
			return true;
		}
		if (link.indexOf(".")!=-1 || link.indexOf("\\")!=-1 || link.indexOf("/")!=-1 || link.indexOf("#")!=-1) {
			return true;
		}
		return false;
	}

};

//--
//-- Standard formatters
//--

config.formatters = [
{
	name: "table",
	match: "^\\|(?:[^\\n]*)\\|(?:[fhck]?)$",
	lookaheadRegExp: /^\|([^\n]*)\|([fhck]?)$/mg,
	rowTermRegExp: /(\|(?:[fhck]?)$\n?)/mg,
	cellRegExp: /(?:\|([^\n\|]*)\|)|(\|[fhck]?$\n?)/mg,
	cellTermRegExp: /((?:\x20*)\|)/mg,
	rowTypes: {"c":"caption", "h":"thead", "":"tbody", "f":"tfoot"},
	handler: function(w)
	{
		var table = createTiddlyElement(w.output,"table",null,"twtable");
		var prevColumns = [];
		var currRowType = null;
		var rowContainer;
		var rowCount = 0;
		w.nextMatch = w.matchStart;
		this.lookaheadRegExp.lastIndex = w.nextMatch;
		var lookaheadMatch = this.lookaheadRegExp.exec(w.source);
		while(lookaheadMatch && lookaheadMatch.index == w.nextMatch) {
			var nextRowType = lookaheadMatch[2];
			if(nextRowType == "k") {
				table.className = lookaheadMatch[1];
				w.nextMatch += lookaheadMatch[0].length+1;
			} else {
				if(nextRowType != currRowType) {
					rowContainer = createTiddlyElement(table,this.rowTypes[nextRowType]);
					currRowType = nextRowType;
				}
				if(currRowType == "c") {
					// Caption
					w.nextMatch++;
					if(rowContainer != table.firstChild)
						table.insertBefore(rowContainer,table.firstChild);
					rowContainer.setAttribute("align",rowCount == 0?"top":"bottom");
					w.subWikifyTerm(rowContainer,this.rowTermRegExp);
				} else {
					var theRow = createTiddlyElement(rowContainer,"tr",null,(rowCount&1)?"oddRow":"evenRow");
					theRow.onmouseover = function() {addClass(this,"hoverRow");};
					theRow.onmouseout = function() {removeClass(this,"hoverRow");};
					this.rowHandler(w,theRow,prevColumns);
					rowCount++;
				}
			}
			this.lookaheadRegExp.lastIndex = w.nextMatch;
			lookaheadMatch = this.lookaheadRegExp.exec(w.source);
		}
	},
	rowHandler: function(w,e,prevColumns)
	{
		var col = 0;
		var colSpanCount = 1;
		var prevCell = null;
		this.cellRegExp.lastIndex = w.nextMatch;
		var cellMatch = this.cellRegExp.exec(w.source);
		while(cellMatch && cellMatch.index == w.nextMatch) {
			if(cellMatch[1] == "~") {
				// Rowspan
				var last = prevColumns[col];
				if(last) {
					last.rowSpanCount++;
					last.element.setAttribute("rowspan",last.rowSpanCount);
					last.element.setAttribute("rowSpan",last.rowSpanCount); // Needed for IE
					last.element.valign = "center";
				}
				w.nextMatch = this.cellRegExp.lastIndex-1;
			} else if(cellMatch[1] == ">") {
				// Colspan
				colSpanCount++;
				w.nextMatch = this.cellRegExp.lastIndex-1;
			} else if(cellMatch[2]) {
				// End of row
				if(prevCell && colSpanCount > 1) {
					prevCell.setAttribute("colspan",colSpanCount);
					prevCell.setAttribute("colSpan",colSpanCount); // Needed for IE
				}
				w.nextMatch = this.cellRegExp.lastIndex;
				break;
			} else {
				// Cell
				w.nextMatch++;
				var styles = config.formatterHelpers.inlineCssHelper(w);
				var spaceLeft = false;
				var chr = w.source.substr(w.nextMatch,1);
				while(chr == " ") {
					spaceLeft = true;
					w.nextMatch++;
					chr = w.source.substr(w.nextMatch,1);
				}
				var cell;
				if(chr == "!") {
					cell = createTiddlyElement(e,"th");
					w.nextMatch++;
				} else {
					cell = createTiddlyElement(e,"td");
				}
				prevCell = cell;
				prevColumns[col] = {rowSpanCount:1,element:cell};
				if(colSpanCount > 1) {
					cell.setAttribute("colspan",colSpanCount);
					cell.setAttribute("colSpan",colSpanCount); // Needed for IE
					colSpanCount = 1;
				}
				config.formatterHelpers.applyCssHelper(cell,styles);
				w.subWikifyTerm(cell,this.cellTermRegExp);
				if(w.matchText.substr(w.matchText.length-2,1) == " ") // spaceRight
					cell.align = spaceLeft ? "center" : "left";
				else if(spaceLeft)
					cell.align = "right";
				w.nextMatch--;
			}
			col++;
			this.cellRegExp.lastIndex = w.nextMatch;
			cellMatch = this.cellRegExp.exec(w.source);
		}
	}
},

{
	name: "heading",
	match: "^!{1,6}",
	termRegExp: /(\n)/mg,
	handler: function(w)
	{
		w.subWikifyTerm(createTiddlyElement(w.output,"h" + w.matchLength),this.termRegExp);
	}
},

{
	name: "list",
	match: "^(?:[\\*#;:]+)",
	lookaheadRegExp: /^(?:(?:(\*)|(#)|(;)|(:))+)/mg,
	termRegExp: /(\n)/mg,
	handler: function(w)
	{
		var stack = [w.output];
		var currLevel = 0, currType = null;
		var listLevel, listType, itemType, baseType;
		w.nextMatch = w.matchStart;
		this.lookaheadRegExp.lastIndex = w.nextMatch;
		var lookaheadMatch = this.lookaheadRegExp.exec(w.source);
		while(lookaheadMatch && lookaheadMatch.index == w.nextMatch) {
			if(lookaheadMatch[1]) {
				listType = "ul";
				itemType = "li";
			} else if(lookaheadMatch[2]) {
				listType = "ol";
				itemType = "li";
			} else if(lookaheadMatch[3]) {
				listType = "dl";
				itemType = "dt";
			} else if(lookaheadMatch[4]) {
				listType = "dl";
				itemType = "dd";
			}
			if(!baseType)
				baseType = listType;
			listLevel = lookaheadMatch[0].length;
			w.nextMatch += lookaheadMatch[0].length;
			var t;
			if(listLevel > currLevel) {
				for(t=currLevel; t<listLevel; t++) {
					var target = (currLevel == 0) ? stack[stack.length-1] : stack[stack.length-1].lastChild;
					stack.push(createTiddlyElement(target,listType));
				}
			} else if(listType!=baseType && listLevel==1) {
				w.nextMatch -= lookaheadMatch[0].length;
				return;
			} else if(listLevel < currLevel) {
				for(t=currLevel; t>listLevel; t--)
					stack.pop();
			} else if(listLevel == currLevel && listType != currType) {
				stack.pop();
				stack.push(createTiddlyElement(stack[stack.length-1].lastChild,listType));
			}
			currLevel = listLevel;
			currType = listType;
			var e = createTiddlyElement(stack[stack.length-1],itemType);
			w.subWikifyTerm(e,this.termRegExp);
			this.lookaheadRegExp.lastIndex = w.nextMatch;
			lookaheadMatch = this.lookaheadRegExp.exec(w.source);
		}
	}
},

{
	name: "quoteByBlock",
	match: "^<<<\\n",
	termRegExp: /(^<<<(\n|$))/mg,
	element: "blockquote",
	handler: config.formatterHelpers.createElementAndWikify
},

{
	name: "quoteByLine",
	match: "^>+",
	lookaheadRegExp: /^>+/mg,
	termRegExp: /(\n)/mg,
	element: "blockquote",
	handler: function(w)
	{
		var stack = [w.output];
		var currLevel = 0;
		var newLevel = w.matchLength;
		var t;
		do {
			if(newLevel > currLevel) {
				for(t=currLevel; t<newLevel; t++)
					stack.push(createTiddlyElement(stack[stack.length-1],this.element));
			} else if(newLevel < currLevel) {
				for(t=currLevel; t>newLevel; t--)
					stack.pop();
			}
			currLevel = newLevel;
			w.subWikifyTerm(stack[stack.length-1],this.termRegExp);
			createTiddlyElement(stack[stack.length-1],"br");
			this.lookaheadRegExp.lastIndex = w.nextMatch;
			var lookaheadMatch = this.lookaheadRegExp.exec(w.source);
			var matched = lookaheadMatch && lookaheadMatch.index == w.nextMatch;
			if(matched) {
				newLevel = lookaheadMatch[0].length;
				w.nextMatch += lookaheadMatch[0].length;
			}
		} while(matched);
	}
},

{
	name: "rule",
	match: "^----+$\\n?",
	handler: function(w)
	{
		createTiddlyElement(w.output,"hr");
	}
},

{
	name: "monospacedByLine",
	match: "^(?:/\\*\\{\\{\\{\\*/|\\{\\{\\{|//\\{\\{\\{|<!--\\{\\{\\{-->)\\n",
	element: "pre",
	handler: function(w)
	{
		switch(w.matchText) {
		case "/*{{{*/\n": // CSS
			this.lookaheadRegExp = /\/\*\{\{\{\*\/\n*((?:^[^\n]*\n)+?)(\n*^\/\*\}\}\}\*\/$\n?)/mg;
			break;
		case "{{{\n": // monospaced block
			this.lookaheadRegExp = /^\{\{\{\n((?:^[^\n]*\n)+?)(^\}\}\}$\n?)/mg;
			break;
		case "//{{{\n": // plugin
			this.lookaheadRegExp = /^\/\/\{\{\{\n\n*((?:^[^\n]*\n)+?)(\n*^\/\/\}\}\}$\n?)/mg;
			break;
		case "<!--{{{-->\n": //template
			this.lookaheadRegExp = /<!--\{\{\{-->\n*((?:^[^\n]*\n)+?)(\n*^<!--\}\}\}-->$\n?)/mg;
			break;
		default:
			break;
		}
		config.formatterHelpers.enclosedTextHelper.call(this,w);
	}
},

{
	name: "wikifyComment",
	match: "^(?:/\\*\\*\\*|<!---)\\n",
	handler: function(w)
	{
		var termRegExp = (w.matchText == "/***\n") ? (/(^\*\*\*\/\n)/mg) : (/(^--->\n)/mg);
		w.subWikifyTerm(w.output,termRegExp);
	}
},

{
	name: "macro",
	match: "<<",
	lookaheadRegExp: /<<([^>\s]+)(?:\s*)((?:[^>]|(?:>(?!>)))*)>>/mg,
	handler: function(w)
	{
		this.lookaheadRegExp.lastIndex = w.matchStart;
		var lookaheadMatch = this.lookaheadRegExp.exec(w.source);
		if(lookaheadMatch && lookaheadMatch.index == w.matchStart && lookaheadMatch[1]) {
			w.nextMatch = this.lookaheadRegExp.lastIndex;
			invokeMacro(w.output,lookaheadMatch[1],lookaheadMatch[2],w,w.tiddler);
		}
	}
},

{
	name: "prettyLink",
	match: "\\[\\[",
	lookaheadRegExp: /\[\[(.*?)(?:\|(~)?(.*?))?\]\]/mg,
	handler: function(w)
	{
		this.lookaheadRegExp.lastIndex = w.matchStart;
		var lookaheadMatch = this.lookaheadRegExp.exec(w.source);
		if(lookaheadMatch && lookaheadMatch.index == w.matchStart) {
			var e;
			var text = lookaheadMatch[1];
			if(lookaheadMatch[3]) {
				// Pretty bracketted link
				var link = lookaheadMatch[3];
				e = (!lookaheadMatch[2] && config.formatterHelpers.isExternalLink(link)) ?
						createExternalLink(w.output,link) : createTiddlyLink(w.output,link,false,null,w.isStatic,w.tiddler);
			} else {
				// Simple bracketted link
				e = createTiddlyLink(w.output,text,false,null,w.isStatic,w.tiddler);
			}
			createTiddlyText(e,text);
			w.nextMatch = this.lookaheadRegExp.lastIndex;
		}
	}
},

{
	name: "wikiLink",
	match: config.textPrimitives.unWikiLink+"?"+config.textPrimitives.wikiLink,
	handler: function(w)
	{
		if(w.matchText.substr(0,1) == config.textPrimitives.unWikiLink) {
			w.outputText(w.output,w.matchStart+1,w.nextMatch);
			return;
		}
		if(w.matchStart > 0) {
			var preRegExp = new RegExp(config.textPrimitives.anyLetterStrict,"mg");
			preRegExp.lastIndex = w.matchStart-1;
			var preMatch = preRegExp.exec(w.source);
			if(preMatch.index == w.matchStart-1) {
				w.outputText(w.output,w.matchStart,w.nextMatch);
				return;
			}
		}
		if(w.autoLinkWikiWords || store.isShadowTiddler(w.matchText)) {
			var link = createTiddlyLink(w.output,w.matchText,false,null,w.isStatic,w.tiddler);
			w.outputText(link,w.matchStart,w.nextMatch);
		} else {
			w.outputText(w.output,w.matchStart,w.nextMatch);
		}
	}
},

{
	name: "urlLink",
	match: config.textPrimitives.urlPattern,
	handler: function(w)
	{
		w.outputText(createExternalLink(w.output,w.matchText),w.matchStart,w.nextMatch);
	}
},

{
	name: "image",
	match: "\\[[<>]?[Ii][Mm][Gg]\\[",
	lookaheadRegExp: /\[([<]?)(>?)[Ii][Mm][Gg]\[(?:([^\|\]]+)\|)?([^\[\]\|]+)\](?:\[([^\]]*)\])?\]/mg,
	handler: function(w)
	{
		this.lookaheadRegExp.lastIndex = w.matchStart;
		var lookaheadMatch = this.lookaheadRegExp.exec(w.source);
		if(lookaheadMatch && lookaheadMatch.index == w.matchStart) {
			var e = w.output;
			if(lookaheadMatch[5]) {
				var link = lookaheadMatch[5];
				e = config.formatterHelpers.isExternalLink(link) ? createExternalLink(w.output,link) : createTiddlyLink(w.output,link,false,null,w.isStatic,w.tiddler);
				addClass(e,"imageLink");
			}
			var img = createTiddlyElement(e,"img");
			if(lookaheadMatch[1])
				img.align = "left";
			else if(lookaheadMatch[2])
				img.align = "right";
			if(lookaheadMatch[3])
				img.title = lookaheadMatch[3];
			img.src = lookaheadMatch[4];
			w.nextMatch = this.lookaheadRegExp.lastIndex;
		}
	}
},

{
	name: "html",
	match: "<[Hh][Tt][Mm][Ll]>",
	lookaheadRegExp: /<[Hh][Tt][Mm][Ll]>((?:.|\n)*?)<\/[Hh][Tt][Mm][Ll]>/mg,
	handler: function(w)
	{
		this.lookaheadRegExp.lastIndex = w.matchStart;
		var lookaheadMatch = this.lookaheadRegExp.exec(w.source);
		if(lookaheadMatch && lookaheadMatch.index == w.matchStart) {
			createTiddlyElement(w.output,"span").innerHTML = lookaheadMatch[1];
			w.nextMatch = this.lookaheadRegExp.lastIndex;
		}
	}
},

{
	name: "commentByBlock",
	match: "/%",
	lookaheadRegExp: /\/%((?:.|\n)*?)%\//mg,
	handler: function(w)
	{
		this.lookaheadRegExp.lastIndex = w.matchStart;
		var lookaheadMatch = this.lookaheadRegExp.exec(w.source);
		if(lookaheadMatch && lookaheadMatch.index == w.matchStart)
			w.nextMatch = this.lookaheadRegExp.lastIndex;
	}
},

{
	name: "characterFormat",
	match: "''|//|__|\\^\\^|~~|--(?!\\s|$)|\\{\\{\\{",
	handler: function(w)
	{
		switch(w.matchText) {
		case "''":
			w.subWikifyTerm(w.output.appendChild(document.createElement("strong")),/('')/mg);
			break;
		case "//":
			w.subWikifyTerm(createTiddlyElement(w.output,"em"),/(\/\/)/mg);
			break;
		case "__":
			w.subWikifyTerm(createTiddlyElement(w.output,"u"),/(__)/mg);
			break;
		case "^^":
			w.subWikifyTerm(createTiddlyElement(w.output,"sup"),/(\^\^)/mg);
			break;
		case "~~":
			w.subWikifyTerm(createTiddlyElement(w.output,"sub"),/(~~)/mg);
			break;
		case "--":
			w.subWikifyTerm(createTiddlyElement(w.output,"strike"),/(--)/mg);
			break;
		case "{{{":
			var lookaheadRegExp = /\{\{\{((?:.|\n)*?)\}\}\}/mg;
			lookaheadRegExp.lastIndex = w.matchStart;
			var lookaheadMatch = lookaheadRegExp.exec(w.source);
			if(lookaheadMatch && lookaheadMatch.index == w.matchStart) {
				createTiddlyElement(w.output,"code",null,null,lookaheadMatch[1]);
				w.nextMatch = lookaheadRegExp.lastIndex;
			}
			break;
		}
	}
},

{
	name: "customFormat",
	match: "@@|\\{\\{",
	handler: function(w)
	{
		switch(w.matchText) {
		case "@@":
			var e = createTiddlyElement(w.output,"span");
			var styles = config.formatterHelpers.inlineCssHelper(w);
			if(styles.length == 0)
				e.className = "marked";
			else
				config.formatterHelpers.applyCssHelper(e,styles);
			w.subWikifyTerm(e,/(@@)/mg);
			break;
		case "{{":
			lookaheadRegExp = /\{\{[\s]*([\w]+[\s\w]*)[\s]*\{(\n?)/mg;
			lookaheadRegExp.lastIndex = w.matchStart;
			lookaheadMatch = lookaheadRegExp.exec(w.source);
			if(lookaheadMatch) {
				w.nextMatch = lookaheadRegExp.lastIndex;
				e = createTiddlyElement(w.output,lookaheadMatch[2] == "\n" ? "div" : "span",null,lookaheadMatch[1]);
				w.subWikifyTerm(e,/(\}\}\})/mg);
			}
			break;
		}
	}
},

{
	name: "mdash",
	match: "--",
	handler: function(w)
	{
		createTiddlyElement(w.output,"span").innerHTML = "&mdash;";
	}
},

{
	name: "lineBreak",
	match: "\\n|<br ?/?>",
	handler: function(w)
	{
		createTiddlyElement(w.output,"br");
	}
},

{
	name: "rawText",
	match: "\\\"{3}|<nowiki>",
	lookaheadRegExp: /(?:\"{3}|<nowiki>)((?:.|\n)*?)(?:\"{3}|<\/nowiki>)/mg,
	handler: function(w)
	{
		this.lookaheadRegExp.lastIndex = w.matchStart;
		var lookaheadMatch = this.lookaheadRegExp.exec(w.source);
		if(lookaheadMatch && lookaheadMatch.index == w.matchStart) {
			createTiddlyElement(w.output,"span",null,null,lookaheadMatch[1]);
			w.nextMatch = this.lookaheadRegExp.lastIndex;
		}
	}
},

{
	name: "htmlEntitiesEncoding",
	match: "(?:(?:&#?[a-zA-Z0-9]{2,8};|.)(?:&#?(?:x0*(?:3[0-6][0-9a-fA-F]|1D[c-fC-F][0-9a-fA-F]|20[d-fD-F][0-9a-fA-F]|FE2[0-9a-fA-F])|0*(?:76[89]|7[7-9][0-9]|8[0-7][0-9]|761[6-9]|76[2-7][0-9]|84[0-3][0-9]|844[0-7]|6505[6-9]|6506[0-9]|6507[0-1]));)+|&#?[a-zA-Z0-9]{2,8};)",
	handler: function(w)
	{
		createTiddlyElement(w.output,"span").innerHTML = w.matchText;
	}
}

];

//--
//-- Wikifier
//--

function getParser(tiddler,format)
{
	if(tiddler) {
		if(!format)
			format = tiddler.fields["wikiformat"];
		var i;
		if(format) {
			for(i in config.parsers) {
				if(format == config.parsers[i].format)
					return config.parsers[i];
			}
		} else {
			for(i in config.parsers) {
				if(tiddler.isTagged(config.parsers[i].formatTag))
					return config.parsers[i];
			}
		}
	}
	return formatter;
}

function wikify(source,output,highlightRegExp,tiddler)
{
	if(source && source != "") {
		var wikifier = new Wikifier(source,getParser(tiddler),highlightRegExp,tiddler);
		wikifier.subWikifyUnterm(output);
	}
}

function wikifyStatic(source,highlightRegExp,tiddler,format)
{
	var e = createTiddlyElement(document.body,"div");
	e.style.display = "none";
	var html = "";
	if(source && source != "") {
		var wikifier = new Wikifier(source,getParser(tiddler,format),highlightRegExp,tiddler);
		wikifier.isStatic = true;
		wikifier.subWikifyUnterm(e);
		html = e.innerHTML;
		removeNode(e);
	}
	return html;
}

function wikifyPlain(title,theStore,limit)
{
	if(!theStore)
		theStore = store;
	if(theStore.tiddlerExists(title) || theStore.isShadowTiddler(title)) {
		return wikifyPlainText(theStore.getTiddlerText(title),limit,tiddler);
	} else {
		return "";
	}
}

function wikifyPlainText(text,limit,tiddler)
{
	if(limit > 0)
		text = text.substr(0,limit);
	var wikifier = new Wikifier(text,formatter,null,tiddler);
	return wikifier.wikifyPlain();
}

function highlightify(source,output,highlightRegExp,tiddler)
{
	if(source && source != "") {
		var wikifier = new Wikifier(source,formatter,highlightRegExp,tiddler);
		wikifier.outputText(output,0,source.length);
	}
}

function Wikifier(source,formatter,highlightRegExp,tiddler)
{
	this.source = source;
	this.output = null;
	this.formatter = formatter;
	this.nextMatch = 0;
	this.autoLinkWikiWords = tiddler && tiddler.autoLinkWikiWords() == false ? false : true;
	this.highlightRegExp = highlightRegExp;
	this.highlightMatch = null;
	this.isStatic = false;
	if(highlightRegExp) {
		highlightRegExp.lastIndex = 0;
		this.highlightMatch = highlightRegExp.exec(source);
	}
	this.tiddler = tiddler;
}

Wikifier.prototype.wikifyPlain = function()
{
	var e = createTiddlyElement(document.body,"div");
	this.subWikify(e);
	var text = getPlainText(e);
	removeNode(e);
	return text;
};

Wikifier.prototype.subWikify = function(output,terminator)
{
	if(terminator)
		this.subWikifyTerm(output,new RegExp("(" + terminator + ")","mg"));
	else
		this.subWikifyUnterm(output);
};

Wikifier.prototype.subWikifyUnterm = function(output)
{
	var oldOutput = this.output;
	this.output = output;
	this.formatter.formatterRegExp.lastIndex = this.nextMatch;
	var formatterMatch = this.formatter.formatterRegExp.exec(this.source);
	while(formatterMatch) {
		// Output any text before the match
		if(formatterMatch.index > this.nextMatch)
			this.outputText(this.output,this.nextMatch,formatterMatch.index);
		// Set the match parameters for the handler
		this.matchStart = formatterMatch.index;
		this.matchLength = formatterMatch[0].length;
		this.matchText = formatterMatch[0];
		this.nextMatch = this.formatter.formatterRegExp.lastIndex;
		for(var t=1; t<formatterMatch.length; t++) {
			if(formatterMatch[t]) {
				this.formatter.formatters[t-1].handler(this);
				this.formatter.formatterRegExp.lastIndex = this.nextMatch;
				break;
			}
		}
		formatterMatch = this.formatter.formatterRegExp.exec(this.source);
	}
	if(this.nextMatch < this.source.length) {
		this.outputText(this.output,this.nextMatch,this.source.length);
		this.nextMatch = this.source.length;
	}
	this.output = oldOutput;
};

Wikifier.prototype.subWikifyTerm = function(output,terminatorRegExp)
{
	var oldOutput = this.output;
	this.output = output;
	terminatorRegExp.lastIndex = this.nextMatch;
	var terminatorMatch = terminatorRegExp.exec(this.source);
	this.formatter.formatterRegExp.lastIndex = this.nextMatch;
	var formatterMatch = this.formatter.formatterRegExp.exec(terminatorMatch ? this.source.substr(0,terminatorMatch.index) : this.source);
	while(terminatorMatch || formatterMatch) {
		if(terminatorMatch && (!formatterMatch || terminatorMatch.index <= formatterMatch.index)) {
			if(terminatorMatch.index > this.nextMatch)
				this.outputText(this.output,this.nextMatch,terminatorMatch.index);
			this.matchText = terminatorMatch[1];
			this.matchLength = terminatorMatch[1].length;
			this.matchStart = terminatorMatch.index;
			this.nextMatch = this.matchStart + this.matchLength;
			this.output = oldOutput;
			return;
		}
		if(formatterMatch.index > this.nextMatch)
			this.outputText(this.output,this.nextMatch,formatterMatch.index);
		this.matchStart = formatterMatch.index;
		this.matchLength = formatterMatch[0].length;
		this.matchText = formatterMatch[0];
		this.nextMatch = this.formatter.formatterRegExp.lastIndex;
		for(var t=1; t<formatterMatch.length; t++) {
			if(formatterMatch[t]) {
				this.formatter.formatters[t-1].handler(this);
				this.formatter.formatterRegExp.lastIndex = this.nextMatch;
				break;
			}
		}
		terminatorRegExp.lastIndex = this.nextMatch;
		terminatorMatch = terminatorRegExp.exec(this.source);
		formatterMatch = this.formatter.formatterRegExp.exec(terminatorMatch ? this.source.substr(0,terminatorMatch.index) : this.source);
	}
	if(this.nextMatch < this.source.length) {
		this.outputText(this.output,this.nextMatch,this.source.length);
		this.nextMatch = this.source.length;
	}
	this.output = oldOutput;
};

Wikifier.prototype.outputText = function(place,startPos,endPos)
{
	while(this.highlightMatch && (this.highlightRegExp.lastIndex > startPos) && (this.highlightMatch.index < endPos) && (startPos < endPos)) {
		if(this.highlightMatch.index > startPos) {
			createTiddlyText(place,this.source.substring(startPos,this.highlightMatch.index));
			startPos = this.highlightMatch.index;
		}
		var highlightEnd = Math.min(this.highlightRegExp.lastIndex,endPos);
		var theHighlight = createTiddlyElement(place,"span",null,"highlight",this.source.substring(startPos,highlightEnd));
		startPos = highlightEnd;
		if(startPos >= this.highlightRegExp.lastIndex)
			this.highlightMatch = this.highlightRegExp.exec(this.source);
	}
	if(startPos < endPos) {
		createTiddlyText(place,this.source.substring(startPos,endPos));
	}
};

//--
//-- Macro definitions
//--

config.macros.today.handler = function(place,macroName,params)
{
	var now = new Date();
	var text = params[0] ? now.formatString(params[0].trim()) : text = now.toLocaleString();
	createTiddlyElement(place,"span",null,null,text);
};

config.macros.version.handler = function(place)
{
	createTiddlyElement(place,"span",null,null,version.major + "." + version.minor + "." + version.revision + (version.beta ? " (beta " + version.beta + ")" : ""));
};

config.macros.list.handler = function(place,macroName,params)
{
	var type = params[0] ? params[0] : "all";
	var list = document.createElement("ul");
	place.appendChild(list);
	if(this[type].prompt)
		createTiddlyElement(list,"li",null,"listTitle",this[type].prompt);
	var results;
	if(this[type].handler)
		results = this[type].handler(params);
	for(var t = 0; t < results.length; t++) {
		var li = document.createElement("li");
		list.appendChild(li);
		createTiddlyLink(li,typeof results[t] == "string" ? results[t] : results[t].title,true);
	}
};

config.macros.list.all.handler = function(params)
{
	return store.reverseLookup("tags","excludeLists",false,"title");
};

config.macros.list.missing.handler = function(params)
{
	return store.getMissingLinks();
};

config.macros.list.orphans.handler = function(params)
{
	return store.getOrphans();
};

config.macros.list.shadowed.handler = function(params)
{
	return store.getShadowed();
};

config.macros.list.touched.handler = function(params)
{
	return store.getTouched();
};

config.macros.list.filter.handler = function(params)
{
	var filter = params[1];
	var results = [];
	if(filter) {
		var tiddlers = store.filterTiddlers(filter);
		for(var t=0; t<tiddlers.length; t++)
			results.push(tiddlers[t].title);
	}
	return results;
};

config.macros.allTags.handler = function(place,macroName,params)
{
	var tags = store.getTags(params[0]);
	var ul = createTiddlyElement(place,"ul");
	if(tags.length == 0)
		createTiddlyElement(ul,"li",null,"listTitle",this.noTags);
	for(var t=0; t<tags.length; t++) {
		var title = tags[t][0];
		var info = getTiddlyLinkInfo(title);
		var li =createTiddlyElement(ul,"li");
		var btn = createTiddlyButton(li,title + " (" + tags[t][1] + ")",this.tooltip.format([title]),onClickTag,info.classes);
		btn.setAttribute("tag",title);
		btn.setAttribute("refresh","link");
		btn.setAttribute("tiddlyLink",title);
	}
};

config.macros.timeline.handler = function(place,macroName,params)
{
	var field = params[0] ? params[0] : "modified";
	var tiddlers = store.reverseLookup("tags","excludeLists",false,field);
	var lastDay = "";
	var last = params[1] ? tiddlers.length-Math.min(tiddlers.length,parseInt(params[1])) : 0;
	var dateFormat = params[2] ? params[2] : this.dateFormat;
	for(var t=tiddlers.length-1; t>=last; t--) {
		var tiddler = tiddlers[t];
		var theDay = tiddler[field].convertToLocalYYYYMMDDHHMM().substr(0,8);
		if(theDay != lastDay) {
			var ul = document.createElement("ul");
			place.appendChild(ul);
			createTiddlyElement(ul,"li",null,"listTitle",tiddler[field].formatString(dateFormat));
			lastDay = theDay;
		}
		createTiddlyElement(ul,"li",null,"listLink").appendChild(createTiddlyLink(place,tiddler.title,true));
	}
};

config.macros.tiddler.handler = function(place,macroName,params,wikifier,paramString,tiddler)
{
	params = paramString.parseParams("name",null,true,false,true);
	var names = params[0]["name"];
	var tiddlerName = names[0];
	var className = names[1] ? names[1] : null;
	var args = params[0]["with"];
	var wrapper = createTiddlyElement(place,"span",null,className);
	if(!args) {
		wrapper.setAttribute("refresh","content");
		wrapper.setAttribute("tiddler",tiddlerName);
	}
	var text = store.getTiddlerText(tiddlerName);
	if(text) {
		var stack = config.macros.tiddler.tiddlerStack;
		if(stack.indexOf(tiddlerName) !== -1)
			return;
		stack.push(tiddlerName);
		try {
			var n = args ? Math.min(args.length,9) : 0;
			for(var i=0; i<n; i++) {
				var placeholderRE = new RegExp("\\$" + (i + 1),"mg");
				text = text.replace(placeholderRE,args[i]);
			}
			config.macros.tiddler.renderText(wrapper,text,tiddlerName,params);
		} finally {
			stack.pop();
		}
	}
};

config.macros.tiddler.renderText = function(place,text,tiddlerName,params)
{
	wikify(text,place,null,store.getTiddler(tiddlerName));
};

config.macros.tiddler.tiddlerStack = [];

config.macros.tag.handler = function(place,macroName,params)
{
	createTagButton(place,params[0]);
};

config.macros.tags.handler = function(place,macroName,params,wikifier,paramString,tiddler)
{
	params = paramString.parseParams("anon",null,true,false,false);
	var ul = createTiddlyElement(place,"ul");
	var title = getParam(params,"anon","");
	if(title && store.tiddlerExists(title))
		tiddler = store.getTiddler(title);
	var sep = getParam(params,"sep"," ");
	var lingo = config.views.wikified.tag;
	var prompt = tiddler.tags.length == 0 ? lingo.labelNoTags : lingo.labelTags;
	createTiddlyElement(ul,"li",null,"listTitle",prompt.format([tiddler.title]));
	for(var t=0; t<tiddler.tags.length; t++) {
		createTagButton(createTiddlyElement(ul,"li"),tiddler.tags[t],tiddler.title);
		if(t<tiddler.tags.length-1)
			createTiddlyText(ul,sep);
	}
};

config.macros.tagging.handler = function(place,macroName,params,wikifier,paramString,tiddler)
{
	params = paramString.parseParams("anon",null,true,false,false);
	var ul = createTiddlyElement(place,"ul");
	var title = getParam(params,"anon","");
	if(title == "" && tiddler instanceof Tiddler)
		title = tiddler.title;
	var sep = getParam(params,"sep"," ");
	ul.setAttribute("title",this.tooltip.format([title]));
	var tagged = store.getTaggedTiddlers(title);
	var prompt = tagged.length == 0 ? this.labelNotTag : this.label;
	createTiddlyElement(ul,"li",null,"listTitle",prompt.format([title,tagged.length]));
	for(var t=0; t<tagged.length; t++) {
		createTiddlyLink(createTiddlyElement(ul,"li"),tagged[t].title,true);
		if(t<tagged.length-1)
			createTiddlyText(ul,sep);
	}
};

config.macros.closeAll.handler = function(place)
{
	createTiddlyButton(place,this.label,this.prompt,this.onClick);
};

config.macros.closeAll.onClick = function(e)
{
	story.closeAllTiddlers();
	return false;
};

config.macros.permaview.handler = function(place)
{
	createTiddlyButton(place,this.label,this.prompt,this.onClick);
};

config.macros.permaview.onClick = function(e)
{
	story.permaView();
	return false;
};

config.macros.saveChanges.handler = function(place)
{
	if(!readOnly)
		createTiddlyButton(place,this.label,this.prompt,this.onClick,null,null,this.accessKey);
};

config.macros.saveChanges.onClick = function(e)
{
	saveChanges();
	return false;
};

config.macros.slider.onClickSlider = function(ev)
{
	var e = ev ? ev : window.event;
	var n = this.nextSibling;
	var cookie = n.getAttribute("cookie");
	var isOpen = n.style.display != "none";
	if(config.options.chkAnimate && anim && typeof Slider == "function")
		anim.startAnimating(new Slider(n,!isOpen,null,"none"));
	else
		n.style.display = isOpen ? "none" : "block";
	config.options[cookie] = !isOpen;
	saveOptionCookie(cookie);
	return false;
};

config.macros.slider.createSlider = function(place,cookie,title,tooltip)
{
	var c = cookie ? cookie : "";
	var btn = createTiddlyButton(place,title,tooltip,this.onClickSlider);
	var panel = createTiddlyElement(null,"div",null,"sliderPanel");
	panel.setAttribute("cookie",c);
	panel.style.display = config.options[c] ? "block" : "none";
	place.appendChild(panel);
	return panel;
};

config.macros.slider.handler = function(place,macroName,params)
{
	var panel = this.createSlider(place,params[0],params[2],params[3]);
	var text = store.getTiddlerText(params[1]);
	panel.setAttribute("refresh","content");
	panel.setAttribute("tiddler",params[1]);
	if(text)
		wikify(text,panel,null,store.getTiddler(params[1]));
};

// <<gradient [[tiddler name]] vert|horiz rgb rgb rgb rgb... >>
config.macros.gradient.handler = function(place,macroName,params,wikifier)
{
	var panel = wikifier ? createTiddlyElement(place,"div",null,"gradient") : place;
	panel.style.position = "relative";
	panel.style.overflow = "hidden";
	panel.style.zIndex = "0";
	if(wikifier) {
		var styles = config.formatterHelpers.inlineCssHelper(wikifier);
		config.formatterHelpers.applyCssHelper(panel,styles);
	}
	var colours = [];
	for(var t=1; t<params.length; t++) {
		var c = new RGB(params[t]);
		if(c)
			colours.push(c);
	}
	drawGradient(panel,params[0] != "vert",colours);
	if(wikifier)
		wikifier.subWikify(panel,">>");
	if(document.all) {
		panel.style.height = "100%";
		panel.style.width = "100%";
	}
};

config.macros.message.handler = function(place,macroName,params)
{
	if(params[0]) {
		var m = config;
		var p = params[0].split(".");
		for(var t=0; t<p.length; t++) {
			if(p[t] in m)
				m = m[p[t]];
			else
				break;
		}
		createTiddlyText(place,m.toString().format(params.splice(1)));
	}
};

config.macros.view.handler = function(place,macroName,params,wikifier,paramString,tiddler)
{
	if((tiddler instanceof Tiddler) && params[0]) {
		var value = store.getValue(tiddler,params[0]);
		if(value != undefined) {
			switch(params[1]) {
				case undefined:
					highlightify(value,place,highlightHack,tiddler);
					break;
				case "link":
					createTiddlyLink(place,value,true);
					break;
				case "wikified":
					wikify(value,place,highlightHack,tiddler);
					break;
				case "date":
					value = Date.convertFromYYYYMMDDHHMM(value);
					createTiddlyText(place,value.formatString(params[2] ? params[2] : config.views.wikified.dateFormat));
					break;
			}
		}
	}
};

config.macros.edit.handler = function(place,macroName,params,wikifier,paramString,tiddler)
{
	var field = params[0];
	var rows = params[1] || 0;
	var defVal = params[2] || '';
	if((tiddler instanceof Tiddler) && field) {
		story.setDirty(tiddler.title,true);
		var e,v;
		if(field != "text" && !rows) {
			e = createTiddlyElement(null,"input");
			if(tiddler.isReadOnly())
				e.setAttribute("readOnly","readOnly");
			e.setAttribute("edit",field);
			e.setAttribute("type","text");
			e.value = store.getValue(tiddler,field) || defVal;
			e.setAttribute("size","40");
			e.setAttribute("autocomplete","off");
			place.appendChild(e);
		} else {
			var wrapper1 = createTiddlyElement(null,"fieldset",null,"fieldsetFix");
			var wrapper2 = createTiddlyElement(wrapper1,"div");
			e = createTiddlyElement(wrapper2,"textarea");
			if(tiddler.isReadOnly())
				e.setAttribute("readOnly","readOnly");
			e.value = v = store.getValue(tiddler,field) || defVal;
			rows = rows ? rows : 10;
			var lines = v.match(/\n/mg);
			var maxLines = Math.max(parseInt(config.options.txtMaxEditRows),5);
			if(lines != null && lines.length > rows)
				rows = lines.length + 5;
			rows = Math.min(rows,maxLines);
			e.setAttribute("rows",rows);
			e.setAttribute("edit",field);
			place.appendChild(wrapper1);
		}
		return e;
	}
};

config.macros.tagChooser.onClick = function(ev)
{
	var e = ev ? ev : window.event;
	var lingo = config.views.editor.tagChooser;
	var popup = Popup.create(this);
	var tags = store.getTags();
	if(tags.length == 0)
		createTiddlyText(createTiddlyElement(popup,"li"),lingo.popupNone);
	for(var t=0; t<tags.length; t++) {
		var tag = createTiddlyButton(createTiddlyElement(popup,"li"),tags[t][0],lingo.tagTooltip.format([tags[t][0]]),config.macros.tagChooser.onTagClick);
		tag.setAttribute("tag",tags[t][0]);
		tag.setAttribute("tiddler",this.getAttribute("tiddler"));
	}
	Popup.show();
	e.cancelBubble = true;
	if(e.stopPropagation) e.stopPropagation();
	return false;
};

config.macros.tagChooser.onTagClick = function(ev)
{
	var e = ev ? ev : window.event;
	var tag = this.getAttribute("tag");
	var title = this.getAttribute("tiddler");
	if(!readOnly)
		story.setTiddlerTag(title,tag,0);
	return false;
};

config.macros.tagChooser.handler = function(place,macroName,params,wikifier,paramString,tiddler)
{
	if(tiddler instanceof Tiddler) {
		var lingo = config.views.editor.tagChooser;
		var btn = createTiddlyButton(place,lingo.text,lingo.tooltip,this.onClick);
		btn.setAttribute("tiddler",tiddler.title);
	}
};

config.macros.refreshDisplay.handler = function(place)
{
	createTiddlyButton(place,this.label,this.prompt,this.onClick);
};

config.macros.refreshDisplay.onClick = function(e)
{
	refreshAll();
	return false;
};

config.macros.annotations.handler = function(place,macroName,params,wikifier,paramString,tiddler)
{
	var title = tiddler ? tiddler.title : null;
	var a = title ? config.annotations[title] : null;
	if(!tiddler || !title || !a)
		return;
	var text = a.format([title]);
	wikify(text,createTiddlyElement(place,"div",null,"annotation"),null,tiddler);
};

//--
//-- NewTiddler and NewJournal macros
//--

config.macros.newTiddler.createNewTiddlerButton = function(place,title,params,label,prompt,accessKey,newFocus,isJournal)
{
	var tags = [];
	for(var t=1; t<params.length; t++) {
		if((params[t].name == "anon" && t != 1) || (params[t].name == "tag"))
			tags.push(params[t].value);
	}
	label = getParam(params,"label",label);
	prompt = getParam(params,"prompt",prompt);
	accessKey = getParam(params,"accessKey",accessKey);
	newFocus = getParam(params,"focus",newFocus);
	var customFields = getParam(params,"fields","");
	if(!customFields && !store.isShadowTiddler(title))
		customFields = String.encodeHashMap(config.defaultCustomFields);
	var btn = createTiddlyButton(place,label,prompt,this.onClickNewTiddler,null,null,accessKey);
	btn.setAttribute("newTitle",title);
	btn.setAttribute("isJournal",isJournal ? "true" : "false");
	if(tags.length > 0)
		btn.setAttribute("params",tags.join("|"));
	btn.setAttribute("newFocus",newFocus);
	btn.setAttribute("newTemplate",getParam(params,"template",DEFAULT_EDIT_TEMPLATE));
	if(customFields !== "")
		btn.setAttribute("customFields",customFields);
	var text = getParam(params,"text");
	if(text !== undefined)
		btn.setAttribute("newText",text);
	return btn;
};

config.macros.newTiddler.onClickNewTiddler = function()
{
	var title = this.getAttribute("newTitle");
	if(this.getAttribute("isJournal") == "true") {
		var now = new Date();
		title = now.formatString(title.trim());
	}
	var params = this.getAttribute("params");
	var tags = params ? params.split("|") : [];
	var focus = this.getAttribute("newFocus");
	var template = this.getAttribute("newTemplate");
	var customFields = this.getAttribute("customFields");
	story.displayTiddler(null,title,template,false,null,null);
	var tiddlerElem = document.getElementById(story.idPrefix + title);
	if(customFields)
		story.addCustomFields(tiddlerElem,customFields);
	var text = this.getAttribute("newText");
	if(typeof text == "string")
		story.getTiddlerField(title,"text").value = text.format([title]);
	for(var t=0;t<tags.length;t++)
		story.setTiddlerTag(title,tags[t],+1);
	story.focusTiddler(title,focus);
	return false;
};

config.macros.newTiddler.handler = function(place,macroName,params,wikifier,paramString,tiddler)
{
	if(!readOnly) {
		params = paramString.parseParams("anon",null,true,false,false);
		var title = params[1] && params[1].name == "anon" ? params[1].value : this.title;
		title = getParam(params,"title",title);
		this.createNewTiddlerButton(place,title,params,this.label,this.prompt,this.accessKey,"title",false);
	}
};

config.macros.newJournal.handler = function(place,macroName,params,wikifier,paramString,tiddler)
{
	if(!readOnly) {
		params = paramString.parseParams("anon",null,true,false,false);
		var title = params[1] && params[1].name == "anon" ? params[1].value : config.macros.timeline.dateFormat;
		title = getParam(params,"title",title);
		config.macros.newTiddler.createNewTiddlerButton(place,title,params,this.label,this.prompt,this.accessKey,"text",true);
	}
};

//--
//-- Search macro
//--

config.macros.search.handler = function(place,macroName,params)
{
	var searchTimeout = null;
	var btn = createTiddlyButton(place,this.label,this.prompt,this.onClick);
	var txt = createTiddlyElement(place,"input",null,"txtOptionInput");
	if(params[0])
		txt.value = params[0];
	txt.onkeyup = this.onKeyPress;
	txt.onfocus = this.onFocus;
	txt.setAttribute("size",this.sizeTextbox);
	txt.setAttribute("accessKey",this.accessKey);
	txt.setAttribute("autocomplete","off");
	txt.setAttribute("lastSearchText","");
	if(config.browser.isSafari) {
		txt.setAttribute("type","search");
		txt.setAttribute("results","5");
	} else {
		txt.setAttribute("type","text");
	}
};

// Global because there's only ever one outstanding incremental search timer
config.macros.search.timeout = null;

config.macros.search.doSearch = function(txt)
{
	if(txt.value.length > 0) {
		story.search(txt.value,config.options.chkCaseSensitiveSearch,config.options.chkRegExpSearch);
		txt.setAttribute("lastSearchText",txt.value);
	}
};

config.macros.search.onClick = function(e)
{
	config.macros.search.doSearch(this.nextSibling);
	return false;
};

config.macros.search.onKeyPress = function(ev)
{
	var e = ev ? ev : window.event;
	switch(e.keyCode) {
		case 13: // Ctrl-Enter
		case 10: // Ctrl-Enter on IE PC
			config.macros.search.doSearch(this);
			break;
		case 27: // Escape
			this.value = "";
			clearMessage();
			break;
	}
	if(this.value.length > 2) {
		if(this.value != this.getAttribute("lastSearchText")) {
			if(config.macros.search.timeout)
				clearTimeout(config.macros.search.timeout);
			var txt = this;
			config.macros.search.timeout = setTimeout(function() {config.macros.search.doSearch(txt);},500);
		}
	} else {
		if(config.macros.search.timeout)
			clearTimeout(config.macros.search.timeout);
	}
};

config.macros.search.onFocus = function(e)
{
	this.select();
};

//--
//-- Tabs macro
//--

config.macros.tabs.handler = function(place,macroName,params)
{
	var cookie = params[0];
	var numTabs = (params.length-1)/3;
	var wrapper = createTiddlyElement(null,"div",null,cookie);
	var tabset = createTiddlyElement(wrapper,"div",null,"tabset");
	tabset.setAttribute("cookie",cookie);
	var validTab = false;
	for(var t=0; t<numTabs; t++) {
		var label = params[t*3+1];
		var prompt = params[t*3+2];
		var content = params[t*3+3];
		var tab = createTiddlyButton(tabset,label,prompt,this.onClickTab,"tab tabUnselected");
		tab.setAttribute("tab",label);
		tab.setAttribute("content",content);
		tab.title = prompt;
		if(config.options[cookie] == label)
			validTab = true;
	}
	if(!validTab)
		config.options[cookie] = params[1];
	place.appendChild(wrapper);
	this.switchTab(tabset,config.options[cookie]);
};

config.macros.tabs.onClickTab = function(e)
{
	config.macros.tabs.switchTab(this.parentNode,this.getAttribute("tab"));
	return false;
};

config.macros.tabs.switchTab = function(tabset,tab)
{
	var cookie = tabset.getAttribute("cookie");
	var theTab = null;
	var nodes = tabset.childNodes;
	for(var t=0; t<nodes.length; t++) {
		if(nodes[t].getAttribute && nodes[t].getAttribute("tab") == tab) {
			theTab = nodes[t];
			theTab.className = "tab tabSelected";
		} else {
			nodes[t].className = "tab tabUnselected";
		}
	}
	if(theTab) {
		if(tabset.nextSibling && tabset.nextSibling.className == "tabContents")
			removeNode(tabset.nextSibling);
		var tabContent = createTiddlyElement(null,"div",null,"tabContents");
		tabset.parentNode.insertBefore(tabContent,tabset.nextSibling);
		var contentTitle = theTab.getAttribute("content");
		wikify(store.getTiddlerText(contentTitle),tabContent,null,store.getTiddler(contentTitle));
		if(cookie) {
			config.options[cookie] = tab;
			saveOptionCookie(cookie);
		}
	}
};

//--
//-- Tiddler toolbar
//--

// Create a toolbar command button
config.macros.toolbar.createCommand = function(place,commandName,tiddler,theClass)
{
	if(typeof commandName != "string") {
		var c = null;
		for(var t in config.commands) {
			if(config.commands[t] == commandName)
				c = t;
		}
		commandName = c;
	}
	if((tiddler instanceof Tiddler) && (typeof commandName == "string")) {
		var command = config.commands[commandName];
		if(command.isEnabled ? command.isEnabled(tiddler) : this.isCommandEnabled(command,tiddler)) {
			var text = command.getText ? command.getText(tiddler) : this.getCommandText(command,tiddler);
			var tooltip = command.getTooltip ? command.getTooltip(tiddler) : this.getCommandTooltip(command,tiddler);
			var cmd;
			switch(command.type) {
				case "popup":
					cmd = this.onClickPopup;
					break;
				case "command":
				default:
					cmd = this.onClickCommand;
					break;
			}
			var btn = createTiddlyButton(null,text,tooltip,cmd);
			btn.setAttribute("commandName",commandName);
			btn.setAttribute("tiddler",tiddler.title);
			if(theClass)
				addClass(btn,theClass);
			place.appendChild(btn);
		}
	}
};

config.macros.toolbar.isCommandEnabled = function(command,tiddler)
{
	var title = tiddler.title;
	var ro = tiddler.isReadOnly();
	var shadow = store.isShadowTiddler(title) && !store.tiddlerExists(title);
	return (!ro || (ro && !command.hideReadOnly)) && !(shadow && command.hideShadow);
};

config.macros.toolbar.getCommandText = function(command,tiddler)
{
	return tiddler.isReadOnly() && command.readOnlyText ? command.readOnlyText : command.text;
};

config.macros.toolbar.getCommandTooltip = function(command,tiddler)
{
	return tiddler.isReadOnly() && command.readOnlyTooltip ? command.readOnlyTooltip : command.tooltip;
};

config.macros.toolbar.onClickCommand = function(ev)
{
	var e = ev ? ev : window.event;
	e.cancelBubble = true;
	if (e.stopPropagation) e.stopPropagation();
	var command = config.commands[this.getAttribute("commandName")];
	return command.handler(e,this,this.getAttribute("tiddler"));
};

config.macros.toolbar.onClickPopup = function(ev)
{
	var e = ev ? ev : window.event;
	e.cancelBubble = true;
	if (e.stopPropagation) e.stopPropagation();
	var popup = Popup.create(this);
	var command = config.commands[this.getAttribute("commandName")];
	var title = this.getAttribute("tiddler");
	var tiddler = store.fetchTiddler(title);
	popup.setAttribute("tiddler",title);
	command.handlePopup(popup,title);
	Popup.show();
	return false;
};

// Invoke the first command encountered from a given place that is tagged with a specified class
config.macros.toolbar.invokeCommand = function(place,theClass,event)
{
	var children = place.getElementsByTagName("a");
	for(var t=0; t<children.length; t++) {
		var c = children[t];
		if(hasClass(c,theClass) && c.getAttribute && c.getAttribute("commandName")) {
			if(c.onclick instanceof Function)
				c.onclick.call(c,event);
			break;
		}
	}
};

config.macros.toolbar.onClickMore = function(ev)
{
	var e = this.nextSibling;
	e.style.display = "inline";
	removeNode(this);
	return false;
};

config.macros.toolbar.handler = function(place,macroName,params,wikifier,paramString,tiddler)
{
	for(var t=0; t<params.length; t++) {
		var c = params[t];
		switch(c) {
			case '>':
				var btn = createTiddlyButton(place,this.moreLabel,this.morePrompt,config.macros.toolbar.onClickMore);
				addClass(btn,"moreCommand");
				var e = createTiddlyElement(place,"span",null,"moreCommand");
				e.style.display = "none";
				place = e;
				break;
			default:
				var theClass = "";
				switch(c.substr(0,1)) {
					case "+":
						theClass = "defaultCommand";
						c = c.substr(1);
						break;
					case "-":
						theClass = "cancelCommand";
						c = c.substr(1);
						break;
				}
				if(c in config.commands)
					this.createCommand(place,c,tiddler,theClass);
				break;
		}
	}
};

//--
//-- Menu and toolbar commands
//--

config.commands.closeTiddler.handler = function(event,src,title)
{
	story.closeTiddler(title,true);
	return false;
};

config.commands.closeOthers.handler = function(event,src,title)
{
	story.closeAllTiddlers(title);
	return false;
};

config.commands.editTiddler.handler = function(event,src,title)
{
	clearMessage();
	var tiddlerElem = document.getElementById(story.idPrefix + title);
	var fields = tiddlerElem.getAttribute("tiddlyFields");
	story.displayTiddler(null,title,DEFAULT_EDIT_TEMPLATE,false,null,fields);
	story.focusTiddler(title,"text");
	return false;
};

config.commands.saveTiddler.handler = function(event,src,title)
{
	var newTitle = story.saveTiddler(title,event.shiftKey);
	if(newTitle)
		story.displayTiddler(null,newTitle);
	return false;
};

config.commands.cancelTiddler.handler = function(event,src,title)
{
	if(story.hasChanges(title) && !readOnly) {
		if(!confirm(this.warning.format([title])))
			return false;
	}
	story.setDirty(title,false);
	story.displayTiddler(null,title);
	return false;
};

config.commands.deleteTiddler.handler = function(event,src,title)
{
	var deleteIt = true;
	if (config.options.chkConfirmDelete)
		deleteIt = confirm(this.warning.format([title]));
	if (deleteIt) {
		store.removeTiddler(title);
		story.closeTiddler(title,true);
		autoSaveChanges();
	}
	return false;
};

config.commands.permalink.handler = function(event,src,title)
{
	var t = encodeURIComponent(String.encodeTiddlyLink(title));
	if(window.location.hash != t)
		window.location.hash = t;
	return false;
};

config.commands.references.handlePopup = function(popup,title)
{
	var references = store.getReferringTiddlers(title);
	var c = false;
	for(var r=0; r<references.length; r++) {
		if(references[r].title != title && !references[r].isTagged("excludeLists")) {
			createTiddlyLink(createTiddlyElement(popup,"li"),references[r].title,true);
			c = true;
		}
	}
	if(!c)
		createTiddlyText(createTiddlyElement(popup,"li",null,"disabled"),this.popupNone);
};

config.commands.jump.handlePopup = function(popup,title)
{
	story.forEachTiddler(function(title,element) {
		createTiddlyLink(createTiddlyElement(popup,"li"),title,true,null,false,null,true);
		});
};

config.commands.syncing.handlePopup = function(popup,title)
{
	var tiddler = store.fetchTiddler(title);
	if(!tiddler)
		return;
	var serverType = tiddler.getServerType();
	var serverHost = tiddler.fields['server.host'];
	var serverWorkspace = tiddler.fields['server.workspace'];
	if(!serverWorkspace)
		serverWorkspace = "";
	if(serverType) {
		var e = createTiddlyElement(popup,"li",null,"popupMessage");
		e.innerHTML = config.commands.syncing.currentlySyncing.format([serverType,serverHost,serverWorkspace]);
	} else {
		createTiddlyElement(popup,"li",null,"popupMessage",config.commands.syncing.notCurrentlySyncing);
	}
	if(serverType) {
		createTiddlyElement(createTiddlyElement(popup,"li",null,"listBreak"),"div");
		var btn = createTiddlyButton(createTiddlyElement(popup,"li"),this.captionUnSync,null,config.commands.syncing.onChooseServer);
		btn.setAttribute("tiddler",title);
		btn.setAttribute("server.type","");
	}
	createTiddlyElement(createTiddlyElement(popup,"li",null,"listBreak"),"div");
	createTiddlyElement(popup,"li",null,"popupMessage",config.commands.syncing.chooseServer);
	var feeds = store.getTaggedTiddlers("systemServer","title");
	for(var t=0; t<feeds.length; t++) {
		var f = feeds[t];
		var feedServerType = store.getTiddlerSlice(f.title,"Type");
		if(!feedServerType)
			feedServerType = "file";
		var feedServerHost = store.getTiddlerSlice(f.title,"URL");
		if(!feedServerHost)
			feedServerHost = "";
		var feedServerWorkspace = store.getTiddlerSlice(f.title,"Workspace");
		if(!feedServerWorkspace)
			feedServerWorkspace = "";
		var caption = f.title;
		if(serverType == feedServerType && serverHost == feedServerHost && serverWorkspace == feedServerWorkspace) {
			caption = config.commands.syncing.currServerMarker + caption;
		} else {
			caption = config.commands.syncing.notCurrServerMarker + caption;
		}
		btn = createTiddlyButton(createTiddlyElement(popup,"li"),caption,null,config.commands.syncing.onChooseServer);
		btn.setAttribute("tiddler",title);
		btn.setAttribute("server.type",feedServerType);
		btn.setAttribute("server.host",feedServerHost);
		btn.setAttribute("server.workspace",feedServerWorkspace);
	}
};

config.commands.syncing.onChooseServer = function(e)
{
	var tiddler = this.getAttribute("tiddler");
	var serverType = this.getAttribute("server.type");
	if(serverType) {
		store.addTiddlerFields(tiddler,{
			'server.type': serverType,
			'server.host': this.getAttribute("server.host"),
			'server.workspace': this.getAttribute("server.workspace")
			});
	} else {
		store.setValue(tiddler,'server',null);
	}
	return false;
};

config.commands.fields.handlePopup = function(popup,title)
{
	var tiddler = store.fetchTiddler(title);
	if(!tiddler)
		return;
	var fields = {};
	store.forEachField(tiddler,function(tiddler,fieldName,value) {fields[fieldName] = value;},true);
	var items = [];
	for(var t in fields) {
		items.push({field: t,value: fields[t]});
	}
	items.sort(function(a,b) {return a.field < b.field ? -1 : (a.field == b.field ? 0 : +1);});
	if(items.length > 0)
		ListView.create(popup,items,this.listViewTemplate);
	else
		createTiddlyElement(popup,"div",null,null,this.emptyText);
};

//--
//-- Tiddler() object
//--

function Tiddler(title)
{
	this.title = title;
	this.text = null;
	this.modifier = null;
	this.modified = new Date();
	this.created = new Date();
	this.links = [];
	this.linksUpdated = false;
	this.tags = [];
	this.fields = {};
	return this;
}

Tiddler.prototype.getLinks = function()
{
	if(this.linksUpdated==false)
		this.changed();
	return this.links;
};

// Returns the fields that are inherited in string field:"value" field2:"value2" format
Tiddler.prototype.getInheritedFields = function()
{
	var f = {};
	for(i in this.fields) {
		if(i=="server.host" || i=="server.workspace" || i=="wikiformat"|| i=="server.type") {
			f[i] = this.fields[i];
		}
	}
	return String.encodeHashMap(f);
};

// Increment the changeCount of a tiddler
Tiddler.prototype.incChangeCount = function()
{
	var c = this.fields['changecount'];
	c = c ? parseInt(c) : 0;
	this.fields['changecount'] = String(c+1);
};

// Clear the changeCount of a tiddler
Tiddler.prototype.clearChangeCount = function()
{
	if(this.fields['changecount']) {
		delete this.fields['changecount'];
	}
};

// Returns true if the tiddler has been updated since the tiddler was created or downloaded
Tiddler.prototype.isTouched = function()
{
	var changeCount = this.fields['changecount'];
	if(changeCount === undefined)
		changeCount = 0;
	return changeCount > 0;
};

// Return the tiddler as an RSS item
Tiddler.prototype.toRssItem = function(uri)
{
	var s = [];
	s.push("<title" + ">" + this.title.htmlEncode() + "</title" + ">");
	s.push("<description>" + wikifyStatic(this.text,null,this).htmlEncode() + "</description>");
	for(var t=0; t<this.tags.length; t++)
		s.push("<category>" + this.tags[t] + "</category>");
	s.push("<link>" + uri + "#" + encodeURIComponent(String.encodeTiddlyLink(this.title)) + "</link>");
	s.push("<pubDate>" + this.modified.toGMTString() + "</pubDate>");
	return s.join("\n");
};

// Format the text for storage in an RSS item
Tiddler.prototype.saveToRss = function(uri)
{
	return "<item>\n" + this.toRssItem(uri) + "\n</item>";
};

// Change the text and other attributes of a tiddler
Tiddler.prototype.set = function(title,text,modifier,modified,tags,created,fields)
{
	this.assign(title,text,modifier,modified,tags,created,fields);
	this.changed();
	return this;
};

// Change the text and other attributes of a tiddler without triggered a tiddler.changed() call
Tiddler.prototype.assign = function(title,text,modifier,modified,tags,created,fields)
{
	if(title != undefined)
		this.title = title;
	if(text != undefined)
		this.text = text;
	if(modifier != undefined)
		this.modifier = modifier;
	if(modified != undefined)
		this.modified = modified;
	if(created != undefined)
		this.created = created;
	if(fields != undefined)
		this.fields = fields;
	if(tags != undefined)
		this.tags = (typeof tags == "string") ? tags.readBracketedList() : tags;
	else if(this.tags == undefined)
		this.tags = [];
	return this;
};

// Get the tags for a tiddler as a string (space delimited, using [[brackets]] for tags containing spaces)
Tiddler.prototype.getTags = function()
{
	return String.encodeTiddlyLinkList(this.tags);
};

// Test if a tiddler carries a tag
Tiddler.prototype.isTagged = function(tag)
{
	return this.tags.indexOf(tag) != -1;
};

// Static method to convert "\n" to newlines, "\s" to "\"
Tiddler.unescapeLineBreaks = function(text)
{
	return text ? text.unescapeLineBreaks() : "";
};

// Convert newlines to "\n", "\" to "\s"
Tiddler.prototype.escapeLineBreaks = function()
{
	return this.text.escapeLineBreaks();
};

// Updates the secondary information (like links[] array) after a change to a tiddler
Tiddler.prototype.changed = function()
{
	this.links = [];
	var t = this.autoLinkWikiWords() ? 0 : 1;
	var tiddlerLinkRegExp = t==0 ? config.textPrimitives.tiddlerAnyLinkRegExp : config.textPrimitives.tiddlerForcedLinkRegExp;
	tiddlerLinkRegExp.lastIndex = 0;
	var formatMatch = tiddlerLinkRegExp.exec(this.text);
	while(formatMatch) {
		var lastIndex = tiddlerLinkRegExp.lastIndex;
		if(t==0 && formatMatch[1] && formatMatch[1] != this.title) {
			// wikiWordLink
			if(formatMatch.index > 0) {
				var preRegExp = new RegExp(config.textPrimitives.unWikiLink+"|"+config.textPrimitives.anyLetter,"mg");
				preRegExp.lastIndex = formatMatch.index-1;
				var preMatch = preRegExp.exec(this.text);
				if(preMatch.index != formatMatch.index-1)
					this.links.pushUnique(formatMatch[1]);
			} else {
				this.links.pushUnique(formatMatch[1]);
			}
		}
		else if(formatMatch[2-t] && !config.formatterHelpers.isExternalLink(formatMatch[3-t])) // titledBrackettedLink
			this.links.pushUnique(formatMatch[3-t]);
		else if(formatMatch[4-t] && formatMatch[4-t] != this.title) // brackettedLink
			this.links.pushUnique(formatMatch[4-t]);
		tiddlerLinkRegExp.lastIndex = lastIndex;
		formatMatch = tiddlerLinkRegExp.exec(this.text);
	}
	this.linksUpdated = true;
};

Tiddler.prototype.getSubtitle = function()
{
	var modifier = this.modifier;
	if(!modifier)
		modifier = config.messages.subtitleUnknown;
	var modified = this.modified;
	if(modified)
		modified = modified.toLocaleString();
	else
		modified = config.messages.subtitleUnknown;
	return config.messages.tiddlerLinkTooltip.format([this.title,modifier,modified]);
};

Tiddler.prototype.isReadOnly = function()
{
	return readOnly;
};

Tiddler.prototype.autoLinkWikiWords = function()
{
	return !(this.isTagged("systemConfig") || this.isTagged("excludeMissing"));
};

Tiddler.prototype.generateFingerprint = function()
{
	return "0x" + Crypto.hexSha1Str(this.text);
};

Tiddler.prototype.getServerType = function()
{
	var serverType = null;
	if(this.fields && this.fields['server.type'])
		serverType = this.fields['server.type'];
	if(!serverType)
		serverType = this.fields['wikiformat'];
	if(serverType && !config.adaptors[serverType])
		serverType = null;
	return serverType;
};

Tiddler.prototype.getAdaptor = function()
{
	var serverType = this.getServerType();
	return serverType ? new config.adaptors[serverType] : null;
};

//--
//-- TiddlyWiki() object contains Tiddler()s
//--

function TiddlyWiki()
{
	var tiddlers = {}; // Hashmap by name of tiddlers
	this.tiddlersUpdated = false;
	this.namedNotifications = []; // Array of {name:,notify:} of notification functions
	this.notificationLevel = 0;
	this.slices = {}; // map tiddlerName->(map sliceName->sliceValue). Lazy.
	this.clear = function() {
		tiddlers = {};
		this.setDirty(false);
	};
	this.fetchTiddler = function(title) {
		var t = tiddlers[title];
		return t instanceof Tiddler ? t : null;
	};
	this.deleteTiddler = function(title) {
		delete this.slices[title];
		delete tiddlers[title];
	};
	this.addTiddler = function(tiddler) {
		delete this.slices[tiddler.title];
		tiddlers[tiddler.title] = tiddler;
	};
	this.forEachTiddler = function(callback) {
		for(var t in tiddlers) {
			var tiddler = tiddlers[t];
			if(tiddler instanceof Tiddler)
				callback.call(this,t,tiddler);
		}
	};
}

TiddlyWiki.prototype.setDirty = function(dirty)
{
	this.dirty = dirty;
};

TiddlyWiki.prototype.isDirty = function()
{
	return this.dirty;
};

TiddlyWiki.prototype.suspendNotifications = function()
{
	this.notificationLevel--;
};

TiddlyWiki.prototype.resumeNotifications = function()
{
	this.notificationLevel++;
};

// Invoke the notification handlers for a particular tiddler
TiddlyWiki.prototype.notify = function(title,doBlanket)
{
	if(!this.notificationLevel) {
		for(var t=0; t<this.namedNotifications.length; t++) {
			var n = this.namedNotifications[t];
			if((n.name == null && doBlanket) || (n.name == title))
				n.notify(title);
		}
	}
};

// Invoke the notification handlers for all tiddlers
TiddlyWiki.prototype.notifyAll = function()
{
	if(!this.notificationLevel) {
		for(var t=0; t<this.namedNotifications.length; t++) {
			var n = this.namedNotifications[t];
			if(n.name)
				n.notify(n.name);
		}
	}
};

// Add a notification handler to a tiddler
TiddlyWiki.prototype.addNotification = function(title,fn)
{
	for(var i=0; i<this.namedNotifications.length; i++) {
		if((this.namedNotifications[i].name == title) && (this.namedNotifications[i].notify == fn))
			return this;
	}
	this.namedNotifications.push({name: title, notify: fn});
	return this;
};

TiddlyWiki.prototype.removeTiddler = function(title)
{
	var tiddler = this.fetchTiddler(title);
	if(tiddler) {
		this.deleteTiddler(title);
		this.notify(title,true);
		this.setDirty(true);
	}
};

TiddlyWiki.prototype.tiddlerExists = function(title)
{
	var t = this.fetchTiddler(title);
	return t != undefined;
};

TiddlyWiki.prototype.isShadowTiddler = function(title)
{
	return typeof config.shadowTiddlers[title] == "string";
};

TiddlyWiki.prototype.getTiddler = function(title)
{
	var t = this.fetchTiddler(title);
	if(t != undefined)
		return t;
	else
		return null;
};

TiddlyWiki.prototype.getTiddlerText = function(title,defaultText)
{
  	if(!title)
		return defaultText;
	var pos = title.indexOf(config.textPrimitives.sectionSeparator);
	var section = null;
	if(pos != -1) {
		section = title.substr(pos + config.textPrimitives.sectionSeparator.length);
		title = title.substr(0,pos);
	}
	pos = title.indexOf(config.textPrimitives.sliceSeparator);
	if(pos != -1) {
		var slice = this.getTiddlerSlice(title.substr(0,pos),title.substr(pos + config.textPrimitives.sliceSeparator.length));
		if(slice)
			return slice;
	}
	var tiddler = this.fetchTiddler(title);
	if(tiddler) {
		if(!section)
			return tiddler.text;
		var re = new RegExp("(^!{1,6}" + section.escapeRegExp() + ")","mg");
		re.lastIndex = 0;
		var match =  re.exec(tiddler.text);
		if(match) {
			var t = tiddler.text.substr(match.index+match[1].length);
			var re2 = /^!/mg;
			re2.lastIndex = 0;
			match = re2.exec(t); //# search for the next heading
			if(match)
				t = t.substr(0,match.index);
			return t;
		}
		return defaultText;
	}
	if(this.isShadowTiddler(title))
		return config.shadowTiddlers[title];
	if(defaultText != undefined)
		return defaultText;
	return null;
};

TiddlyWiki.prototype.slicesRE = /(?:[\'\/]*~?([\.\w]+)[\'\/]*\:[\'\/]*\s*(.*?)\s*$)|(?:\|[\'\/]*~?([\.\w]+)\:?[\'\/]*\|\s*(.*?)\s*\|)/gm;

// @internal
TiddlyWiki.prototype.calcAllSlices = function(title)
{
	var slices = {};
	var text = this.getTiddlerText(title,"");
	this.slicesRE.lastIndex = 0;
	do {
		var m = this.slicesRE.exec(text);
		if(m) {
			if(m[1])
				slices[m[1]] = m[2];
			else
				slices[m[3]] = m[4];
		}
	} while(m);
	return slices;
};

// Returns the slice of text of the given name
TiddlyWiki.prototype.getTiddlerSlice = function(title,sliceName)
{
	var slices = this.slices[title];
	if(!slices) {
		slices = this.calcAllSlices(title);
		this.slices[title] = slices;
	}
	return slices[sliceName];
};

// Build an hashmap of the specified named slices of a tiddler
TiddlyWiki.prototype.getTiddlerSlices = function(title,sliceNames)
{
	var r = {};
	for(var t=0; t<sliceNames.length; t++) {
		var slice = this.getTiddlerSlice(title,sliceNames[t]);
		if(slice)
			r[sliceNames[t]] = slice;
	}
	return r;
};

TiddlyWiki.prototype.getRecursiveTiddlerText = function(title,defaultText,depth)
{
	var bracketRegExp = new RegExp("(?:\\[\\[([^\\]]+)\\]\\])","mg");
	var text = this.getTiddlerText(title,null);
	if(text == null)
		return defaultText;
	var textOut = [];
	var lastPos = 0;
	do {
		var match = bracketRegExp.exec(text);
		if(match) {
			textOut.push(text.substr(lastPos,match.index-lastPos));
			if(match[1]) {
				if(depth <= 0)
					textOut.push(match[1]);
				else
					textOut.push(this.getRecursiveTiddlerText(match[1],"[[" + match[1] + "]]",depth-1));
			}
			lastPos = match.index + match[0].length;
		} else {
			textOut.push(text.substr(lastPos));
		}
	} while(match);
	return textOut.join("");
};

TiddlyWiki.prototype.setTiddlerTag = function(title,status,tag)
{
	var tiddler = this.fetchTiddler(title);
	if(tiddler) {
		var t = tiddler.tags.indexOf(tag);
		if(t != -1)
			tiddler.tags.splice(t,1);
		if(status)
			tiddler.tags.push(tag);
		tiddler.changed();
		this.incChangeCount(title);
		this.notify(title,true);
		this.setDirty(true);
	}
};

TiddlyWiki.prototype.addTiddlerFields = function(title,fields)
{
	var tiddler = this.fetchTiddler(title);
	if(!tiddler)
		return;
	merge(tiddler.fields,fields);
	tiddler.changed();
	this.incChangeCount(title);
	this.notify(title,true);
	this.setDirty(true);
};

TiddlyWiki.prototype.saveTiddler = function(title,newTitle,newBody,modifier,modified,tags,fields,clearChangeCount,created)
{
	var tiddler = this.fetchTiddler(title);
	if(tiddler) {
		created = created ? created : tiddler.created; // Preserve created date
		this.deleteTiddler(title);
	} else {
		created = created ? created : modified;
		tiddler = new Tiddler();
	}
	tiddler.set(newTitle,newBody,modifier,modified,tags,created,fields);
	this.addTiddler(tiddler);
	if(clearChangeCount)
		tiddler.clearChangeCount();
	else
		tiddler.incChangeCount();
	if(title != newTitle)
		this.notify(title,true);
	this.notify(newTitle,true);
	this.setDirty(true);
	return tiddler;
};

// Reset the sync status of a freshly synced tiddler
TiddlyWiki.prototype.resetTiddler = function(title)
{
	var tiddler = this.fetchTiddler(title);
	if(tiddler) {
		tiddler.clearChangeCount();
		this.notify(title,true);
		this.setDirty(true);
	}
};

TiddlyWiki.prototype.incChangeCount = function(title)
{
	var tiddler = this.fetchTiddler(title);
	if(tiddler)
		tiddler.incChangeCount();
};

TiddlyWiki.prototype.createTiddler = function(title)
{
	var tiddler = this.fetchTiddler(title);
	if(!tiddler) {
		tiddler = new Tiddler();
		tiddler.title = title;
		this.addTiddler(tiddler);
		this.setDirty(true);
	}
	return tiddler;
};

// Load contents of a TiddlyWiki from an HTML DIV
TiddlyWiki.prototype.loadFromDiv = function(src,idPrefix,noUpdate)
{
	this.idPrefix = idPrefix;
	var storeElem = (typeof src == "string") ? document.getElementById(src) : src;
	if(!storeElem)
		return;
	var tiddlers = this.getLoader().loadTiddlers(this,storeElem.childNodes);
	this.setDirty(false);
	if(!noUpdate) {
		for(var i = 0;i<tiddlers.length; i++)
			tiddlers[i].changed();
	}
};

// Load contents of a TiddlyWiki from a string
// Returns null if there's an error
TiddlyWiki.prototype.importTiddlyWiki = function(text)
{
	var posDiv = locateStoreArea(text);
	if(!posDiv)
		return null;
	var content = "<" + "html><" + "body>" + text.substring(posDiv[0],posDiv[1] + endSaveArea.length) + "<" + "/body><" + "/html>";
	// Create the iframe
	var iframe = document.createElement("iframe");
	iframe.style.display = "none";
	document.body.appendChild(iframe);
	var doc = iframe.document;
	if(iframe.contentDocument)
		doc = iframe.contentDocument; // For NS6
	else if(iframe.contentWindow)
		doc = iframe.contentWindow.document; // For IE5.5 and IE6
	// Put the content in the iframe
	doc.open();
	doc.writeln(content);
	doc.close();
	// Load the content into a TiddlyWiki() object
	var storeArea = doc.getElementById("storeArea");
	this.loadFromDiv(storeArea,"store");
	// Get rid of the iframe
	iframe.parentNode.removeChild(iframe);
	return this;
};

TiddlyWiki.prototype.updateTiddlers = function()
{
	this.tiddlersUpdated = true;
	this.forEachTiddler(function(title,tiddler) {
		tiddler.changed();
	});
};

// Return all tiddlers formatted as an HTML string
TiddlyWiki.prototype.allTiddlersAsHtml = function()
{
	return store.getSaver().externalize(store);
};

// Return an array of tiddlers matching a search regular expression
TiddlyWiki.prototype.search = function(searchRegExp,sortField,excludeTag,match)
{
	var candidates = this.reverseLookup("tags",excludeTag,!!match);
	var results = [];
	for(var t=0; t<candidates.length; t++) {
		if((candidates[t].title.search(searchRegExp) != -1) || (candidates[t].text.search(searchRegExp) != -1))
			results.push(candidates[t]);
	}
	if(!sortField)
		sortField = "title";
	results.sort(function(a,b) {return a[sortField] < b[sortField] ? -1 : (a[sortField] == b[sortField] ? 0 : +1);});
	return results;
};

// Returns a list of all tags in use
//   excludeTag - if present, excludes tags that are themselves tagged with excludeTag
// Returns an array of arrays where [tag][0] is the name of the tag and [tag][1] is the number of occurances
TiddlyWiki.prototype.getTags = function(excludeTag)
{
	var results = [];
	this.forEachTiddler(function(title,tiddler) {
		for(var g=0; g<tiddler.tags.length; g++) {
			var tag = tiddler.tags[g];
			var n = true;
			for(var c=0; c<results.length; c++) {
				if(results[c][0] == tag) {
					n = false;
					results[c][1]++;
				}
			}
			if(n && excludeTag) {
				var t = store.fetchTiddler(tag);
				if(t && t.isTagged(excludeTag))
					n = false;
			}
			if(n)
				results.push([tag,1]);
		}
	});
	results.sort(function(a,b) {return a[0].toLowerCase() < b[0].toLowerCase() ? -1 : (a[0].toLowerCase() == b[0].toLowerCase() ? 0 : +1);});
	return results;
};

// Return an array of the tiddlers that are tagged with a given tag
TiddlyWiki.prototype.getTaggedTiddlers = function(tag,sortField)
{
	return this.reverseLookup("tags",tag,true,sortField);
};

// Return an array of the tiddlers that link to a given tiddler
TiddlyWiki.prototype.getReferringTiddlers = function(title,unusedParameter,sortField)
{
	if(!this.tiddlersUpdated)
		this.updateTiddlers();
	return this.reverseLookup("links",title,true,sortField);
};

// Return an array of the tiddlers that do or do not have a specified entry in the specified storage array (ie, "links" or "tags")
// lookupMatch == true to match tiddlers, false to exclude tiddlers
TiddlyWiki.prototype.reverseLookup = function(lookupField,lookupValue,lookupMatch,sortField)
{
	var results = [];
	this.forEachTiddler(function(title,tiddler) {
		var f = !lookupMatch;
		for(var lookup=0; lookup<tiddler[lookupField].length; lookup++) {
			if(tiddler[lookupField][lookup] == lookupValue)
				f = lookupMatch;
		}
		if(f)
			results.push(tiddler);
	});
	if(!sortField)
		sortField = "title";
	results.sort(function(a,b) {return a[sortField] < b[sortField] ? -1 : (a[sortField] == b[sortField] ? 0 : +1);});
	return results;
};

// Return the tiddlers as a sorted array
TiddlyWiki.prototype.getTiddlers = function(field,excludeTag)
{
	var results = [];
	this.forEachTiddler(function(title,tiddler) {
		if(excludeTag == undefined || !tiddler.isTagged(excludeTag))
			results.push(tiddler);
	});
	if(field)
		results.sort(function(a,b) {return a[field] < b[field] ? -1 : (a[field] == b[field] ? 0 : +1);});
	return results;
};

// Return array of names of tiddlers that are referred to but not defined
TiddlyWiki.prototype.getMissingLinks = function(sortField)
{
	if(!this.tiddlersUpdated)
		this.updateTiddlers();
	var results = [];
	this.forEachTiddler(function (title,tiddler) {
		if(tiddler.isTagged("excludeMissing") || tiddler.isTagged("systemConfig"))
			return;
		for(var n=0; n<tiddler.links.length;n++) {
			var link = tiddler.links[n];
			if(this.fetchTiddler(link) == null && !this.isShadowTiddler(link))
				results.pushUnique(link);
		}
	});
	results.sort();
	return results;
};

// Return an array of names of tiddlers that are defined but not referred to
TiddlyWiki.prototype.getOrphans = function()
{
	var results = [];
	this.forEachTiddler(function (title,tiddler) {
		if(this.getReferringTiddlers(title).length == 0 && !tiddler.isTagged("excludeLists"))
			results.push(title);
	});
	results.sort();
	return results;
};

// Return an array of names of all the shadow tiddlers
TiddlyWiki.prototype.getShadowed = function()
{
	var results = [];
	for(var t in config.shadowTiddlers) {
		if(typeof config.shadowTiddlers[t] == "string")
			results.push(t);
	}
	results.sort();
	return results;
};

// Return an array of tiddlers that have been touched since they were downloaded or created
TiddlyWiki.prototype.getTouched = function()
{
	var results = [];
	this.forEachTiddler(function(title,tiddler) {
		if(tiddler.isTouched())
			results.push(tiddler);
		});
	results.sort();
	return results;
};

// Resolves a Tiddler reference or tiddler title into a Tiddler object, or null if it doesn't exist
TiddlyWiki.prototype.resolveTiddler = function(tiddler)
{
	var t = (typeof tiddler == 'string') ? this.getTiddler(tiddler) : tiddler;
	return t instanceof Tiddler ? t : null;
};

TiddlyWiki.prototype.getLoader = function()
{
	if(!this.loader)
		this.loader = new TW21Loader();
	return this.loader;
};

TiddlyWiki.prototype.getSaver = function()
{
	if(!this.saver)
		this.saver = new TW21Saver();
	return this.saver;
};

// Filter a list of tiddlers
TiddlyWiki.prototype.filterTiddlers = function(filter)
{
	var results = [];
	if(filter) {
		var tiddler;
		var re = /([^ \[\]]+)|(?:\[([ \w]+)\[([^\]]+)\]\])|(?:\[\[([^\]]+)\]\])/mg;
		var match = re.exec(filter);
		while(match) {
			if(match[1] || match[4]) {
				var title = match[1] ? match[1] : match[4];
				tiddler = this.fetchTiddler(title);
				if(tiddler) {
					results.pushUnique(tiddler);
				} else if(store.isShadowTiddler(title)) {
					tiddler = new Tiddler();
					tiddler.set(title,store.getTiddlerText(title));
					results.pushUnique(tiddler);
				}
			} else if(match[2]) {
				switch(match[2]) {
					case "tag":
						this.forEachTiddler(function(title,tiddler) {
							if(tiddler.isTagged(match[3]))
								results.pushUnique(tiddler);
						});
						break;
					case "sort":
						results = this.sortTiddlers(results,match[3]);
						break; 
				}
			}
			match = re.exec(filter);
		}
	}
	return results;
};

// Sort a list of tiddlers
TiddlyWiki.prototype.sortTiddlers = function(tiddlers,field)
{
	var asc = +1;
	switch(field.substr(0,1)) {
		case "-":
			asc = -1;
			// Note: this fall-through is intentional
		case "+":
			field = field.substr(1);
			break;
	}
	if(TiddlyWiki.standardFieldAccess[field])
		tiddlers.sort(function(a,b) {return a[field] < b[field] ? -asc : (a[field] == b[field] ? 0 : asc);});
	else
		tiddlers.sort(function(a,b) {return a.fields[field] < b.fields[field] ? -asc : (a.fields[field] == b.fields[field] ? 0 : +asc);});
	return tiddlers;
};
// Returns true if path is a valid field name (path),
// i.e. a sequence of identifiers, separated by '.'
TiddlyWiki.isValidFieldName = function(name)
{
	var match = /[a-zA-Z_]\w*(\.[a-zA-Z_]\w*)*/.exec(name);
	return match && (match[0] == name);
};

// Throws an exception when name is not a valid field name.
TiddlyWiki.checkFieldName = function(name)
{
	if(!TiddlyWiki.isValidFieldName(name))
		throw config.messages.invalidFieldName.format([name]);
};

function StringFieldAccess(n,readOnly)
{
	this.set = readOnly ?
			function(t,v) {if(v != t[n]) throw config.messages.fieldCannotBeChanged.format([n]);} :
			function(t,v) {if(v != t[n]) {t[n] = v; return true;}};
	this.get = function(t) {return t[n];};
}

function DateFieldAccess(n)
{
	this.set = function(t,v) {
		var d = v instanceof Date ? v : Date.convertFromYYYYMMDDHHMM(v);
		if(d != t[n]) {
			t[n] = d; return true;
		}
	};
	this.get = function(t) {return t[n].convertToYYYYMMDDHHMM();};
}

function LinksFieldAccess(n)
{
	this.set = function(t,v) {
		var s = (typeof v == "string") ? v.readBracketedList() : v;
		if(s.toString() != t[n].toString()) {
			t[n] = s; return true;
		}
	};
	this.get = function(t) {return String.encodeTiddlyLinkList(t[n]);};
}

TiddlyWiki.standardFieldAccess = {
	// The set functions return true when setting the data has changed the value.
	"title":    new StringFieldAccess("title",true),
	// Handle the "tiddler" field name as the title
	"tiddler":  new StringFieldAccess("title",true),
	"text":     new StringFieldAccess("text"),
	"modifier": new StringFieldAccess("modifier"),
	"modified": new DateFieldAccess("modified"),
	"created":  new DateFieldAccess("created"),
	"tags":     new LinksFieldAccess("tags")
};

TiddlyWiki.isStandardField = function(name)
{
	return TiddlyWiki.standardFieldAccess[name] != undefined;
};

// Sets the value of the given field of the tiddler to the value.
// Setting an ExtendedField's value to null or undefined removes the field.
// Setting a namespace to undefined removes all fields of that namespace.
// The fieldName is case-insensitive.
// All values will be converted to a string value.
TiddlyWiki.prototype.setValue = function(tiddler,fieldName,value)
{
	TiddlyWiki.checkFieldName(fieldName);
	var t = this.resolveTiddler(tiddler);
	if(!t)
		return;
	fieldName = fieldName.toLowerCase();
	var isRemove = (value === undefined) || (value === null);
	var accessor = TiddlyWiki.standardFieldAccess[fieldName];
	if(accessor) {
		if(isRemove)
			// don't remove StandardFields
			return;
		var h = TiddlyWiki.standardFieldAccess[fieldName];
		if(!h.set(t,value))
			return;
	} else {
		var oldValue = t.fields[fieldName];
		if(isRemove) {
			if(oldValue !== undefined) {
				// deletes a single field
				delete t.fields[fieldName];
			} else {
				// no concrete value is defined for the fieldName
				// so we guess this is a namespace path.
				// delete all fields in a namespace
				var re = new RegExp('^'+fieldName+'\\.');
				var dirty = false;
				for(var n in t.fields) {
					if(n.match(re)) {
						delete t.fields[n];
						dirty = true;
					}
				}
				if(!dirty)
					return;
			}
		} else {
			// the "normal" set case. value is defined (not null/undefined)
			// For convenience provide a nicer conversion Date->String
			value = value instanceof Date ? value.convertToYYYYMMDDHHMMSSMMM() : String(value);
			if(oldValue == value)
				return;
			t.fields[fieldName] = value;
		}
	}
	// When we are here the tiddler/store really was changed.
	this.notify(t.title,true);
	if(!fieldName.match(/^temp\./))
		this.setDirty(true);
};

// Returns the value of the given field of the tiddler.
// The fieldName is case-insensitive.
// Will only return String values (or undefined).
TiddlyWiki.prototype.getValue = function(tiddler,fieldName)
{
	var t = this.resolveTiddler(tiddler);
	if(!t)
		return undefined;
	fieldName = fieldName.toLowerCase();
	var accessor = TiddlyWiki.standardFieldAccess[fieldName];
	if(accessor) {
		return accessor.get(t);
	}
	return t.fields[fieldName];
};

// Calls the callback function for every field in the tiddler.
// When callback function returns a non-false value the iteration stops
// and that value is returned.
// The order of the fields is not defined.
// @param callback a function(tiddler,fieldName,value).
TiddlyWiki.prototype.forEachField = function(tiddler,callback,onlyExtendedFields)
{
	var t = this.resolveTiddler(tiddler);
	if(!t)
		return undefined;
	var n,result;
	for(n in t.fields) {
		result = callback(t,n,t.fields[n]);
		if(result)
			return result;
		}
	if(onlyExtendedFields)
		return undefined;
	for(n in TiddlyWiki.standardFieldAccess) {
		if(n == "tiddler")
			// even though the "title" field can also be referenced through the name "tiddler"
			// we only visit this field once.
			continue;
		result = callback(t,n,TiddlyWiki.standardFieldAccess[n].get(t));
		if(result)
			return result;
	}
	return undefined;
};

//--
//-- Story functions
//--

function Story(container,idPrefix)
{
	this.container = container;
	this.idPrefix = idPrefix;
	this.highlightRegExp = null;
}

Story.prototype.forEachTiddler = function(fn)
{
	var place = document.getElementById(this.container);
	if(!place)
		return;
	var e = place.firstChild;
	while(e) {
		var n = e.nextSibling;
		var title = e.getAttribute("tiddler");
		fn.call(this,title,e);
		e = n;
	}
};

Story.prototype.displayTiddlers = function(srcElement,titles,template,animate,unused,customFields,toggle)
{
	for(var t = titles.length-1;t>=0;t--)
		this.displayTiddler(srcElement,titles[t],template,animate,unused,customFields);
};

Story.prototype.displayTiddler = function(srcElement,tiddler,template,animate,unused,customFields,toggle)
{
	var title = (tiddler instanceof Tiddler)? tiddler.title : tiddler;  
	var place = document.getElementById(this.container);
	var tiddlerElem = document.getElementById(this.idPrefix + title);
	if(tiddlerElem) {
		if(toggle)
			this.closeTiddler(title,true);
		else
			this.refreshTiddler(title,template,false,customFields);
	} else {
		var before = this.positionTiddler(srcElement);
		tiddlerElem = this.createTiddler(place,before,title,template,customFields);
	}
	if(srcElement && typeof srcElement !== "string") {
		if(config.options.chkAnimate && (animate == undefined || animate == true) && anim && typeof Zoomer == "function" && typeof Scroller == "function")
			anim.startAnimating(new Zoomer(title,srcElement,tiddlerElem),new Scroller(tiddlerElem));
		else
			window.scrollTo(0,ensureVisible(tiddlerElem));
	}
};

Story.prototype.positionTiddler = function(srcElement)
{
	var place = document.getElementById(this.container);
	var before = null;
	if(typeof srcElement == "string") {
		switch(srcElement) {
			case "top":
				before = place.firstChild;
				break;
			case "bottom":
				before = null;
				break;
		}
	} else {
		var after = this.findContainingTiddler(srcElement);
		if(after == null) {
			before = place.firstChild;
		} else if(after.nextSibling) {
			before = after.nextSibling;
			if(before.nodeType != 1)
				before = null;
		}
	}
	return before;
};

Story.prototype.createTiddler = function(place,before,title,template,customFields)
{
	var tiddlerElem = createTiddlyElement(null,"div",this.idPrefix + title,"tiddler");
	tiddlerElem.setAttribute("refresh","tiddler");
	if(customFields)
		tiddlerElem.setAttribute("tiddlyFields",customFields);
	place.insertBefore(tiddlerElem,before);
	var defaultText = null;
	if(!store.tiddlerExists(title) && !store.isShadowTiddler(title))
		defaultText = this.loadMissingTiddler(title,customFields,tiddlerElem);
	this.refreshTiddler(title,template,false,customFields,defaultText);
	return tiddlerElem;
};

Story.prototype.loadMissingTiddler = function(title,fields,tiddlerElem)
{
	var tiddler = new Tiddler(title);
	tiddler.fields = typeof fields == "string" ?  fields.decodeHashMap() : (fields ? fields : {});
	var serverType = tiddler.getServerType();
	var host = tiddler.fields['server.host'];
	var workspace = tiddler.fields['server.workspace'];
	if(!serverType || !host)
		return null;
	var sm = new SyncMachine(serverType,{
			start: function() {
				return this.openHost(host,"openWorkspace");
			},
			openWorkspace: function() {
				return this.openWorkspace(workspace,"getTiddler");
			},
			getTiddler: function() {
				return this.getTiddler(title,"onGetTiddler");
			},
			onGetTiddler: function(context) {
				var tiddler = context.tiddler;
				if(tiddler && tiddler.text) {
					var downloaded = new Date();
					if(!tiddler.created)
						tiddler.created = downloaded;
					if(!tiddler.modified)
						tiddler.modified = tiddler.created;
					store.saveTiddler(tiddler.title,tiddler.title,tiddler.text,tiddler.modifier,tiddler.modified,tiddler.tags,tiddler.fields,true,tiddler.created);
					autoSaveChanges();
				}
				delete this;
				return true;
			},
			error: function(message) {
				displayMessage("Error loading missing tiddler from %0: %1".format([host,message]));
			}
		});
	sm.go();
	return config.messages.loadingMissingTiddler.format([title,serverType,host,workspace]);
};

Story.prototype.chooseTemplateForTiddler = function(title,template)
{
	if(!template)
		template = DEFAULT_VIEW_TEMPLATE;
	if(template == DEFAULT_VIEW_TEMPLATE || template == DEFAULT_EDIT_TEMPLATE)
		template = config.tiddlerTemplates[template];
	return template;
};

Story.prototype.getTemplateForTiddler = function(title,template,tiddler)
{
	return store.getRecursiveTiddlerText(template,null,10);
};

Story.prototype.refreshTiddler = function(title,template,force,customFields,defaultText)
{
	var tiddlerElem = document.getElementById(this.idPrefix + title);
	if(tiddlerElem) {
		if(tiddlerElem.getAttribute("dirty") == "true" && !force)
			return tiddlerElem;
		template = this.chooseTemplateForTiddler(title,template);
		var currTemplate = tiddlerElem.getAttribute("template");
		if((template != currTemplate) || force) {
			var tiddler = store.getTiddler(title);
			if(!tiddler) {
				tiddler = new Tiddler();
				if(store.isShadowTiddler(title)) {
					tiddler.set(title,store.getTiddlerText(title),config.views.wikified.shadowModifier,version.date,[],version.date);
				} else {
					var text = template=="EditTemplate" ?
								config.views.editor.defaultText.format([title]) :
								config.views.wikified.defaultText.format([title]);
					text = defaultText ? defaultText : text;
					var fields = customFields ? customFields.decodeHashMap() : null;
					tiddler.set(title,text,config.views.wikified.defaultModifier,version.date,[],version.date,fields);
				}
			}
			tiddlerElem.setAttribute("tags",tiddler.tags.join(" "));
			tiddlerElem.setAttribute("tiddler",title);
			tiddlerElem.setAttribute("template",template);
			var me = this;
			tiddlerElem.onmouseover = this.onTiddlerMouseOver;
			tiddlerElem.onmouseout = this.onTiddlerMouseOut;
			tiddlerElem.ondblclick = this.onTiddlerDblClick;
			tiddlerElem[window.event?"onkeydown":"onkeypress"] = this.onTiddlerKeyPress;
			var html = this.getTemplateForTiddler(title,template,tiddler);
			tiddlerElem.innerHTML = html;
			applyHtmlMacros(tiddlerElem,tiddler);
			if(store.getTaggedTiddlers(title).length > 0)
				addClass(tiddlerElem,"isTag");
			else
				removeClass(tiddlerElem,"isTag");
			if(!store.tiddlerExists(title)) {
				if(store.isShadowTiddler(title))
					addClass(tiddlerElem,"shadow");
				else
					addClass(tiddlerElem,"missing");
			} else {
				removeClass(tiddlerElem,"shadow");
				removeClass(tiddlerElem,"missing");
			}
			if(customFields)
				this.addCustomFields(tiddlerElem,customFields);
			forceReflow();
		}
	}
	return tiddlerElem;
};

Story.prototype.addCustomFields = function(place,customFields)
{
	var fields = customFields.decodeHashMap();
	var w = document.createElement("div");
	w.style.display = "none";
	place.appendChild(w);
	for(var t in fields) {
		var e = document.createElement("input");
		e.setAttribute("type","text");
		e.setAttribute("value",fields[t]);
		w.appendChild(e);
		e.setAttribute("edit",t);
	}
};

Story.prototype.refreshAllTiddlers = function(force)
{
	var place = document.getElementById(this.container);
	var e = place.firstChild;
	if(!e)
		return;
	this.refreshTiddler(e.getAttribute("tiddler"),force ? null : e.getAttribute("template"),true);
	while((e = e.nextSibling) != null)
		this.refreshTiddler(e.getAttribute("tiddler"),force ? null : e.getAttribute("template"),true);
};

Story.prototype.onTiddlerMouseOver = function(e)
{
	if(window.addClass instanceof Function)
		addClass(this,"selected");
};

Story.prototype.onTiddlerMouseOut = function(e)
{
	if(window.removeClass instanceof Function)
		removeClass(this,"selected");
};

Story.prototype.onTiddlerDblClick = function(ev)
{
	var e = ev ? ev : window.event;
	var theTarget = resolveTarget(e);
	if(theTarget && theTarget.nodeName.toLowerCase() != "input" && theTarget.nodeName.toLowerCase() != "textarea") {
		if(document.selection && document.selection.empty)
			document.selection.empty();
		config.macros.toolbar.invokeCommand(this,"defaultCommand",e);
		e.cancelBubble = true;
		if(e.stopPropagation) e.stopPropagation();
		return true;
	} else {
		return false;
	}
};

Story.prototype.onTiddlerKeyPress = function(ev)
{
	var e = ev ? ev : window.event;
	clearMessage();
	var consume = false;
	var title = this.getAttribute("tiddler");
	var target = resolveTarget(e);
	switch(e.keyCode) {
		case 9: // Tab
			if(config.options.chkInsertTabs && target.tagName.toLowerCase() == "textarea") {
				replaceSelection(target,String.fromCharCode(9));
				consume = true;
			}
			if(config.isOpera) {
				target.onblur = function() {
					this.focus();
					this.onblur = null;
				};
			}
			break;
		case 13: // Ctrl-Enter
		case 10: // Ctrl-Enter on IE PC
		case 77: // Ctrl-Enter is "M" on some platforms
			if(e.ctrlKey) {
				blurElement(this);
				config.macros.toolbar.invokeCommand(this,"defaultCommand",e);
				consume = true;
			}
			break;
		case 27: // Escape
			blurElement(this);
			config.macros.toolbar.invokeCommand(this,"cancelCommand",e);
			consume = true;
			break;
	}
	e.cancelBubble = consume;
	if(consume) {
		if(e.stopPropagation) e.stopPropagation(); // Stop Propagation
		e.returnValue = true; // Cancel The Event in IE
		if(e.preventDefault ) e.preventDefault(); // Cancel The Event in Moz
	}
	return !consume;
};

Story.prototype.getTiddlerField = function(title,field)
{
	var tiddlerElem = document.getElementById(this.idPrefix + title);
	var e = null;
	if(tiddlerElem != null) {
		var children = tiddlerElem.getElementsByTagName("*");
		for(var t=0; t<children.length; t++) {
			var c = children[t];
			if(c.tagName.toLowerCase() == "input" || c.tagName.toLowerCase() == "textarea") {
				if(!e)
					e = c;
				if(c.getAttribute("edit") == field)
					e = c;
			}
		}
	}
	return e;
};

Story.prototype.focusTiddler = function(title,field)
{
	var e = this.getTiddlerField(title,field);
	if(e) {
		e.focus();
		e.select();
	}
};

Story.prototype.blurTiddler = function(title)
{
	var tiddlerElem = document.getElementById(this.idPrefix + title);
	if(tiddlerElem != null && tiddlerElem.focus && tiddlerElem.blur) {
		tiddlerElem.focus();
		tiddlerElem.blur();
	}
};

Story.prototype.setTiddlerField = function(title,tag,mode,field)
{
	var c = story.getTiddlerField(title,field);

	var tags = c.value.readBracketedList();
	tags.setItem(tag,mode);
	c.value = String.encodeTiddlyLinkList(tags);
};

Story.prototype.setTiddlerTag = function(title,tag,mode)
{
	Story.prototype.setTiddlerField(title,tag,mode,"tags");
};

Story.prototype.closeTiddler = function(title,animate,unused)
{
	var tiddlerElem = document.getElementById(this.idPrefix + title);
	if(tiddlerElem != null) {
		clearMessage();
		this.scrubTiddler(tiddlerElem);
		if(config.options.chkAnimate && animate && anim && typeof Slider == "function")
			anim.startAnimating(new Slider(tiddlerElem,false,null,"all"));
		else {
			removeNode(tiddlerElem);
			forceReflow();
		}
	}
};

Story.prototype.scrubTiddler = function(tiddlerElem)
{
	tiddlerElem.id = null;
};

Story.prototype.setDirty = function(title,dirty)
{
	var tiddlerElem = document.getElementById(this.idPrefix + title);
	if(tiddlerElem != null)
		tiddlerElem.setAttribute("dirty",dirty ? "true" : "false");
};

Story.prototype.isDirty = function(title)
{
	var tiddlerElem = document.getElementById(this.idPrefix + title);
	if(tiddlerElem != null)
		return tiddlerElem.getAttribute("dirty") == "true";
	return null;
};

Story.prototype.areAnyDirty = function()
{
	var r = false;
	this.forEachTiddler(function(title,element) {
		if(this.isDirty(title))
			r = true;
	});
	return r;
};

Story.prototype.closeAllTiddlers = function(exclude)
{
	clearMessage();
	this.forEachTiddler(function(title,element) {
		if((title != exclude) && element.getAttribute("dirty") != "true")
			this.closeTiddler(title);
	});
	window.scrollTo(0,ensureVisible(this.container));
};

Story.prototype.isEmpty = function()
{
	var place = document.getElementById(this.container);
	return place && place.firstChild == null;
};

Story.prototype.search = function(text,useCaseSensitive,useRegExp)
{
	this.closeAllTiddlers();
	highlightHack = new RegExp(useRegExp ?	 text : text.escapeRegExp(),useCaseSensitive ? "mg" : "img");
	var matches = store.search(highlightHack,"title","excludeSearch");
	this.displayTiddlers(null,matches);
	highlightHack = null;
	var q = useRegExp ? "/" : "'";
	if(matches.length > 0)
		displayMessage(config.macros.search.successMsg.format([matches.length.toString(),q + text + q]));
	else
		displayMessage(config.macros.search.failureMsg.format([q + text + q]));
};

Story.prototype.findContainingTiddler = function(e)
{
	while(e && !hasClass(e,"tiddler"))
		e = e.parentNode;
	return e;
};

Story.prototype.gatherSaveFields = function(e,fields)
{
	if(e && e.getAttribute) {
		var f = e.getAttribute("edit");
		if(f)
			fields[f] = e.value.replace(/\r/mg,"");
		if(e.hasChildNodes()) {
			var c = e.childNodes;
			for(var t=0; t<c.length; t++)
				this.gatherSaveFields(c[t],fields);
		}
	}
};

Story.prototype.hasChanges = function(title)
{
	var e = document.getElementById(this.idPrefix + title);
	if(e != null) {
		var fields = {};
		this.gatherSaveFields(e,fields);
		var tiddler = store.fetchTiddler(title);
		if(!tiddler)
			return false;
		for(var n in fields) {
			if(store.getValue(title,n) != fields[n])
				return true;
		}
	}
	return false;
};

Story.prototype.saveTiddler = function(title,minorUpdate)
{
	var tiddlerElem = document.getElementById(this.idPrefix + title);
	if(tiddlerElem != null) {
		var fields = {};
		this.gatherSaveFields(tiddlerElem,fields);
		var newTitle = fields.title ? fields.title : title;
		if(!store.tiddlerExists(newTitle))
			newTitle = newTitle.trim();
		if(store.tiddlerExists(newTitle) && newTitle != title) {
			if(!confirm(config.messages.overwriteWarning.format([newTitle.toString()])))
				return null;
		}
		if(newTitle != title)
			this.closeTiddler(newTitle,false);
		tiddlerElem.id = this.idPrefix + newTitle;
		tiddlerElem.setAttribute("tiddler",newTitle);
		tiddlerElem.setAttribute("template",DEFAULT_VIEW_TEMPLATE);
		tiddlerElem.setAttribute("dirty","false");
		if(config.options.chkForceMinorUpdate)
			minorUpdate = !minorUpdate;
		if(!store.tiddlerExists(newTitle))
			minorUpdate = false;
		var newDate = new Date();
		var extendedFields = store.tiddlerExists(newTitle) ? store.fetchTiddler(newTitle).fields : (newTitle!=title && store.tiddlerExists(title) ? store.fetchTiddler(title).fields : {});
		for(var n in fields) {
			if(!TiddlyWiki.isStandardField(n))
				extendedFields[n] = fields[n];
		}
		var tiddler = store.saveTiddler(title,newTitle,fields.text,minorUpdate ? undefined : config.options.txtUserName,minorUpdate ? undefined : newDate,fields.tags,extendedFields);
		autoSaveChanges(null,[tiddler]);
		return newTitle;
	}
	return null;
};

Story.prototype.permaView = function()
{
	var links = [];
	this.forEachTiddler(function(title,element) {
		links.push(String.encodeTiddlyLink(title));
	});
	var t = encodeURIComponent(links.join(" "));
	if(t == "")
		t = "#";
	if(window.location.hash != t)
		window.location.hash = t;
};


Story.prototype.switchTheme = function(theme)
{
	if(safeMode) 
		return;
		
	isAvailable = function(title) { 
		var s = title ? title.indexOf(config.textPrimitives.sectionSeparator) : -1; 
		if(s!=-1) 
			title = title.substr(0,s); 
		return store.tiddlerExists(title) || store.isShadowTiddler(title); 
 	};

	getSlice = function(theme,slice) {
		var r = store.getTiddlerSlice(theme,slice);
		if(r && r.indexOf(config.textPrimitives.sectionSeparator)==0)
			r = theme + r;
		return isAvailable(r) ? r : slice;
	};

	replaceNotification = function(i,name,newName) {
		if(name==newName)
			return name;
		if(store.namedNotifications[i].name == name) {
			store.namedNotifications[i].name = newName;
			return newName;
		}
		return name;
	};

	for(var i=0; i<config.notifyTiddlers.length; i++) {
		var name = config.notifyTiddlers[i].name;
		switch(name) {
		case "PageTemplate":
			config.refreshers.pageTemplate = replaceNotification(i,config.refreshers.pageTemplate,getSlice(theme,name));
			break;
		case "StyleSheet":
			removeStyleSheet(config.refreshers.styleSheet);
			config.refreshers.styleSheet = replaceNotification(i,config.refreshers.styleSheet,getSlice(theme,name));
			break;
		case "ColorPalette":
			config.refreshers.colorPalette = replaceNotification(i,config.refreshers.colorPalette,getSlice(theme,name));
			break;
		default:
			break;
		}
	}
	config.tiddlerTemplates[DEFAULT_VIEW_TEMPLATE] = getSlice(theme,"ViewTemplate");
	config.tiddlerTemplates[DEFAULT_EDIT_TEMPLATE] = getSlice(theme,"EditTemplate");
	if(!startingUp) {
		refreshAll();
		story.refreshAllTiddlers(true);
		config.options.txtTheme = theme;
		saveOptionCookie("txtTheme");
	}
};

//--
//-- Backstage
//--

var backstage = {
	area: null,
	toolbar: null,
	button: null,
	showButton: null,
	hideButton: null,
	cloak: null,
	panel: null,
	panelBody: null,
	panelFooter: null,
	currTabName: null,
	currTabElem: null,
	content: null,

	init: function() {
		var cmb = config.messages.backstage;
		this.area = document.getElementById("backstageArea");
		this.toolbar = document.getElementById("backstageToolbar");
		this.button = document.getElementById("backstageButton");
		this.button.style.display = "block";
		var t = cmb.open.text + " " + glyph("bentArrowLeft");
		this.showButton = createTiddlyButton(this.button,t,cmb.open.tooltip,
						function (e) {backstage.show(); return false;},null,"backstageShow");
		t = glyph("bentArrowRight") + " " + cmb.close.text;
		this.hideButton = createTiddlyButton(this.button,t,cmb.close.tooltip,
						function (e) {backstage.hide(); return false;},null,"backstageHide");
		this.cloak = document.getElementById("backstageCloak");
		this.panel = document.getElementById("backstagePanel");
		this.panelFooter = createTiddlyElement(this.panel,"div",null,"backstagePanelFooter");
		this.panelBody = createTiddlyElement(this.panel,"div",null,"backstagePanelBody");
		this.cloak.onmousedown = function(e) {
			backstage.switchTab(null);
		};
		createTiddlyText(this.toolbar,cmb.prompt);
		for(t=0; t<config.backstageTasks.length; t++) {
			var taskName = config.backstageTasks[t];
			var task = config.tasks[taskName];
			var handler = task.action ? this.onClickCommand : this.onClickTab;
			var text = task.text + (task.action ? "" : glyph("downTriangle"));
			var btn = createTiddlyButton(this.toolbar,text,task.tooltip,handler,"backstageTab");
			btn.setAttribute("task",taskName);
			addClass(btn,task.action ? "backstageAction" : "backstageTask");
			}
		this.content = document.getElementById("contentWrapper");
		if(config.options.chkBackstage)
			this.show();
		else
			this.hide();
	},

	isVisible: function() {
		return this.area ? this.area.style.display == "block" : false;
	},

	show: function() {
		this.area.style.display = "block";
		if(anim && config.options.chkAnimate) {
			backstage.toolbar.style.left = findWindowWidth() + "px";
			var p = [
				{style: "left", start: findWindowWidth(), end: 0, template: "%0px"}
			];
			anim.startAnimating(new Morpher(backstage.toolbar,config.animDuration,p));
		} else {
			backstage.area.style.left = "0px";
		}
		this.showButton.style.display = "none";
		this.hideButton.style.display = "block";
		config.options.chkBackstage = true;
		saveOptionCookie("chkBackstage");
		addClass(this.content,"backstageVisible");
	},

	hide: function() {
		if(this.currTabElem) {
			this.switchTab(null);
		} else {
			backstage.toolbar.style.left = "0px";
			if(anim && config.options.chkAnimate) {
				var p = [
					{style: "left", start: 0, end: findWindowWidth(), template: "%0px"}
				];
				var c = function(element,properties) {backstage.area.style.display = "none";};
				anim.startAnimating(new Morpher(backstage.toolbar,config.animDuration,p,c));
			} else {
				this.area.style.display = "none";
			}
			this.showButton.style.display = "block";
			this.hideButton.style.display = "none";
			config.options.chkBackstage = false;
			saveOptionCookie("chkBackstage");
			removeClass(this.content,"backstageVisible");
		}
	},

	onClickCommand: function(e) {
		var task = config.tasks[this.getAttribute("task")];
		displayMessage(task);
		if(task.action) {
			backstage.switchTab(null);
			task.action();
		}
		return false;
	},

	onClickTab: function(e) {
		backstage.switchTab(this.getAttribute("task"));
		return false;
	},

	// Switch to a given tab, or none if null is passed
	switchTab: function(tabName) {
		var tabElem = null;
		var e = this.toolbar.firstChild;
		while(e)
			{
			if(e.getAttribute && e.getAttribute("task") == tabName)
				tabElem = e;
			e = e.nextSibling;
			}
		if(tabName == backstage.currTabName)
			return;
		if(backstage.currTabElem) {
			removeClass(this.currTabElem,"backstageSelTab");
		}
		if(tabElem && tabName) {
			backstage.preparePanel();
			addClass(tabElem,"backstageSelTab");
			var task = config.tasks[tabName];
			wikify(task.content,backstage.panelBody,null,null);
			backstage.showPanel();
		} else if(backstage.currTabElem) {
			backstage.hidePanel();
		}
		backstage.currTabName = tabName;
		backstage.currTabElem = tabElem;
	},

	isPanelVisible: function() {
		return backstage.panel ? backstage.panel.style.display == "block" : false;
	},

	preparePanel: function() {
		backstage.cloak.style.height = findWindowHeight() + "px";
		backstage.cloak.style.display = "block";
		removeChildren(backstage.panelBody);
		return backstage.panelBody;
	},

	showPanel: function() {
		backstage.panel.style.display = "block";
		if(anim && config.options.chkAnimate) {
			backstage.panel.style.top = (-backstage.panel.offsetHeight) + "px";
			var p = [
				{style: "top", start: -backstage.panel.offsetHeight, end: 0, template: "%0px"}
			];
			anim.startAnimating(new Morpher(backstage.panel,config.animDuration,p),new Scroller(backstage.panel,false));
		} else {
			backstage.panel.style.top = "0px";
		}
		return backstage.panelBody;
	},

	hidePanel: function() {
		backstage.currTabName = null;
		backstage.currTabElem = null;
		if(anim && config.options.chkAnimate) {
			var p = [
				{style: "top", start: 0, end: -(backstage.panel.offsetHeight), template: "%0px"},
				{style: "display", atEnd: "none"}
			];
			var c = function(element,properties) {backstage.cloak.style.display = "none";};
			anim.startAnimating(new Morpher(backstage.panel,config.animDuration,p,c));
		 } else {
			backstage.panel.style.display = "none";
			backstage.cloak.style.display = "none";
		}
	}
};

config.macros.backstage = {};

config.macros.backstage.handler = function(place,macroName,params,wikifier,paramString,tiddler)
{
	var backstageTask = config.tasks[params[0]];
	if(backstageTask)
		createTiddlyButton(place,backstageTask.text,backstageTask.tooltip,function(e) {backstage.switchTab(params[0]); return false;});
};

//--
//-- ImportTiddlers macro
//--

config.macros.importTiddlers.handler = function(place,macroName,params,wikifier,paramString,tiddler)
{
	if(readOnly) {
		createTiddlyElement(place,"div",null,"marked",this.readOnlyWarning);
		return;
	}
	var w = new Wizard();
	w.createWizard(place,this.wizardTitle);
	this.restart(w);
};

config.macros.importTiddlers.onCancel = function(e)
{
	var wizard = new Wizard(this);
	var place = wizard.clear();
	config.macros.importTiddlers.restart(wizard);
	return false;
};

config.macros.importTiddlers.restart = function(wizard)
{
	wizard.addStep(this.step1Title,this.step1Html);
	var s = wizard.getElement("selTypes");
	for(var t in config.adaptors) {
		var e = createTiddlyElement(s,"option",null,null,t);
		e.value = t;
	}
	s = wizard.getElement("selFeeds");
	var feeds = this.getFeeds();
	for(t in feeds) {
		e = createTiddlyElement(s,"option",null,null,t);
		e.value = t;
	}
	wizard.setValue("feeds",feeds);
	s.onchange = config.macros.importTiddlers.onFeedChange;
	var fileInput = wizard.getElement("txtBrowse");
	fileInput.onchange = config.macros.importTiddlers.onBrowseChange;
	fileInput.onkeyup = config.macros.importTiddlers.onBrowseChange;
	wizard.setButtons([{caption: this.openLabel, tooltip: this.openPrompt, onClick: config.macros.importTiddlers.onOpen}]);
};

config.macros.importTiddlers.getFeeds = function()
{
	var feeds = {};
	var tagged = store.getTaggedTiddlers("systemServer","title");
	for(var t=0; t<tagged.length; t++) {
		var title = tagged[t].title;
		var serverType = store.getTiddlerSlice(title,"Type");
		if(!serverType)
			serverType = "file";
		feeds[title] = {title: title,
						url: store.getTiddlerSlice(title,"URL"),
						workspace: store.getTiddlerSlice(title,"Workspace"),
						workspaceList: store.getTiddlerSlice(title,"WorkspaceList"),
						tiddlerFilter: store.getTiddlerSlice(title,"TiddlerFilter"),
						serverType: serverType,
						description: store.getTiddlerSlice(title,"Description")};
	}
	return feeds;
};

config.macros.importTiddlers.onFeedChange = function(e)
{
	var wizard = new Wizard(this);
	var selTypes = wizard.getElement("selTypes");
	var fileInput = wizard.getElement("txtPath");
	var feeds = wizard.getValue("feeds");
	var f = feeds[this.value];
	if(f) {
		selTypes.value = f.serverType;
		fileInput.value = f.url;
		this.selectedIndex = 0;
		wizard.setValue("feedName",f.serverType);
		wizard.setValue("feedHost",f.url);
		wizard.setValue("feedWorkspace",f.workspace);
		wizard.setValue("feedWorkspaceList",f.workspaceList);
		wizard.setValue("feedTiddlerFilter",f.tiddlerFilter);
	}
	return false;
};

config.macros.importTiddlers.onBrowseChange = function(e)
{
	var wizard = new Wizard(this);
	var fileInput = wizard.getElement("txtPath");
	fileInput.value = "file://" + this.value;
	var serverType = wizard.getElement("selTypes");
	serverType.value = "file";
	return false;
};

config.macros.importTiddlers.onOpen = function(e)
{
	var wizard = new Wizard(this);
	var fileInput = wizard.getElement("txtPath");
	var url = fileInput.value;
	var serverType = wizard.getElement("selTypes").value;
	var adaptor = new config.adaptors[serverType];
	wizard.setValue("adaptor",adaptor);
	wizard.setValue("serverType",serverType);
	wizard.setValue("host",url);
	var ret = adaptor.openHost(url,null,wizard,config.macros.importTiddlers.onOpenHost);
	if(ret !== true)
		displayMessage(ret);
	wizard.setButtons([{caption: config.macros.importTiddlers.cancelLabel, tooltip: config.macros.importTiddlers.cancelPrompt, onClick: config.macros.importTiddlers.onCancel}],config.macros.importTiddlers.statusOpenHost);
	return false;
};

config.macros.importTiddlers.onOpenHost = function(context,wizard)
{
	var adaptor = wizard.getValue("adaptor");
	if(context.status !== true)
		displayMessage("Error in importTiddlers.onOpenHost: " + context.statusText);
	var ret = adaptor.getWorkspaceList(context,wizard,config.macros.importTiddlers.onGetWorkspaceList);
	if(ret !== true)
		displayMessage(ret);
	wizard.setButtons([{caption: config.macros.importTiddlers.cancelLabel, tooltip: config.macros.importTiddlers.cancelPrompt, onClick: config.macros.importTiddlers.onCancel}],config.macros.importTiddlers.statusGetWorkspaceList);
};

config.macros.importTiddlers.onGetWorkspaceList = function(context,wizard)
{
	if(context.status !== true)
		displayMessage("Error in importTiddlers.onGetWorkspaceList: " + context.statusText);
	wizard.setValue("context",context);
	var workspace = wizard.getValue("feedWorkspace");
	if(!workspace && context.workspaces.length==1)
		workspace = context.workspaces[0].title;
	if(workspace) {
		var ret = context.adaptor.openWorkspace(workspace,context,wizard,config.macros.importTiddlers.onOpenWorkspace);
		if(ret !== true)
			displayMessage(ret);
		wizard.setValue("workspace",workspace);
		wizard.setButtons([{caption: config.macros.importTiddlers.cancelLabel, tooltip: config.macros.importTiddlers.cancelPrompt, onClick: config.macros.importTiddlers.onCancel}],config.macros.importTiddlers.statusOpenWorkspace);
		return;
	}
	wizard.addStep(config.macros.importTiddlers.step2Title,config.macros.importTiddlers.step2Html);
	var s = wizard.getElement("selWorkspace");
	s.onchange = config.macros.importTiddlers.onWorkspaceChange;
	for(var t=0; t<context.workspaces.length; t++) {
		var e = createTiddlyElement(s,"option",null,null,context.workspaces[t].title);
		e.value = context.workspaces[t].title;
	}
	var workspaceList = wizard.getValue("feedWorkspaceList");
	if(workspaceList) {
		var list = workspaceList.parseParams("workspace",null,false,true);
		for(var n=1; n<list.length; n++) {
			if(context.workspaces.findByField("title",list[n].value) == null) {
				e = createTiddlyElement(s,"option",null,null,list[n].value);
				e.value = list[n].value;
			}
		}
	}
	if(workspace) {
		t = wizard.getElement("txtWorkspace");
		t.value = workspace;
	}
	wizard.setButtons([{caption: config.macros.importTiddlers.openLabel, tooltip: config.macros.importTiddlers.openPrompt, onClick: config.macros.importTiddlers.onChooseWorkspace}]);
};

config.macros.importTiddlers.onWorkspaceChange = function(e)
{
	var wizard = new Wizard(this);
	var t = wizard.getElement("txtWorkspace");
	t.value  = this.value;
	this.selectedIndex = 0;
	return false;
};

config.macros.importTiddlers.onChooseWorkspace = function(e)
{
	var wizard = new Wizard(this);
	var adaptor = wizard.getValue("adaptor");
	var workspace = wizard.getElement("txtWorkspace").value;
	wizard.setValue("workspace",workspace);
	var context = wizard.getValue("context");
	var ret = adaptor.openWorkspace(workspace,context,wizard,config.macros.importTiddlers.onOpenWorkspace);
	if(ret !== true)
		displayMessage(ret);
	wizard.setButtons([{caption: config.macros.importTiddlers.cancelLabel, tooltip: config.macros.importTiddlers.cancelPrompt, onClick: config.macros.importTiddlers.onCancel}],config.macros.importTiddlers.statusOpenWorkspace);
	return false;
};

config.macros.importTiddlers.onOpenWorkspace = function(context,wizard)
{
	if(context.status !== true)
		displayMessage("Error in importTiddlers.onOpenWorkspace: " + context.statusText);
	var adaptor = wizard.getValue("adaptor");
	var ret = adaptor.getTiddlerList(context,wizard,config.macros.importTiddlers.onGetTiddlerList,wizard.getValue("feedTiddlerFilter"));
	if(ret !== true)
		displayMessage(ret);
	wizard.setButtons([{caption: config.macros.importTiddlers.cancelLabel, tooltip: config.macros.importTiddlers.cancelPrompt, onClick: config.macros.importTiddlers.onCancel}],config.macros.importTiddlers.statusGetTiddlerList);
};

config.macros.importTiddlers.onGetTiddlerList = function(context,wizard)
{
	if(context.status !== true)
		displayMessage("Error in importTiddlers.onGetTiddlerList: " + context.statusText);
	// Extract data for the listview
	var listedTiddlers = [];
	if(context.tiddlers) {
		for(var n=0; n<context.tiddlers.length; n++) {
			var tiddler = context.tiddlers[n];
			listedTiddlers.push({
				title: tiddler.title,
				modified: tiddler.modified,
				modifier: tiddler.modifier,
				text: tiddler.text ? wikifyPlainText(tiddler.text,100) : "",
				tags: tiddler.tags,
				size: tiddler.text ? tiddler.text.length : 0,
				tiddler: tiddler
			});
		}
	}
	listedTiddlers.sort(function(a,b) {return a.title < b.title ? -1 : (a.title == b.title ? 0 : +1);});
	// Display the listview
	wizard.addStep(config.macros.importTiddlers.step3Title,config.macros.importTiddlers.step3Html);
	var markList = wizard.getElement("markList");
	var listWrapper = document.createElement("div");
	markList.parentNode.insertBefore(listWrapper,markList);
	var listView = ListView.create(listWrapper,listedTiddlers,config.macros.importTiddlers.listViewTemplate);
	wizard.setValue("listView",listView);
	var txtSaveTiddler = wizard.getElement("txtSaveTiddler");
	txtSaveTiddler.value = config.macros.importTiddlers.generateSystemServerName(wizard);
	wizard.setButtons([
			{caption: config.macros.importTiddlers.cancelLabel, tooltip: config.macros.importTiddlers.cancelPrompt, onClick: config.macros.importTiddlers.onCancel},
			{caption: config.macros.importTiddlers.importLabel, tooltip: config.macros.importTiddlers.importPrompt, onClick:  config.macros.importTiddlers.doImport}
		]);
};

config.macros.importTiddlers.generateSystemServerName = function(wizard)
{
	var serverType = wizard.getValue("serverType");
	var host = wizard.getValue("host");
	var workspace = wizard.getValue("workspace");
	var pattern = config.macros.importTiddlers[workspace ? "systemServerNamePattern" : "systemServerNamePatternNoWorkspace"];
	return pattern.format([serverType,host,workspace]);
};

config.macros.importTiddlers.saveServerTiddler = function(wizard)
{
	var txtSaveTiddler = wizard.getElement("txtSaveTiddler").value;
	if(store.tiddlerExists(txtSaveTiddler)) {
		if(!confirm(config.macros.importTiddlers.confirmOverwriteSaveTiddler.format([txtSaveTiddler])))
			return;
		store.suspendNotifications();
		store.removeTiddler(txtSaveTiddler);
		store.resumeNotifications();
	}
	var serverType = wizard.getValue("serverType");
	var host = wizard.getValue("host");
	var workspace = wizard.getValue("workspace");
	var text = config.macros.importTiddlers.serverSaveTemplate.format([serverType,host,workspace]);
	store.saveTiddler(txtSaveTiddler,txtSaveTiddler,text,config.macros.importTiddlers.serverSaveModifier,new Date(),["systemServer"]);
};

config.macros.importTiddlers.doImport = function(e)
{
	var wizard = new Wizard(this);
	if(wizard.getElement("chkSave").checked)
		config.macros.importTiddlers.saveServerTiddler(wizard);
	var chkSync = wizard.getElement("chkSync").checked;
	wizard.setValue("sync",chkSync);
	var listView = wizard.getValue("listView");
	var rowNames = ListView.getSelectedRows(listView);
	var adaptor = wizard.getValue("adaptor");
	var overwrite = new Array();
	var t;
	for(t=0; t<rowNames.length; t++) {
		if(store.tiddlerExists(rowNames[t]))
			overwrite.push(rowNames[t]);
	}
	if(overwrite.length > 0) {
		if(!confirm(config.macros.importTiddlers.confirmOverwriteText.format([overwrite.join(", ")])))
			return false;
	}
	wizard.addStep(config.macros.importTiddlers.step4Title.format([rowNames.length]),config.macros.importTiddlers.step4Html);
	for(t=0; t<rowNames.length; t++) {
		var link = document.createElement("div");
		createTiddlyLink(link,rowNames[t],true);
		var place = wizard.getElement("markReport");
		place.parentNode.insertBefore(link,place);
	}
	wizard.setValue("remainingImports",rowNames.length);
	wizard.setButtons([
			{caption: config.macros.importTiddlers.cancelLabel, tooltip: config.macros.importTiddlers.cancelPrompt, onClick: config.macros.importTiddlers.onCancel}
		],config.macros.importTiddlers.statusDoingImport);
	for(t=0; t<rowNames.length; t++) {
		var context = {};
		context.allowSynchronous = true;
		var inbound = adaptor.getTiddler(rowNames[t],context,wizard,config.macros.importTiddlers.onGetTiddler);
	}
	return false;
};

config.macros.importTiddlers.onGetTiddler = function(context,wizard)
{
	if(!context.status)
		displayMessage("Error in importTiddlers.onGetTiddler: " + context.statusText);
	var tiddler = context.tiddler;
	store.suspendNotifications();
	store.saveTiddler(tiddler.title, tiddler.title, tiddler.text, tiddler.modifier, tiddler.modified, tiddler.tags, tiddler.fields, true, tiddler.created);
	if(!wizard.getValue("sync")) {
		store.setValue(tiddler.title,'server',null);
	}
	store.resumeNotifications();
	if(!context.isSynchronous)
		store.notify(tiddler.title,true);
	var remainingImports = wizard.getValue("remainingImports")-1;
	wizard.setValue("remainingImports",remainingImports);
	if(remainingImports == 0) {
		if(context.isSynchronous) {
			store.notifyAll();
			refreshDisplay();
		}
		wizard.setButtons([
				{caption: config.macros.importTiddlers.doneLabel, tooltip: config.macros.importTiddlers.donePrompt, onClick: config.macros.importTiddlers.onCancel}
			],config.macros.importTiddlers.statusDoneImport);
		autoSaveChanges();
	}
};

//--
//-- Sync macro
//--

// Synchronisation handlers
config.syncers = {};

// Sync state.
var currSync = null;

// sync macro
config.macros.sync.handler = function(place,macroName,params,wikifier,paramString,tiddler)
{
	if(!wikifier.isStatic)
		this.startSync(place);
};

config.macros.sync.startSync = function(place)
{
	if(currSync)
		config.macros.sync.cancelSync();
	currSync = {};
	currSync.syncList = this.getSyncableTiddlers();
	this.createSyncTasks();
	this.preProcessSyncableTiddlers();
	var wizard = new Wizard();
	currSync.wizard = wizard;
	wizard.createWizard(place,this.wizardTitle);
	wizard.addStep(this.step1Title,this.step1Html);
	var markList = wizard.getElement("markList");
	var listWrapper = document.createElement("div");
	markList.parentNode.insertBefore(listWrapper,markList);
	currSync.listView = ListView.create(listWrapper,currSync.syncList,this.listViewTemplate);
	this.processSyncableTiddlers();
	wizard.setButtons([
			{caption: this.syncLabel, tooltip: this.syncPrompt, onClick: this.doSync}
		]);
};

config.macros.sync.getSyncableTiddlers = function()
{
	var list = [];
	store.forEachTiddler(function(title,tiddler) {
		var syncItem = {};
		syncItem.serverType = tiddler.getServerType();
		syncItem.serverHost = tiddler.fields['server.host'];
		syncItem.serverWorkspace = tiddler.fields['server.workspace'];
		syncItem.tiddler = tiddler;
		syncItem.title = tiddler.title;
		syncItem.isTouched = tiddler.isTouched();
		syncItem.selected = syncItem.isTouched;
		syncItem.syncStatus = config.macros.sync.syncStatusList[syncItem.isTouched ? "changedLocally" : "none"];
		syncItem.status = syncItem.syncStatus.text;
		if(syncItem.serverType && syncItem.serverHost)
			list.push(syncItem);
		});
	list.sort(function(a,b) {return a.title < b.title ? -1 : (a.title == b.title ? 0 : +1);});
	return list;
};

config.macros.sync.preProcessSyncableTiddlers = function()
{
	for(var t=0; t<currSync.syncList.length; t++) {
		si = currSync.syncList[t];
		var ti = si.syncTask.syncMachine.generateTiddlerInfo(si.tiddler);
		si.serverUrl = ti.uri;
	}
};

config.macros.sync.processSyncableTiddlers = function()
{
	for(var t=0; t<currSync.syncList.length; t++) {
		si = currSync.syncList[t];
		si.rowElement.style.backgroundColor = si.syncStatus.color;
	}
};

config.macros.sync.createSyncTasks = function()
{
	currSync.syncTasks = [];
	for(var t=0; t<currSync.syncList.length; t++) {
		var si = currSync.syncList[t];
		var r = null;
		for(var st=0; st<currSync.syncTasks.length; st++) {
			var cst = currSync.syncTasks[st];
			if(si.serverType == cst.serverType && si.serverHost == cst.serverHost && si.serverWorkspace == cst.serverWorkspace)
				r = cst;
		}
		if(r == null) {
			si.syncTask = this.createSyncTask(si);
			currSync.syncTasks.push(si.syncTask);
		} else {
			si.syncTask = r;
			r.syncItems.push(si);
		}
	}
};

config.macros.sync.createSyncTask = function(syncItem)
{
	var st = {};
	st.serverType = syncItem.serverType;
	st.serverHost = syncItem.serverHost;
	st.serverWorkspace = syncItem.serverWorkspace;
	st.syncItems = [syncItem];
	st.syncMachine = new SyncMachine(st.serverType,{
		start: function() {
			return this.openHost(st.serverHost,"openWorkspace");
		},
		openWorkspace: function() {
			return this.openWorkspace(st.serverWorkspace,"getTiddlerList");
		},
		getTiddlerList: function() {
			return this.getTiddlerList("onGetTiddlerList");
		},
		onGetTiddlerList: function(context) {
			var tiddlers = context.tiddlers;
			for(var t=0; t<st.syncItems.length; t++) {
				var si = st.syncItems[t];
				var f = tiddlers.findByField("title",si.title);
				if(f !== null) {
					if(tiddlers[f].fields['server.page.revision'] > si.tiddler.fields['server.page.revision']) {
						si.syncStatus = config.macros.sync.syncStatusList[si.isTouched ? 'changedBoth' : 'changedServer'];
					}
				} else {
					si.syncStatus = config.macros.sync.syncStatusList.notFound;
				}
				config.macros.sync.updateSyncStatus(si);
			}
		},
		getTiddler: function(title) {
			return this.getTiddler(title,"onGetTiddler");
		},
		onGetTiddler: function(context) {
			var tiddler = context.tiddler;
			var syncItem = st.syncItems.findByField("title",tiddler.title);
			if(syncItem !== null) {
				syncItem = st.syncItems[syncItem];
				store.saveTiddler(tiddler.title, tiddler.title, tiddler.text, tiddler.modifier, tiddler.modified, tiddler.tags, tiddler.fields, true, tiddler.created);
				syncItem.syncStatus = config.macros.sync.syncStatusList.gotFromServer;
				config.macros.sync.updateSyncStatus(syncItem);
			}
		},
		putTiddler: function(tiddler) {
			return this.putTiddler(tiddler,"onPutTiddler");
		},
		onPutTiddler: function(context) {
			var title = context.title;
			var syncItem = st.syncItems.findByField("title",title);
			if(syncItem !== null) {
				syncItem = st.syncItems[syncItem];
				store.resetTiddler(title);
				syncItem.syncStatus = config.macros.sync.syncStatusList.putToServer;
				config.macros.sync.updateSyncStatus(syncItem);
			}
		}
	});
	st.syncMachine.go();
	return st;
};

config.macros.sync.updateSyncStatus = function(syncItem)
{
	var e = syncItem.colElements["status"];
	removeChildren(e);
	createTiddlyText(e,syncItem.syncStatus.text);
	syncItem.rowElement.style.backgroundColor = syncItem.syncStatus.color;
};

config.macros.sync.doSync = function(e)
{
	var rowNames = ListView.getSelectedRows(currSync.listView);
	for(var t=0; t<currSync.syncList.length; t++) {
		var si = currSync.syncList[t];
		if(rowNames.indexOf(si.title) != -1) {
			config.macros.sync.doSyncItem(si);
		}
	}
	return false;
};

config.macros.sync.doSyncItem = function(syncItem)
{
	var r = true;
	var sl = config.macros.sync.syncStatusList;
	switch(syncItem.syncStatus) {
		case sl.changedServer:
			r = syncItem.syncTask.syncMachine.go("getTiddler",syncItem.title);
			break;
		case sl.notFound:
		case sl.changedLocally:
		case sl.changedBoth:
			r = syncItem.syncTask.syncMachine.go("putTiddler",syncItem.tiddler);
			break;
		default:
			break;
	}
	if(r !== true)
		displayMessage("Error in doSyncItem: " + r);
};

config.macros.sync.cancelSync = function()
{
	currSync = null;
};

function SyncMachine(serverType,steps)
{
	this.serverType = serverType;
	this.adaptor = new config.adaptors[serverType];
	this.steps = steps;
}

SyncMachine.prototype.go = function(step,context)
{
	var r = context ? context.status : null;
	if(typeof r == "string") {
		this.invokeError(r);
		return r;
	}
	var h = this.steps[step ? step : "start"];
	if(!h)
		return null;
	r = h.call(this,context);
	if(typeof r == "string")
		this.invokeError(r);
	return r;
};

SyncMachine.prototype.invokeError = function(message)
{
	if(this.steps.error)
		this.steps.error(message);
};

SyncMachine.prototype.openHost = function(host,nextStep)
{
	var me = this;
	return me.adaptor.openHost(host,null,null,function(context) {me.go(nextStep,context);});
};

SyncMachine.prototype.getWorkspaceList = function(nextStep)
{
	var me = this;
	return me.adaptor.getWorkspaceList(null,null,function(context) {me.go(nextStep,context);});
};

SyncMachine.prototype.openWorkspace = function(workspace,nextStep)
{
	var me = this;
	return me.adaptor.openWorkspace(workspace,null,null,function(context) {me.go(nextStep,context);});
};

SyncMachine.prototype.getTiddlerList = function(nextStep)
{
	var me = this;
	return me.adaptor.getTiddlerList(null,null,function(context) {me.go(nextStep,context);});
};

SyncMachine.prototype.generateTiddlerInfo = function(tiddler)
{
	return this.adaptor.generateTiddlerInfo(tiddler);
};

SyncMachine.prototype.getTiddler = function(title,nextStep)
{
	var me = this;
	return me.adaptor.getTiddler(title,null,null,function(context) {me.go(nextStep,context);});
};

SyncMachine.prototype.putTiddler = function(tiddler,nextStep)
{
	var me = this;
	return me.adaptor.putTiddler(tiddler,null,null,function(context) {me.go(nextStep,context);});
};

//--
//-- Manager UI for groups of tiddlers
//--

config.macros.plugins.handler = function(place,macroName,params,wikifier,paramString,tiddler)
{
	var wizard = new Wizard();
	wizard.createWizard(place,this.wizardTitle);
	wizard.addStep(this.step1Title,this.step1Html);
	var markList = wizard.getElement("markList");
	var listWrapper = document.createElement("div");
	markList.parentNode.insertBefore(listWrapper,markList);
	listWrapper.setAttribute("refresh","macro");
	listWrapper.setAttribute("macroName","plugins");
	listWrapper.setAttribute("params",paramString);
	this.refresh(listWrapper,paramString);
};

config.macros.plugins.refresh = function(listWrapper,params)
{
	var wizard = new Wizard(listWrapper);
	var selectedRows = [];
	ListView.forEachSelector(listWrapper,function(e,rowName) {
			if(e.checked)
				selectedRows.push(e.getAttribute("rowName"));
		});
	removeChildren(listWrapper);
	params = params.parseParams("anon");
	var plugins = installedPlugins.slice(0);
	var t,tiddler,p;
	var configTiddlers = store.getTaggedTiddlers("systemConfig");
	for(t=0; t<configTiddlers.length; t++) {
		tiddler = configTiddlers[t];
		if(plugins.findByField("title",tiddler.title) == null) {
			p = getPluginInfo(tiddler);
			p.executed = false;
			p.log.splice(0,0,this.skippedText);
			plugins.push(p);
		}
	}
	for(t=0; t<plugins.length; t++) {
		p = plugins[t];
		p.size = p.tiddler.text ? p.tiddler.text.length : 0;
		p.forced = p.tiddler.isTagged("systemConfigForce");
		p.disabled = p.tiddler.isTagged("systemConfigDisable");
		p.Selected = selectedRows.indexOf(plugins[t].title) != -1;
	}
	if(plugins.length == 0) {
		createTiddlyElement(listWrapper,"em",null,null,this.noPluginText);
		wizard.setButtons([]);
	} else {
		var listView = ListView.create(listWrapper,plugins,this.listViewTemplate,this.onSelectCommand);
		wizard.setValue("listView",listView);
		wizard.setButtons([
				{caption: config.macros.plugins.removeLabel, tooltip: config.macros.plugins.removePrompt, onClick:  config.macros.plugins.doRemoveTag},
				{caption: config.macros.plugins.deleteLabel, tooltip: config.macros.plugins.deletePrompt, onClick:  config.macros.plugins.doDelete}
			]);
	}
};

config.macros.plugins.doRemoveTag = function(e)
{
	var wizard = new Wizard(this);
	var listView = wizard.getValue("listView");
	var rowNames = ListView.getSelectedRows(listView);
	if(rowNames.length == 0) {
		alert(config.messages.nothingSelected);
	} else {
		for(var t=0; t<rowNames.length; t++)
			store.setTiddlerTag(rowNames[t],false,"systemConfig");
	}
};

config.macros.plugins.doDelete = function(e)
{
	var wizard = new Wizard(this);
	var listView = wizard.getValue("listView");
	var rowNames = ListView.getSelectedRows(listView);
	if(rowNames.length == 0) {
		alert(config.messages.nothingSelected);
	} else {
		if(confirm(config.macros.plugins.confirmDeleteText.format([rowNames.join(", ")]))) {
			for(t=0; t<rowNames.length; t++) {
				store.removeTiddler(rowNames[t]);
				story.closeTiddler(rowNames[t],true);
			}
		}
	}
};

//--
//-- Message area
//--

function getMessageDiv()
{
	var msgArea = document.getElementById("messageArea");
	if(!msgArea)
		return null;
	if(!msgArea.hasChildNodes())
		createTiddlyButton(createTiddlyElement(msgArea,"div",null,"messageToolbar"),
			config.messages.messageClose.text,
			config.messages.messageClose.tooltip,
			clearMessage);
	msgArea.style.display = "block";
	return createTiddlyElement(msgArea,"div");
}

function displayMessage(text,linkText)
{
	var e = getMessageDiv();
	if(!e) {
		alert(text);
		return;
	}
	if(linkText) {
		var link = createTiddlyElement(e,"a",null,null,text);
		link.href = linkText;
		link.target = "_blank";
	} else {
		e.appendChild(document.createTextNode(text));
	}
}

function clearMessage()
{
	var msgArea = document.getElementById("messageArea");
	if(msgArea) {
		removeChildren(msgArea);
		msgArea.style.display = "none";
	}
	return false;
}

//--
//-- Refresh mechanism
//--

config.refreshers = {
	link: function(e,changeList)
		{
		var title = e.getAttribute("tiddlyLink");
		refreshTiddlyLink(e,title);
		return true;
		},

	tiddler: function(e,changeList)
		{
		var title = e.getAttribute("tiddler");
		var template = e.getAttribute("template");
		if(changeList && changeList.indexOf(title) != -1 && !story.isDirty(title))
			story.refreshTiddler(title,template,true);
		else
			refreshElements(e,changeList);
		return true;
		},

	content: function(e,changeList)
		{
		var title = e.getAttribute("tiddler");
		var force = e.getAttribute("force");
		if(force != null || changeList == null || changeList.indexOf(title) != -1) {
			removeChildren(e);
			wikify(store.getTiddlerText(title,title),e,null);
			return true;
		} else
			return false;
		},

	macro: function(e,changeList)
		{
		var macro = e.getAttribute("macroName");
		var params = e.getAttribute("params");
		if(macro)
			macro = config.macros[macro];
		if(macro && macro.refresh)
			macro.refresh(e,params);
		return true;
		},
	styleSheet: "StyleSheet", 
	defaultStyleSheet: "StyleSheet", 
	pageTemplate: "PageTemplate", 
	defaultPageTemplate: "PageTemplate", 
	colorPalette: "ColorPalette", 
	defaultColorPalette: "ColorPalette" 
};

function refreshElements(root,changeList)
{
	var nodes = root.childNodes;
	for(var c=0; c<nodes.length; c++) {
		var e = nodes[c], type = null;
		if(e.getAttribute  && (e.tagName ? e.tagName != "IFRAME" : true))
			type = e.getAttribute("refresh");
		var refresher = config.refreshers[type];
		var refreshed = false;
		if(refresher != undefined)
			refreshed = refresher(e,changeList);
		if(e.hasChildNodes() && !refreshed)
			refreshElements(e,changeList);
	}
}

function applyHtmlMacros(root,tiddler)
{
	var e = root.firstChild;
	while(e) {
		var nextChild = e.nextSibling;
		if(e.getAttribute) {
			var macro = e.getAttribute("macro");
			if(macro) {
				var params = "";
				var p = macro.indexOf(" ");
				if(p != -1) {
					params = macro.substr(p+1);
					macro = macro.substr(0,p);
				}
				invokeMacro(e,macro,params,null,tiddler);
			}
		}
		if(e.hasChildNodes())
			applyHtmlMacros(e,tiddler);
		e = nextChild;
	}
}

function refreshPageTemplate(title)
{
	var stash = createTiddlyElement(document.body,"div");
	stash.style.display = "none";
	var display = document.getElementById("tiddlerDisplay");
	var nodes,t;
	if(display) {
		nodes = display.childNodes;
		for(t=nodes.length-1; t>=0; t--)
			stash.appendChild(nodes[t]);
	}
	var wrapper = document.getElementById("contentWrapper");

	isAvailable = function(title) { 
		var s = title ? title.indexOf(config.textPrimitives.sectionSeparator) : -1; 
		if(s!=-1) 
			title = title.substr(0,s); 
		return store.tiddlerExists(title) || store.isShadowTiddler(title); 
 	};
	if(!title || !isAvailable(title))
		title = config.refreshers.pageTemplate;
	if(!isAvailable(title))
		title = config.refreshers.defaultPageTemplate; //# this one is always avaialable
	html = store.getRecursiveTiddlerText(title,null,10);
	wrapper.innerHTML = html;
	applyHtmlMacros(wrapper);
	refreshElements(wrapper);
	display = document.getElementById("tiddlerDisplay");
	removeChildren(display);
	if(!display)
		display = createTiddlyElement(wrapper,"div","tiddlerDisplay");
	nodes = stash.childNodes;
	for(t=nodes.length-1; t>=0; t--)
		display.appendChild(nodes[t]);
	removeNode(stash);
}

function refreshDisplay(hint)
{
	if(typeof hint == "string")
		hint = [hint];
	var e = document.getElementById("contentWrapper");
	refreshElements(e,hint);
	if(backstage.isPanelVisible()) {
		e = document.getElementById("backstage");
		refreshElements(e,hint);
	}
}

function refreshPageTitle()
{
	document.title = getPageTitle();
}

function getPageTitle()
{
	var st = wikifyPlain("SiteTitle");
	var ss = wikifyPlain("SiteSubtitle");
	return st + ((st == "" || ss == "") ? "" : " - ") + ss;
}

function refreshStyles(title,doc)
{
	setStylesheet(title == null ? "" : store.getRecursiveTiddlerText(title,"",10),title,doc ? doc : document);
}

function refreshColorPalette(title)
{
	if(!startingUp)
		refreshAll();
}

function refreshAll()
{
	refreshPageTemplate();
	refreshDisplay();
	refreshStyles("StyleSheetLayout");
	refreshStyles("StyleSheetColors");
	refreshStyles(config.refreshers.styleSheet);
	refreshStyles("StyleSheetPrint");
}

//--
//-- Options stuff
//--

config.optionHandlers = {
	'txt': {
		get: function(name) {return encodeCookie(config.options[name].toString());},
		set: function(name,value) {config.options[name] = decodeCookie(value);}
	},
	'chk': {
		get: function(name) {return config.options[name] ? "true" : "false";},
		set: function(name,value) {config.options[name] = value == "true";}
	}
};

function loadOptionsCookie()
{
	if(safeMode)
		return;
	var cookies = document.cookie.split(";");
	for(var c=0; c<cookies.length; c++) {
		var p = cookies[c].indexOf("=");
		if(p != -1) {
			var name = cookies[c].substr(0,p).trim();
			var value = cookies[c].substr(p+1).trim();
			var optType = name.substr(0,3);
			if(config.optionHandlers[optType] && config.optionHandlers[optType].set)
				config.optionHandlers[optType].set(name,value);
		}
	}
}

function saveOptionCookie(name)
{
	if(safeMode)
		return;
	var c = name + "=";
	var optType = name.substr(0,3);
	if(config.optionHandlers[optType] && config.optionHandlers[optType].get)
		c += config.optionHandlers[optType].get(name);
	c += "; expires=Fri, 1 Jan 2038 12:00:00 UTC; path=/";
	document.cookie = c;
}

function encodeCookie(s)
{
	return escape(manualConvertUnicodeToUTF8(s));
}

function decodeCookie(s)
{
	s = unescape(s);
	var re = /&#[0-9]{1,5};/g;
	return s.replace(re,function($0) {return String.fromCharCode(eval($0.replace(/[&#;]/g,"")));});
}


config.macros.option.genericCreate = function(place,type,opt,className,desc)
{
	var typeInfo = config.macros.option.types[type];
	var c = document.createElement(typeInfo.elementType);
	if(typeInfo.typeValue)
		c.setAttribute("type",typeInfo.typeValue);
	c[typeInfo.eventName] = typeInfo.onChange;
	c.setAttribute("option",opt);
	if(className)
		c.className = className;
	else
		c.className = typeInfo.className;
	if(config.optionsDesc[opt])
		c.setAttribute("title",config.optionsDesc[opt]);
	place.appendChild(c);
	if(desc != "no")
		createTiddlyText(place,config.optionsDesc[opt] ? config.optionsDesc[opt] : opt);
	c[typeInfo.valueField] = config.options[opt];
	return c;
};

config.macros.option.genericOnChange = function(e)
{
	var opt = this.getAttribute("option");
	if(opt) {
		var optType = opt.substr(0,3);
		var handler = config.macros.option.types[optType];
		if (handler.elementType && handler.valueField)
			config.macros.option.propagateOption(opt,handler.valueField,this[handler.valueField],handler.elementType);
		}
	return true;
};

config.macros.option.types = {
	'txt': {
		elementType: "input",
		valueField: "value",
		eventName: "onkeyup",
		className: "txtOptionInput",
		create: config.macros.option.genericCreate,
		onChange: config.macros.option.genericOnChange
	},
	'chk': {
		elementType: "input",
		valueField: "checked",
		eventName: "onclick",
		className: "chkOptionInput",
		typeValue: "checkbox",
		create: config.macros.option.genericCreate,
		onChange: config.macros.option.genericOnChange
	}
};

config.macros.option.propagateOption = function(opt,valueField,value,elementType)
{
	config.options[opt] = value;
	saveOptionCookie(opt);
	var nodes = document.getElementsByTagName(elementType);
	for(var t=0; t<nodes.length; t++) {
		var optNode = nodes[t].getAttribute("option");
		if(opt == optNode)
			nodes[t][valueField] = value;
		}
};

config.macros.option.handler = function(place,macroName,params,wikifier,paramString,tiddler)
{
	params = paramString.parseParams("anon",null,true,false,false);
	var opt = (params[1] && params[1].name == "anon") ? params[1].value : getParam(params,"name",null);
	var className = (params[2] && params[2].name == "anon") ? params[2].value : getParam(params,"class",null);
	var desc = getParam(params,"desc","no");
	var type = opt.substr(0,3);
	var h = config.macros.option.types[type];
	if (h && h.create)
		h.create(place,type,opt,className,desc);
};

config.macros.options.handler = function(place,macroName,params,wikifier,paramString,tiddler)
{
	params = paramString.parseParams("anon",null,true,false,false);
	var showUnknown = getParam(params,"showUnknown","no");
	var wizard = new Wizard();
	wizard.createWizard(place,this.wizardTitle);
	wizard.addStep(this.step1Title,this.step1Html);
	var markList = wizard.getElement("markList");
	var chkUnknown = wizard.getElement("chkUnknown");
	chkUnknown.checked = showUnknown == "yes";
	chkUnknown.onchange = this.onChangeUnknown;
	var listWrapper = document.createElement("div");
	markList.parentNode.insertBefore(listWrapper,markList);
	wizard.setValue("listWrapper",listWrapper);
	this.refreshOptions(listWrapper,showUnknown == "yes");
};

config.macros.options.refreshOptions = function(listWrapper,showUnknown)
{
	var opts = [];
	for(var n in config.options) {
		var opt = {};
		opt.option = "";
		opt.name = n;
		opt.lowlight = !config.optionsDesc[n];
		opt.description = opt.lowlight ? this.unknownDescription : config.optionsDesc[n];
		if(!opt.lowlight || showUnknown)
			opts.push(opt);
	}
	opts.sort(function(a,b) {return a.name.substr(3) < b.name.substr(3) ? -1 : (a.name.substr(3) == b.name.substr(3) ? 0 : +1);});
	var listview = ListView.create(listWrapper,opts,this.listViewTemplate);
	for(n=0; n<opts.length; n++) {
		var type = opts[n].name.substr(0,3);
		var h = config.macros.option.types[type];
		if (h && h.create) {
			h.create(opts[n].colElements['option'],type,opts[n].name,null,"no");
		}
	}
};

config.macros.options.onChangeUnknown = function(e)
{
	var wizard = new Wizard(this);
	var listWrapper = wizard.getValue("listWrapper");
	removeChildren(listWrapper);
	config.macros.options.refreshOptions(listWrapper,this.checked);
	return false;
};

//--
//-- Saving
//--

var saveUsingSafari = false;

var startSaveArea = '<div id="' + 'storeArea">'; // Split up into two so that indexOf() of this source doesn't find it
var endSaveArea = '</d' + 'iv>';

// If there are unsaved changes, force the user to confirm before exitting
function confirmExit()
{
	hadConfirmExit = true;
	if((store && store.isDirty && store.isDirty()) || (story && story.areAnyDirty && story.areAnyDirty()))
		return config.messages.confirmExit;
}

// Give the user a chance to save changes before exitting
function checkUnsavedChanges()
{
	if(store && store.isDirty && store.isDirty() && window.hadConfirmExit === false) {
		if(confirm(config.messages.unsavedChangesWarning))
			saveChanges();
	}
}

function updateLanguageAttribute(s)
{
	if(config.locale) {
		var mRE = /(<html(?:.*?)?)(?: xml:lang\="([a-z]+)")?(?: lang\="([a-z]+)")?>/;
		var m = mRE.exec(s);
		if(m) {
			var t = m[1];
			if(m[2])
				t += ' xml:lang="' + config.locale + '"';
			if(m[3])
				t += ' lang="' + config.locale + '"';
			t += ">";
			s = s.substr(0,m.index) + t + s.substr(m.index+m[0].length);
		}
	}
	return s;
}

function updateMarkupBlock(s,blockName,tiddlerName)
{
	return s.replaceChunk(
			"<!--%0-START-->".format([blockName]),
			"<!--%0-END-->".format([blockName]),
			"\n" + store.getRecursiveTiddlerText(tiddlerName,"") + "\n");
}

function updateOriginal(original,posDiv)
{
	if(!posDiv)
		posDiv = locateStoreArea(original);
	if(!posDiv) {
		alert(config.messages.invalidFileError.format([localPath]));
		return null;
	}
	var revised = original.substr(0,posDiv[0] + startSaveArea.length) + "\n" +
				convertUnicodeToUTF8(store.allTiddlersAsHtml()) + "\n" +
				original.substr(posDiv[1]);
	var newSiteTitle = convertUnicodeToUTF8(getPageTitle()).htmlEncode();
	revised = revised.replaceChunk("<title"+">","</title"+">"," " + newSiteTitle + " ");
	revised = updateLanguageAttribute(revised);
	revised = updateMarkupBlock(revised,"PRE-HEAD","MarkupPreHead");
	revised = updateMarkupBlock(revised,"POST-HEAD","MarkupPostHead");
	revised = updateMarkupBlock(revised,"PRE-BODY","MarkupPreBody");
	revised = updateMarkupBlock(revised,"POST-SCRIPT","MarkupPostBody");
	return revised;
}

function locateStoreArea(original)
{
	// Locate the storeArea div's
	var posOpeningDiv = original.indexOf(startSaveArea);
	var limitClosingDiv = original.indexOf("<"+"!--POST-STOREAREA--"+">");
	if(limitClosingDiv == -1)
		limitClosingDiv = original.indexOf("<"+"!--POST-BODY-START--"+">");
	var posClosingDiv = original.lastIndexOf(endSaveArea,limitClosingDiv == -1 ? original.length : limitClosingDiv);
	return (posOpeningDiv != -1 && posClosingDiv != -1) ? [posOpeningDiv,posClosingDiv] : null;
}

function autoSaveChanges(onlyIfDirty,tiddlers)
{
	if(config.options.chkAutoSave)
		saveChanges(onlyIfDirty,tiddlers);
}

// Save this tiddlywiki with the pending changes
function saveChanges(onlyIfDirty,tiddlers)
{
	if(onlyIfDirty && !store.isDirty())
		return;
	clearMessage();
	// Get the URL of the document
	var originalPath = document.location.toString();
	// Check we were loaded from a file URL
	if(originalPath.substr(0,5) != "file:") {
		alert(config.messages.notFileUrlError);
		if(store.tiddlerExists(config.messages.saveInstructions))
			story.displayTiddler(null,config.messages.saveInstructions);
		return;
	}
	var localPath = getLocalPath(originalPath);
	// Load the original file
	var original = loadFile(localPath);
	if(original == null) {
		alert(config.messages.cantSaveError);
		if(store.tiddlerExists(config.messages.saveInstructions))
			story.displayTiddler(null,config.messages.saveInstructions);
		return;
	}
	// Locate the storeArea div's
	var posDiv = locateStoreArea(original);
	if(!posDiv) {
		alert(config.messages.invalidFileError.format([localPath]));
		return;
	}
	saveBackup(localPath,original);
	saveRss(localPath);
	saveEmpty(localPath,original,posDiv);
	saveMain(localPath,original,posDiv);
}

function saveBackup(localPath,original)
{
	if(config.options.chkSaveBackups) {
		var backupPath = getBackupPath(localPath);
		var backup = config.browser.isIE ? ieCopyFile(backupPath,localPath) : saveFile(backupPath,original);
		if(backup)
			displayMessage(config.messages.backupSaved,"file://" + backupPath);
		else
			alert(config.messages.backupFailed);
	}
}

function saveRss(localPath)
{
	if(config.options.chkGenerateAnRssFeed) {
		var rssPath = localPath.substr(0,localPath.lastIndexOf(".")) + ".xml";
		var rssSave = saveFile(rssPath,convertUnicodeToUTF8(generateRss()));
		if(rssSave)
			displayMessage(config.messages.rssSaved,"file://" + rssPath);
		else
			alert(config.messages.rssFailed);
	}
}

function saveEmpty(localPath,original,posDiv)
{
	if(config.options.chkSaveEmptyTemplate) {
		var emptyPath,p;
		if((p = localPath.lastIndexOf("/")) != -1)
			emptyPath = localPath.substr(0,p) + "/empty.html";
		else if((p = localPath.lastIndexOf("\\")) != -1)
			emptyPath = localPath.substr(0,p) + "\\empty.html";
		else
			emptyPath = localPath + ".empty.html";
		var empty = original.substr(0,posDiv[0] + startSaveArea.length) + original.substr(posDiv[1]);
		var emptySave = saveFile(emptyPath,empty);
		if(emptySave)
			displayMessage(config.messages.emptySaved,"file://" + emptyPath);
		else
			alert(config.messages.emptyFailed);
	}
}

function saveMain(localPath,original,posDiv)
{
	var save;
	try {
		var revised = updateOriginal(original,posDiv);
		save = saveFile(localPath,revised);
	} catch (ex) {
		showException(ex);
	}
	if(save) {
		displayMessage(config.messages.mainSaved,"file://" + localPath);
		store.setDirty(false);
	} else {
		alert(config.messages.mainFailed);
	}
}

function getLocalPath(origPath)
{
	var originalPath = convertUriToUTF8(origPath,config.options.txtFileSystemCharSet);
	// Remove any location or query part of the URL
	var argPos = originalPath.indexOf("?");
	if(argPos != -1)
		originalPath = originalPath.substr(0,argPos);
	var hashPos = originalPath.indexOf("#");
	if(hashPos != -1)
		originalPath = originalPath.substr(0,hashPos);
	// Convert file://localhost/ to file:///
	if(originalPath.indexOf("file://localhost/") == 0)
		originalPath = "file://" + originalPath.substr(16);
	// Convert to a native file format
	var localPath;
	if(originalPath.charAt(9) == ":") // pc local file
		localPath = unescape(originalPath.substr(8)).replace(new RegExp("/","g"),"\\");
	else if(originalPath.indexOf("file://///") == 0) // FireFox pc network file
		localPath = "\\\\" + unescape(originalPath.substr(10)).replace(new RegExp("/","g"),"\\");
	else if(originalPath.indexOf("file:///") == 0) // mac/unix local file
		localPath = unescape(originalPath.substr(7));
	else if(originalPath.indexOf("file:/") == 0) // mac/unix local file
		localPath = unescape(originalPath.substr(5));
	else // pc network file
		localPath = "\\\\" + unescape(originalPath.substr(7)).replace(new RegExp("/","g"),"\\");
	return localPath;
}

function getBackupPath(localPath,title,extension)
{
	var slash = "\\";
	var dirPathPos = localPath.lastIndexOf("\\");
	if(dirPathPos == -1) {
		dirPathPos = localPath.lastIndexOf("/");
		slash = "/";
	}
	var backupFolder = config.options.txtBackupFolder;
	if(!backupFolder || backupFolder == "")
		backupFolder = ".";
	var backupPath = localPath.substr(0,dirPathPos) + slash + backupFolder + localPath.substr(dirPathPos);
	backupPath = backupPath.substr(0,backupPath.lastIndexOf(".")) + ".";
	if(title)
		backupPath += title.replace(/[\\\/\*\?\":<> ]/g,"_") + ".";
	backupPath += (new Date()).convertToYYYYMMDDHHMMSSMMM() + "." + (extension ? extension : "html");
	return backupPath;
}

function generateRss()
{
	var s = [];
	var d = new Date();
	var u = store.getTiddlerText("SiteUrl");
	// Assemble the header
	s.push("<" + "?xml version=\"1.0\"?" + ">");
	s.push("<rss version=\"2.0\">");
	s.push("<channel>");
	s.push("<title" + ">" + wikifyPlain("SiteTitle").htmlEncode() + "</title" + ">");
	if(u)
		s.push("<link>" + u.htmlEncode() + "</link>");
	s.push("<description>" + wikifyPlain("SiteSubtitle").htmlEncode() + "</description>");
	s.push("<language>en-us</language>");
	s.push("<copyright>Copyright " + d.getFullYear() + " " + config.options.txtUserName.htmlEncode() + "</copyright>");
	s.push("<pubDate>" + d.toGMTString() + "</pubDate>");
	s.push("<lastBuildDate>" + d.toGMTString() + "</lastBuildDate>");
	s.push("<docs>http://blogs.law.harvard.edu/tech/rss</docs>");
	s.push("<generator>TiddlyWiki " + version.major + "." + version.minor + "." + version.revision + "</generator>");
	// The body
	var tiddlers = store.getTiddlers("modified","excludeLists");
	var n = config.numRssItems > tiddlers.length ? 0 : tiddlers.length-config.numRssItems;
	for (var t=tiddlers.length-1; t>=n; t--) {
		s.push("<item>\n" + tiddlers[t].toRssItem(u) + "\n</item>");
	}
	// And footer
	s.push("</channel>");
	s.push("</rss>");
	// Save it all
	return s.join("\n");
}

//--
//-- Filesystem code
//--

function convertUTF8ToUnicode(u)
{
	return window.netscape == undefined ? manualConvertUTF8ToUnicode(u) : mozConvertUTF8ToUnicode(u);
}

function manualConvertUTF8ToUnicode(utf)
{
	var uni = utf;
	var src = 0;
	var dst = 0;
	var b1, b2, b3;
	var c;
	while(src < utf.length) {
		b1 = utf.charCodeAt(src++);
		if(b1 < 0x80) {
			dst++;
		} else if(b1 < 0xE0) {
			b2 = utf.charCodeAt(src++);
			c = String.fromCharCode(((b1 & 0x1F) << 6) | (b2 & 0x3F));
			uni = uni.substring(0,dst++).concat(c,utf.substr(src));
		} else {
			b2 = utf.charCodeAt(src++);
			b3 = utf.charCodeAt(src++);
			c = String.fromCharCode(((b1 & 0xF) << 12) | ((b2 & 0x3F) << 6) | (b3 & 0x3F));
			uni = uni.substring(0,dst++).concat(c,utf.substr(src));
		}
	}
	return uni;
}

function mozConvertUTF8ToUnicode(u)
{
	try {
		netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect");
		var converter = Components.classes["@mozilla.org/intl/scriptableunicodeconverter"].createInstance(Components.interfaces.nsIScriptableUnicodeConverter);
		converter.charset = "UTF-8";
	} catch(ex) {
		return manualConvertUTF8ToUnicode(u);
	} // fallback
	var s = converter.ConvertToUnicode(u);
	var fin = converter.Finish();
	return (fin.length > 0) ? s+fin : s;
}

function convertUnicodeToUTF8(s)
{
	if(window.netscape == undefined)
		return manualConvertUnicodeToUTF8(s);
	else
		return mozConvertUnicodeToUTF8(s);
}

function manualConvertUnicodeToUTF8(s)
{
	var re = /[^\u0000-\u007F]/g ;
	return s.replace(re,function($0) {return "&#" + $0.charCodeAt(0).toString() + ";";});
}

function mozConvertUnicodeToUTF8(s)
{
	try {
		netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect");
		var converter = Components.classes["@mozilla.org/intl/scriptableunicodeconverter"].createInstance(Components.interfaces.nsIScriptableUnicodeConverter);
		converter.charset = "UTF-8";
	} catch(ex) {
		return manualConvertUnicodeToUTF8(s);
	} // fallback
	var u = converter.ConvertFromUnicode(s);
	var fin = converter.Finish();
	return fin.length > 0 ? u + fin : u;
}

function convertUriToUTF8(uri,charSet)
{
	if(window.netscape == undefined || charSet == undefined || charSet == "")
		return uri;
	try {
		netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect");
		var converter = Components.classes["@mozilla.org/intl/utf8converterservice;1"].getService(Components.interfaces.nsIUTF8ConverterService);
	} catch(ex) {
		return uri;
	}
	return converter.convertURISpecToUTF8(uri,charSet);
}

function saveFile(fileUrl,content)
{
	var r = mozillaSaveFile(fileUrl,content);
	if(!r)
		r = ieSaveFile(fileUrl,content);
	if(!r)
		r = javaSaveFile(fileUrl,content);
	return r;
}

function loadFile(fileUrl)
{
	var r = mozillaLoadFile(fileUrl);
	if((r == null) || (r == false))
		r = ieLoadFile(fileUrl);
	if((r == null) || (r == false))
		r = javaLoadFile(fileUrl);
	return r;
}

function ieCreatePath(path)
{
	try {
		var fso = new ActiveXObject("Scripting.FileSystemObject");
	} catch(ex) {
		return null;
	}

	var pos = path.lastIndexOf("\\");
	if(pos!=-1)
		path = path.substring(0, pos+1);

	var scan = [];
	scan.push(path);
	var i = 0;
	do {
		var parent = fso.GetParentFolderName(scan[i++]);
		if (fso.FolderExists(parent))
			break;
		scan.push(parent);
	} while(true);

	for(i=scan.length-1;i>=0;i--) {
		if (!fso.FolderExists(scan[i]))
			fso.CreateFolder(scan[i]);
	}
	return true;
}

// Returns null if it can't do it, false if there's an error, true if it saved OK
function ieSaveFile(filePath,content)
{
	ieCreatePath(filePath);
	try {
		var fso = new ActiveXObject("Scripting.FileSystemObject");
	} catch(ex) {
		return null;
	}
	var file = fso.OpenTextFile(filePath,2,-1,0);
	file.Write(content);
	file.Close();
	return true;
}

// Returns null if it can't do it, false if there's an error, or a string of the content if successful
function ieLoadFile(filePath)
{
	try {
		var fso = new ActiveXObject("Scripting.FileSystemObject");
		var file = fso.OpenTextFile(filePath,1);
		var content = file.ReadAll();
		file.Close();
	} catch(ex) {
		return null;
	}
	return content;
}

function ieCopyFile(dest,source)
{
	ieCreatePath(dest);
	try {
		var fso = new ActiveXObject("Scripting.FileSystemObject");
		fso.GetFile(source).Copy(dest);
	} catch(ex) {
		return false;
	}
	return true;
}

// Returns null if it can't do it, false if there's an error, true if it saved OK
function mozillaSaveFile(filePath,content)
{
	if(window.Components) {
		try {
			netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect");
			var file = Components.classes["@mozilla.org/file/local;1"].createInstance(Components.interfaces.nsILocalFile);
			file.initWithPath(filePath);
			if(!file.exists())
				file.create(0,0664);
			var out = Components.classes["@mozilla.org/network/file-output-stream;1"].createInstance(Components.interfaces.nsIFileOutputStream);
			out.init(file,0x20|0x02,00004,null);
			out.write(content,content.length);
			out.flush();
			out.close();
			return true;
		} catch(ex) {
			return false;
		}
	}
	return null;
}

// Returns null if it can't do it, false if there's an error, or a string of the content if successful
function mozillaLoadFile(filePath)
{
	if(window.Components) {
		try {
			netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect");
			var file = Components.classes["@mozilla.org/file/local;1"].createInstance(Components.interfaces.nsILocalFile);
			file.initWithPath(filePath);
			if(!file.exists())
				return null;
			var inputStream = Components.classes["@mozilla.org/network/file-input-stream;1"].createInstance(Components.interfaces.nsIFileInputStream);
			inputStream.init(file,0x01,00004,null);
			var sInputStream = Components.classes["@mozilla.org/scriptableinputstream;1"].createInstance(Components.interfaces.nsIScriptableInputStream);
			sInputStream.init(inputStream);
			return sInputStream.read(sInputStream.available());
		} catch(ex) {
			return false;
		}
	}
	return null;
}

function javaUrlToFilename(url)
{
	var f = "//localhost";
	if(url.indexOf(f) == 0)
		return url.substring(f.length);
	var i = url.indexOf(":");
	if(i > 0)
		return url.substring(i-1);
	return url;
}

function javaSaveFile(filePath,content)
{
	try {
		if(document.applets["TiddlySaver"])
			return document.applets["TiddlySaver"].saveFile(javaUrlToFilename(filePath),"UTF-8",content);
	} catch(ex) {
	}
	try {
		var s = new java.io.PrintStream(new java.io.FileOutputStream(javaUrlToFilename(filePath)));
		s.print(content);
		s.close();
	} catch(ex) {
		return null;
	}
	return true;
}

function javaLoadFile(filePath)
{
	try {
		if(document.applets["TiddlySaver"])
			return String(document.applets["TiddlySaver"].loadFile(javaUrlToFilename(filePath),"UTF-8"));
	} catch(ex) {
	}
	var content = [];
	try {
		var r = new java.io.BufferedReader(new java.io.FileReader(javaUrlToFilename(filePath)));
		var line;
		while((line = r.readLine()) != null)
			content.push(new String(line));
		r.close();
	} catch(ex) {
		return null;
	}
	return content.join("\n");
}

//--
//-- Server adaptor for talking to static TiddlyWiki files
//--

function FileAdaptor()
{
	this.host = null;
	this.store = null;
	return this;
}

FileAdaptor.serverType = 'file';

FileAdaptor.prototype.setContext = function(context,userParams,callback)
{
	if(!context) context = {};
	context.userParams = userParams;
	if(callback) context.callback = callback;
	context.adaptor = this;
	if(!context.host)
		context.host = this.host;
	context.host = FileAdaptor.fullHostName(context.host);
	if(!context.workspace)
		context.workspace = this.workspace;
	return context;
};

FileAdaptor.fullHostName = function(host)
{
	if(!host)
		return '';
	if(!host.match(/:\/\//))
		host = 'http://' + host;
	return host;
};

FileAdaptor.minHostName = function(host)
{
	return host ? host.replace(/^http:\/\//,'').replace(/\/$/,'') : '';
};

// Open the specified host
FileAdaptor.prototype.openHost = function(host,context,userParams,callback)
{
	this.host = host;
	context = this.setContext(context,userParams,callback);
	context.status = true;
	if(callback)
		window.setTimeout(function() {callback(context,userParams);},10);
	return true;
};

FileAdaptor.loadTiddlyWikiCallback = function(status,context,responseText,url,xhr)
{
	context.status = status;
	if(!status) {
		context.statusText = "Error reading file: " + xhr.statusText;
	} else {
		context.adaptor.store = new TiddlyWiki();
		if(!context.adaptor.store.importTiddlyWiki(responseText))
			context.statusText = config.messages.invalidFileError.format([url]);
	}
	context.complete(context,context.userParams);
};

// Get the list of workspaces on a given server
FileAdaptor.prototype.getWorkspaceList = function(context,userParams,callback)
{
	context = this.setContext(context,userParams,callback);
	context.workspaces = [{title:"(default)"}];
	context.status = true;
	if(callback)
		window.setTimeout(function() {callback(context,userParams);},10);
	return true;
};

// Open the specified workspace
FileAdaptor.prototype.openWorkspace = function(workspace,context,userParams,callback)
{
	this.workspace = workspace;
	context = this.setContext(context,userParams,callback);
	context.status = true;
	if(callback)
		window.setTimeout(function() {callback(context,userParams);},10);
	return true;
};

// Gets the list of tiddlers within a given workspace
FileAdaptor.prototype.getTiddlerList = function(context,userParams,callback,filter)
{
	context = this.setContext(context,userParams,callback);
	if(!context.filter)
		context.filter = filter;
	context.complete = FileAdaptor.getTiddlerListComplete;
	if(this.store) {
		var ret = context.complete(context,context.userParams);
	} else {
		ret = loadRemoteFile(context.host,FileAdaptor.loadTiddlyWikiCallback,context);
		if(typeof ret != "string")
			ret = true;
	}
	return ret;
};

FileAdaptor.getTiddlerListComplete = function(context,userParams)
{
	if(context.filter) {
		context.tiddlers = context.adaptor.store.filterTiddlers(context.filter);
	} else {
		context.tiddlers = [];
		context.adaptor.store.forEachTiddler(function(title,tiddler) {context.tiddlers.push(tiddler);});
	}
	for(var i=0; i<context.tiddlers.length; i++) {
		context.tiddlers[i].fields['server.type'] = FileAdaptor.serverType;
		context.tiddlers[i].fields['server.host'] = FileAdaptor.minHostName(context.host);
		context.tiddlers[i].fields['server.page.revision'] = context.tiddlers[i].modified.convertToYYYYMMDDHHMM();
	}
	context.status = true;
	if(context.callback) {
		window.setTimeout(function() {context.callback(context,userParams);},10);
	}
	return true;
};

FileAdaptor.prototype.generateTiddlerInfo = function(tiddler)
{
	var info = {};
	info.uri = tiddler.fields['server.host'] + "#" + tiddler.title;
	return info;
};

// Retrieve a tiddler from a given workspace on a given server
FileAdaptor.prototype.getTiddler = function(title,context,userParams,callback)
{
	context = this.setContext(context,userParams,callback);
	context.title = title;
	context.complete = FileAdaptor.getTiddlerComplete;
	return context.adaptor.store ? 
		context.complete(context,context.userParams) :
		loadRemoteFile(context.host,FileAdaptor.loadTiddlyWikiCallback,context);
};

FileAdaptor.getTiddlerComplete = function(context,userParams)
{
	var t = context.adaptor.store.fetchTiddler(context.title);
	t.fields['server.type'] = FileAdaptor.serverType;
	t.fields['server.host'] = FileAdaptor.minHostName(context.host);
	t.fields['server.page.revision'] = t.modified.convertToYYYYMMDDHHMM();
	context.tiddler = t;
	context.status = true;
	if(context.allowSynchronous) {
		context.isSynchronous = true;
		context.callback(context,userParams);
	} else {
		window.setTimeout(function() {callback(context,userParams);},10);
	}
	return true;
};

FileAdaptor.prototype.close = function()
{
	delete this.store;
	this.store = null;
};

config.adaptors[FileAdaptor.serverType] = FileAdaptor;

//--
//-- Remote HTTP requests
//--

function loadRemoteFile(url,callback,params)
{
	return doHttp("GET",url,null,null,null,null,callback,params,null);
}

// HTTP status codes
var httpStatus = {
	OK: 200,
	ContentCreated: 201,
	NoContent: 204,
	MultiStatus: 207,
	Unauthorized: 401,
	Forbidden: 403,
	NotFound: 404,
	MethodNotAllowed: 405
};

function doHttp(type,url,data,contentType,username,password,callback,params,headers)
{
	var x = getXMLHttpRequest();
	if(!x)
		return "Can't create XMLHttpRequest object";
	x.onreadystatechange = function() {
		try {
			var status = x.status;
		} catch(ex) {
			status = false;
		}
		if (x.readyState == 4 && callback && (status !== undefined)) {
			if([0, httpStatus.OK, httpStatus.ContentCreated, httpStatus.NoContent, httpStatus.MultiStatus].contains(status))
				callback(true,params,x.responseText,url,x);
			else
				callback(false,params,null,url,x);
			x.onreadystatechange = function(){};
			x = null;
		}
	};
	if(window.Components && window.netscape && window.netscape.security && document.location.protocol.indexOf("http") == -1)
		window.netscape.security.PrivilegeManager.enablePrivilege("UniversalBrowserRead");
	try {
		url = url + (url.indexOf("?") < 0 ? "?" : "&") + "nocache=" + Math.random();
		x.open(type,url,true,username,password);
		if(data)
			x.setRequestHeader("Content-Type", contentType ? contentType : "application/x-www-form-urlencoded");
		if(x.overrideMimeType)
			x.setRequestHeader("Connection", "close");
		if(headers) {
			for(var n in headers)
				x.setRequestHeader(n,headers[n]);
		}
		x.setRequestHeader("X-Requested-With", "TiddlyWiki " + version.major + "." + version.minor + "." + version.revision + (version.beta ? " (beta " + version.beta + ")" : ""));
		x.send(data);
	} catch(ex) {
		return exceptionText(ex);
	}
	return x;
}

function getXMLHttpRequest()
{
	try {
		var x = new XMLHttpRequest(); // Modern
	} catch(ex) {
		try {
			x = new ActiveXObject("Msxml2.XMLHTTP"); // IE 6
		} catch (ex2) {
			return null;
		}
	}
	return x;
}

//--
//-- TiddlyWiki-specific utility functions
//--

function createTiddlyButton(parent,text,tooltip,action,className,id,accessKey,attribs)
{
	var btn = document.createElement("a");
	if(action) {
		btn.onclick = action;
		btn.setAttribute("href","javascript:;");
	}
	if(tooltip)
		btn.setAttribute("title",tooltip);
	if(text)
		btn.appendChild(document.createTextNode(text));
	btn.className = className ? className : "button";
	if(id)
		btn.id = id;
	if(attribs) {
		for(var n in attribs) {
			btn.setAttribute(n,attribs[n]);
		}
	}
	if(parent)
		parent.appendChild(btn);
	if(accessKey)
		btn.setAttribute("accessKey",accessKey);
	return btn;
}

function createTiddlyLink(place,title,includeText,className,isStatic,linkedFromTiddler,noToggle)
{
	var text = includeText ? title : null;
	var i = getTiddlyLinkInfo(title,className);
	var btn = isStatic ? createExternalLink(place,store.getTiddlerText("SiteUrl",null) + "#" + title) : createTiddlyButton(place,text,i.subTitle,onClickTiddlerLink,i.classes);
	btn.setAttribute("refresh","link");
	btn.setAttribute("tiddlyLink",title);
	if(noToggle)
		btn.setAttribute("noToggle","true");
	if(linkedFromTiddler) {
		var fields = linkedFromTiddler.getInheritedFields();
		if(fields)
			btn.setAttribute("tiddlyFields",fields);
	}
	return btn;
}

function refreshTiddlyLink(e,title)
{
	var i = getTiddlyLinkInfo(title,e.className);
	e.className = i.classes;
	e.title = i.subTitle;
}

function getTiddlyLinkInfo(title,currClasses)
{
	var classes = currClasses ? currClasses.split(" ") : [];
	classes.pushUnique("tiddlyLink");
	var tiddler = store.fetchTiddler(title);
	var subTitle;
	if(tiddler) {
		subTitle = tiddler.getSubtitle();
		classes.pushUnique("tiddlyLinkExisting");
		classes.remove("tiddlyLinkNonExisting");
		classes.remove("shadow");
	} else {
		classes.remove("tiddlyLinkExisting");
		classes.pushUnique("tiddlyLinkNonExisting");
		if(store.isShadowTiddler(title)) {
			subTitle = config.messages.shadowedTiddlerToolTip.format([title]);
			classes.pushUnique("shadow");
		} else {
			subTitle = config.messages.undefinedTiddlerToolTip.format([title]);
			classes.remove("shadow");
		}
	}
	if(typeof config.annotations[title]=="string")
		subTitle = config.annotations[title];
	return {classes: classes.join(" "),subTitle: subTitle};
}

function createExternalLink(place,url)
{
	var link = document.createElement("a");
	link.className = "externalLink";
	link.href = url;
	link.title = config.messages.externalLinkTooltip.format([url]);
	if(config.options.chkOpenInNewWindow)
		link.target = "_blank";
	place.appendChild(link);
	return link;
}

// Event handler for clicking on a tiddly link
function onClickTiddlerLink(ev)
{
	var e = ev ? ev : window.event;
	var target = resolveTarget(e);
	var link = target;
	var title = null;
	var fields = null;
	var noToggle = null;
	do {
		title = link.getAttribute("tiddlyLink");
		fields = link.getAttribute("tiddlyFields");
		noToggle = link.getAttribute("noToggle");
		link = link.parentNode;
	} while(title == null && link != null);
	if(!store.isShadowTiddler(title)) {
		var f = fields ? fields.decodeHashMap() : {};
		fields = String.encodeHashMap(merge(f,config.defaultCustomFields,true));
	}
	if(title) {
		var toggling = e.metaKey || e.ctrlKey;
		if(config.options.chkToggleLinks)
			toggling = !toggling;
		if(noToggle)
			toggling = false;
		if(store.getTiddler(title))
			fields = null;
		story.displayTiddler(target,title,null,true,null,fields,toggling);
	}
	clearMessage();
	return false;
}

// Create a button for a tag with a popup listing all the tiddlers that it tags
function createTagButton(place,tag,excludeTiddler)
{
	var btn = createTiddlyButton(place,tag,config.views.wikified.tag.tooltip.format([tag]),onClickTag);
	btn.setAttribute("tag",tag);
	if(excludeTiddler)
		btn.setAttribute("tiddler",excludeTiddler);
	return btn;
}

// Event handler for clicking on a tiddler tag
function onClickTag(ev)
{
	var e = ev ? ev : window.event;
	var popup = Popup.create(this);
	var tag = this.getAttribute("tag");
	var title = this.getAttribute("tiddler");
	if(popup && tag) {
		var tagged = store.getTaggedTiddlers(tag);
		var titles = [];
		var li,r;
		for(r=0;r<tagged.length;r++) {
			if(tagged[r].title != title)
				titles.push(tagged[r].title);
		}
		var lingo = config.views.wikified.tag;
		if(titles.length > 0) {
			var openAll = createTiddlyButton(createTiddlyElement(popup,"li"),lingo.openAllText.format([tag]),lingo.openAllTooltip,onClickTagOpenAll);
			openAll.setAttribute("tag",tag);
			createTiddlyElement(createTiddlyElement(popup,"li",null,"listBreak"),"div");
			for(r=0; r<titles.length; r++) {
				createTiddlyLink(createTiddlyElement(popup,"li"),titles[r],true);
			}
		} else {
			createTiddlyText(createTiddlyElement(popup,"li",null,"disabled"),lingo.popupNone.format([tag]));
		}
		createTiddlyElement(createTiddlyElement(popup,"li",null,"listBreak"),"div");
		var h = createTiddlyLink(createTiddlyElement(popup,"li"),tag,false);
		createTiddlyText(h,lingo.openTag.format([tag]));
	}
	Popup.show();
	e.cancelBubble = true;
	if(e.stopPropagation) e.stopPropagation();
	return false;
}

// Event handler for 'open all' on a tiddler popup
function onClickTagOpenAll(ev)
{
	var e = ev ? ev : window.event;
	var tag = this.getAttribute("tag");
	var tagged = store.getTaggedTiddlers(tag);
	story.displayTiddlers(this,tagged);
	return false;
}

function onClickError(ev)
{
	var e = ev ? ev : window.event;
	var popup = Popup.create(this);
	var lines = this.getAttribute("errorText").split("\n");
	for(var t=0; t<lines.length; t++)
		createTiddlyElement(popup,"li",null,null,lines[t]);
	Popup.show();
	e.cancelBubble = true;
	if(e.stopPropagation) e.stopPropagation();
	return false;
}

function createTiddlyDropDown(place,onchange,options,defaultValue)
{
	var sel = createTiddlyElement(place,"select");
	sel.onchange = onchange;
	for(var t=0; t<options.length; t++) {
		var e = createTiddlyElement(sel,"option",null,null,options[t].caption);
		e.value = options[t].name;
		if(options[t].name == defaultValue)
			e.selected = true;
	}
	return sel;
}

function createTiddlyPopup(place,caption,tooltip,tiddler)
{
	if(tiddler.text) {
		createTiddlyLink(place,caption,true);
		var btn = createTiddlyButton(place,glyph("downArrow"),tooltip,onClickTiddlyPopup,"tiddlerPopupButton");
		btn.tiddler = tiddler;
	} else {
		createTiddlyText(place,caption);
	}
}

function onClickTiddlyPopup(ev)
{
	var e = ev ? ev : window.event;
	var tiddler = this.tiddler;
	if(tiddler.text) {
		var popup = Popup.create(this,"div","popupTiddler");
		wikify(tiddler.text,popup,null,tiddler);
		Popup.show();
	}
	if(e) e.cancelBubble = true;
	if(e && e.stopPropagation) e.stopPropagation();
	return false;
}

function createTiddlyError(place,title,text)
{
	var btn = createTiddlyButton(place,title,null,onClickError,"errorButton");
	if(text) btn.setAttribute("errorText",text);
}

function merge(dst,src,preserveExisting)
{
	for(p in src) {
		if(!preserveExisting || dst[p] === undefined)
			dst[p] = src[p];
	}
	return dst;
}

// Returns a string containing the description of an exception, optionally prepended by a message
function exceptionText(e,message)
{
	var s = e.description ? e.description : e.toString();
	return message ? "%0:\n%1".format([message,s]) : s;
}

// Displays an alert of an exception description with optional message
function showException(e,message)
{
	alert(exceptionText(e,message));
}

function alertAndThrow(m)
{
	alert(m);
	throw(m);
}

function glyph(name)
{
	var g = config.glyphs;
	var b = g.currBrowser;
	if(b == null) {
		b = 0;
		while(!g.browsers[b]() && b < g.browsers.length-1)
			b++;
		g.currBrowser = b;
	}
	if(!g.codes[name])
		return "";
	return g.codes[name][b];
}


//-
//- Animation engine
//-

function Animator()
{
	this.running = 0; // Incremented at start of each animation, decremented afterwards. If zero, the interval timer is disabled
	this.timerID = 0; // ID of the timer used for animating
	this.animations = []; // List of animations in progress
	return this;
}

// Start animation engine
Animator.prototype.startAnimating = function() //# Variable number of arguments
{
	for(var t=0; t<arguments.length; t++)
		this.animations.push(arguments[t]);
	if(this.running == 0) {
		var me = this;
		this.timerID = window.setInterval(function() {me.doAnimate(me);},10);
	}
	this.running += arguments.length;
};

// Perform an animation engine tick, calling each of the known animation modules
Animator.prototype.doAnimate = function(me)
{
	var a = 0;
	while(a < me.animations.length) {
		var animation = me.animations[a];
		if(animation.tick()) {
			a++;
		} else {
			me.animations.splice(a,1);
			if(--me.running == 0)
				window.clearInterval(me.timerID);
		}
	}
};

Animator.slowInSlowOut = function(progress)
{
	return(1-((Math.cos(progress * Math.PI)+1)/2));
};

//--
//-- Morpher animation
//--

// Animate a set of properties of an element
function Morpher(element,duration,properties,callback)
{
	this.element = element;
	this.duration = duration;
	this.properties = properties;
	this.startTime = new Date();
	this.endTime = Number(this.startTime) + duration;
	this.callback = callback;
	this.tick();
	return this;
}

Morpher.prototype.assignStyle = function(element,style,value)
{
	switch(style) {
		case "-tw-vertScroll":
			window.scrollTo(findScrollX(),value);
			break;
		case "-tw-horizScroll":
			window.scrollTo(value,findScrollY());
			break;
		default:
			element.style[style] = value;
			break;
	}
};

Morpher.prototype.stop = function()
{
	for(var t=0; t<this.properties.length; t++) {
		var p = this.properties[t];
		if(p.atEnd !== undefined) {
			this.assignStyle(this.element,p.style,p.atEnd);
		}
	}
	if(this.callback)
		this.callback(this.element,this.properties);
};

Morpher.prototype.tick = function()
{
	var currTime = Number(new Date());
	progress = Animator.slowInSlowOut(Math.min(1,(currTime-this.startTime)/this.duration));
	for(var t=0; t<this.properties.length; t++) {
		var p = this.properties[t];
		if(p.start !== undefined && p.end !== undefined) {
			var template = p.template ? p.template : "%0";
			switch(p.format) {
				case undefined:
				case "style":
					var v = p.start + (p.end-p.start) * progress;
					this.assignStyle(this.element,p.style,template.format([v]));
					break;
				case "color":
					break;
			}
		}
	}
	if(currTime >= this.endTime) {
		this.stop();
		return false;
	}
	return true;
};

//--
//-- Zoomer animation
//--

function Zoomer(text,startElement,targetElement,unused)
{
	var e = createTiddlyElement(document.body,"div",null,"zoomer");
	createTiddlyElement(e,"div",null,null,text);
	var winWidth = findWindowWidth();
	var winHeight = findWindowHeight();
	var p = [
		{style: 'left', start: findPosX(startElement), end: findPosX(targetElement), template: '%0px'},
		{style: 'top', start: findPosY(startElement), end: findPosY(targetElement), template: '%0px'},
		{style: 'width', start: Math.min(startElement.scrollWidth,winWidth), end: Math.min(targetElement.scrollWidth,winWidth), template: '%0px', atEnd: 'auto'},
		{style: 'height', start: Math.min(startElement.scrollHeight,winHeight), end: Math.min(targetElement.scrollHeight,winHeight), template: '%0px', atEnd: 'auto'},
		{style: 'fontSize', start: 8, end: 24, template: '%0pt'}
	];
	var c = function(element,properties) {removeNode(element);};
	return new Morpher(e,config.animDuration,p,c);
}

//--
//-- Scroller animation
//--

function Scroller(targetElement,unused)
{
	var p = [
		{style: '-tw-vertScroll', start: findScrollY(), end: ensureVisible(targetElement)}
	];
	return new Morpher(targetElement,config.animDuration,p);
}

//--
//-- Slider animation
//--

// deleteMode - "none", "all" [delete target element and it's children], [only] "children" [but not the target element]
function Slider(element,opening,unused,deleteMode)
{
	element.style.overflow = 'hidden';
	if(opening)
		element.style.height = '0px'; // Resolves a Firefox flashing bug
	element.style.display = 'block';
	var left = findPosX(element);
	var width = element.scrollWidth;
	var height = element.scrollHeight;
	var winWidth = findWindowWidth();
	var p = [];
	var c = null;
	if(opening) {
		p.push({style: 'height', start: 0, end: height, template: '%0px', atEnd: 'auto'});
		p.push({style: 'opacity', start: 0, end: 1, template: '%0'});
		p.push({style: 'filter', start: 0, end: 100, template: 'alpha(opacity:%0)'});
	} else {
		p.push({style: 'height', start: height, end: 0, template: '%0px'});
		p.push({style: 'display', atEnd: 'none'});
		p.push({style: 'opacity', start: 1, end: 0, template: '%0'});
		p.push({style: 'filter', start: 100, end: 0, template: 'alpha(opacity:%0)'});
		switch(deleteMode) {
			case "all":
				c = function(element,properties) {removeNode(element);};
				break;
			case "children":
				c = function(element,properties) {removeChildren(element);};
				break;
		}
	}
	return new Morpher(element,config.animDuration,p,c);
}

//--
//-- Popup menu
//--

var Popup = {
	stack: [] // Array of objects with members root: and popup:
	};

Popup.create = function(root,elem,theClass)
{
	Popup.remove();
	var popup = createTiddlyElement(document.body,elem ? elem : "ol","popup",theClass ? theClass : "popup");
	Popup.stack.push({root: root, popup: popup});
	return popup;
};

Popup.onDocumentClick = function(ev)
{
	var e = ev ? ev : window.event;
	if(e.eventPhase == undefined)
		Popup.remove();
	else if(e.eventPhase == Event.BUBBLING_PHASE || e.eventPhase == Event.AT_TARGET)
		Popup.remove();
	return true;
};

Popup.show = function(unused1,unused2)
{
	var curr = Popup.stack[Popup.stack.length-1];
	this.place(curr.root,curr.popup);
	addClass(curr.root,"highlight");
	if(config.options.chkAnimate && anim && typeof Scroller == "function")
		anim.startAnimating(new Scroller(curr.popup));
	else
		window.scrollTo(0,ensureVisible(curr.popup));
};

Popup.place = function(root,popup,offset)
{
	if(!offset) var offset = {x:0, y:0};
	var rootLeft = findPosX(root);
	var rootTop = findPosY(root);
	var rootHeight = root.offsetHeight;
	var popupLeft = rootLeft + offset.x;
	var popupTop = rootTop + rootHeight + offset.y;
	var winWidth = findWindowWidth();
	if(popup.offsetWidth > winWidth*0.75)
		popup.style.width = winWidth*0.75 + "px";
	var popupWidth = popup.offsetWidth;
	if(popupLeft + popupWidth > winWidth)
		popupLeft = winWidth - popupWidth;
	popup.style.left = popupLeft + "px";
	popup.style.top = popupTop + "px";
	popup.style.display = "block";
};

Popup.remove = function()
{
	if(Popup.stack.length > 0) {
		Popup.removeFrom(0);
	}
};

Popup.removeFrom = function(from)
{
	for(var t=Popup.stack.length-1; t>=from; t--) {
		var p = Popup.stack[t];
		removeClass(p.root,"highlight");
		removeNode(p.popup);
	}
	Popup.stack = Popup.stack.slice(0,from);
};

//--
//-- Wizard support
//--

function Wizard(elem)
{
	if(elem) {
		this.formElem = findRelated(elem,"wizard","className");
		this.bodyElem = findRelated(this.formElem.firstChild,"wizardBody","className","nextSibling");
		this.footElem = findRelated(this.formElem.firstChild,"wizardFooter","className","nextSibling");
	} else {
		this.formElem = null;
		this.bodyElem = null;
		this.footElem = null;
	}
}

Wizard.prototype.setValue = function(name,value)
{
	if(this.formElem)
		this.formElem[name] = value;
};

Wizard.prototype.getValue = function(name)
{
	return this.formElem ? this.formElem[name] : null;
};

Wizard.prototype.createWizard = function(place,title)
{
	this.formElem = createTiddlyElement(place,"form",null,"wizard");
	createTiddlyElement(this.formElem,"h1",null,null,title);
	this.bodyElem = createTiddlyElement(this.formElem,"div",null,"wizardBody");
	this.footElem = createTiddlyElement(this.formElem,"div",null,"wizardFooter");
};

Wizard.prototype.clear = function()
{
	removeChildren(this.bodyElem);
};

Wizard.prototype.setButtons = function(buttonInfo,status)
{
	removeChildren(this.footElem);
	for(var t=0; t<buttonInfo.length; t++) {
		createTiddlyButton(this.footElem,buttonInfo[t].caption,buttonInfo[t].tooltip,buttonInfo[t].onClick);
		insertSpacer(this.footElem);
		}
	if(typeof status == "string") {
		createTiddlyElement(this.footElem,"span",null,"status",status);
	}
};

Wizard.prototype.addStep = function(stepTitle,html)
{
	removeChildren(this.bodyElem);
	var w = createTiddlyElement(this.bodyElem,"div");
	createTiddlyElement(w,"h2",null,null,stepTitle);
	var step = createTiddlyElement(w,"div",null,"wizardStep");
	step.innerHTML = html;
	applyHtmlMacros(step,tiddler);
};

Wizard.prototype.getElement = function(name)
{
	return this.formElem.elements[name];
};

//--
//-- ListView gadget
//--

var ListView = {};

// Create a listview
ListView.create = function(place,listObject,listTemplate,callback,className)
{
	var table = createTiddlyElement(place,"table",null,className ? className : "listView twtable");
	var thead = createTiddlyElement(table,"thead");
	var r = createTiddlyElement(thead,"tr");
	for(var t=0; t<listTemplate.columns.length; t++) {
		var columnTemplate = listTemplate.columns[t];
		var c = createTiddlyElement(r,"th");
		var colType = ListView.columnTypes[columnTemplate.type];
		if(colType && colType.createHeader)
			colType.createHeader(c,columnTemplate,t);
	}
	var tbody = createTiddlyElement(table,"tbody");
	for(var rc=0; rc<listObject.length; rc++) {
		rowObject = listObject[rc];
		r = createTiddlyElement(tbody,"tr");
		for(c=0; c<listTemplate.rowClasses.length; c++) {
			if(rowObject[listTemplate.rowClasses[c].field])
				addClass(r,listTemplate.rowClasses[c].className);
		}
		rowObject.rowElement = r;
		rowObject.colElements = {};
		for(var cc=0; cc<listTemplate.columns.length; cc++) {
			c = createTiddlyElement(r,"td");
			columnTemplate = listTemplate.columns[cc];
			var field = columnTemplate.field;
			colType = ListView.columnTypes[columnTemplate.type];
			if(colType && colType.createItem)
				colType.createItem(c,rowObject,field,columnTemplate,cc,rc);
			rowObject.colElements[field] = c;
		}
	}
	if(callback && listTemplate.actions)
		createTiddlyDropDown(place,ListView.getCommandHandler(callback),listTemplate.actions);
	if(callback && listTemplate.buttons) {
		for(t=0; t<listTemplate.buttons.length; t++) {
			var a = listTemplate.buttons[t];
			if(a && a.name != "")
				createTiddlyButton(place,a.caption,null,ListView.getCommandHandler(callback,a.name,a.allowEmptySelection));
		}
	}
	return table;
};

ListView.getCommandHandler = function(callback,name,allowEmptySelection)
{
	return function(e) {
		var view = findRelated(this,"TABLE",null,"previousSibling");
		var tiddlers = [];
		ListView.forEachSelector(view,function(e,rowName) {
					if(e.checked)
						tiddlers.push(rowName);
					});
		if(tiddlers.length == 0 && !allowEmptySelection) {
			alert(config.messages.nothingSelected);
		} else {
			if(this.nodeName.toLowerCase() == "select") {
				callback(view,this.value,tiddlers);
				this.selectedIndex = 0;
			} else {
				callback(view,name,tiddlers);
			}
		}
	};
};

// Invoke a callback for each selector checkbox in the listview
ListView.forEachSelector = function(view,callback)
{
	var checkboxes = view.getElementsByTagName("input");
	var hadOne = false;
	for(var t=0; t<checkboxes.length; t++) {
		var cb = checkboxes[t];
		if(cb.getAttribute("type") == "checkbox") {
			var rn = cb.getAttribute("rowName");
			if(rn) {
				callback(cb,rn);
				hadOne = true;
			}
		}
	}
	return hadOne;
};

ListView.getSelectedRows = function(view)
{
	var rowNames = [];
	ListView.forEachSelector(view,function(e,rowName) {
				if(e.checked)
					rowNames.push(rowName);
				});
	return rowNames;
};

ListView.columnTypes = {};

ListView.columnTypes.String = {
	createHeader: function(place,columnTemplate,col)
		{
			createTiddlyText(place,columnTemplate.title);
		},
	createItem: function(place,listObject,field,columnTemplate,col,row)
		{
			var v = listObject[field];
			if(v != undefined)
				createTiddlyText(place,v);
		}
};

ListView.columnTypes.WikiText = {
	createHeader: ListView.columnTypes.String.createHeader,
	createItem: function(place,listObject,field,columnTemplate,col,row)
		{
			var v = listObject[field];
			if(v != undefined)
				wikify(v,place,null,null);
		}
};

ListView.columnTypes.Tiddler = {
	createHeader: ListView.columnTypes.String.createHeader,
	createItem: function(place,listObject,field,columnTemplate,col,row)
		{
			var v = listObject[field];
			if(v != undefined && v.title)
				createTiddlyPopup(place,v.title,config.messages.listView.tiddlerTooltip,v);
		}
};

ListView.columnTypes.Size = {
	createHeader: ListView.columnTypes.String.createHeader,
	createItem: function(place,listObject,field,columnTemplate,col,row)
		{
			var v = listObject[field];
			if(v != undefined) {
				var t = 0;
				while(t<config.messages.sizeTemplates.length-1 && v<config.messages.sizeTemplates[t].unit)
					t++;
				createTiddlyText(place,config.messages.sizeTemplates[t].template.format([Math.round(v/config.messages.sizeTemplates[t].unit)]));
			}
		}
};

ListView.columnTypes.Link = {
	createHeader: ListView.columnTypes.String.createHeader,
	createItem: function(place,listObject,field,columnTemplate,col,row)
		{
			var v = listObject[field];
			var c = columnTemplate.text;
			if(v != undefined)
				createTiddlyText(createExternalLink(place,v),c ? c : v);
		}
};

ListView.columnTypes.Date = {
	createHeader: ListView.columnTypes.String.createHeader,
	createItem: function(place,listObject,field,columnTemplate,col,row)
		{
			var v = listObject[field];
			if(v != undefined)
				createTiddlyText(place,v.formatString(columnTemplate.dateFormat));
		}
};

ListView.columnTypes.StringList = {
	createHeader: ListView.columnTypes.String.createHeader,
	createItem: function(place,listObject,field,columnTemplate,col,row)
		{
			var v = listObject[field];
			if(v != undefined) {
				for(var t=0; t<v.length; t++) {
					createTiddlyText(place,v[t]);
					createTiddlyElement(place,"br");
				}
			}
		}
};

ListView.columnTypes.Selector = {
	createHeader: function(place,columnTemplate,col)
		{
			createTiddlyCheckbox(place,null,false,this.onHeaderChange);
		},
	createItem: function(place,listObject,field,columnTemplate,col,row)
		{
			var e = createTiddlyCheckbox(place,null,listObject[field],null);
			e.setAttribute("rowName",listObject[columnTemplate.rowName]);
		},
	onHeaderChange: function(e)
		{
			var state = this.checked;
			var view = findRelated(this,"TABLE");
			if(!view)
				return;
			ListView.forEachSelector(view,function(e,rowName) {
								e.checked = state;
							});
		}
};

ListView.columnTypes.Tags = {
	createHeader: ListView.columnTypes.String.createHeader,
	createItem: function(place,listObject,field,columnTemplate,col,row)
		{
			var tags = listObject[field];
			createTiddlyText(place,String.encodeTiddlyLinkList(tags));
		}
};

ListView.columnTypes.Boolean = {
	createHeader: ListView.columnTypes.String.createHeader,
	createItem: function(place,listObject,field,columnTemplate,col,row)
		{
			if(listObject[field] == true)
				createTiddlyText(place,columnTemplate.trueText);
			if(listObject[field] == false)
				createTiddlyText(place,columnTemplate.falseText);
		}
};

ListView.columnTypes.TagCheckbox = {
	createHeader: ListView.columnTypes.String.createHeader,
	createItem: function(place,listObject,field,columnTemplate,col,row)
		{
			var e = createTiddlyCheckbox(place,null,listObject[field],this.onChange);
			e.setAttribute("tiddler",listObject.title);
			e.setAttribute("tag",columnTemplate.tag);
		},
	onChange : function(e)
		{
			var tag = this.getAttribute("tag");
			var tiddler = this.getAttribute("tiddler");
			store.setTiddlerTag(tiddler,this.checked,tag);
		}
};

ListView.columnTypes.TiddlerLink = {
	createHeader: ListView.columnTypes.String.createHeader,
	createItem: function(place,listObject,field,columnTemplate,col,row)
		{
			var v = listObject[field];
			if(v != undefined) {
				var link = createTiddlyLink(place,listObject[columnTemplate.tiddlerLink],false,null);
				createTiddlyText(link,listObject[field]);
			}
		}
};

//--
//-- Augmented methods for the JavaScript Number(), Array(), String() and Date() objects
//--

// Clamp a number to a range
Number.prototype.clamp = function(min,max)
{
	var c = this;
	if(c < min)
		c = min;
	if(c > max)
		c = max;
	return c;
};

// Add indexOf function if browser does not support it
if(!Array.indexOf) {
Array.prototype.indexOf = function(item,from)
{
	if(!from)
		from = 0;
	for(var i=from; i<this.length; i++) {
		if(this[i] === item)
			return i;
	}
	return -1;
};}

// Find an entry in a given field of the members of an array
Array.prototype.findByField = function(field,value)
{
	for(var t=0; t<this.length; t++) {
		if(this[t][field] == value)
			return t;
	}
	return null;
};

// Return whether an entry exists in an array
Array.prototype.contains = function(item)
{
	return this.indexOf(item) != -1;
};

// Adds, removes or toggles a particular value within an array
//  value - value to add
//  mode - +1 to add value, -1 to remove value, 0 to toggle it
Array.prototype.setItem = function(value,mode)
{
	var p = this.indexOf(value);
	if(mode == 0)
		mode = (p == -1) ? +1 : -1;
	if(mode == +1) {
		if(p == -1)
			this.push(value);
	} else if(mode == -1) {
		if(p != -1)
			this.splice(p,1);
	}
};

// Return whether one of a list of values exists in an array
Array.prototype.containsAny = function(items)
{
	for(var i=0; i<items.length; i++) {
		if (this.indexOf(items[i]) != -1)
			return true;
	}
	return false;
};

// Return whether all of a list of values exists in an array
Array.prototype.containsAll = function(items)
{
	for (var i = 0; i<items.length; i++) {
		if (this.indexOf(items[i]) == -1)
			return false;
	}
	return true;
};

// Push a new value into an array only if it is not already present in the array. If the optional unique parameter is false, it reverts to a normal push
Array.prototype.pushUnique = function(item,unique)
{
	if(unique === false) {
		this.push(item);
	} else {
		if(this.indexOf(item) == -1)
			this.push(item);
	}
};

Array.prototype.remove = function(item)
{
	var p = this.indexOf(item);
	if(p != -1)
		this.splice(p,1);
};

if(!Array.prototype.map){
Array.prototype.map = function(fn, thisObj) {
    var scope = thisObj || window;
    var a = [];
    for ( var i=0, j=this.length; i < j; ++i ) {
        a.push(fn.call(scope, this[i], i, this));
    }
    return a;
};}// Get characters from the right end of a string
String.prototype.right = function(n)
{
	return n < this.length ? this.slice(this.length-n) : this;
};

// Trim whitespace from both ends of a string
String.prototype.trim = function()
{
	return this.replace(/^\s*|\s*$/g,"");
};

// Convert a string from a CSS style property name to a JavaScript style name ("background-color" -> "backgroundColor")
String.prototype.unDash = function()
{
	var s = this.split("-");
	if(s.length > 1) {
		for(var t=1; t<s.length; t++)
			s[t] = s[t].substr(0,1).toUpperCase() + s[t].substr(1);
	}
	return s.join("");
};

// Substitute substrings from an array into a format string that includes '%1'-type specifiers
String.prototype.format = function(substrings)
{
	var subRegExp = /(?:%(\d+))/mg;
	var currPos = 0;
	var r = [];
	do {
		var match = subRegExp.exec(this);
		if(match && match[1]) {
			if(match.index > currPos)
				r.push(this.substring(currPos,match.index));
			r.push(substrings[parseInt(match[1])]);
			currPos = subRegExp.lastIndex;
		}
	} while(match);
	if(currPos < this.length)
		r.push(this.substring(currPos,this.length));
	return r.join("");
};

// Escape any special RegExp characters with that character preceded by a backslash
String.prototype.escapeRegExp = function()
{
	var s = "\\^$*+?()=!|,{}[].";
	var c = this;
	for(var t=0; t<s.length; t++)
		c = c.replace(new RegExp("\\" + s.substr(t,1),"g"),"\\" + s.substr(t,1));
	return c;
};

// Convert "\" to "\s", newlines to "\n" (and remove carriage returns)
String.prototype.escapeLineBreaks = function()
{
	return this.replace(/\\/mg,"\\s").replace(/\n/mg,"\\n").replace(/\r/mg,"");
};

// Convert "\n" to newlines, "\b" to " ", "\s" to "\" (and remove carriage returns)
String.prototype.unescapeLineBreaks = function()
{
	return this.replace(/\\n/mg,"\n").replace(/\\b/mg," ").replace(/\\s/mg,"\\").replace(/\r/mg,"");
};

// Convert & to "&amp;", < to "&lt;", > to "&gt;" and " to "&quot;"
String.prototype.htmlEncode = function()
{
	return this.replace(/&/mg,"&amp;").replace(/</mg,"&lt;").replace(/>/mg,"&gt;").replace(/\"/mg,"&quot;");
};

// Convert "&amp;" to &, "&lt;" to <, "&gt;" to > and "&quot;" to "
String.prototype.htmlDecode = function()
{
	return this.replace(/&lt;/mg,"<").replace(/&gt;/mg,">").replace(/&quot;/mg,"\"").replace(/&amp;/mg,"&");
};

// Convert a string to it's JSON representation by encoding control characters, double quotes and backslash. See json.org
String.prototype.toJSONString = function()
{
	var m = {
		'\b': '\\b',
		'\f': '\\f',
		'\n': '\\n',
		'\r': '\\r',
		'\t': '\\t',
		'"' : '\\"',
		'\\': '\\\\'
		};
	var replaceFn = function(a,b) {
		var c = m[b];
		if(c)
			return c;
		c = b.charCodeAt();
		return '\\u00' + Math.floor(c / 16).toString(16) + (c % 16).toString(16);
		};
	if(/["\\\x00-\x1f]/.test(this))
		return '"' + this.replace(/([\x00-\x1f\\"])/g,replaceFn) + '"';
	return '"' + this + '"';
};

// Parse a space-separated string of name:value parameters
// The result is an array of objects:
//   result[0] = object with a member for each parameter name, value of that member being an array of values
//   result[1..n] = one object for each parameter, with 'name' and 'value' members
String.prototype.parseParams = function(defaultName,defaultValue,allowEval,noNames,cascadeDefaults)
{
	var parseToken = function(match,p) {
		var n;
		if(match[p]) // Double quoted
			n = match[p];
		else if(match[p+1]) // Single quoted
			n = match[p+1];
		else if(match[p+2]) // Double-square-bracket quoted
			n = match[p+2];
		else if(match[p+3]) // Double-brace quoted
			try {
				n = match[p+3];
				if(allowEval)
					n = window.eval(n);
			} catch(ex) {
				throw "Unable to evaluate {{" + match[p+3] + "}}: " + exceptionText(ex);
			}
		else if(match[p+4]) // Unquoted
			n = match[p+4];
		else if(match[p+5]) // empty quote
			n = "";
		return n;
	};
	var r = [{}];
	var dblQuote = "(?:\"((?:(?:\\\\\")|[^\"])+)\")";
	var sngQuote = "(?:'((?:(?:\\\\\')|[^'])+)')";
	var dblSquare = "(?:\\[\\[((?:\\s|\\S)*?)\\]\\])";
	var dblBrace = "(?:\\{\\{((?:\\s|\\S)*?)\\}\\})";
	var unQuoted = noNames ? "([^\"'\\s]\\S*)" : "([^\"':\\s][^\\s:]*)";
	var emptyQuote = "((?:\"\")|(?:''))";
	var skipSpace = "(?:\\s*)";
	var token = "(?:" + dblQuote + "|" + sngQuote + "|" + dblSquare + "|" + dblBrace + "|" + unQuoted + "|" + emptyQuote + ")";
	var re = noNames ? new RegExp(token,"mg") : new RegExp(skipSpace + token + skipSpace + "(?:(\\:)" + skipSpace + token + ")?","mg");
	var params = [];
	do {
		var match = re.exec(this);
		if(match) {
			var n = parseToken(match,1);
			if(noNames) {
				r.push({name:"",value:n});
			} else {
				var v = parseToken(match,8);
				if(v == null && defaultName) {
					v = n;
					n = defaultName;
				} else if(v == null && defaultValue) {
					v = defaultValue;
				}
				r.push({name:n,value:v});
				if(cascadeDefaults) {
					defaultName = n;
					defaultValue = v;
				}
			}
		}
	} while(match);
	// Summarise parameters into first element
	for(var t=1; t<r.length; t++) {
		if(r[0][r[t].name])
			r[0][r[t].name].push(r[t].value);
		else
			r[0][r[t].name] = [r[t].value];
	}
	return r;
};

// Process a string list of macro parameters into an array. Parameters can be quoted with "", '',
// [[]], {{ }} or left unquoted (and therefore space-separated). Double-braces {{}} results in
// an *evaluated* parameter: e.g. {{config.options.txtUserName}} results in the current user's name.
String.prototype.readMacroParams = function()
{
	var p = this.parseParams("list",null,true,true);
	var n = [];
	for(var t=1; t<p.length; t++)
		n.push(p[t].value);
	return n;
};

// Process a string list of unique tiddler names into an array. Tiddler names that have spaces in them must be [[bracketed]]
String.prototype.readBracketedList = function(unique)
{
	var p = this.parseParams("list",null,false,true);
	var n = [];
	for(var t=1; t<p.length; t++) {
		if(p[t].value)
			n.pushUnique(p[t].value,unique);
	}
	return n;
};

// Returns array with start and end index of chunk between given start and end marker, or undefined.
String.prototype.getChunkRange = function(start,end)
{
	var s = this.indexOf(start);
	if(s != -1) {
		s += start.length;
		var e = this.indexOf(end,s);
		if(e != -1)
			return [s,e];
	}
};

// Replace a chunk of a string given start and end markers
String.prototype.replaceChunk = function(start,end,sub)
{
	var r = this.getChunkRange(start,end);
	return r ? this.substring(0,r[0]) + sub + this.substring(r[1]) : this;
};

// Returns a chunk of a string between start and end markers, or undefined
String.prototype.getChunk = function(start,end)
{
	var r = this.getChunkRange(start,end);
	if(r)
		return this.substring(r[0],r[1]);
};


// Static method to bracket a string with double square brackets if it contains a space
String.encodeTiddlyLink = function(title)
{
	return title.indexOf(" ") == -1 ? title : "[[" + title + "]]";
};

// Static method to encodeTiddlyLink for every item in an array and join them with spaces
String.encodeTiddlyLinkList = function(list)
{
	if(list) {
		var results = [];
		for(var t=0; t<list.length; t++)
			results.push(String.encodeTiddlyLink(list[t]));
		return results.join(" ");
	} else {
		return "";
	}
};

// Convert a string as a sequence of name:"value" pairs into a hashmap
String.prototype.decodeHashMap = function()
{
	var fields = this.parseParams("anon","",false);
	var r = {};
	for(var t=1; t<fields.length; t++)
		r[fields[t].name] = fields[t].value;
	return r;
};

// Static method to encode a hashmap into a name:"value"... string
String.encodeHashMap = function(hashmap)
{
	var r = [];
	for(var t in hashmap)
		r.push(t + ':"' + hashmap[t] + '"');
	return r.join(" ");
};

// Static method to left-pad a string with 0s to a certain width
String.zeroPad = function(n,d)
{
	var s = n.toString();
	if(s.length < d)
		s = "000000000000000000000000000".substr(0,d-s.length) + s;
	return s;
};

String.prototype.startsWith = function(prefix)
{
	return !prefix || this.substring(0,prefix.length) == prefix;
};

// Returns the first value of the given named parameter.
function getParam(params,name,defaultValue)
{
	if(!params)
		return defaultValue;
	var p = params[0][name];
	return p ? p[0] : defaultValue;
}

// Returns the first value of the given boolean named parameter.
function getFlag(params,name,defaultValue)
{
	return !!getParam(params,name,defaultValue);
}

// Substitute date components into a string
Date.prototype.formatString = function(template)
{
	var t = template.replace(/0hh12/g,String.zeroPad(this.getHours12(),2));
	t = t.replace(/hh12/g,this.getHours12());
	t = t.replace(/0hh/g,String.zeroPad(this.getHours(),2));
	t = t.replace(/hh/g,this.getHours());
	t = t.replace(/mmm/g,config.messages.dates.shortMonths[this.getMonth()]);
	t = t.replace(/0mm/g,String.zeroPad(this.getMinutes(),2));
	t = t.replace(/mm/g,this.getMinutes());
	t = t.replace(/0ss/g,String.zeroPad(this.getSeconds(),2));
	t = t.replace(/ss/g,this.getSeconds());
	t = t.replace(/[ap]m/g,this.getAmPm().toLowerCase());
	t = t.replace(/[AP]M/g,this.getAmPm().toUpperCase());
	t = t.replace(/wYYYY/g,this.getYearForWeekNo());
	t = t.replace(/wYY/g,String.zeroPad(this.getYearForWeekNo()-2000,2));
	t = t.replace(/YYYY/g,this.getFullYear());
	t = t.replace(/YY/g,String.zeroPad(this.getFullYear()-2000,2));
	t = t.replace(/MMM/g,config.messages.dates.months[this.getMonth()]);
	t = t.replace(/0MM/g,String.zeroPad(this.getMonth()+1,2));
	t = t.replace(/MM/g,this.getMonth()+1);
	t = t.replace(/0WW/g,String.zeroPad(this.getWeek(),2));
	t = t.replace(/WW/g,this.getWeek());
	t = t.replace(/DDD/g,config.messages.dates.days[this.getDay()]);
	t = t.replace(/ddd/g,config.messages.dates.shortDays[this.getDay()]);
	t = t.replace(/0DD/g,String.zeroPad(this.getDate(),2));
	t = t.replace(/DDth/g,this.getDate()+this.daySuffix());
	t = t.replace(/DD/g,this.getDate());
	return t;
};

Date.prototype.getWeek = function()
{
	var dt = new Date(this.getTime());
	var d = dt.getDay();
	if (d==0) d=7;// JavaScript Sun=0, ISO Sun=7
	dt.setTime(dt.getTime()+(4-d)*86400000);// shift day to Thurs of same week to calculate weekNo
	var n = Math.floor((dt.getTime()-new Date(dt.getFullYear(),0,1)+3600000)/86400000);
	return Math.floor(n/7)+1;
};

Date.prototype.getYearForWeekNo = function()
{
	var dt = new Date(this.getTime());
	var d = dt.getDay();
	if (d==0) d=7;// JavaScript Sun=0, ISO Sun=7
	dt.setTime(dt.getTime()+(4-d)*86400000);// shift day to Thurs of same week
	return dt.getFullYear();
};

Date.prototype.getHours12 = function()
{
	var h = this.getHours();
	return h > 12 ? h-12 : ( h > 0 ? h : 12 );
};

Date.prototype.getAmPm = function()
{
	return this.getHours() >= 12 ? config.messages.dates.pm : config.messages.dates.am;
};

Date.prototype.daySuffix = function()
{
	return config.messages.dates.daySuffixes[this.getDate()-1];
};

// Convert a date to local YYYYMMDDHHMM string format
Date.prototype.convertToLocalYYYYMMDDHHMM = function()
{
	return String.zeroPad(this.getFullYear(),4) + String.zeroPad(this.getMonth()+1,2) + String.zeroPad(this.getDate(),2) + String.zeroPad(this.getHours(),2) + String.zeroPad(this.getMinutes(),2);
};

// Convert a date to UTC YYYYMMDDHHMM string format
Date.prototype.convertToYYYYMMDDHHMM = function()
{
	return String.zeroPad(this.getUTCFullYear(),4) + String.zeroPad(this.getUTCMonth()+1,2) + String.zeroPad(this.getUTCDate(),2) + String.zeroPad(this.getUTCHours(),2) + String.zeroPad(this.getUTCMinutes(),2);
};

// Convert a date to UTC YYYYMMDD.HHMMSSMMM string format
Date.prototype.convertToYYYYMMDDHHMMSSMMM = function()
{
	return String.zeroPad(this.getUTCFullYear(),4) + String.zeroPad(this.getUTCMonth()+1,2) + String.zeroPad(this.getUTCDate(),2) + "." + String.zeroPad(this.getUTCHours(),2) + String.zeroPad(this.getUTCMinutes(),2) + String.zeroPad(this.getUTCSeconds(),2) + String.zeroPad(this.getUTCMilliseconds(),4);
};

// Static method to create a date from a UTC YYYYMMDDHHMM format string
Date.convertFromYYYYMMDDHHMM = function(d)
{
	return new Date(Date.UTC(parseInt(d.substr(0,4),10),
			parseInt(d.substr(4,2),10)-1,
			parseInt(d.substr(6,2),10),
			parseInt(d.substr(8,2),10),
			parseInt(d.substr(10,2),10),0,0));
};

//--
//-- RGB colour object
//--

// Construct an RGB colour object from a '#rrggbb', '#rgb' or 'rgb(n,n,n)' string or from separate r,g,b values
function RGB(r,g,b)
{
	this.r = 0;
	this.g = 0;
	this.b = 0;
	if(typeof r == "string") {
		if(r.substr(0,1) == "#") {
			if(r.length == 7) {
				this.r = parseInt(r.substr(1,2),16)/255;
				this.g = parseInt(r.substr(3,2),16)/255;
				this.b = parseInt(r.substr(5,2),16)/255;
			} else {
				this.r = parseInt(r.substr(1,1),16)/15;
				this.g = parseInt(r.substr(2,1),16)/15;
				this.b = parseInt(r.substr(3,1),16)/15;
			}
		} else {
			var rgbPattern = /rgb\s*\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*\)/;
			var c = r.match(rgbPattern);
			if(c) {
				this.r = parseInt(c[1],10)/255;
				this.g = parseInt(c[2],10)/255;
				this.b = parseInt(c[3],10)/255;
			}
		}
	} else {
		this.r = r;
		this.g = g;
		this.b = b;
	}
	return this;
}

// Mixes this colour with another in a specified proportion
// c = other colour to mix
// f = 0..1 where 0 is this colour and 1 is the new colour
// Returns an RGB object
RGB.prototype.mix = function(c,f)
{
	return new RGB(this.r + (c.r-this.r) * f,this.g + (c.g-this.g) * f,this.b + (c.b-this.b) * f);
};

// Return an rgb colour as a #rrggbb format hex string
RGB.prototype.toString = function()
{
	return "#" + ("0" + Math.floor(this.r.clamp(0,1) * 255).toString(16)).right(2) +
				 ("0" + Math.floor(this.g.clamp(0,1) * 255).toString(16)).right(2) +
				 ("0" + Math.floor(this.b.clamp(0,1) * 255).toString(16)).right(2);
};

//--
//-- DOM utilities - many derived from www.quirksmode.org
//--

function drawGradient(place,horiz,colours)
{
	for(var t=0; t<= 100; t+=2) {
		var bar = document.createElement("div");
		place.appendChild(bar);
		bar.style.position = "absolute";
		bar.style.left = horiz ? t + "%" : 0;
		bar.style.top = horiz ? 0 : t + "%";
		bar.style.width = horiz ? (101-t) + "%" : "100%";
		bar.style.height = horiz ? "100%" : (101-t) + "%";
		bar.style.zIndex = -1;
		var f = t/100;
		var p = f*(colours.length-1);
		bar.style.backgroundColor = colours[Math.floor(p)].mix(colours[Math.ceil(p)],p-Math.floor(p)).toString();
	}
}

function createTiddlyText(theParent,theText)
{
	return theParent.appendChild(document.createTextNode(theText));
}

function createTiddlyCheckbox(theParent,caption,checked,onChange)
{
	var cb = document.createElement("input");
	cb.setAttribute("type","checkbox");
	cb.onclick = onChange;
	theParent.appendChild(cb);
	cb.checked = checked;
	cb.className = "chkOptionInput";
	if(caption)
		wikify(caption,theParent);
	return cb;
}

function createTiddlyElement(theParent,theElement,theID,theClass,theText,attribs)
{
	var e = document.createElement(theElement);
	if(theClass != null)
		e.className = theClass;
	if(theID != null)
		e.setAttribute("id",theID);
	if(theText != null)
		e.appendChild(document.createTextNode(theText));
	if(attribs){
		for(var n in attribs){
			e.setAttribute(n,attribs[n]);
		}
	}
	if(theParent != null)
		theParent.appendChild(e);
	return e;
}

function addEvent(obj,type,fn)
{
	if(obj.attachEvent) {
		obj['e'+type+fn] = fn;
		obj[type+fn] = function(){obj['e'+type+fn](window.event);};
		obj.attachEvent('on'+type,obj[type+fn]);
	} else {
		obj.addEventListener(type,fn,false);
	}
}

function removeEvent(obj,type,fn)
{
	if(obj.detachEvent) {
		obj.detachEvent('on'+type,obj[type+fn]);
		obj[type+fn] = null;
	} else {
		obj.removeEventListener(type,fn,false);
	}
}

function addClass(e,theClass)
{
	var currClass = e.className.split(" ");
	if(currClass.indexOf(theClass) == -1)
		e.className += " " + theClass;
}

function removeClass(e,theClass)
{
	var currClass = e.className.split(" ");
	var i = currClass.indexOf(theClass);
	while(i != -1) {
		currClass.splice(i,1);
		i = currClass.indexOf(theClass);
	}
	e.className = currClass.join(" ");
}

function hasClass(e,theClass)
{
	if(e.className) {
		if(e.className.split(" ").indexOf(theClass) != -1)
			return true;
	}
	return false;
}

// Find the closest relative with a given property value (property defaults to tagName, relative defaults to parentNode)
function findRelated(e,value,name,relative)
{
	name = name ? name : "tagName";
	relative = relative ? relative : "parentNode";
	if(name == "className") {
		while(e && !hasClass(e,value)) {
			e = e[relative];
		}
	} else {
		while(e && e[name] != value) {
			e = e[relative];
		}
	}
	return e;
}

// Resolve the target object of an event
function resolveTarget(e)
{
	var obj;
	if(e.target)
		obj = e.target;
	else if(e.srcElement)
		obj = e.srcElement;
	if(obj.nodeType == 3) // defeat Safari bug
		obj = obj.parentNode;
	return obj;
}

// Prevent an event from bubbling
function stopEvent(e){
	var ev = e? e : window.event;
	ev.cancelBubble = true;
	if (ev.stopPropagation) ev.stopPropagation();
	return false;	
}

// Return the content of an element as plain text with no formatting
function getPlainText(e)
{
	var text = "";
	if(e.innerText)
		text = e.innerText;
	else if(e.textContent)
		text = e.textContent;
	return text;
}

// Get the scroll position for window.scrollTo necessary to scroll a given element into view
function ensureVisible(e)
{
	var posTop = findPosY(e);
	var posBot = posTop + e.offsetHeight;
	var winTop = findScrollY();
	var winHeight = findWindowHeight();
	var winBot = winTop + winHeight;
	if(posTop < winTop) {
		return posTop;
	} else if(posBot > winBot) {
		if(e.offsetHeight < winHeight)
			return posTop - (winHeight - e.offsetHeight);
		else
			return posTop;
	} else {
		return winTop;
	}
}

// Get the current width of the display window
function findWindowWidth()
{
	return window.innerWidth ? window.innerWidth : document.documentElement.clientWidth;
}

// Get the current height of the display window
function findWindowHeight()
{
	return window.innerHeight ? window.innerHeight : document.documentElement.clientHeight;
}

// Get the current horizontal page scroll position
function findScrollX()
{
	return window.scrollX ? window.scrollX : document.documentElement.scrollLeft;
}

// Get the current vertical page scroll position
function findScrollY()
{
	return window.scrollY ? window.scrollY : document.documentElement.scrollTop;
}

function findPosX(obj)
{
	var curleft = 0;
	while(obj.offsetParent) {
		curleft += obj.offsetLeft;
		obj = obj.offsetParent;
	}
	return curleft;
}

function findPosY(obj)
{
	var curtop = 0;
	while(obj.offsetParent) {
		curtop += obj.offsetTop;
		obj = obj.offsetParent;
	}
	return curtop;
}

// Blur a particular element
function blurElement(e)
{
	if(e != null && e.focus && e.blur) {
		e.focus();
		e.blur();
	}
}

// Create a non-breaking space
function insertSpacer(place)
{
	var e = document.createTextNode(String.fromCharCode(160));
	if(place)
		place.appendChild(e);
	return e;
}

// Remove all children of a node
function removeChildren(e)
{
	while(e && e.hasChildNodes())
		removeNode(e.firstChild);
}

// Remove a node and all it's children
function removeNode(e)
{
	scrubNode(e);
	e.parentNode.removeChild(e);
}

// Remove any event handlers or non-primitve custom attributes
function scrubNode(e)
{
	if(!config.browser.isIE)
		return;
	var att = e.attributes;
	if(att) {
		for(var t=0; t<att.length; t++) {
			var n = att[t].name;
			if(n !== 'style' && (typeof e[n] === 'function' || (typeof e[n] === 'object' && e[n] != null))) {
				try {
					e[n] = null;
				} catch(ex) {
				}
			}
		}
	}
	var c = e.firstChild;
	while(c) {
		scrubNode(c);
		c = c.nextSibling;
	}
}

// Add a stylesheet, replacing any previous custom stylesheet
function setStylesheet(s,id,doc)
{
	if(!id)
		id = "customStyleSheet";
	if(!doc)
		doc = document;
	var n = doc.getElementById(id);
	if(doc.createStyleSheet) {
		// Test for IE's non-standard createStyleSheet method
		if(n)
			n.parentNode.removeChild(n);
		// This failed without the &nbsp;
		doc.getElementsByTagName("head")[0].insertAdjacentHTML("beforeEnd","&nbsp;<style id='" + id + "'>" + s + "</style>");
	} else {
		if(n) {
			n.replaceChild(doc.createTextNode(s),n.firstChild);
		} else {
			n = doc.createElement("style");
			n.type = "text/css";
			n.id = id;
			n.appendChild(doc.createTextNode(s));
			doc.getElementsByTagName("head")[0].appendChild(n);
		}
	}
}

function removeStyleSheet(id)
{
	var e = document.getElementById(id);
	if(e)
		e.parentNode.removeChild(e);
}

// Force the browser to do a document reflow when needed to workaround browser bugs
function forceReflow()
{
	if(config.browser.isGecko) {
		setStylesheet("body {top:-1em;margin-top:1em;}");
		setStylesheet("");
	}
}

// Replace the current selection of a textarea or text input and scroll it into view
function replaceSelection(e,text)
{
	if(e.setSelectionRange) {
		var oldpos = e.selectionStart;
		var isRange = e.selectionEnd > e.selectionStart;
		e.value = e.value.substr(0,e.selectionStart) + text + e.value.substr(e.selectionEnd);
		e.setSelectionRange(isRange ? oldpos : oldpos + text.length,oldpos + text.length);
		var linecount = e.value.split('\n').length;
		var thisline = e.value.substr(0,e.selectionStart).split('\n').length-1;
		e.scrollTop = Math.floor((thisline - e.rows / 2) * e.scrollHeight / linecount);
	} else if(document.selection) {
		var range = document.selection.createRange();
		if(range.parentElement() == e) {
			var isCollapsed = range.text == "";
			range.text = text;
			if(!isCollapsed) {
				range.moveStart('character', -text.length);
				range.select();
			}
		}
	}
}

// Returns the text of the given (text) node, possibly merging subsequent text nodes
function getNodeText(e)
{
	var t = "";
	while(e && e.nodeName == "#text") {
		t += e.nodeValue;
		e = e.nextSibling;
	}
	return t;
}

//--
//-- LoaderBase and SaverBase
//--

function LoaderBase() {}

LoaderBase.prototype.loadTiddler = function(store,node,tiddlers)
{
	var title = this.getTitle(store,node);
	if(title) {
		var tiddler = store.createTiddler(title);
		this.internalizeTiddler(store,tiddler,title,node);
		tiddlers.push(tiddler);
	}
};

LoaderBase.prototype.loadTiddlers = function(store,nodes)
{
	var tiddlers = [];
	for(var t = 0; t < nodes.length; t++) {
		try {
			this.loadTiddler(store,nodes[t],tiddlers);
		} catch(ex) {
			showException(ex,config.messages.tiddlerLoadError.format([this.getTitle(store,nodes[t])]));
		}
	}
	return tiddlers;
};

function SaverBase() {}

SaverBase.prototype.externalize = function(store)
{
	var results = [];
	var tiddlers = store.getTiddlers("title");
	for(var t = 0; t < tiddlers.length; t++)
		results.push(this.externalizeTiddler(store,tiddlers[t]));
	return results.join("\n");
};

//--
//-- TW21Loader (inherits from LoaderBase)
//--

function TW21Loader() {}

TW21Loader.prototype = new LoaderBase();

TW21Loader.prototype.getTitle = function(store,node)
{
	var title = null;
	if(node.getAttribute) {
		title = node.getAttribute("title");
		if(!title)
			title = node.getAttribute("tiddler");
	}
	if(!title && node.id) {
		var lenPrefix = store.idPrefix.length;
		if (node.id.substr(0,lenPrefix) == store.idPrefix)
			title = node.id.substr(lenPrefix);
	}
	return title;
};

TW21Loader.prototype.internalizeTiddler = function(store,tiddler,title,node)
{
	var e = node.firstChild;
	var text = null;
	if(node.getAttribute("tiddler")) {
		text = getNodeText(e).unescapeLineBreaks();
	} else {
		while(e.nodeName!="PRE" && e.nodeName!="pre") {
			e = e.nextSibling;
		}
		text = e.innerHTML.replace(/\r/mg,"").htmlDecode();
	}
	var modifier = node.getAttribute("modifier");
	var c = node.getAttribute("created");
	var m = node.getAttribute("modified");
	var created = c ? Date.convertFromYYYYMMDDHHMM(c) : version.date;
	var modified = m ? Date.convertFromYYYYMMDDHHMM(m) : created;
	var tags = node.getAttribute("tags");
	var fields = {};
	var attrs = node.attributes;
	for(var i = attrs.length-1; i >= 0; i--) {
		var name = attrs[i].name;
		if (attrs[i].specified && !TiddlyWiki.isStandardField(name)) {
			fields[name] = attrs[i].value.unescapeLineBreaks();
		}
	}
	tiddler.assign(title,text,modifier,modified,tags,created,fields);
	return tiddler;
};

//--
//-- TW21Saver (inherits from SaverBase)
//--

function TW21Saver() {}

TW21Saver.prototype = new SaverBase();

TW21Saver.prototype.externalizeTiddler = function(store,tiddler)
{
	try {
		var extendedAttributes = "";
		var usePre = config.options.chkUsePreForStorage;
		store.forEachField(tiddler,
			function(tiddler,fieldName,value) {
				// don't store stuff from the temp namespace
				if(typeof value != "string")
					value = "";
				if (!fieldName.match(/^temp\./))
					extendedAttributes += ' %0="%1"'.format([fieldName,value.escapeLineBreaks().htmlEncode()]);
			},true);
		var created = tiddler.created.convertToYYYYMMDDHHMM();
		var modified = tiddler.modified.convertToYYYYMMDDHHMM();
		var vdate = version.date.convertToYYYYMMDDHHMM();
		var attributes = tiddler.modifier ? ' modifier="' + tiddler.modifier.htmlEncode() + '"' : "";
		attributes += (usePre && modified == created) ? "" : ' modified="' + modified +'"';
		attributes += (usePre && created == vdate) ? "" :' created="' + created + '"';
		var tags = tiddler.getTags();
		if(!usePre || tags)
			attributes += ' tags="' + tags.htmlEncode() + '"';
		return ('<div %0="%1"%2%3>%4</'+'div>').format([
				usePre ? "title" : "tiddler",
				tiddler.title.htmlEncode(),
				attributes,
				extendedAttributes,
				usePre ? "\n<pre>" + tiddler.text.htmlEncode() + "</pre>\n" : tiddler.text.escapeLineBreaks().htmlEncode()
			]);
	} catch (ex) {
		throw exceptionText(ex,config.messages.tiddlerSaveError.format([tiddler.title]));
	}
};

//--
//-- End of scripts
//--
//]]>
</script>
<script type="text/javascript">
//<![CDATA[
if(useJavaSaver)
	document.write("<applet style='position:absolute;left:-1px' name='TiddlySaver' code='TiddlySaver.class' archive='TiddlySaver.jar' width='1' height='1'></applet>");
//]]>
</script>
<!--POST-SCRIPT-START-->

<!--POST-SCRIPT-END-->
</body>
</html>
