<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../img/favicon.ico">
        <title>delegation of admin duties - Gitolite</title>
        <link href="../css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="../css/font-awesome-4.5.0.css" rel="stylesheet">
        <link href="../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="../css/highlight.css">
        <link href="../css/gitolite.css" rel="stylesheet">
        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
	
	<script src="../js/jquery-1.10.2.min.js"></script>
        <script src="../js/bootstrap-3.0.3.min.js"></script>
        <script src="../js/highlight.pack.js"></script> 
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="..">Gitolite</a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
                <!-- Main navigation -->
                <ul class="nav navbar-nav">
                    <li >
                        <a href="..">home</a>
                    </li>
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">what/why <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            
<li >
    <a href="../overview/">overview</a>
</li>
                            
<li >
    <a href="../concepts/">concepts, conventions, terminology</a>
</li>
                        </ul>
                    </li>
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">install and setup <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            
<li >
    <a href="../quick_install/">(unix/ssh experts) quick install and setup</a>
</li>
                            
<li >
    <a href="../install/">normal ssh mode install and setup</a>
</li>
                            
<li >
    <a href="../fool_proof_setup/">(if all else fails) fool-proof, step-by-step, install and setup</a>
</li>
                            
<li >
    <a href="../http/">HTTP mode install</a>
</li>
                            
<li >
    <a href="../migr/">migrating from v2</a>
</li>
                        </ul>
                    </li>
                    <li class="dropdown active">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">use <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            
  <li class="dropdown-submenu">
    <a href="#">basic</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../basic-admin/">basic administration</a>
</li>
            
<li >
    <a href="../conf/">the "conf" file (part 1)</a>
</li>
            
<li >
    <a href="../conf-2/">the "conf" file (part 2)</a>
</li>
            
<li >
    <a href="../rc/">the "rc" file</a>
</li>
            
<li >
    <a href="../user/">your users' view</a>
</li>
    </ul>
  </li>
                            
  <li class="dropdown-submenu">
    <a href="#">advanced</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../git-config/">setting git-config values</a>
</li>
            
<li >
    <a href="../options/">gitolite options</a>
</li>
            
<li >
    <a href="../wild/">ad hoc user-created ("wild") repos</a>
</li>
            
<li >
    <a href="../templates/">using templates</a>
</li>
            
<li >
    <a href="../vref/">virtual refs (part 1)</a>
</li>
            
<li >
    <a href="../vref-2/">virtual refs (part 2)</a>
</li>
            
<li class="active">
    <a href="./">delegation of admin duties</a>
</li>
            
<li >
    <a href="../gitweb-daemon/">gitweb and git-daemon</a>
</li>
            
<li >
    <a href="../mirroring/">mirroring</a>
</li>
    </ul>
  </li>
                            
  <li class="dropdown-submenu">
    <a href="#">customise</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../non-core/">core and "non-core" gitolite</a>
</li>
            
<li >
    <a href="../dev-notes/">writing your own non-core code</a>
</li>
            
<li >
    <a href="../triggers/">gitolite triggers</a>
</li>
            
<li >
    <a href="../list-non-core/">list of non-core programs shipped with gitolite</a>
</li>
    </ul>
  </li>
                            
<li >
    <a href="../cookbook/">(quick! how do I...) the cookbook</a>
</li>
                        </ul>
                    </li>
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">HELP! <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            
<li >
    <a href="../emergencies/">emergency!!</a>
</li>
                            
  <li class="dropdown-submenu">
    <a href="#">ssh</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../ssh/">ssh</a>
</li>
            
<li >
    <a href="../glssh/">how gitolite uses ssh</a>
</li>
            
<li >
    <a href="../sts/">ssh troubleshooting</a>
</li>
    </ul>
  </li>
                            
<li >
    <a href="../regex/">regular expressions</a>
</li>
                        </ul>
                    </li>
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">other docs <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            
<li >
    <a href="../odds-and-ends/">miscellaneous features</a>
</li>
                            
<li >
    <a href="../namespaces/">using git namespaces</a>
</li>
                            
<li >
    <a href="../locking/">locking binary files</a>
</li>
                            
<li >
    <a href="../testing/">testing gitolite</a>
</li>
                            
<li >
    <a href="../package/">packaging gitolite</a>
</li>
                            
  <li class="dropdown-submenu">
    <a href="#">more about gitolite</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../files/">gitolite files & directories</a>
</li>
            
<li >
    <a href="../rc-33/">the 3.3 format rc file</a>
</li>
            
<li >
    <a href="../perf/">performance</a>
</li>
            
<li >
    <a href="../internals/">internals</a>
</li>
    </ul>
  </li>
                            
  <li class="dropdown-submenu">
    <a href="#">contrib</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../contrib/ssh-and-http/">Using both ssh and http</a>
</li>
            
<li >
    <a href="../contrib/putty/">Putty and Msysgit</a>
</li>
            
<li >
    <a href="../contrib/sskm/">Self-service key management</a>
</li>
            
<li >
    <a href="../contrib/ukm/">User key management</a>
</li>
            
<li >
    <a href="../contrib/README-emacs/">Emacs major mode</a>
</li>
    </ul>
  </li>
                            
<li >
    <a href="../no-way/">no way!</a>
</li>
                        </ul>
                    </li>
                </ul>

            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                        <i class="fa fa-search"></i> Search
                    </a>
                </li>
                    <li >
                        <a rel="next" href="../vref-2/">
                            <i class="fa fa-arrow-left"></i> Previous
                        </a>
                    </li>
                    <li >
                        <a rel="prev" href="../gitweb-daemon/">
                            Next <i class="fa fa-arrow-right"></i>
                        </a>
                    </li>
            </ul>
        </div>
    </div>
</div>

        <div class="container">
                <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
        <li class="main active"><a href="#delegating-access-control-responsibilities">delegating access control responsibilities</a></li>
        <li class="main "><a href="#example">example</a></li>
        <li class="main "><a href="#the-subconf-command">the subconf command</a></li>
            <li><a href="#how-the-subconf-name-is-derived">how the "subconf name" is derived</a></li>
        <li class="main "><a href="#security-notes">security notes</a></li>
            <li><a href="#group-names">group names</a></li>
            <li><a href="#delegating-pubkeys">delegating pubkeys</a></li>
    </ul>
</div></div>
                <div class="col-md-9" role="main">

<h1 id="delegating-access-control-responsibilities">delegating access control responsibilities<a class="headerlink" href="#delegating-access-control-responsibilities" title="Permanent link"></a></h1>
<hr />
<p>Delegation allows you to divide up a large conf file into smaller groups of
repos (called <strong>subconf</strong>s) and hand over responsibility to manage them to
<strong>sub-admin</strong>s.  Gitolite can prevent one sub-admin from being able to set
access rules for any other sub-admin's repos.</p>
<p>Delegation is achieved by combining two gitolite features:
<a href="../deleg/#the-subconf-command">subconf</a> and the <a href="../vref-2/#restricting-pushes-by-dirfile-name">NAME VREF</a>.</p>
<h1 id="example">example<a class="headerlink" href="#example" title="Permanent link"></a></h1>
<p>Here's a sample conf that does delegation:</p>
<pre style="color: #ffffff; background-color: #000000;">
<span class="Identifier">@webbrowsers</span>        = firefox lynx <span class="Special">browsers/..*</span>
<span class="Identifier">@webservers</span>         = apache nginx <span class="Special">servers/..*</span>
<span class="Identifier">@malwares</span>           = conficker storm <span class="Special">ms/..*</span>
   <span class="Comment"> # side note: if anyone objects, we claim ms stands for &quot;metasploit&quot; ;-)</span>

<span class="Comment"># the admin repo access probably had these 2 lines to start with:</span>
<span class="Type">repo </span>gitolite-admin
<span class="Statement">    RW+</span><span class="Constant">                                     </span>= sitaram
<span class="Comment"># now add these lines to the config for the admin repo</span>
<span class="Statement">    RW</span><span class="Constant">                                      </span>= alice bob mallory
<span class="Statement">    RW</span><span class="Constant">  VREF/NAME/conf/subs/webbrowsers     </span>= alice
<span class="Statement">    RW</span><span class="Constant">  VREF/NAME/conf/subs/webservers      </span>= bob
<span class="Statement">    RW</span><span class="Constant">  VREF/NAME/conf/subs/malwares        </span>= mallory
<span class="Statement">    -</span><span class="Constant">   VREF/NAME/                          </span>=<span class="WarningMsg"> alice bob mallory</span>

<span class="Comment"># pull in these files using the &quot;subconf&quot; command</span>
<span class="PreProc">subconf </span><span class="Constant">&quot;subs/*.conf&quot;</span>
</pre>

<p>If you've read the <a href="../vref">VREF</a> part, or at least understood how <a href="../vref-2/#restricting-pushes-by-dirfile-name">NAME
VREF</a>s work, it should be clear that, in terms of changes to the
gitolite-admin repo:</p>
<ul>
<li>The user sitaram has no restrictions of any kind</li>
<li>Users alice, bob, and mallory can only touch files within their assigned
    areas within conf/subs.  If they try to change any other file (keydir,
    conf/gitolite.conf, or something in one of the other sub-admin's areas),
    then the last rule kicks in and the push gets rejected.</li>
</ul>
<p>Now all we need is to see what this "subconf" thing is all about.</p>
<h1 id="the-subconf-command">the subconf command<a class="headerlink" href="#the-subconf-command" title="Permanent link"></a></h1>
<p>Subconf is exactly like the include command in syntax:</p>
<pre style="color: #ffffff; background-color: #000000;">
<span class="PreProc">subconf </span><span class="Constant">&quot;foo.conf&quot;</span>
</pre>

<p>but while reading the included file (as well as anything included from it),
gitolite sets the "current subconf name" to "foo".</p>
<p>A "subconf" imposes some restrictions on what repos can be managed.</p>
<p>For example, while the subconf name is "foo", as in the above example,
gitolite will only process "repo" lines for:</p>
<ul>
<li>A repo called "foo".</li>
<li>A group called "@foo", as long as the group is defined in the main conf
    file (i.e., <em>outside</em> "foo.conf").</li>
<li>A member of a group called "@foo" (again, defined outside).</li>
<li>A repo that matches a member of a group called "@foo" if that member is a
    regular expression.</li>
</ul>
<p>Here's an example.  If the main conf file contains</p>
<pre style="color: #ffffff; background-color: #000000;">
<span class="Identifier">@foo</span>    =   aa bb <span class="Special">cc/..*</span>
</pre>

<p>then the subconf can only accept repo statements that refer to 'foo', '@foo',
'aa', 'bb', or any repo whose name starts with 'cc/'.</p>
<p><strong>Note</strong>: the subconf name "master" is special; it is the default subconf in
effect for the main conf file and has no restrictions.</p>
<h2 id="how-the-subconf-name-is-derived">how the "subconf name" is derived<a class="headerlink" href="#how-the-subconf-name-is-derived" title="Permanent link"></a></h2>
<p>For subconf lines that look just like include statements, i.e.,</p>
<pre style="color: #ffffff; background-color: #000000;">
<span class="PreProc">subconf </span><span class="Constant">&quot;foo/bar.conf&quot;</span>
<span class="PreProc">subconf </span><span class="Constant">&quot;frob/*.conf&quot;</span>
   <span class="Comment"> # assume frob has files aa.conf, bb.conf</span>
</pre>

<p>the subconf name as each file is being processed is the base name of the file.
This means it would be "bar" for the first line, "aa" when processing
"frob/aa.conf", and "bb" when processing "frob/bb.conf".</p>
<p>A variation of subconf exists that can explicitly state the subconf name:</p>
<pre style="color: #ffffff; background-color: #000000;">
<span class="PreProc">subconf </span>foo <span class="Constant">&quot;frob/*.conf&quot;</span>
</pre>

<p>In this variation, regardless of what file in "frob/" is being read, the
subconf name in effect is "foo".</p>
<h1 id="security-notes">security notes<a class="headerlink" href="#security-notes" title="Permanent link"></a></h1>
<h2 id="group-names">group names<a class="headerlink" href="#group-names" title="Permanent link"></a></h2>
<p>You can use "@group"s defined in the main config file but do not attempt to
redefine or extend them in your own subconf file.  If you must extend a group
(say <code>@foo</code>) defined in the main config file, do this:</p>
<pre style="color: #ffffff; background-color: #000000;">
<span class="Identifier">@myfoo</span>  =   <span class="Identifier">@foo</span>
<span class="Comment"># now do whatever you want with @myfoo</span>
</pre>

<p>Group names you define in your subconf will not clash even if the exact same
name is used in another subconf file, so you need not worry about that.</p>
<h2 id="delegating-pubkeys">delegating pubkeys<a class="headerlink" href="#delegating-pubkeys" title="Permanent link"></a></h2>
<p>Short answer: not gonna happen.</p>
<p>The delegation feature is meant only for access control rules, not pubkeys.
Adding/removing pubkeys is a much more significant event than changing branch
level permissions for people already on staff, and only the main admin should
be allowed to do it.</p>
<p>Gitolite's "userids" all live in the same namespace.  This is unlikely to
change, so please don't ask -- it gets real complicated to do otherwise.
Allowing sub-admins to add users means username collisions, which also means
security problems (admin-A creates a pubkey for Admin-B, thus gaining access
to all of Admin-B's stuff).</p>
<p>If you feel the need to delegate even that, please just go the whole hog and
give them separate gitolite instances (i.e., running on different servers, or
at least under different gitolite hosting users on the same server)!</p>
<!--

undocumented feature that I have "committed" to in the mailing list

*   https://groups.google.com/forum/#!topic/gitolite/Aks-P_L5Ca4

    group foo defined in subconf available in main as @foo.foo

    (question: does this apply to @foo.bar also?  I.e., group bar in subconf
    foo?)

--></div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>var base_url = '..';</script>
        <script data-main="../mkdocs/js/search.js" src="../mkdocs/js/require.js"></script>
        <script src="../js/base.js"></script><div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="exampleModalLabel">Search</h4>
            </div>
            <div class="modal-body">
                <p>
                    From here you can search these documents. Enter
                    your search terms below.
                </p>
                <form role="form">
                    <div class="form-group">
                        <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query">
                    </div>
                </form>
                <div id="mkdocs-search-results"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
