<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="pandoc" />
  <title>idiot-proof setup for gitolite</title>
  <style type="text/css">code{white-space: pre;}</style>
  <style>
      body        { background: #fff; text-color: #000; margin-left:  40px;   font-size:  0.9em;  font-family: arial; }
  
      code        { font-size:    1.1em;  background:  #ddf; text-color: #000; }
      pre         { margin-left:  2em;    background:  #ddf; text-color: #000; }
      pre code    { font-size:    1.1em;  background:  #ddf; text-color: #000; }
  
      td          { vertical-align: top }
  
      .red        { color: red }
      .blue       { color: blue }
      .green      { color: green }
      .gray       { color: gray }
      .pink       { color: pink }
  
      .box        { background-color:#e0e0e0 }
      .bg-red     { background-color:#ffe0e0 }
      .bg-green   { background-color:#e0ffe0 }
      .bg-blue    { background-color:#e0e0ff }
  
      /* couldn't resist the name! */
      .wd40       { width: 40% !important }
  
      .box-l      { float: left;  padding: 0px 0.5em; background-color: #e0e0e0; width:25%; margin-right: 4px; }
      .box-r      { float: right; padding: 0px 0.5em; background-color: #e0e0e0; width:25%; margin-left:  4px; }
  
      .fl-l       { float: left;  padding: 0px 0.5em;                                       margin-right: 4px; }
      .fl-r       { float: right; padding: 0px 0.5em;                                       margin-left:  4px; }
  
      .sidebar {
          margin-left: 4px;
          width: 25%;
          float: right;
          border: 4px solid #fff;
      }
  
  </style>
  <style>
      h1          { background: #ffb; text-color: #000; margin-left: -30px;   border-top:    5px  solid #ccc; }
      h2          { background: #ffb; text-color: #000; margin-left: -20px;   border-top:    3px  solid #ddd; }
      h3          { background: #ffb; text-color: #000; margin-left: -10px; }
      h4          { background: #ffb; text-color: #000; }
  </style>
</head>
<body>
<!--
    generated by gvim then munged a fair bit.  The following command
        vim -E -c "TOhtml" -c "w" -c 'qa!' \-\- conf/gitolite.conf
    may or may not produce the same thing
-->

<style type="text/css">
<!--
.WarningMsg { color: #ff0000; }
.Constant { color: #ffa0a0; }
.Statement { color: #ffff60; font-weight: bold; }
.PreProc { color: #ff80ff; }
.LineNr { color: #ffff00; }
.Comment { color: #80a0ff; }
.Type { color: #60ff60; font-weight: bold; }
.Special { color: #ffa500; }
.Identifier { color: #40ffff; }
.Error { color: #ffffff; background-color: #ff0000; padding-bottom: 1px; }
.Todo { color: #0000ff; background-color: #ffff00; padding-bottom: 1px; }
-->
</style>
<div id="header">
<h1 class="title">idiot-proof setup for gitolite</h1>
</div>
<div id="TOC">
<ul>
<li><a href="#pre-requisites-etc"><span class="toc-section-number">1</span> pre-requisites, etc</a></li>
<li><a href="#assumptions"><span class="toc-section-number">2</span> assumptions</a></li>
<li><a href="#installation-tasks"><span class="toc-section-number">3</span> installation tasks</a></li>
<li><a href="#administration-tasks"><span class="toc-section-number">4</span> administration tasks</a></li>
</ul>
</div>
<script type="text/javascript">
<!--
    function hide_show(id) {
        var e = document.getElementById(id);
        if(e == null)
            return;
        if(e.style.display != 'none')
            e.style.display = 'none';
        else
            e.style.display = 'block';
    }

    window.onload = function() {
        var t = document.getElementById('TOC');
        var sbt = document.getElementById('SBTOC');
        var h = '<div id="PTOC">'
        var h2 = '<p><strong><span class="red">Page TOC</span></strong></p>'
        var h3 = '</div>'
        var h4 = '<div id="GTOC">'
        var h5 = '</div>'
        var hst = '<div style="background: white; color: green; border: 2px solid green"><center><font size=-1><strong>Hide/Show Table of Contents</strong><br />'
        var pd = '<a href="#" onclick="hide_show(\'PTOC\');">Page TOC</a> | '
        var gt = '<a href="#" onclick="hide_show(\'GTOC\');">Gitolite TOC</a></font></center></div>'

        if(t == null)
            sbt.innerHTML = hst + gt + h4 + sbt.innerHTML + h5;
        else {
            sbt.innerHTML = hst + pd + gt + h + h2 + t.innerHTML + h3 + h4 + sbt.innerHTML + h5;
            t.style.display = 'none';   // hide the TOC that pandoc placed
        }
    }
-->
</script>

<style>
    #PTOC ul {
        list-style: none;
        margin-left: 0;
        padding-left: 2em;
        text-indent: -2em;
        padding-bottom: 2em;
    }
    #PTOC ul li {
        padding-bottom: 10px;
    }
    #PTOC ul li ul {
        padding-bottom: 0px;
    }
    #PTOC ul li ul li {
        padding-bottom: 0px;
    }

    .sidebar-toc a:hover {
        background-color: white;
    }

    .sidebar-toc {
        margin-left: 4px;
        width: 25%;
        float: right;
        color: gray;
        background: lightgray;
        border: 4px solid #fff;
        font-size: 0.90em;
    }

    .sidebar-toc ul {
        padding-left: 2em;
    }

</style>

<div id="SBTOC" class="sidebar-toc">

<p><strong><span class="red">Gitolite TOC</span></strong></p>
<hr />
<center>
<span class="red"><strong>Background</strong></span>
</center>

<hr />
<p><a href="index.html">Main page</a></p>
<ul>
<li><a href="index.html#dl">download</a></li>
<li><a href="index.html#rtfm">documentation</a>
<ul>
<li><a href="gitolite.html"><strong>all-in-one</strong></a> page</li>
</ul></li>
<li><a href="index.html#trouble"><strong>troubleshooting</strong></a></li>
<li><a href="index.html#contact"><strong>contact and support</strong></a></li>
<li><a href="index.html#license">license</a></li>
</ul>
<p><a href="overview.html">Overview</a></p>
<ul>
<li>what is Gitolite?</li>
<li>why might you need it?</li>
<li>how does it work?</li>
<li>who uses it?</li>
</ul>
<p><a href="concepts.html">Concepts, conventions, and terminology</a></p>
<ul>
<li>authentication and authorisation</li>
<li>ssh mode and http mode</li>
<li>the &quot;hosting user&quot;</li>
<li>the &quot;logical repo name&quot;</li>
<li>the special gitolite-admin repo</li>
</ul>
<p><a href="req.html">Before you start...</a></p>
<ul>
<li>your skills</li>
<li>your server</li>
<li>your and your users' clients</li>
<li><strong>cautions and caveats</strong></li>
<li><a href="req.html#trying">trying</a> out gitolite safely</li>
</ul>
<hr />
<center>
<span class="red"><strong>Basics</strong></span>
</center>

<hr />
<p><a href="install.html">install and setup</a></p>
<ul>
<li><a href="install.html#qi">quick install+setup</a> (for experts)</li>
<li>the long way around</li>
<li><a href="install.html#upgrading">upgrading</a></li>
<li><a href="install.html#moving">moving servers</a></li>
</ul>
<p><a href="basic-admin.html">Basic Administration</a></p>
<ul>
<li>clone the gitolite-admin repo</li>
<li>add/remove users</li>
<li>add/remove/rename repos</li>
<li>bringing existing repos into gitolite</li>
</ul>
<p><a href="conf.html">The conf file (<code>conf/gitolite.conf</code>)</a></p>
<ul>
<li>basic <a href="conf.html#syntax">syntax</a></li>
<li><a href="conf.html#include">include</a> files</li>
<li><a href="conf.html#groups">group definitions</a></li>
<li><a href="conf.html#rules"><strong><span class="red">access rules</span></strong></a></li>
</ul>
<p><a href="rc.html">the rc file (<code>~/.gitolite.rc</code>)</a></p>
<p><a href="user.html">Your users' view</a> of gitolite</p>
<p>Troubleshooting</p>
<ul>
<li>help for <a href="emergencies.html">emergencies</a></li>
<li>the <a href="ips.html">fool-proof install guide</a></li>
<li>the gitolite &quot;<a href="cookbook.html">cookbook</a>&quot;</li>
</ul>
<hr />
<center>
<span class="red"><strong>Advanced</strong></span>
</center>

<hr />
<p>Advanced &quot;conf file&quot; use</p>
<ul>
<li>specifying <a href="git-config.html">git-config</a> keys and values</li>
<li>gitolite <a href="options.html">options</a></li>
<li><a href="wild.html"><strong>wild repos</strong></a> (user created repos)</li>
<li><a href="vref.html">virtual refs</a></li>
<li><a href="deleg.html">delegation</a> of admin duties</li>
<li><a href="gitweb-daemon.html">gitweb and git-daemon</a></li>
</ul>
<p>Special features/setups</p>
<ul>
<li><strong><a href="mirroring.html">mirroring</a></strong></li>
<li><a href="http.html">http</a> mode</li>
<li>using a <a href="cache.html">cache</a></li>
<li>(<a href="namespaces.html">namespaces</a>)</li>
<li><a href="locking.html">locking</a> binary files</li>
<li><a href="package.html">packaging</a> gitolite</li>
</ul>
<p>Customising gitolite</p>
<ul>
<li>core and <a href="non-core.html">non-core</a> gitolite</li>
<li><a href="dev-notes.html">writing your own</a> non-core programs</li>
<li>gitolite <a href="triggers.html">triggers</a></li>
<li><a href="list-non-core.html">list of non-core programs</a> shipped with gitolite</li>
</ul>
<hr />
<center>
<span class="red"><strong>Extras</strong></span>
</center>

<hr />
<p><a href="odds-and-ends.html">Odds and Ends</a></p>
<ul>
<li><a href="odds-and-ends.html#writable">disabling pushes</a> to take backups</li>
<li><a href="odds-and-ends.html#elsewhere">putting 'repositories' and '.gitolite' elsewhere</a></li>
<li><a href="odds-and-ends.html#keysonly">using pubkeys obtained from elsewhere</a></li>
<li><a href="odds-and-ends.html#gh">giving users their own repos</a></li>
<li><a href="odds-and-ends.html#server-side-admin">administering gitolite directly on the server</a></li>
</ul>
<p>Additional information/discussion</p>
<ul>
<li><a href="ssh.html">all about ssh and gitolite</a></li>
<li>Running the <a href="testing.html">test suite</a></li>
<li><a href="files.html">gitolite files and directories</a></li>
<li><a href="perf.html">gitolite performance</a></li>
<li><a href="migr.html">Migration</a></li>
<li><a href="http://sitaramc.github.com/gitolite/g2/master-toc.html">documentation for gitolite v2</a></li>
<li><a href="regex.html">regular expressions</a></li>
<li><a href="no-way.html">no way!</a></li>
</ul>
<hr />
<center>
<span class="red"><strong>Contributed docs</strong></span>
</center>

<hr />
<p>Contributed software, tools, and documentation</p>
<ul>
<li><a href="ssh-and-http.html">combining ssh and http mode</a></li>
<li><a href="putty.html">putty and msysgit</a></li>
<li><a href="sskm.html">changing keys -- self service key management</a></li>
<li><a href="ukm.html">user key management</a></li>
<li><a href="README-emacs.html">emacs</a> &quot;major mode&quot;</li>
</ul>
</div>

<p>If I gave you this link to read, it most likely means either:</p>
<ul>
<li>(most common reason) You got really confused by <a href="ssh.html">ssh</a>.</li>
<li>(a bit less common) You got confused by how to administer users and repos using gitolite.</li>
</ul>
<p>Don't take the title personally. The &quot;idiot&quot; in the title is indeed a real person who once bugged me so much I wrote this for him. However, I have since realised that this is also useful for (a) people for whom English is not the first language and (b) people who really should not be doing technical work at this level, but are forced to do it by circumstances.</p>
<h1 id="pre-requisites-etc"><span class="header-section-number">1</span> pre-requisites, etc</h1>
<p>These are the pre-requisites:</p>
<ul>
<li>Any Linux machine on which git has already been installed.</li>
<li>Probably any BSD or legacy system like Solaris will also work, but I have not tested them.
<ul>
<li>I do not consider Apple devices to be Unix enough; it should work, but please do not ask me for help if it does not.</li>
</ul></li>
</ul>
<p>This page has several restrictions and constraints that seem unnecessary to people who <strong>do</strong> understand ssh. That's the whole point -- I'm compensating for lack of ssh knowledge by removing things that trip people up.</p>
<p>If even this page does not help you install gitolite, I probably cannot help you. Either you did not follow the instructions carefully <font color="gray">(maybe some task has to be run on your workstation, but you ran it on the server, or you ran something as root when it should be as the hosting user, etc.)</font>, or your environment is far too different from standard Unix, or you have some other problem. In any case, it is not something I can help with. Sorry.</p>
<h1 id="assumptions"><span class="header-section-number">2</span> assumptions</h1>
<ul>
<li><p>Your name is Ron. Substitute accordingly in the instructions below.</p></li>
<li><p>You have a workstation.</p></li>
<li><p>You have a server called <code>server</code>.</p></li>
<li><p>You have root access on this server.</p></li>
</ul>
<h1 id="installation-tasks"><span class="header-section-number">3</span> installation tasks</h1>
<ol style="list-style-type: decimal">
<li><p>Create a new userid on the server, say <code>git</code>. This will be the <strong>hosting user</strong>. (&quot;hosting user&quot; means when you're done installing, your users will use URLs like <code>git@server:reponame</code> or <code>ssh://git@server/reponame</code>).</p>
<p><strong>Make sure this is a NEW userid</strong>.</p>
<p>If the name you want already exists, then:</p>
<ul>
<li>Log in as root.</li>
<li>If you have any data on that user's HOME directory save it somewhere else.</li>
<li>Delete the userid.</li>
<li>Completely wipe out (erase) the home directory of the user (since on most systems merely deleting the user does not remove the home directory).</li>
<li>Re-create the userid again.</li>
</ul></li>
<li><p>If you don't already have one, make yourself an ssh keypair <strong>on your workstation</strong>.</p>
<p>Do NOT add this public key to the authorised keys file on the newly created hosting user!</p>
<p>Your ONLY access to the new (<code>git</code>) userid should be by logging onto the server as root, then running <code>su - git</code>.</p></li>
<li><p>Now copy the pubkey from your workstation (<code>~/.ssh/id_rsa.pub</code>) to the server as <code>/tmp/ron.pub</code>. (Your name is Ron, remember?)</p></li>
<li><p>Log on to the server as root.</p></li>
<li><p>Switch to the <code>git</code> user:</p>
<pre><code>su - git</code></pre></li>
<li><p>Clone the gitolite source code</p>
<pre><code>git clone git://github.com/sitaramc/gitolite</code></pre></li>
<li><p>Install it</p>
<pre><code>cd $HOME
mkdir -p bin
gitolite/install -to $HOME/bin</code></pre></li>
<li><p>Set it up</p>
<pre><code>cd $HOME
$HOME/bin/gitolite setup -pk /tmp/ron.pub</code></pre></li>
<li><p>Now go to your workstation and type in</p>
<pre><code>git ls-remote git@server:gitolite-admin</code></pre>
<p>This should return something like</p>
<pre><code>9dd8aab60bac5e54ccf887a87b4f3d35c96b05e4    HEAD
9dd8aab60bac5e54ccf887a87b4f3d35c96b05e4    refs/heads/master</code></pre>
<p>(do I have to mention that your SHAs will be different?)</p></li>
</ol>
<h1 id="administration-tasks"><span class="header-section-number">4</span> administration tasks</h1>
<p>Most day-to-day administration is done by making changes to a clone of the gitolite-admin repo and pushing. (There are some things that are done by editing <code>$HOME/.gitolite.rc</code> on the server, but those are too advanced for this tutorial so we will ignore that).</p>
<ol style="list-style-type: decimal">
<li><p>To start administering gitolite, clone the gitolite-admin repo:</p>
<pre><code>git clone git@server:gitolite-admin</code></pre></li>
<li><p>Now go to the new directory this creates, and look around:</p>
<pre><code>cd gitolite-admin
ls -A</code></pre>
<p>which gives you</p>
<pre><code>conf/  .git/  keydir/</code></pre>
<p>Ignoring the &quot;.git&quot; and exploring further:</p>
<pre><code>ls -A conf keydir</code></pre>
<p>which says:</p>
<pre><code>conf:
gitolite.conf

keydir:
ron.pub</code></pre></li>
<li><p>Let's say you want to add your colleague Alice. She has sent you her ssh public key by email (the file is called <code>id_rsa.pub</code>). Save this file as /tmp/alice.pub, then do this:</p>
<pre><code># still in your gitolite-admin clone, from the previous step
cp /tmp/alice.pub keydir
git add keydir
git commit -m 'new user alice'
git push</code></pre></li>
<li><p>Well, that might not be sufficient. There aren't any new repos for alice to play with, yet. So here's what you do: edit &quot;conf/gitolite.conf&quot; and add something like to the end:</p>
<pre><code>repo foo
    RW+     =   alice
    R       =   ron</code></pre>
<p>Save the file, then <code>git add conf; git commit -m 'new repo foo'; git push</code>.</p>
<p>This will automatically create a brand new repo called &quot;foo&quot; on the server, and alice will be able to clone from it, or push anything to it.</p></li>
</ol>
</body>
</html>
