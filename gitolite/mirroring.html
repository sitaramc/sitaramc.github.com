<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="pandoc" />
  <title>mirroring using gitolite</title>
  <style type="text/css">code{white-space: pre;}</style>
  <style>
      body        { background: #fff; text-color: #000; margin-left:  40px;   font-size:  0.9em;  font-family: arial; }
  
      code        { font-size:    1.1em;  background:  #ddf; text-color: #000; }
      pre         { margin-left:  2em;    background:  #ddf; text-color: #000; }
      pre code    { font-size:    1.1em;  background:  #ddf; text-color: #000; }
  
      td          { vertical-align: top }
  
      .red        { color: red }
      .blue       { color: blue }
      .green      { color: green }
      .gray       { color: gray }
      .pink       { color: pink }
  
      .box        { background-color:#e0e0e0 }
      .bg-red     { background-color:#ffe0e0 }
      .bg-green   { background-color:#e0ffe0 }
      .bg-blue    { background-color:#e0e0ff }
  
      /* couldn't resist the name! */
      .wd40       { width: 40% !important }
  
      .box-l      { float: left;  padding: 0px 0.5em; background-color: #e0e0e0; width:25%; margin-right: 4px; }
      .box-r      { float: right; padding: 0px 0.5em; background-color: #e0e0e0; width:25%; margin-left:  4px; }
  
      .fl-l       { float: left;  padding: 0px 0.5em;                                       margin-right: 4px; }
      .fl-r       { float: right; padding: 0px 0.5em;                                       margin-left:  4px; }
  
      .sidebar {
          margin-left: 4px;
          width: 25%;
          float: right;
          border: 4px solid #fff;
      }
  
  </style>
  <style>
      h1          { background: #ffb; text-color: #000; margin-left: -30px;   border-top:    5px  solid #ccc; }
      h2          { background: #ffb; text-color: #000; margin-left: -20px;   border-top:    3px  solid #ddd; }
      h3          { background: #ffb; text-color: #000; margin-left: -10px; }
      h4          { background: #ffb; text-color: #000; }
  </style>
</head>
<body>
<!--
    generated by gvim then munged a fair bit.  The following command
        vim -E -c "TOhtml" -c "w" -c 'qa!' \-\- conf/gitolite.conf
    may or may not produce the same thing
-->

<style type="text/css">
<!--
.WarningMsg { color: #ff0000; }
.Constant { color: #ffa0a0; }
.Statement { color: #ffff60; font-weight: bold; }
.PreProc { color: #ff80ff; }
.LineNr { color: #ffff00; }
.Comment { color: #80a0ff; }
.Type { color: #60ff60; font-weight: bold; }
.Special { color: #ffa500; }
.Identifier { color: #40ffff; }
.Error { color: #ffffff; background-color: #ff0000; padding-bottom: 1px; }
.Todo { color: #0000ff; background-color: #ffff00; padding-bottom: 1px; }
-->
</style>
<div id="header">
<h1 class="title">mirroring using gitolite</h1>
</div>
<div id="TOC">
<ul>
<li><a href="#quick-intro"><span class="toc-section-number">1</span> quick intro</a></li>
<li><a href="#caveats"><span class="toc-section-number">2</span> caveats</a></li>
<li><a href="#setting-up-mirroring"><span class="toc-section-number">3</span> setting up mirroring</a><ul>
<li><a href="#the-initial-setup-and-the-rc-filerc"><span class="toc-section-number">3.1</span> the initial setup and the <a href="rc.html">rc file</a></a></li>
<li><a href="#conf-file-settings-and-syntax"><span class="toc-section-number">3.2</span> conf file settings and syntax</a><ul>
<li><a href="#v3.6-preventing-automatic-sync"><span class="toc-section-number">3.2.1</span> <span class="gray">(v3.6+)</span> preventing automatic sync</a></li>
</ul></li>
</ul></li>
<li><a href="#v3.6.1-mirroring-failures"><span class="toc-section-number">4</span> <span class="gray">(v3.6.1+)</span> mirroring failures</a></li>
<li><a href="#sync"><span class="toc-section-number">5</span> manually synchronising a slave repo</a></li>
<li><a href="#redirected-pushes"><span class="toc-section-number">6</span> redirected pushes</a></li>
<li><a href="#HOSTNAME"><span class="toc-section-number">7</span> appendix A: HOSTNAME substitution</a></li>
<li><a href="#appendix-b-efficiency-versus-paranoia"><span class="toc-section-number">8</span> appendix B: efficiency versus paranoia</a></li>
<li><a href="#appendix-c-moving-the-admin-repo-to-a-different-master"><span class="toc-section-number">9</span> appendix C: moving the admin repo to a different master</a></li>
</ul>
</div>
<script type="text/javascript">
<!--
    function hide_show(id) {
        var e = document.getElementById(id);
        if(e == null)
            return;
        if(e.style.display != 'none')
            e.style.display = 'none';
        else
            e.style.display = 'block';
    }

    window.onload = function() {
        var t = document.getElementById('TOC');
        var sbt = document.getElementById('SBTOC');
        var h = '<div id="PTOC">'
        var h2 = '<p><strong><span class="red">Page TOC</span></strong></p>'
        var h3 = '</div>'
        var h4 = '<div id="GTOC">'
        var h5 = '</div>'
        var hst = '<div style="background: white; color: green; border: 2px solid green"><center><font size=-1><strong>Hide/Show Table of Contents</strong><br />'
        var pd = '<a href="#" onclick="hide_show(\'PTOC\');">Page TOC</a> | '
        var gt = '<a href="#" onclick="hide_show(\'GTOC\');">Gitolite TOC</a></font></center></div>'

        if(t == null)
            sbt.innerHTML = hst + gt + h4 + sbt.innerHTML + h5;
        else {
            sbt.innerHTML = hst + pd + gt + h + h2 + t.innerHTML + h3 + h4 + sbt.innerHTML + h5;
            t.style.display = 'none';   // hide the TOC that pandoc placed
        }
    }
-->
</script>

<style>
    #PTOC ul {
        list-style: none;
        margin-left: 0;
        padding-left: 2em;
        text-indent: -2em;
        padding-bottom: 2em;
    }
    #PTOC ul li {
        padding-bottom: 10px;
    }
    #PTOC ul li ul {
        padding-bottom: 0px;
    }
    #PTOC ul li ul li {
        padding-bottom: 0px;
    }

    .sidebar-toc a:hover {
        background-color: white;
    }

    .sidebar-toc {
        margin-left: 4px;
        width: 25%;
        float: right;
        color: gray;
        background: lightgray;
        border: 4px solid #fff;
        font-size: 0.90em;
    }

    .sidebar-toc ul {
        padding-left: 2em;
    }

</style>

<div id="SBTOC" class="sidebar-toc">

<p><strong><span class="red">Gitolite TOC</span></strong></p>
<hr />
<center>
<span class="red"><strong>Background</strong></span>
</center>

<hr />
<p><a href="index.html">Main page</a></p>
<ul>
<li><a href="index.html#dl">download</a></li>
<li><a href="index.html#rtfm">documentation</a></li>
<li><a href="index.html#trouble"><strong>troubleshooting</strong></a></li>
<li><a href="index.html#contact"><strong>contact and support</strong></a></li>
<li><a href="index.html#license">license</a></li>
</ul>
<p><a href="overview.html">Overview</a></p>
<ul>
<li>what is Gitolite?</li>
<li>why might you need it?</li>
<li>how does it work?</li>
<li>who uses it?</li>
</ul>
<p><a href="concepts.html">Concepts and terminology</a></p>
<ul>
<li>authentication and authorisation</li>
<li>the &quot;hosting user&quot;</li>
<li>ssh mode and http mode</li>
<li>the special gitolite-admin repo</li>
</ul>
<p><a href="req.html">Before you start...</a></p>
<ul>
<li>your skills</li>
<li>your server</li>
<li>your and your users' clients</li>
<li><strong>cautions and caveats</strong></li>
<li><a href="req.html#trying">trying</a> out gitolite safely</li>
</ul>
<hr />
<center>
<span class="red"><strong>Basics</strong></span>
</center>

<hr />
<p><a href="install.html">install and setup</a></p>
<ul>
<li><a href="install.html#qi">quick install+setup</a> (for experts)</li>
<li>the long way around</li>
<li><a href="install.html#upgrading">upgrading</a></li>
<li><a href="install.html#moving">moving servers</a></li>
</ul>
<p><a href="basic-admin.html">Basic Administration</a></p>
<ul>
<li>clone the gitolite-admin repo</li>
<li>add/remove users</li>
<li>add/remove/rename repos</li>
<li>bringing existing repos into gitolite</li>
</ul>
<p><a href="conf.html">The conf file (<code>conf/gitolite.conf</code>)</a></p>
<ul>
<li>basic <a href="conf.html#syntax">syntax</a></li>
<li><a href="conf.html#include">include</a> files</li>
<li><a href="conf.html#groups">group definitions</a></li>
<li><a href="conf.html#rules"><strong><span class="red">access rules</span></strong></a></li>
</ul>
<p><a href="rc.html">the rc file (<code>~/.gitolite.rc</code>)</a></p>
<p><a href="user.html">Your users' view</a> of gitolite</p>
<p>Troubleshooting</p>
<ul>
<li>help for <a href="emergencies.html">emergencies</a></li>
<li>the <a href="ips.html">fool-proof install guide</a></li>
<li>the gitolite &quot;<a href="cookbook.html">cookbook</a>&quot;</li>
</ul>
<hr />
<center>
<span class="red"><strong>Advanced</strong></span>
</center>

<hr />
<p>Advanced &quot;conf file&quot; use</p>
<ul>
<li>specifying <a href="git-config.html">git-config</a> keys and values</li>
<li>gitolite <a href="options.html">options</a></li>
<li><a href="wild.html"><strong>wild repos</strong></a> (user created repos)</li>
<li><a href="vref.html">virtual refs</a></li>
<li><a href="deleg.html">delegation</a> of admin duties</li>
<li><a href="gitweb-daemon.html">gitweb and git-daemon</a></li>
</ul>
<p>Special features/setups</p>
<ul>
<li><strong><a href="mirroring.html">mirroring</a></strong></li>
<li><a href="http.html">http</a> mode</li>
<li>using a <a href="cache.html">cache</a></li>
<li>(<a href="namespaces.html">namespaces</a>)</li>
<li><a href="locking.html">locking</a> binary files</li>
<li><a href="package.html">packaging</a> gitolite</li>
</ul>
<p>Customising gitolite</p>
<ul>
<li>core and <a href="non-core.html">non-core</a> gitolite</li>
<li><a href="dev-notes.html">writing your own</a> non-core programs</li>
<li>gitolite <a href="triggers.html">triggers</a></li>
<li><a href="list-non-core.html">list of non-core programs</a> shipped with gitolite</li>
</ul>
<hr />
<center>
<span class="red"><strong>Extras</strong></span>
</center>

<hr />
<p><a href="odds-and-ends.html">Odds and Ends</a></p>
<ul>
<li><a href="odds-and-ends.html#writable">disabling pushes</a> to take backups</li>
<li><a href="odds-and-ends.html#elsewhere">putting 'repositories' and '.gitolite' elsewhere</a></li>
<li><a href="odds-and-ends.html#keysonly">using pubkeys obtained from elsewhere</a></li>
<li><a href="odds-and-ends.html#gh">giving users their own repos</a></li>
<li><a href="odds-and-ends.html#server-side-admin">administering gitolite directly on the server</a></li>
</ul>
<p>Additional information/discussion</p>
<ul>
<li><a href="ssh.html">all about ssh and gitolite</a></li>
<li>Running the <a href="testing.html">test suite</a></li>
<li><a href="files.html">gitolite files and directories</a></li>
<li><a href="perf.html">gitolite performance</a></li>
<li><a href="migr.html">Migration</a></li>
<li><a href="http://sitaramc.github.com/gitolite/g2/master-toc.html">documentation for gitolite v2</a></li>
<li><a href="regex.html">regular expressions</a></li>
<li><a href="no-way.html">no way!</a></li>
</ul>
<hr />
<center>
<span class="red"><strong>Contributed docs</strong></span>
</center>

<hr />
<p>Contributed software, tools, and documentation</p>
<ul>
<li><a href="ssh-and-http.html">combining ssh and http mode</a></li>
<li><a href="putty.html">putty and msysgit</a></li>
<li><a href="sskm.html">changing keys -- self service key management</a></li>
<li><a href="ukm.html">user key management</a></li>
<li><a href="README-emacs.html">emacs</a> &quot;major mode&quot;</li>
</ul>
</div>

<p><font color="red"><strong>WARNING</strong> v2 gitolite mirroring users please note: <strong>there are <a href="migr.html#g2i-mirroring">significant changes</a></strong> in syntax and usage compared to v2. If you're not the kind who reads documentation before doing serious system admin things, well... good luck!</font></p>
<h1 id="quick-intro"><span class="header-section-number">1</span> quick intro</h1>
<p>Mirroring is simple: you have one &quot;master&quot; server and one or more &quot;slave&quot; servers. The slaves get updates only from the master; to the rest of the world they are at best read-only.</p>
<p>In the following pictures, each box (A, B, C, ...) is a repo. The master server for a repo is colored red, slaves are green. The <strong>user</strong> pushes to the repo on the master server (red), and the master server -- once the user's push succeeds -- then does a <code>git push --mirror</code> to the slaves. The arrows show this mirror push.</p>
<p>The first picture shows what gitolite mirroring used to be like a long time ago (before v2.1, actually). There is exactly one master server; all the rest are slaves. Each slave mirrors <strong>all</strong> the repos that the master carries, no more and no less.</p>
<div class="figure">
<img src="data:image/png;base64,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" />
</div>
<p>This is simple to understand and manage, and might actually be fine for many small sites. The mirrors are more &quot;hot standby&quot; than anything else.</p>
<p>But when you have 4000+ developers on 500 repos using 25 servers in 9 cities, that single server tends to become a wee bit stressed. Especially when you realise that many projects have highly localised development teams. For example, if most developers for a project are in city X, with perhaps a few in city Y, then having the master server in city Z is... suboptimal :-)</p>
<p>And so, for about 3 years now, gitolite could do this:</p>
<div class="figure">
<img src="data:image/png;base64,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" />
</div>
<p>You can easily see the differences in this scenario, but here's a more complete description of what gitolite can do:</p>
<ul>
<li><p>Different masters and sets of slaves for different repos.</p>
<p>This lets you do things like:</p>
<ul>
<li>Use the server closest to <em>most</em> of its developers as the master for that repo.</li>
<li>Mirror a repo to only some of the servers.</li>
<li>Have repos that are purely local to a server (not mirrored at all).</li>
<li>Push to a slave on demand or via cron (helps deal with bandwidth or connectivity constraints).</li>
</ul>
<p>All this is possible whether or not the gitolite-admin repo is mirrored -- that is, all servers have the <em>exact same</em> gitolite-admin repo or not.</p></li>
<li><p>Pushes to a slave can be transparently forwarded to the real master.</p>
<p>Your developers need not worry about where a repo's master is -- they just write to their local mirror for <em>all</em> repos, even if their local mirror is only a slave for some.</p></li>
</ul>
<h1 id="caveats"><span class="header-section-number">2</span> caveats</h1>
<ul>
<li><p>Mirroring by itself will never <em>create</em> a repo on a slave; it has to exist and be prepared to receive updates from the master.</p>
<p>The simplest way to ensure your repos exist on the slaves also is to mirror the special gitolite-admin repo as well, and this is what most sites do.</p></li>
<li><p>There is limited support for auto-creating wild card repos and sending 'perms' info across, with the following caveats at present. (Some of this text won't make sense unless you know what those features are).</p>
<ul>
<li><p><em>WARNING: it does NOT make sense to mirror wild repos in setups where the authentication data is not the same (i.e., where &quot;alice&quot; on the master and &quot;alice&quot; on a slave maybe totally different people)</em>.</p></li>
<li><p>This has only been minimally tested. For example, complex setups or asymmetric configs on master and slave, etc. have NOT been tested.</p></li>
<li><p>Permission changes will only propagate on the next 'git push'. Of course, if you know the name of the slave server, you can run</p>
<pre><code>ssh git@host mirror push slave-server-name repo-name</code></pre></li>
<li><p>Using 'perms' on a slave is allowed but will neither propagate nor persist. They will be overwritten by whatever perms the master has (even if it is an empty set) on the next 'git push'.</p></li>
<li><p>As with lots of extra features in gitolite, smart http support is not on my radar. Don't ask.</p></li>
</ul>
<p>Please test it out and let me know if something surprising happens. Be aware that I have been known to claim bugs are features if I don't have time to fix them immediately :-)</p></li>
<li><p>Mirroring is only for git repos. Ancillary files like gl-creator and gl-perms in the repo directory are not mirrored; you must do that separately. Files in the admin directory (like log files) are also not mirrored.</p></li>
<li><p>If you ever do a <a href="emergencies.html#bypass">bypass push</a>, mirroring will not work. Mirroring checks also will not work -- for example, you can push to a slave, which is not usually a good idea. So don't bypass gitolite if the repo is mirrored!</p></li>
<li><p>From v3.5.3 on, gitolite uses an asynchronous push to the slaves, so that the main push returns immediately, without waiting for the slave pushes to complete. Keep this in mind if you're writing scripts that do a push, and then read one of the slaves immediately -- you will need to add a few seconds of sleep in your script.</p></li>
</ul>
<h1 id="setting-up-mirroring"><span class="header-section-number">3</span> setting up mirroring</h1>
<p>This is in two parts: the initial setup and the rc file, followed by the conf file settings and syntax.</p>
<h2 id="the-initial-setup-and-the-rc-filerc"><span class="header-section-number">3.1</span> the initial setup and the <a href="rc.html">rc file</a></h2>
<p>On <strong>each</strong> server:</p>
<ul>
<li><p>Install gitolite normally. Make clones of the server's 'gitolite-admin' repo on your workstation so you can admin them all from one place.</p></li>
<li><p>Give the server a short, simple, &quot;hostname&quot; and set the HOSTNAME in the rc file (i.e., <code>~/.gitolite.rc</code> on the server) to this name, for example 'mars'. <em>Note: this has nothing to do with the hostname of the server in networking or DNS terms, or in OS terms. This is internal to gitolite</em>.</p></li>
<li><p>Run ssh-keygen if needed and get an ssh key pair for the server. Copy the public key to a common area and name it after the host, but with 'server-' prefixed. For example, the pubkey for server 'mars' must be stored as 'server-mars.pub'.</p></li>
<li><p>Copy all keys to all the admin repo clones on your workstation and and add them as usual. This is an <code>O(N^2)</code> operation ;-)</p>
<p>You may have guessed that the prefix 'server-' is special, and distinguishes a human user from a mirroring peer.</p></li>
<li><p>Create &quot;host&quot; aliases to refer to all other machines. See <a href="sts.html#ssh-ha">here</a> for what/how.</p>
<p>The host alias for a host (in all other machines' <code>~/.ssh/config</code> files) MUST be the same as the <code>HOSTNAME</code> in the referred host's <code>~/.gitolite.rc</code>. Gitolite mirroring <strong>requires</strong> this consistency in naming; things will NOT work otherwise.</p>
<p>Normally you should be able to build one common file and append it to all the servers' <code>~/.ssh/config</code> files.</p></li>
<li><p>The following <strong>MUST</strong> work for <strong>each pair</strong> of servers that must talk to each other:</p>
<pre><code># on server mars
ssh phobos info
# the response MUST start with &quot;hello, server-mars...&quot;</code></pre>
<p>Note the exact syntax used; variations like &quot;ssh git@phobos.example.com info&quot; are NOT sufficient. That is why you need the ssh host aliases.</p>
<p>Check this command from <em>everywhere to everywhere else</em>, and make sure you get expected results. <strong>Do NOT proceed otherwise.</strong></p></li>
<li>Setup the gitolite.conf file on all the servers. If the slaves are to be exact copies of the master, you need to do the complete configuration only on the master; the slaves can have just this because on the first push to the master it will update all the slaves anyway:
<pre style="font-family: 'Andale mono',monospace; padding: 4px; color: #ffffff; background-color: #000000;">
<span class="Type">    repo </span>gitolite-admin
<span class="Statement">        RW+</span><span class="Constant">     </span>=   some-local-admin

    option mirror.master    =   mars
    option mirror.slaves    =   phobos
</pre>
</li>
<li><p>When that is all done and tested, <strong>enable mirroring</strong> by going through the rc file and uncommenting all the lines mentioning <code>Mirroring</code>.</p></li>
<li><p>If you wish to allow your users to run the mirror command remotely (usually <em>not</em> required), you need to enable it just like any other command that is not enabled by default; see <a href="non-core.html#commands">gitolite commands</a> for how.</p></li>
</ul>
<h2 id="conf-file-settings-and-syntax"><span class="header-section-number">3.2</span> conf file settings and syntax</h2>
<p>Mirroring is defined by the following <a href="options.html">options</a>. You can have different settings for different repos, and of course some repos may not have any mirror options at all -- they are then purely local.</p>
<pre style="font-family: 'Andale mono',monospace; padding: 4px; color: #ffffff; background-color: #000000;">
<span class="Type">repo </span>foo
    ...access rules...

    option mirror.master        =   mars
    option mirror.slaves        =   phobos deimos
    option mirror.redirectOK    =   all
</pre>

<p>The first line is easy, since a repo can have only one master.</p>
<p>The second is a space separated list of hosts that are all slaves. You can have several slave lists, as long as the config key starts with 'mirror.slaves' and is unique. For example.</p>
<pre style="font-family: 'Andale mono',monospace; padding: 4px; color: #ffffff; background-color: #000000;">
    option mirror.slaves-1   =   phobos deimos
    option mirror.slaves-2   =   io europa
    option mirror.slaves-3   =   ganymede callisto
</pre>

<p>Do not repeat a key; then only the last line for that key will be effective.</p>
<h3 id="v3.6-preventing-automatic-sync"><span class="header-section-number">3.2.1</span> <span class="gray">(v3.6+)</span> preventing automatic sync</h3>
<p>Sometimes you don't want a repo to be mirrored automatically (as soon as someone pushes to the master) to all the slaves. For whatever reasons, you have some slaves for whom you would like to trigger the sync later (and you don't mind the fact that those slaves is out of sync until then).</p>
<p>To make that happen, use option lines like this instead of those shown above:</p>
<pre style="font-family: 'Andale mono',monospace; padding: 4px; color: #ffffff; background-color: #000000;">
    option mirror.slaves.nosync-1   =   phobos deimos
</pre>

<p>Except for the addition of a <code>.nosync</code> just after <code>slaves</code>, all the other rules are the same as before.</p>
<h1 id="v3.6.1-mirroring-failures"><span class="header-section-number">4</span> <span class="gray">(v3.6.1+)</span> mirroring failures</h1>
<p>Since mirror pushes happen asynchronously (i.e, the user who originally pushed does not have to wait for the mirrors to be synced), any mirror push failures are not immediately visible to a human being, although you will find them if you look in gitolite's log files.</p>
<p><span class="box-r">Note: since only a successful push can clear the error status, it follows that if a mirror push failed due to an invalid hostname, that status file will need to be manually deleted from the server. Look in the bare repo directory on the server, for one or more files whose names start with 'gl-slave' and delete the appropriate one.</span></p>
<p>Therefore, when the output of the mirror push to some slave contains the word &quot;fatal&quot;, gitolite saves the output. This saved output is printed to STDERR when any user attempts to clone/fetch/push the repo on the master server for that repo. The hope is that someone will alert an admin to look at the problem. This will continue to happen until the error condition is cleared (i.e., a successful mirror push happens to that specific slave).</p>
<p>If you don't want these unexpected reports confusing users (or programs!), simply create a new rc variable called HUSH_MIRROR_STATUS and set it to 1. <span class="gray">(If you're not sure where in the rc file this should go, I suggest putting it right after the HOSTNAME variable).</span></p>
<p>You can see the mirror status of any repo using the 'mirror status' command; the command line help for the mirror command ('gitolite mirror -h' or 'ssh git@host mirror -h') has details.</p>
<h1 id="sync"><span class="header-section-number">5</span> manually synchronising a slave repo</h1>
<p>You can use the <code>gitolite mirror push</code> command on a master to manually synchronise any of its slaves. Try it with <code>-h</code> to get usage info.</p>
<p>Tip: if you want to do this to all the slaves, try this:</p>
<pre><code>for s in `gitolite git-config -r reponame mirror.slave | cut -f3`
do
    gitolite mirror push $s reponame
done</code></pre>
<p>This command can also be run remotely; run <code>ssh git@host mirror -h</code> for details.</p>
<h1 id="redirected-pushes"><span class="header-section-number">6</span> redirected pushes</h1>
<p><strong>Please read carefully; there are security implications if you enable this for mirrors NOT under your control</strong>.</p>
<p>Normally, a master, (and <em>only</em> a master), pushes to a slave, and the slaves are &quot;read-only&quot; to the users. Gitolite allows a <em>slave</em> to receive pushes from a user and transparently redirect them to the <em>master</em>.</p>
<p>This simplifies things for users in complex setups, letting them use their local mirror for both fetch and push access to all repos.</p>
<p>The syntax for enabling this is one of these:</p>
<pre style="font-family: 'Andale mono',monospace; padding: 4px; color: #ffffff; background-color: #000000;">
option mirror.redirectOK    =   all
option mirror.redirectOK    =   phobos deimos
</pre>

<p>The first syntax trusts all valid slaves to redirect user pushes, while the second one trusts only some slaves.</p>
<p><strong>IMPORTANT NOTES</strong></p>
<ul>
<li><p>This only works for ssh-based setups; you cannot use this feature in http mode.</p></li>
<li><p><strong>Authentication</strong> happens on the slave, but <strong>authorisation</strong> is on the master. The master is trusting the slave to authenticate the user correctly, <em>and</em> use the same authentication data (i.e., user alice on the slave should be guaranteed to be the same as user alice on the master).</p></li>
<li><p>The part of the authorisation that happens before passing control to git-receive-pack (see the <a href="conf.html#rules">access rules</a> page) will happen on the slave as well.</p></li>
<li><p>You cannot redirect gitolite commands (like perms, etc).</p></li>
</ul>
<h1 id="HOSTNAME"><span class="header-section-number">7</span> appendix A: HOSTNAME substitution</h1>
<p>Wherever gitolite sees the word <code>%HOSTNAME</code>, it will replace it with the HOSTNAME supplied in the rc file, if one was supplied. This lets you maintain configurations for all servers in one repo, yet have them act differently on different servers, by saying something like:</p>
<pre style="font-family: 'Andale mono',monospace; padding: 4px; color: #ffffff; background-color: #000000;">
<span class="PreProc">subconf </span><span class="Constant">&quot;%HOSTNAME/*.conf&quot;</span>
</pre>

<p>You can use it in other places also, for example:</p>
<pre style="font-family: 'Andale mono',monospace; padding: 4px; color: #ffffff; background-color: #000000;">
<span class="Statement">RW+</span><span class="Constant">     VREF/NAME/subs/%HOSTNAME/       </span>=   <span class="Identifier">@</span><span class="Error">%</span><span class="Identifier">HOSTNAME-admins</span>
</pre>

<p>(you still have to define <span class="citation">@mars-admins</span>, <span class="citation">@phobos-admins</span>, etc., but the actual VREF is now one line instead of one for each server!)</p>
<h1 id="appendix-b-efficiency-versus-paranoia"><span class="header-section-number">8</span> appendix B: efficiency versus paranoia</h1>
<p>If you're paranoid enough to use mirrors, you should be paranoid enough to set this on each server, despite the possible CPU overhead:</p>
<pre><code>git config --global receive.fsckObjects true</code></pre>
<h1 id="appendix-c-moving-the-admin-repo-to-a-different-master"><span class="header-section-number">9</span> appendix C: moving the admin repo to a different master</h1>
<p>Moving only some repos (other than the gitolite-admin repo) to a different master is easy. Just make the change in the gitolite.conf file, add, commit, and push.</p>
<p>Even for the gitolite-admin repo, if the current master is ok, it's the same thing; just make the change and push <em>to the current master</em>. Subsequent pushes will go to the new master, of course.</p>
<p>But if the current master is already dead, there's a bit of a catch-22. You can't push to the master because it is dead, and you can't push to any slave because they won't accept updates from anywhere but the server they think is the master.</p>
<p>Here's how to resolve this:</p>
<ol style="list-style-type: decimal">
<li><p>On <em>each</em> slave:</p>
<ul>
<li><p>Edit <code>~/.gitolite/conf/gitolite.conf</code> to change the master and slave options for the gitolite-admin repo.</p></li>
<li><p>Run <code>gitolite setup</code>.</p></li>
</ul></li>
<li><p>Now clone the admin repo from the <em>new</em> master to your workstation, change the options for the rest of the repos (if needed), then add/commit/push.</p></li>
</ol>
<p>And that should be all you need to do.</p>
</body>
</html>
