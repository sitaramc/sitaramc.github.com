<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="pandoc" />
  <title>specifying &quot;git-config&quot; keys and values</title>
  <style type="text/css">code{white-space: pre;}</style>
  <style>
      body        { background: #fff; text-color: #000; margin-left:  40px;   font-size:  0.9em;  font-family: arial; }
  
      code        { font-size:    1.1em;  background:  #ddf; text-color: #000; }
      pre         { margin-left:  2em;    background:  #ddf; text-color: #000; }
      pre code    { font-size:    1.1em;  background:  #ddf; text-color: #000; }
  
      td          { vertical-align: top }
  
      .red        { color: red }
      .blue       { color: blue }
      .green      { color: green }
      .gray       { color: gray }
      .pink       { color: pink }
  
      .box        { background-color:#e0e0e0 }
      .bg-red     { background-color:#ffe0e0 }
      .bg-green   { background-color:#e0ffe0 }
      .bg-blue    { background-color:#e0e0ff }
  
      /* couldn't resist the name! */
      .wd40       { width: 40% !important }
  
      .box-l      { float: left;  padding: 0px 0.5em; background-color: #e0e0e0; width:25%; margin-right: 4px; }
      .box-r      { float: right; padding: 0px 0.5em; background-color: #e0e0e0; width:25%; margin-left:  4px; }
  
      .fl-l       { float: left;  padding: 0px 0.5em;                                       margin-right: 4px; }
      .fl-r       { float: right; padding: 0px 0.5em;                                       margin-left:  4px; }
  
      .sidebar {
          margin-left: 4px;
          width: 25%;
          float: right;
          border: 4px solid #fff;
      }
  
  </style>
  <style>
      h1          { background: #ffb; text-color: #000; margin-left: -30px;   border-top:    5px  solid #ccc; }
      h2          { background: #ffb; text-color: #000; margin-left: -20px;   border-top:    3px  solid #ddd; }
      h3          { background: #ffb; text-color: #000; margin-left: -10px; }
      h4          { background: #ffb; text-color: #000; }
  </style>
</head>
<body>
<!--
    generated by gvim then munged a fair bit.  The following command
        vim -E -c "TOhtml" -c "w" -c 'qa!' \-\- conf/gitolite.conf
    may or may not produce the same thing
-->

<style type="text/css">
<!--
.WarningMsg { color: #ff0000; }
.Constant { color: #ffa0a0; }
.Statement { color: #ffff60; font-weight: bold; }
.PreProc { color: #ff80ff; }
.LineNr { color: #ffff00; }
.Comment { color: #80a0ff; }
.Type { color: #60ff60; font-weight: bold; }
.Special { color: #ffa500; }
.Identifier { color: #40ffff; }
.Error { color: #ffffff; background-color: #ff0000; padding-bottom: 1px; }
.Todo { color: #0000ff; background-color: #ffff00; padding-bottom: 1px; }
-->
</style>
<div id="header">
<h1 class="title">specifying &quot;git-config&quot; keys and values</h1>
</div>
<div id="TOC">
<ul>
<li><a href="#basic-syntax"><span class="toc-section-number">1</span> basic syntax</a><ul>
<li><a href="#an-important-warning-about-deleting-a-config-line"><span class="toc-section-number">1.1</span> <span class="red">an important warning about <strong>deleting</strong> a config line</span></a></li>
</ul></li>
<li><a href="#substituting-the-repo-name-and-the-creator-name"><span class="toc-section-number">2</span> substituting the repo name and the creator name</a></li>
<li><a href="#v3.6.7-expanding-a-group-name"><span class="toc-section-number">3</span> <span class="gray">(v3.6.7+)</span> expanding a group name</a></li>
<li><a href="#override_conf"><span class="toc-section-number">4</span> overriding config values</a></li>
<li><a href="#unsafe-patt"><span class="toc-section-number">5</span> compensating for UNSAFE_PATT</a></li>
</ul>
</div>
<script type="text/javascript">
<!--
    function hide_show(id) {
        var e = document.getElementById(id);
        if(e == null)
            return;
        if(e.style.display != 'none')
            e.style.display = 'none';
        else
            e.style.display = 'block';
    }

    window.onload = function() {
        var t = document.getElementById('TOC');
        var sbt = document.getElementById('SBTOC');
        var h = '<div id="PTOC">'
        var h2 = '<p><strong><span class="red">Page TOC</span></strong></p>'
        var h3 = '</div>'
        var h4 = '<div id="GTOC">'
        var h5 = '</div>'
        var hst = '<div style="background: white; color: green; border: 2px solid green"><center><font size=-1><strong>Hide/Show Table of Contents</strong><br />'
        var pd = '<a href="#" onclick="hide_show(\'PTOC\');">Page TOC</a> | '
        var gt = '<a href="#" onclick="hide_show(\'GTOC\');">Gitolite TOC</a></font></center></div>'

        if(t == null)
            sbt.innerHTML = hst + gt + h4 + sbt.innerHTML + h5;
        else {
            sbt.innerHTML = hst + pd + gt + h + h2 + t.innerHTML + h3 + h4 + sbt.innerHTML + h5;
            t.style.display = 'none';   // hide the TOC that pandoc placed
        }
    }
-->
</script>
<style>
    #PTOC ul {
        list-style: none;
        margin-left: 0;
        padding-left: 2em;
        text-indent: -2em;
        padding-bottom: 2em;
    }
    #PTOC ul li {
        padding-bottom: 10px;
    }
    #PTOC ul li ul {
        padding-bottom: 0px;
    }
    #PTOC ul li ul li {
        padding-bottom: 0px;
    }

    .sidebar-toc a:hover {
        background-color: white;
    }

    .sidebar-toc {
        margin-left: 4px;
        width: 25%;
        float: right;
        color: gray;
        background: lightgray;
        border: 4px solid #fff;
        font-size: 0.90em;
    }

    .sidebar-toc ul {
        padding-left: 2em;
    }

</style>
<div id="SBTOC" class="sidebar-toc">
<p><strong><span class="red">Gitolite TOC</span></strong></p>
<hr />
<center>
<span class="red"><strong>Background</strong></span>
</center>
<hr />
<p><a href="index.html">Main page</a></p>
<ul>
<li><a href="index.html#dl">download</a></li>
<li><a href="index.html#rtfm">documentation</a>
<ul>
<li><a href="gitolite.html"><strong>all-in-one</strong></a> page</li>
</ul></li>
<li><a href="index.html#trouble"><strong>troubleshooting</strong></a></li>
<li><a href="index.html#contact"><strong>contact and support</strong></a></li>
<li><a href="index.html#license">license</a></li>
</ul>
<p><a href="overview.html">Overview</a></p>
<ul>
<li>what is Gitolite?</li>
<li>why might you need it?</li>
<li>how does it work?</li>
<li>who uses it?</li>
</ul>
<p><a href="concepts.html">Concepts, conventions, and terminology</a></p>
<ul>
<li>authentication and authorisation</li>
<li>ssh mode and http mode</li>
<li>the &quot;hosting user&quot;</li>
<li>the &quot;logical repo name&quot;</li>
<li>the special gitolite-admin repo</li>
</ul>
<p><a href="req.html">Before you start...</a></p>
<ul>
<li>your skills</li>
<li>your server</li>
<li>your and your users' clients</li>
<li><strong>cautions and caveats</strong></li>
<li><a href="req.html#trying">trying</a> out gitolite safely</li>
</ul>
<hr />
<center>
<span class="red"><strong>Basics</strong></span>
</center>
<hr />
<p><a href="install.html">install and setup</a></p>
<ul>
<li><a href="install.html#qi">quick install+setup</a> (for experts)</li>
<li>the long way around</li>
<li><a href="install.html#upgrading">upgrading</a></li>
<li><a href="install.html#moving">moving servers</a></li>
</ul>
<p><a href="basic-admin.html">Basic Administration</a></p>
<ul>
<li>clone the gitolite-admin repo</li>
<li>add/remove users</li>
<li>add/remove/rename repos</li>
<li>bringing existing repos into gitolite</li>
</ul>
<p><a href="conf.html">The conf file (<code>conf/gitolite.conf</code>)</a></p>
<ul>
<li>basic <a href="conf.html#syntax">syntax</a></li>
<li><a href="conf.html#include">include</a> files</li>
<li><a href="conf.html#groups">group definitions</a></li>
<li><a href="conf.html#rules"><strong><span class="red">access rules</span></strong></a></li>
</ul>
<p><a href="rc.html">the rc file (<code>~/.gitolite.rc</code>)</a></p>
<p><a href="user.html">Your users' view</a> of gitolite</p>
<p>Troubleshooting</p>
<ul>
<li>help for <a href="emergencies.html">emergencies</a></li>
<li>the <a href="ips.html">fool-proof install guide</a></li>
<li>the gitolite &quot;<a href="cookbook.html">cookbook</a>&quot;</li>
</ul>
<hr />
<center>
<span class="red"><strong>Advanced</strong></span>
</center>
<hr />
<p>Advanced &quot;conf file&quot; use</p>
<ul>
<li>specifying <a href="git-config.html">git-config</a> keys and values</li>
<li>gitolite <a href="options.html">options</a></li>
<li><a href="wild.html"><strong>wild repos</strong></a> (user created repos)</li>
<li><a href="vref.html">virtual refs</a></li>
<li><a href="deleg.html">delegation</a> of admin duties</li>
<li><a href="gitweb-daemon.html">gitweb and git-daemon</a></li>
</ul>
<p>Special features/setups</p>
<ul>
<li><strong><a href="mirroring.html">mirroring</a></strong></li>
<li><a href="http.html">http</a> mode</li>
<li>using a <a href="cache.html">cache</a></li>
<li>(<a href="namespaces.html">namespaces</a>)</li>
<li><a href="locking.html">locking</a> binary files</li>
<li><a href="package.html">packaging</a> gitolite</li>
</ul>
<p>Customising gitolite</p>
<ul>
<li>core and <a href="non-core.html">non-core</a> gitolite</li>
<li><a href="dev-notes.html">writing your own</a> non-core programs</li>
<li>gitolite <a href="triggers.html">triggers</a></li>
<li><a href="list-non-core.html">list of non-core programs</a> shipped with gitolite</li>
</ul>
<hr />
<center>
<span class="red"><strong>Extras</strong></span>
</center>
<hr />
<p><a href="odds-and-ends.html">Odds and Ends</a></p>
<ul>
<li><a href="odds-and-ends.html#writable">disabling pushes</a> to take backups</li>
<li><a href="odds-and-ends.html#elsewhere">putting 'repositories' and '.gitolite' elsewhere</a></li>
<li><a href="odds-and-ends.html#keysonly">using pubkeys obtained from elsewhere</a></li>
<li><a href="odds-and-ends.html#gh">giving users their own repos</a></li>
<li><a href="odds-and-ends.html#server-side-admin">administering gitolite directly on the server</a></li>
</ul>
<p>Additional information/discussion</p>
<ul>
<li><a href="ssh.html">all about ssh and gitolite</a></li>
<li>Running the <a href="testing.html">test suite</a></li>
<li><a href="files.html">gitolite files and directories</a></li>
<li><a href="perf.html">gitolite performance</a></li>
<li><a href="migr.html">Migration</a></li>
<li><a href="http://sitaramc.github.com/gitolite/g2/master-toc.html">documentation for gitolite v2</a></li>
<li><a href="regex.html">regular expressions</a></li>
<li><a href="no-way.html">no way!</a></li>
</ul>
<hr />
<center>
<span class="red"><strong>Contributed docs</strong></span>
</center>
<hr />
<p>Contributed software, tools, and documentation</p>
<ul>
<li><a href="ssh-and-http.html">combining ssh and http mode</a></li>
<li><a href="putty.html">putty and msysgit</a></li>
<li><a href="sskm.html">changing keys -- self service key management</a></li>
<li><a href="ukm.html">user key management</a></li>
<li><a href="README-emacs.html">emacs</a> &quot;major mode&quot;</li>
</ul>
</div>
<p><span class="gray">(Original version thanks to teemu dot matilainen at iki dot fi.)</span></p>
<blockquote>
<hr />
</blockquote>
<blockquote>
<p><strong>Note</strong>: this won't work unless the rc file has the right settings; please see <code>$GIT_CONFIG_KEYS</code> in the <a href="rc.html">rc file doc</a>.</p>
</blockquote>
<blockquote>
<hr />
</blockquote>
<h1 id="basic-syntax"><span class="header-section-number">1</span> basic syntax</h1>
<p>The syntax is simple:</p>
<pre><code>config sectionname.keyname = value</code></pre>
<p>For example:</p>
<pre style="font-family: 'Andale mono',monospace; padding: 4px; color: #ffffff; background-color: #000000;">
<span class="Type">repo </span>gitolite
<span class="Statement">    config </span><span class="Identifier">hooks.mailinglist </span>= gitolite-commits@example.tld
<span class="Statement">    config </span><span class="Identifier">hooks.emailprefix </span>= <span class="Constant">&quot;[gitolite] &quot;</span>
<span class="Statement">    config </span><span class="Identifier">foo.bar </span>= <span class="Constant">&quot;&quot;</span>
</pre>
<p>This does either a plain &quot;git config section.key value&quot; (for the first 2 examples above) or &quot;git config --unset-all section.key&quot; (for the last example). Other forms of the <code>git config</code> command (<code>--add</code>, the <code>value_regex</code>, etc) are not supported.</p>
<h2 id="an-important-warning-about-deleting-a-config-line"><span class="header-section-number">1.1</span> <span class="red">an important warning about <strong>deleting</strong> a config line</span></h2>
<blockquote>
<hr />
</blockquote>
<blockquote>
<p><strong>WARNING</strong>: simply deleting the config line from the <code>conf/gitolite.conf</code> file will <em>not</em> delete the variable from <code>repo.git/config</code>. You have to use the syntax in the last example to make gitolite execute a <code>--unset-all</code> operation on the given key.</p>
</blockquote>
<blockquote>
<hr />
</blockquote>
<h1 id="substituting-the-repo-name-and-the-creator-name"><span class="header-section-number">2</span> substituting the repo name and the creator name</h1>
<p>You can also use the special values <code>%GL_REPO</code> and <code>%GL_CREATOR</code> in the string. The former is available to all repos, while the latter is only available to <a href="wild.html">wild</a> repos.</p>
<pre style="font-family: 'Andale mono',monospace; padding: 4px; color: #ffffff; background-color: #000000;">
<span class="Type">repo </span>foo bar baz
<span class="Statement">    config </span><span class="Identifier">hooks.mailinglist </span>= %GL_REPO-commits@example.tld
<span class="Statement">    config </span><span class="Identifier">hooks.emailprefix </span>= <span class="Constant">&quot;[%GL_REPO] &quot;</span>
</pre>
<h1 id="v3.6.7-expanding-a-group-name"><span class="header-section-number">3</span> <span class="gray">(v3.6.7+)</span> expanding a group name</h1>
<p>If you add</p>
<pre><code>EXPAND_GROUPS_IN_CONFIG     =&gt;  1,</code></pre>
<p>to the rc file (suggested location: just after the <code>GIT_CONFIG_KEYS</code> line), then the <em>value</em> of a config line will have groupnames expanded. For example:</p>
<pre><code>@admins = sitaramc@gmail.com jdoe@example.com
...
repo foo
    ...
    config hooks.mailinglist = @admins</code></pre>
<p>will behave as if the two email addresses were explicitly listed in the config line. However, if there is no such group, the text will be left as-is. Also, for safety, only word characters (alphanumerics and underscore) are expected as part of the group name.</p>
<h1 id="override_conf"><span class="header-section-number">4</span> overriding config values</h1>
<p>You can repeat the 'config' line as many times as you like, and the <em>last</em> occurrence will be the one in effect. This allows you to override settings just for one project, as in this example:</p>
<pre style="font-family: 'Andale mono',monospace; padding: 4px; color: #ffffff; background-color: #000000;">
<span class="Type">repo </span><span class="Identifier">@all</span>
<span class="Statement">    config </span><span class="Identifier">hooks.mailinglist </span>= %GL_REPO-commits@example.tld
<span class="Statement">    config </span><span class="Identifier">hooks.emailprefix </span>= <span class="Constant">&quot;[%GL_REPO] &quot;</span>

<span class="Comment"># ... later ...</span>

<span class="Type">repo </span>customer-project
   <span class="Comment"> # different mailing list</span>
<span class="Statement">    config </span><span class="Identifier">hooks.mailinglist </span>= announce@customer.tld
</pre>
<p>The &quot;delete config variable&quot; syntax can also be used, if you wish:</p>
<pre style="font-family: 'Andale mono',monospace; padding: 4px; color: #ffffff; background-color: #000000;">
<span class="Type">repo </span>secret    <span class="Comment"> # no emails for this one please</span>
<span class="Statement">    config </span><span class="Identifier">hooks.mailinglist </span>= <span class="Constant">&quot;&quot;</span>
<span class="Statement">    config </span><span class="Identifier">hooks.emailprefix </span>= <span class="Constant">&quot;&quot;</span>
</pre>
<p>As you can see, the general idea is to place the most generic ones (<code>repo @all</code>, or repo regex like <code>repo foo.*</code>) first, and place more specific ones later to override the generic settings.</p>
<h1 id="unsafe-patt"><span class="header-section-number">5</span> compensating for UNSAFE_PATT</h1>
<p>An important feature in gitolite is that you can share the admin load with more people, <strong>without</strong> having to give all of them shell access on the server. Thus there are some restrictions designed to prevent someone who can push the gitolite-admin repo, from somehow managing to run arbitrary commands on the server.</p>
<p>This section is about one of these restrictions.</p>
<p>Gitolite, by default, does not allow the following characters in the value of a config variable: <code>` ~ # $ &amp; ( ) | ; &lt; &gt;</code>. This is due to unspecified paranoia; see <a href="https://groups.google.com/d/topic/gitolite/9WNsA-Axmg4/discussion">this discussion</a> for some context. This restriction is enforced by a regex called <code>UNSAFE_PATT</code>, whose default value is <code>[`~#\$\&amp;()|;&lt;&gt;]</code>.</p>
<p>But let's say you need to do this, which fails due to the semicolon.</p>
<pre style="font-family: 'Andale mono',monospace; padding: 4px; color: #ffffff; background-color: #000000;">
<span class="Statement">config </span><span class="Identifier">hooks.showrev </span>= <span class="Constant">&quot;git show -C %s; echo&quot;</span>
</pre>
<p>There are two ways to fix this.</p>
<p><strong>If all your admins already have shell access</strong>, you can override this by placing a modified version in the rc file. For our example, you'd just put the following line at the <strong>very end</strong> of your rc file, just before the <code>1;</code> line (notice there is no semicolon in the regex here):</p>
<pre><code>$UNSAFE_PATT          = qr([`~#\$\&amp;()|&lt;&gt;]);</code></pre>
<p>Similarly, you can remove other characters from that regex (to allow those characters in your config values).</p>
<p><strong>If all your admins do not have shell access</strong>, you need a more fine-grained method:</p>
<ul>
<li><p>In the rc file, add the following within the '%RC' hash (for example, just after the UMASK line would do fine):</p>
<pre><code>SAFE_CONFIG =&gt; {
    SHOWREV         =&gt;  &quot;git show -C %s; echo&quot;
},</code></pre></li>
<li><p>In your gitolite.conf file, add this instead of the line we saw earlier:</p></li>
</ul>
<pre style="font-family: 'Andale mono',monospace; padding: 4px; color: #ffffff; background-color: #000000;">
<span class="Statement">    config </span><span class="Identifier">hooks.showrev </span>= %SHOWREV
</pre>
<p>This mechanism allows you to add any number of <strong>specific</strong> violations to the <code>UNSAFE_PATT</code> rule instead of denaturing the regex itself and potentially allowing something that could be (ab)used by a repo admin to obtain shell access at some later point in time.</p>
<p>A similar problem arises with email addresses, which contain the <code>&lt;</code> and <code>&gt;</code> characters. Here's how to deal with that easily:</p>
<ul>
<li><p>In the rc file:</p>
<pre><code>SAFE_CONFIG =&gt; {
    LT              =&gt;  '&lt;',
    GT              =&gt;  '&gt;',
},</code></pre></li>
<li><p>In the gitolite.conf file:</p></li>
</ul>
<pre style="font-family: 'Andale mono',monospace; padding: 4px; color: #ffffff; background-color: #000000;">
<span class="Statement">    config </span><span class="Identifier">hooks.mailinglist </span>= <span class="Constant">&quot;Sitaram Chamarty %LTsitaramc@gmail.com%GT&quot;</span>
</pre>
<p>Admittedly, that looks a wee bit ugly, but it gets the job done without having to remove angle brackets from UNSAFE_PATT.</p>
</body>
</html>
