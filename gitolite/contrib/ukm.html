
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="sskm.html">
      
      
        <link rel="next" href="README-emacs.html">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.18">
    
    
      
        <title>User key management - Gitolite</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.7e37652d.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
        <script src="https://unpkg.com/iframe-worker/shim"></script>
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../css/gitolite.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#user-key-management" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../index.html" title="Gitolite" class="md-header__button md-logo" aria-label="Gitolite" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Gitolite
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              User key management
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../index.html" title="Gitolite" class="md-nav__button md-logo" aria-label="Gitolite" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Gitolite
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    what/why
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            what/why
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../overview.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../concepts.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    concepts, conventions, terminology
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    install and setup
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            install and setup
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../quick_install.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    (unix/ssh experts) quick install and setup
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../install.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    normal ssh mode install and setup
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../fool_proof_setup.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    (if all else fails) fool-proof, step-by-step, install and setup
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../http.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    HTTP mode install
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../migr.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    migrating from v2
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    use
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            use
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1" >
        
          
          <label class="md-nav__link" for="__nav_4_1" id="__nav_4_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    basic
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1">
            <span class="md-nav__icon md-icon"></span>
            basic
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../basic-admin.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    basic administration
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../conf.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    the "conf" file (part 1)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../conf-2.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    the "conf" file (part 2)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../rc.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    the "rc" file
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../user.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    your users' view
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_2" >
        
          
          <label class="md-nav__link" for="__nav_4_2" id="__nav_4_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    advanced
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_2">
            <span class="md-nav__icon md-icon"></span>
            advanced
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../git-config.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    setting git-config values
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../options.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    gitolite options
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../wild.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ad hoc user-created ("wild") repos
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../templates.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    using templates
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../vref.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    virtual refs (part 1)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../vref-2.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    virtual refs (part 2)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../deleg.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    delegation of admin duties
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../gitweb-daemon.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    gitweb and git-daemon
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../mirroring.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    mirroring
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_3" >
        
          
          <label class="md-nav__link" for="__nav_4_3" id="__nav_4_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    customise
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_3">
            <span class="md-nav__icon md-icon"></span>
            customise
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../non-core.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    core and "non-core" gitolite
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dev-notes.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    writing your own non-core code
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../triggers.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    gitolite triggers
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../list-non-core.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    list of non-core programs shipped with gitolite
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cookbook.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    (quick! how do I...) the cookbook
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    HELP!
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            HELP!
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../emergencies.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    emergency!!
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2" >
        
          
          <label class="md-nav__link" for="__nav_5_2" id="__nav_5_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    ssh
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2">
            <span class="md-nav__icon md-icon"></span>
            ssh
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ssh.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ssh
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../glssh.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    how gitolite uses ssh
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../sts.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ssh troubleshooting
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../regex.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    regular expressions
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" checked>
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    other docs
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            other docs
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../odds-and-ends.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    miscellaneous features
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../locking.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    locking binary files
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../testing.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    testing gitolite
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../package.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    packaging gitolite
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../gitolite-and-ssh-certs.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    gitolite and ssh certs
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_6" >
        
          
          <label class="md-nav__link" for="__nav_6_6" id="__nav_6_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    more about gitolite
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_6">
            <span class="md-nav__icon md-icon"></span>
            more about gitolite
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../files.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    gitolite files & directories
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../rc-33.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    the 3.3 format rc file
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../perf.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    performance
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../internals.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    internals
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_7" checked>
        
          
          <label class="md-nav__link" for="__nav_6_7" id="__nav_6_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    contrib
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_7_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_6_7">
            <span class="md-nav__icon md-icon"></span>
            contrib
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="ssh-and-http.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Using both ssh and http
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="putty.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Putty and Msysgit
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="sskm.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Self-service key management
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    User key management
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="ukm.html" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    User key management
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#important-warning" class="md-nav__link">
    <span class="md-ellipsis">
      Important Warning!
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#general-note" class="md-nav__link">
    <span class="md-ellipsis">
      General note
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#who-might-be-interested" class="md-nav__link">
    <span class="md-ellipsis">
      Who might be interested?
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Who might be interested?">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#the-gitolite-admin" class="md-nav__link">
    <span class="md-ellipsis">
      The gitolite admin
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#users-that-want-more-control-over-who-can-access-their-repositories" class="md-nav__link">
    <span class="md-ellipsis">
      Users that want more control over who can access their repositories
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#users-that-want-to-manage-multiple-keys" class="md-nav__link">
    <span class="md-ellipsis">
      Users that want to manage multiple keys
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-to-enable-user-key-management" class="md-nav__link">
    <span class="md-ellipsis">
      How to enable user key management?
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-to-configure-user-key-management-and-who-can-use-it" class="md-nav__link">
    <span class="md-ellipsis">
      How to configure user key management and who can use it?
    </span>
  </a>
  
    <nav class="md-nav" aria-label="How to configure user key management and who can use it?">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#super-key-managers" class="md-nav__link">
    <span class="md-ellipsis">
      Super key managers
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#guest-key-managers" class="md-nav__link">
    <span class="md-ellipsis">
      Guest key managers
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#self-key-managers" class="md-nav__link">
    <span class="md-ellipsis">
      Self key managers
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-to-use-user-key-management" class="md-nav__link">
    <span class="md-ellipsis">
      How to use user key management?
    </span>
  </a>
  
    <nav class="md-nav" aria-label="How to use user key management?">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#list-managed-keys" class="md-nav__link">
    <span class="md-ellipsis">
      List managed keys
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#add-a-new-public-key" class="md-nav__link">
    <span class="md-ellipsis">
      Add a new public key
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Add a new public key">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#add-a-new-key-as-a-super-key-manager" class="md-nav__link">
    <span class="md-ellipsis">
      Add a new key as a super key manager
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#add-a-new-key-as-a-guest-key-manager" class="md-nav__link">
    <span class="md-ellipsis">
      Add a new key as a guest key manager
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#add-a-new-key-as-a-self-key-manager" class="md-nav__link">
    <span class="md-ellipsis">
      Add a new key as a self key manager
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#delete-a-key" class="md-nav__link">
    <span class="md-ellipsis">
      Delete a key
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Delete a key">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#delete-a-guest-key" class="md-nav__link">
    <span class="md-ellipsis">
      Delete a guest key
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#delete-a-self-key" class="md-nav__link">
    <span class="md-ellipsis">
      Delete a self key
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#generic-errors" class="md-nav__link">
    <span class="md-ellipsis">
      Generic Errors
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#glossary" class="md-nav__link">
    <span class="md-ellipsis">
      Glossary
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#security-note" class="md-nav__link">
    <span class="md-ellipsis">
      Security note
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#important-notes-for-the-admin" class="md-nav__link">
    <span class="md-ellipsis">
      Important notes for the admin
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ideas" class="md-nav__link">
    <span class="md-ellipsis">
      Ideas
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="README-emacs.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Emacs major mode
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../no-way.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    no way!
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#important-warning" class="md-nav__link">
    <span class="md-ellipsis">
      Important Warning!
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#general-note" class="md-nav__link">
    <span class="md-ellipsis">
      General note
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#who-might-be-interested" class="md-nav__link">
    <span class="md-ellipsis">
      Who might be interested?
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Who might be interested?">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#the-gitolite-admin" class="md-nav__link">
    <span class="md-ellipsis">
      The gitolite admin
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#users-that-want-more-control-over-who-can-access-their-repositories" class="md-nav__link">
    <span class="md-ellipsis">
      Users that want more control over who can access their repositories
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#users-that-want-to-manage-multiple-keys" class="md-nav__link">
    <span class="md-ellipsis">
      Users that want to manage multiple keys
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-to-enable-user-key-management" class="md-nav__link">
    <span class="md-ellipsis">
      How to enable user key management?
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-to-configure-user-key-management-and-who-can-use-it" class="md-nav__link">
    <span class="md-ellipsis">
      How to configure user key management and who can use it?
    </span>
  </a>
  
    <nav class="md-nav" aria-label="How to configure user key management and who can use it?">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#super-key-managers" class="md-nav__link">
    <span class="md-ellipsis">
      Super key managers
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#guest-key-managers" class="md-nav__link">
    <span class="md-ellipsis">
      Guest key managers
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#self-key-managers" class="md-nav__link">
    <span class="md-ellipsis">
      Self key managers
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-to-use-user-key-management" class="md-nav__link">
    <span class="md-ellipsis">
      How to use user key management?
    </span>
  </a>
  
    <nav class="md-nav" aria-label="How to use user key management?">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#list-managed-keys" class="md-nav__link">
    <span class="md-ellipsis">
      List managed keys
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#add-a-new-public-key" class="md-nav__link">
    <span class="md-ellipsis">
      Add a new public key
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Add a new public key">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#add-a-new-key-as-a-super-key-manager" class="md-nav__link">
    <span class="md-ellipsis">
      Add a new key as a super key manager
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#add-a-new-key-as-a-guest-key-manager" class="md-nav__link">
    <span class="md-ellipsis">
      Add a new key as a guest key manager
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#add-a-new-key-as-a-self-key-manager" class="md-nav__link">
    <span class="md-ellipsis">
      Add a new key as a self key manager
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#delete-a-key" class="md-nav__link">
    <span class="md-ellipsis">
      Delete a key
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Delete a key">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#delete-a-guest-key" class="md-nav__link">
    <span class="md-ellipsis">
      Delete a guest key
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#delete-a-self-key" class="md-nav__link">
    <span class="md-ellipsis">
      Delete a self key
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#generic-errors" class="md-nav__link">
    <span class="md-ellipsis">
      Generic Errors
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#glossary" class="md-nav__link">
    <span class="md-ellipsis">
      Glossary
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#security-note" class="md-nav__link">
    <span class="md-ellipsis">
      Security note
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#important-notes-for-the-admin" class="md-nav__link">
    <span class="md-ellipsis">
      Important notes for the admin
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ideas" class="md-nav__link">
    <span class="md-ellipsis">
      Ideas
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="user-key-management">user key management<a class="headerlink" href="#user-key-management" title="Permanent link">#</a></h1>
<p>Copyright 2012-2013  Ralf Hemmecke <a href="&#109;&#97;&#105;&#108;&#116;&#111;&#58;&#114;&#97;&#108;&#102;&#64;&#104;&#101;&#109;&#109;&#101;&#99;&#107;&#101;&#46;&#111;&#114;&#103;">&#114;&#97;&#108;&#102;&#64;&#104;&#101;&#109;&#109;&#101;&#99;&#107;&#101;&#46;&#111;&#114;&#103;</a>.</p>
<p>Licensed under the <a href="https://creativecommons.org/licenses/by-nc-sa/3.0/">Creative Commons
Attribution-NonCommercial-ShareAlike 3.0 Unported
License</a></p>
<p>User key management allows certain users to add and remove keys.</p>
<p>The key management is done using a command called <code>ukm</code>. This command
must be enabled for remote use by both the <a href="#SYSADMIN">sysadmin</a> and the
<a href="#GA">gitolite-admin</a> (see <a href="../non-core.html#gitolite-commands">here</a> for more on this) or look
below.</p>
<hr />
<h2 id="important-warning">Important Warning!<a class="headerlink" href="#important-warning" title="Permanent link">#</a></h2>
<p>User key management undermines the fundamental principle of gitolite
(see <a href="../concepts.html#authentication-and-authorisation">authentication versus authorisation</a>) by allowing certain
users to juggle with ssh public keys. Make sure someone (sysadmin?)
can login to the server with a <strong>password</strong>, just in case something
breaks and the <code>.ssh/authorized_keys</code> file for the user running
gitolite on the server is messed up.</p>
<h2 id="general-note">General note<a class="headerlink" href="#general-note" title="Permanent link">#</a></h2>
<p>Although gitolite deals in its core only with authorisation, by
default it uses ssh as its authentication mechanism. Sure, ssh is
not at all part of gitolite and it can be replaced by other means, but
still there is a directory <code>gitolite-admin/keydir</code> that is reserved
for public ssh keys.</p>
<p>In fact, management of <a href="../basic-admin.html#addremove-users">users</a> and <a href="../basic-admin.html#multiple-keys-per-user">multiple keys</a> per
user is not actually a gitolite administration stuff. It's external to
gitolite. In a future version, <code>ukm</code> could be used as an equivalent of
the <code>keydir/</code> directory from the <code>gitolite-admin</code> repo (currently it
just manages that directory) and thus <code>ukm</code> could be seen as such an
external tool that does what its name suggests: user (key) management.</p>
<p>In the following description we assume that there is an entry like</p>
<pre><code>Host gitserver
     IdentityFile ~/.ssh/id_rsa    # choose your gitolite key here
     HostName gitolite.example.org # location where gitolite is installed
     User git                      # user that runs gitolite
</code></pre>
<p>in the client's <code>~/.ssh/config</code> file.</p>
<h2 id="who-might-be-interested">Who might be interested?<a class="headerlink" href="#who-might-be-interested" title="Permanent link">#</a></h2>
<h3 id="the-gitolite-admin">The gitolite admin<a class="headerlink" href="#the-gitolite-admin" title="Permanent link">#</a></h3>
<p>Adding a new public key to the system means to copy the key into
<code>gitolite/keydir</code> commit and push.</p>
<p>With <code>ukm</code> it would be</p>
<pre><code>cat FOO.PUB | ssh gitserver ukm add KEYID
</code></pre>
<p>This would be a setup where only the <a href="#GA">gitolite administrator</a>
uses <code>ukm</code>. Not a big benefit, but <code>ukm</code> prevents adding identical
keys under different userids. This consistency check might be an
advantage. Furthermore, <code>ukm</code> does not allow the
<a href="#GA">gitolite administrator</a> to remove his/her last, i.e., it
prevents the administrator from locking him-/herself out of the
system. (Note, we assume that the <a href="#GA">gitolite administrator</a> has no
shell access to the server; only the <a href="#SYSADMIN">sysadmin</a> has shell
access.)</p>
<h3 id="users-that-want-more-control-over-who-can-access-their-repositories">Users that want more control over who can access their repositories<a class="headerlink" href="#users-that-want-more-control-over-who-can-access-their-repositories" title="Permanent link">#</a></h3>
<p>Suppose the <a href="#GA">gitolite administrator</a> of a research institute has
set up gitolite to provide <a href="../wild.html">wild repositories</a> for example with
a <code>gitolite.conf</code> like this.</p>
<pre><code>repo gitolite-admin
    RW+ = gitadmin

# These people are allowed to create wild repositories.
@creators = alice bob ...

# wildcard repositories for the users
repo CREATOR/..*
    C   = @creators
    RW+ = CREATOR
    RW  = WRITERS
    R   = READERS
</code></pre>
<p>Researchers Alice and Bob want to write an article together. Alice
creates a wild repository <code>alice/article</code> and adds Bob via the
<a href="../user.html#setget-additional-permissions-for-repos-you-created">perms</a> command to the WRITERS of her repository. After a while they
realize that Otto from another institute would be a reasonable third
author. However, if they cannot give him write access to the
repository, they would have to exchange the article via email. Back to
the stone age? Better, Alice asks Otto to send her his public ssh key.
Alice then forwards that key to the <a href="#GA">gitolite administrator</a> and
asks him to include that key into the system. (Hopefully, all that
didn't happen on a holiday or on the weekend.) After 3 days the
gitolite administrater finds some time. Since he doesn't know Otto, he
simply trusts Alice and adds the public key into the system.</p>
<p>With <code>ukm</code> Alice can save bothering the gitolite administrator and is
perhaps even faster in saying:</p>
<pre><code>cat otto.pub | ssh gitserver ukm add otto@other.institute.edu
ssh gitserver perms alice/article + WRITERS otto@other.institute.edu
</code></pre>
<p>The effect would be the same.</p>
<h3 id="users-that-want-to-manage-multiple-keys">Users that want to manage multiple keys<a class="headerlink" href="#users-that-want-to-manage-multiple-keys" title="Permanent link">#</a></h3>
<p>Suppose, you have different computers and a different ssh key for each
of them. You would like to tell gitolite that all these different keys
belong to just one gitolite identity.</p>
<p>Your <a href="#GA">gitolite administrator</a> creates your gitolite identity with
one of your keys as your initial key. This key can only be managed by
the gitolite administrator, not by you. It basically determines under
which name you are known to gitolite.</p>
<p>You can add new keys to this identity and remove them at your will.</p>
<h2 id="how-to-enable-user-key-management">How to enable user key management?<a class="headerlink" href="#how-to-enable-user-key-management" title="Permanent link">#</a></h2>
<p>The <code>ukm</code> command is contributed code and lives under
<code>contrib/commands/ukm</code> in the gitolite source tree.
A <a href="#SYSADMIN">sysadmin</a> of the gitserver has to copy or link this
script to the right location.</p>
<pre><code>cd src/commands
ln -s ../../contrib/commands/ukm .
</code></pre>
<p>Furthermore, a <a href="#SYSADMIN">sysadmin</a> must add the string <code>'ukm'</code> to
the <code>ENABLE</code> array, i.e.,</p>
<pre><code>ENABLE =&gt; [ ..., 'ukm', ... ],
</code></pre>
<p>in <a href="../rc.html">.gitolite.rc</a>. (That's the preferred way for gitolite starting
with version v3.4.)</p>
<p>Instead of the above (in particular in gitolite v3.0-v3.3), add
<code>'ukm' =&gt; 1</code> to the <code>COMMANDS</code> hash.</p>
<pre><code>COMMANDS =&gt; {..., 'ukm' =&gt; 1, ... },
</code></pre>
<h2 id="how-to-configure-user-key-management-and-who-can-use-it">How to configure user key management and who can use it?<a class="headerlink" href="#how-to-configure-user-key-management-and-who-can-use-it" title="Permanent link">#</a></h2>
<p>As described above there are three main use cases for <code>ukm</code>. Each of
them requires different values in the respective config files.</p>
<p>There are two files where <code>ukm</code> must be configured.</p>
<ul>
<li><a href="../rc.html">.gitolite.rc</a> (managed by a <a href="#SYSADMIN">sysadmin</a> of the gitserver)</li>
<li><code>gitolite-admin/conf/gitolite.conf</code> (managed by a
    <a href="#GA">gitolite administrator</a>)</li>
</ul>
<p>Besides <a href="#SYSADMIN">sysadmin</a> and <a href="#GA">gitolite administrator</a>, <code>ukm</code>
knows 3 roles.</p>
<ul>
<li><a href="#SKM">super key manager</a></li>
<li><a href="#GKM">guest key manager</a></li>
<li><a href="#EKM">self key manager</a></li>
</ul>
<h3 id="super-key-managers"><a href="#SKM">Super key managers</a><a class="headerlink" href="#super-key-managers" title="Permanent link">#</a></h3>
<p>When <code>ukm</code> is enabled, nothing else must be configured.</p>
<h3 id="guest-key-managers"><a href="#GKM">Guest key managers</a><a class="headerlink" href="#guest-key-managers" title="Permanent link">#</a></h3>
<p>The <a href="#GA">gitolite administrator</a> defines guest key managers by
creating a group <code>@guest-key-managers</code> in
<code>gitolite-admin/conf/gitolite.conf</code> and adding (trusted) users to this
group.</p>
<p><strong>WARNING</strong>: If the gitolite administrator includes <code>@all</code> into this
list, it allows guests to add new public keys. If, additionally, there
is <code>@creators=@all</code>, it basically allows the initial guest key
managers to start a hierarchy of new users with the same rights as the
initial users.</p>
<p>The <a href="#SYSADMIN">system administrator</a> must configure <code>ukm</code> for
<a href="#GKM">guest key managers</a> in <a href="../rc.html">.gitolite.rc</a> by adding something
like</p>
<pre><code>UKM_CONFIG =&gt; { FORBIDDEN_GUEST_PATTERN =&gt; qr(FORBIDDEN-PATTERN), },
</code></pre>
<p>to the <code>%RC</code> hash.</p>
<p>If <code>FORBIDDEN_GUEST_PATTERN</code> is missing, it defaults to the following.</p>
<pre><code>FORBIDDEN_GUEST_PATTERN =&gt; qr(.)
</code></pre>
<p>Any <a href="#KEYID">KEYID</a> that matches this pattern is rejected, i.e., the
default value basically allows only the <a href="#SKM">super key managers</a> to
add/del keys.</p>
<p>If <code>ukm</code> is supposed to work for <a href="#GKM">guest key managers</a>,
<code>FORBIDDEN_GUEST_PATTERN</code> must be set to some reasonable value.</p>
<p>If your company has email addresses of the form
<code>first.last@company.com</code> you might want to write something like this</p>
<pre><code>UKM_CONFIG =&gt; { FORBIDDEN_GUEST_PATTERN =&gt; qr(@company.com$) },
</code></pre>
<p>which would only allow <a href="#KEYID">KEYIDs</a> in the form of email addresses
that do not come from your company.</p>
<p><font color="red"><strong>For the very brave only!!!</strong></font></p>
<p>The variable <code>REQUIRED_GUEST_PATTERN</code> is optional. It is strongly
discouraged to set it. However, if you know, what you are doing, it
allows for a bit more flexibility.</p>
<p><font color="red"><strong>Don't complain if you modify the default
value!!!</strong></font></p>
<p><code>REQUIRED_GUEST_PATTERN</code> defaults to a regular expression that only
allows <a href="#KEYID">KEYIDs</a> in the form of email addresses (see the source
code if you want to see this regular expression).</p>
<p>You can write</p>
<pre><code>UKM_CONFIG =&gt; {
    REQUIRED_GUEST_PATTERN  =&gt; qr(REQUIRED-PATTERN),
    FORBIDDEN_GUEST_PATTERN =&gt; qr(FORBIDDEN-PATTERN),
},
</code></pre>
<p>with the meaning that the <a href="#KEYID">KEYID</a> <strong>must match</strong></p>
<pre><code>qr(^(REQUIRED-PATTERN)$)
</code></pre>
<p>(note that <code>^</code> and <code>$</code> are automatically added to the pattern) and
<strong>must not match</strong></p>
<pre><code>qr(FORBIDDEN-PATTERN)
</code></pre>
<p>in order for <code>ukm</code> to proceed with this <a href="#KEYID">KEYID</a> for a
<a href="#GKM">guest key manager</a>.</p>
<p>Gitolite's namespace for <a href="#USERID">USERIDs</a> is flat. The
<code>REQUIRED_GUEST_PATTERN</code> and <code>FORBIDDEN_GUEST_PATTERN</code> serve two
purposes.</p>
<ol>
<li>
<p>Restrict permissions for what <a href="#GKM">guest key managers</a> can
     do.</p>
</li>
<li>
<p>Patterns that cannot be used for guests can still be used by
     <a href="#SKM">super key managers</a>. In other words, those patterns are
     reserved for in-house <a href="#USERID">USERIDs</a>.</p>
</li>
</ol>
<h3 id="self-key-managers"><a href="#EKM">Self key managers</a><a class="headerlink" href="#self-key-managers" title="Permanent link">#</a></h3>
<p>The <a href="#GA">gitolite administrator</a> defines <a href="#EKM">self key managers</a> by
creating a group <code>@self-key-managers</code> in
<code>gitolite-admin/conf/gitolite.conf</code> and adding (trusted) users to this
group.</p>
<p><strong>WARNING</strong>: A <a href="#GA">gitolite administrator</a> shouldn't include <code>@all</code>
into this list. If guest key management is enabled, then also guests
would be allowed to add their own keys. Since
<a href="#GKM">guest key managers</a> would have no access to those keys, only
<a href="#GA">gitolite administrators</a> would be able to remove those
additional keys. In fact, <code>ukm</code> was designed to allow only <strong>one</strong> key
per guest. Don't complain, if you enable a setup where guests can have
multiple keys. It's a security issue. (Suppose Alice has added a guest
<code>foo@example.org</code> and MrBad generates a new ssh key and adds it under
<code>foo@example.org@attacker</code> to the list of his guests. That would give
MrBad all the permissions that <code>foo@example.org</code> has.)</p>
<p>The <a href="#SYSADMIN">system administrator</a> must enable <code>ukm</code> for
<a href="#EKM">self key managers</a> in <a href="../rc.html">.gitolite.rc</a> by adding</p>
<pre><code>UKM_CONGFIG =&gt; { SELFKEY_MANAGEMENT =&gt; 1, },
</code></pre>
<p>to the <code>%RC</code> hash.</p>
<p>Since by design self keys start with an <code>@</code> sign, and thus cannot
conflict with guest keys (which are not allowed to start with an <code>@</code>),
there is no problem to enable self key and guest key management at the
same time.</p>
<pre><code>UKM_CONFIG =&gt; {
    FORBIDDEN_GUEST_PATTERN =&gt; qr(FORBIDDEN-PATTERN),
    SELFKEY_MANAGEMENT =&gt; 1,
},
</code></pre>
<h2 id="how-to-use-user-key-management">How to use user key management?<a class="headerlink" href="#how-to-use-user-key-management" title="Permanent link">#</a></h2>
<p>There are three subcommands of <code>ukm</code>, namely <code>list</code> (the default),<code>add</code>, and <code>del</code>.</p>
<p>Depending on whether or not the respective <a href="#KEYID">KEYID</a> starts with
an <code>@</code> sign, <code>ukm</code> distinguishes between guest and self key management.
Self keys start with <code>@</code> and are followed by letters and/or digits.</p>
<p>For <a href="#SKM">super key managers</a> there is not such a distinction.
Rather, the <a href="#KEYID">KEYID</a> is the full path of the actual public key
file relative to <code>gitolite-admin/keydir/</code> with the <code>.pub</code> file
extension removed.</p>
<p>By convention, take as guest key the proper email address of the
guest. That not only makes for a unique ID, it also gives you a hint
to whom this key belongs.</p>
<h3 id="list-managed-keys">List managed keys<a class="headerlink" href="#list-managed-keys" title="Permanent link">#</a></h3>
<p>A <a href="#GKM">guest key manager</a> and <a href="#EKM">self key manager</a> can list all
their personally managed keys via:</p>
<pre><code>ssh gitserver ukm
</code></pre>
<p>or</p>
<pre><code>ssh gitserver ukm list
</code></pre>
<p>If this command is issued by a <a href="#SKM">super key manager</a>, it lists all
keys that are stored under <code>keydir/</code>.</p>
<p>The result will show the fingerprints of the keys, the corresponding
<a href="#USERID">USERID</a> and the <a href="#KEYID">KEYID</a> by which one can refer to
the key on the commandline.</p>
<h3 id="add-a-new-public-key">Add a new public key<a class="headerlink" href="#add-a-new-public-key" title="Permanent link">#</a></h3>
<h4 id="add-a-new-key-as-a-super-key-manager">Add a new key as a super key manager<a class="headerlink" href="#add-a-new-key-as-a-super-key-manager" title="Permanent link">#</a></h4>
<p>A <a href="#SKM">super key manager</a> can nearly add any key, but <code>ukm</code> does not
accept a different key, i.e., different fingerprint, for the same
<a href="#KEYID">KEYID</a>. Also a double dot is not allowed in the
<a href="#KEYID">KEYID</a>.</p>
<h4 id="add-a-new-key-as-a-guest-key-manager">Add a new key as a guest key manager<a class="headerlink" href="#add-a-new-key-as-a-guest-key-manager" title="Permanent link">#</a></h4>
<p>The command for this is:</p>
<pre><code>cat foo.pub | ssh gitserver ukm add foo@example.com
</code></pre>
<p>There are several situations when the above command fails, i.e.,
rejects to add the key.</p>
<ul>
<li>
<p>The <a href="#KEYID">KEYID</a> <code>foo@example.com</code> does not match the pattern
    given by <code>REQUIRED_GUEST_PATTERN</code> in <code>.gitolite.rc</code>.</p>
</li>
<li>
<p>The <a href="#KEYID">KEYID</a> <code>foo@example.com</code> matches the pattern given by
    <code>FORBIDDEN_GUEST_PATTERN</code> in <code>.gitolite.rc</code>.</p>
</li>
<li>
<p>The public key <code>foo.pub</code> is already known to the system and does
    not belong to the <a href="#USERID">USERID</a> <code>foo@example.com</code>.</p>
</li>
<li>
<p>The <a href="#KEYID">KEYID</a> <code>foo@example.com</code> is already in use and it
    corresponds to a key with another public key. In other words,
    <code>ukm</code> will not simply override a key. One has to delete the old
    key first and then add a new one.</p>
</li>
<li>
<p>The <a href="#KEYID">KEYID</a> contains a <code>/</code> character or two <code>@</code>
    characters, i.e., guest key managers are not allowed to add
    <a href="#MULTIKEY">multiple keys</a> for one user.</p>
</li>
</ul>
<h4 id="add-a-new-key-as-a-self-key-manager">Add a new key as a self key manager<a class="headerlink" href="#add-a-new-key-as-a-self-key-manager" title="Permanent link">#</a></h4>
<p>Adding a self key is a bit more complicated, since the user must
confirm that he/she is in possession of the corresponding private key.
The command sequence is as follows. Note that the second call of ssh
is done with the key <code>foo</code> and not the default ssh key.</p>
<pre><code>cat foo.pub | ssh gitserver ukm add @two &gt; session
cat session | ssh -i foo gitserver ukm
</code></pre>
<p>If you don't want to create an intermediate file call it like this:</p>
<pre><code>cat foo.pub | ssh gitserver ukm add @two | (sleep 2; ssh -i foo gitserver ukm)
</code></pre>
<p>Make sure that the second ssh call only happens after the fist one has
done its job. Otherwise you might be asked for a password of the <code>git</code>
user on the <code>gitserver</code>.</p>
<p>After successfully completing the first ssh call, the new key is
scheduled for addition and a session key is returned on stdin. That
session key must be used to confirm the addition of the new public key
as shown above.</p>
<h3 id="delete-a-key">Delete a key<a class="headerlink" href="#delete-a-key" title="Permanent link">#</a></h3>
<p>A <a href="#SKM">super key manager</a> can delete any key by simply giving its
<a href="#KEYID">KEYID</a> in a command like this</p>
<pre><code>ssh gitserver ukm del some/dir/foo@example.com
</code></pre>
<p>The <code>ukm</code> command, however, prevents a <a href="#SKM">super key manager</a> from
removing his/her last key.</p>
<h4 id="delete-a-guest-key">Delete a guest key<a class="headerlink" href="#delete-a-guest-key" title="Permanent link">#</a></h4>
<p>The command for this is:</p>
<pre><code>ssh gitserver ukm del foo@example.com
</code></pre>
<p>If the given <a href="#KEYID">KEYID</a> is not among the managed keys of the user
who issues the <code>del</code> command, the command will fail.</p>
<p><strong>IMPORTANT!</strong> You should not forget to remove from all of your
repositories all the permissions you gave to <code>foo@example.com</code>,
because this key might still be managed by another
<a href="#GKM">guest key manager</a>.</p>
<p>You might want to run</p>
<pre><code>ssh gitserver info -lc \
| perl -e 'chomp($u=&lt;&gt;);$u=~s/hello //;$u=~s/,.*$//;' \
       -e 'while(&lt;&gt;){if(/\s(\S+)\s+$u$/){print "$1\n"}}' \
| while read r; do ssh gitserver perms $r - WRITERS foo@example.com; done
</code></pre>
<p>Repeat this for other roles such as <code>READERS</code> instead of <code>WRITERS</code>.</p>
<h4 id="delete-a-self-key">Delete a self key<a class="headerlink" href="#delete-a-self-key" title="Permanent link">#</a></h4>
<p>The command for this is:</p>
<pre><code>ssh gitserver ukm del @two
ssh gitserver ukm del @two
</code></pre>
<p>Yes, you have to give that command twice. The first call will bring
the key <code>@two</code> into a "pending-del" state. The second time, the
command will only delete the key <code>@two</code>, if the login was <strong>not</strong> done
with exactly that key. If logging in with the key corresponding to
<code>@two</code>, it will bring back the <code>@two</code> key from its "pending-del" state
to a non-pending state.</p>
<p><strong>Note:</strong> This safety net is not absolutely necessary, since a
<a href="#EKM">self key manager</a> is not allowed to delete his/her initial key
(added by the <a href="#GA">gitolite administrator</a>). The command <code>ukm</code> wants
to make sure that the user still has a key that can be used for
login. (Think about having lost the passphrase for the initial key. --
Maybe this over complication will be simplified in the future. Losing
a passphrase is not a good excuse and should result in removal of the
corresponding key from the system, i.e., contacting the
<a href="#GA">gitolite administrator</a>.)</p>
<h2 id="generic-errors">Generic Errors<a class="headerlink" href="#generic-errors" title="Permanent link">#</a></h2>
<p>Key management is done via creating a temporary clone of the
<code>gitolite-admin</code> repository, changing, committing, and pushing back.
In cases where two people are trying to modify the <code>gitolite-admin</code>
repository at the same time, one of the push commands will most
probably fail. Then simply redo the command after a while.</p>
<h2 id="glossary">Glossary<a class="headerlink" href="#glossary" title="Permanent link">#</a></h2>
<ul>
<li>
<p><strong>sysadmin</strong><a id="SYSADMIN"></a>:
  A person who is able to edit the <a href="../rc.html">.gitolite.rc</a> file on
  the server machine.</p>
</li>
<li>
<p><strong>gitolite administrator</strong><a id="GA"></a>:
  A user with write access to the <code>gitolite-admin</code> repositoriy.</p>
</li>
<li>
<p><strong>super key manager</strong><a id="SKM"></a>:
  A user who has write access to the <code>keydir/</code> inside the
  <code>gitolite-admin</code> repository.
  A <a href="#GA">gitolite administrator</a> is always a super key manager.</p>
</li>
</ul>
<p>Super key managers have no restriction on how <a href="#KEYID">KEYIDs</a> must
  look like. They can do (nearly) everything inside <code>keydir/</code> that a
  <a href="#GA">gitolite administrator</a> can do when pushing to the
  <code>gitolite-admin</code> repository directly.</p>
<ul>
<li><strong>guest key manager</strong><a id="GKM"></a>:
  A user who is a member of the <code>@guest-key-managers</code> group.</li>
</ul>
<p>A guest key manager can manage a set of guest keys.</p>
<ul>
<li><strong>self key manager</strong><a id="EKM"></a>:
  A user who is a member of the <code>@self-key-managers</code> group.</li>
</ul>
<p>A self key manager can manage a set of his/her own keys.</p>
<ul>
<li><strong>KEYID</strong><a id="KEYID"></a>:
  an identifier for a key given on the command line</li>
</ul>
<p>The KEYID is normalized to lowercase letters.</p>
<p>If the script is called by one of the super key managers, then the
  KEYID is the path to the pubkey file relative to the <code>keydir/</code>
  without the <code>.pub</code> extension.</p>
<p>If called by a guest key manager it's an email address and if called
  by a self key manager, it's an alphanumeric identifier with an <code>@</code>
  prepended.</p>
<ul>
<li><strong>USERID</strong><a id="USERID"></a>:
  The <a href="#KEYID">KEYID</a> given on the command line will be translated
  into a USERID which is used inside <code>conf/gitolite.conf</code> or for the
  <a href="../user.html#setget-additional-permissions-for-repos-you-created">perms</a> <a href="../non-core.html#gitolite-commands">command</a> of gitolite.</li>
</ul>
<h2 id="security-note">Security note<a class="headerlink" href="#security-note" title="Permanent link">#</a></h2>
<p><a id="MULTIKEY" />
<a href="#SKM">Super key managers</a> can basically add any key.
<a href="#GKM">Guest key managers</a> are not allowed to add
<a href="../basic-admin.html#multiple-keys-per-user">multiple keys</a> and this restriction is hardcoded.</p>
<p>Suppose Alice adds <code>bob.pub</code> as <code>bob@example.org</code> and David adds
<code>eve.pub</code> under the keyid <code>bob@example.org@foo</code>. (Of course, only Eve
and not Bob has the private key correspoinding to <code>eve.pub</code>.) This
basically gives Eve the same rights as Bob.</p>
<h2 id="important-notes-for-the-admin">Important notes for the admin<a class="headerlink" href="#important-notes-for-the-admin" title="Permanent link">#</a></h2>
<p>Note that <code>ukm</code> clones, changes, and pushes back the <code>gitolite-admin</code>
repo. This means, even if you are the only administrator, you should
never <code>git push -f</code>, because that might override something <code>ukm</code>
did.</p>
<h2 id="ideas">Ideas<a class="headerlink" href="#ideas" title="Permanent link">#</a></h2>
<p>The command <code>ukm</code> has been created with also having the
<code>keysubdirs-as-groups</code> <a href="../non-core.html">syntactic sugar</a> in mind. If a
<a href="#SKM">super key manager</a> manages the respective keys in
sub-directories with names <code>guest-key-managers/</code> and
<code>self-key-managers/</code>, respectively, he/she can use the <code>ukm</code> command
to control who is allowed to manage keys.</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="sskm.html" class="md-footer__link md-footer__link--prev" aria-label="Previous: Self-service key management">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                Self-service key management
              </div>
            </div>
          </a>
        
        
          
          <a href="README-emacs.html" class="md-footer__link md-footer__link--next" aria-label="Next: Emacs major mode">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                Emacs major mode
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "..", "features": ["navigation.footer", "search.suggest", "search.highlight"], "search": "../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.92b07e13.min.js"></script>
      
    
  </body>
</html>