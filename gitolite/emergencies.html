<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="pandoc" />
  <title>help for emergencies</title>
  <style type="text/css">code{white-space: pre;}</style>
  <style>
      body        { background: #fff; text-color: #000; margin-left:  40px;   font-size:  0.9em;  font-family: arial; }
  
      code        { font-size:    1.1em;  background:  #ddf; text-color: #000; }
      pre         { margin-left:  2em;    background:  #ddf; text-color: #000; }
      pre code    { font-size:    1.1em;  background:  #ddf; text-color: #000; }
  
      td          { vertical-align: top }
  
      .red        { color: red }
      .blue       { color: blue }
      .green      { color: green }
      .gray       { color: gray }
      .pink       { color: pink }
  
      .box        { background-color:#e0e0e0 }
      .bg-red     { background-color:#ffe0e0 }
      .bg-green   { background-color:#e0ffe0 }
      .bg-blue    { background-color:#e0e0ff }
  
      /* couldn't resist the name! */
      .wd40       { width: 40% !important }
  
      .box-l      { float: left;  padding: 0px 0.5em; background-color: #e0e0e0; width:25%; margin-right: 4px; }
      .box-r      { float: right; padding: 0px 0.5em; background-color: #e0e0e0; width:25%; margin-left:  4px; }
  
      .fl-l       { float: left;  padding: 0px 0.5em;                                       margin-right: 4px; }
      .fl-r       { float: right; padding: 0px 0.5em;                                       margin-left:  4px; }
  
      .sidebar {
          margin-left: 4px;
          width: 25%;
          float: right;
          border: 4px solid #fff;
      }
  
  </style>
  <style>
      h1          { background: #ffb; text-color: #000; margin-left: -30px;   border-top:    5px  solid #ccc; }
      h2          { background: #ffb; text-color: #000; margin-left: -20px;   border-top:    3px  solid #ddd; }
      h3          { background: #ffb; text-color: #000; margin-left: -10px; }
      h4          { background: #ffb; text-color: #000; }
  </style>
</head>
<body>
<!--
    generated by gvim then munged a fair bit.  The following command
        vim -E -c "TOhtml" -c "w" -c 'qa!' \-\- conf/gitolite.conf
    may or may not produce the same thing
-->

<style type="text/css">
<!--
.WarningMsg { color: #ff0000; }
.Constant { color: #ffa0a0; }
.Statement { color: #ffff60; font-weight: bold; }
.PreProc { color: #ff80ff; }
.LineNr { color: #ffff00; }
.Comment { color: #80a0ff; }
.Type { color: #60ff60; font-weight: bold; }
.Special { color: #ffa500; }
.Identifier { color: #40ffff; }
.Error { color: #ffffff; background-color: #ff0000; padding-bottom: 1px; }
.Todo { color: #0000ff; background-color: #ffff00; padding-bottom: 1px; }
-->
</style>
<div id="header">
<h1 class="title">help for emergencies</h1>
</div>
<div id="TOC">
<ul>
<li><a href="#installsetup-issues"><span class="toc-section-number">1</span> install/setup issues</a></li>
<li><a href="#lost-key"><span class="toc-section-number">2</span> lost admin key/access</a></li>
<li><a href="#bypass"><span class="toc-section-number">3</span> bypassing gitolite</a></li>
<li><a href="#botch"><span class="toc-section-number">4</span> botched something?</a><ul>
<li><a href="#fixing-botched-repos"><span class="toc-section-number">4.1</span> fixing botched repos</a></li>
<li><a href="#clean"><span class="toc-section-number">4.2</span> cleaning out a botched install</a></li>
</ul></li>
<li><a href="#ce"><span class="toc-section-number">5</span> common errors</a></li>
<li><a href="#ue"><span class="toc-section-number">6</span> uncommon errors</a></li>
<li><a href="#nonstd"><span class="toc-section-number">7</span> non-standard configs that'll trip you up</a></li>
<li><a href="#ngp"><span class="toc-section-number">8</span> things that are not gitolite problems</a></li>
</ul>
</div>
<script type="text/javascript">
<!--
    function hide_show(id) {
        var e = document.getElementById(id);
        if(e == null)
            return;
        if(e.style.display != 'none')
            e.style.display = 'none';
        else
            e.style.display = 'block';
    }

    window.onload = function() {
        var t = document.getElementById('TOC');
        var sbt = document.getElementById('SBTOC');
        var h = '<div id="PTOC">'
        var h2 = '<p><strong><span class="red">Page TOC</span></strong></p>'
        var h3 = '</div>'
        var h4 = '<div id="GTOC">'
        var h5 = '</div>'
        var hst = '<div style="background: white; color: green; border: 2px solid green"><center><font size=-1><strong>Hide/Show Table of Contents</strong><br />'
        var pd = '<a href="#" onclick="hide_show(\'PTOC\');">Page TOC</a> | '
        var gt = '<a href="#" onclick="hide_show(\'GTOC\');">Gitolite TOC</a></font></center></div>'

        if(t == null)
            sbt.innerHTML = hst + gt + h4 + sbt.innerHTML + h5;
        else {
            sbt.innerHTML = hst + pd + gt + h + h2 + t.innerHTML + h3 + h4 + sbt.innerHTML + h5;
            t.style.display = 'none';   // hide the TOC that pandoc placed
        }
    }
-->
</script>

<style>
    #PTOC ul {
        list-style: none;
        margin-left: 0;
        padding-left: 2em;
        text-indent: -2em;
        padding-bottom: 2em;
    }
    #PTOC ul li {
        padding-bottom: 10px;
    }
    #PTOC ul li ul {
        padding-bottom: 0px;
    }
    #PTOC ul li ul li {
        padding-bottom: 0px;
    }

    .sidebar-toc a:hover {
        background-color: white;
    }

    .sidebar-toc {
        margin-left: 4px;
        width: 25%;
        float: right;
        color: gray;
        background: lightgray;
        border: 4px solid #fff;
        font-size: 0.90em;
    }

    .sidebar-toc ul {
        padding-left: 2em;
    }

</style>

<div id="SBTOC" class="sidebar-toc">

<p><strong><span class="red">Gitolite TOC</span></strong></p>
<hr />
<center>
<span class="red"><strong>Background</strong></span>
</center>

<hr />
<p><a href="index.html">Main page</a></p>
<ul>
<li><a href="index.html#dl">download</a></li>
<li><a href="index.html#rtfm">documentation</a></li>
<li><a href="index.html#trouble"><strong>troubleshooting</strong></a></li>
<li><a href="index.html#contact"><strong>contact and support</strong></a></li>
<li><a href="index.html#license">license</a></li>
</ul>
<p><a href="overview.html">Overview</a></p>
<ul>
<li>what is Gitolite?</li>
<li>why might you need it?</li>
<li>how does it work?</li>
<li>who uses it?</li>
</ul>
<p><a href="concepts.html">Concepts and terminology</a></p>
<ul>
<li>authentication and authorisation</li>
<li>the &quot;hosting user&quot;</li>
<li>ssh mode and http mode</li>
<li>the special gitolite-admin repo</li>
</ul>
<p><a href="req.html">Before you start...</a></p>
<ul>
<li>your skills</li>
<li>your server</li>
<li>your and your users' clients</li>
<li><strong>cautions and caveats</strong></li>
<li><a href="req.html#trying">trying</a> out gitolite safely</li>
</ul>
<hr />
<center>
<span class="red"><strong>Basics</strong></span>
</center>

<hr />
<p><a href="install.html">install and setup</a></p>
<ul>
<li><a href="install.html#qi">quick install+setup</a> (for experts)</li>
<li>the long way around</li>
<li><a href="install.html#upgrading">upgrading</a></li>
<li><a href="install.html#moving">moving servers</a></li>
</ul>
<p><a href="basic-admin.html">Basic Administration</a></p>
<ul>
<li>clone the gitolite-admin repo</li>
<li>add/remove users</li>
<li>add/remove/rename repos</li>
<li>bringing existing repos into gitolite</li>
</ul>
<p><a href="conf.html">The conf file (<code>conf/gitolite.conf</code>)</a></p>
<ul>
<li>basic <a href="conf.html#syntax">syntax</a></li>
<li><a href="conf.html#include">include</a> files</li>
<li><a href="conf.html#groups">group definitions</a></li>
<li><a href="conf.html#rules"><strong><span class="red">access rules</span></strong></a></li>
</ul>
<p><a href="rc.html">the rc file (<code>~/.gitolite.rc</code>)</a></p>
<p><a href="user.html">Your users' view</a> of gitolite</p>
<p>Troubleshooting</p>
<ul>
<li>help for <a href="emergencies.html">emergencies</a></li>
<li>the <a href="ips.html">fool-proof install guide</a></li>
<li>the gitolite &quot;<a href="cookbook.html">cookbook</a>&quot;</li>
</ul>
<hr />
<center>
<span class="red"><strong>Advanced</strong></span>
</center>

<hr />
<p>Advanced &quot;conf file&quot; use</p>
<ul>
<li>specifying <a href="git-config.html">git-config</a> keys and values</li>
<li>gitolite <a href="options.html">options</a></li>
<li><a href="wild.html"><strong>wild repos</strong></a> (user created repos)</li>
<li><a href="vref.html">virtual refs</a></li>
<li><a href="deleg.html">delegation</a> of admin duties</li>
<li><a href="gitweb-daemon.html">gitweb and git-daemon</a></li>
</ul>
<p>Special features/setups</p>
<ul>
<li><strong><a href="mirroring.html">mirroring</a></strong></li>
<li><a href="http.html">http</a> mode</li>
<li>using a <a href="cache.html">cache</a></li>
<li>(<a href="namespaces.html">namespaces</a>)</li>
<li><a href="locking.html">locking</a> binary files</li>
<li><a href="package.html">packaging</a> gitolite</li>
</ul>
<p>Customising gitolite</p>
<ul>
<li>core and <a href="non-core.html">non-core</a> gitolite</li>
<li><a href="dev-notes.html">writing your own</a> non-core programs</li>
<li>gitolite <a href="triggers.html">triggers</a></li>
<li><a href="list-non-core.html">list of non-core programs</a> shipped with gitolite</li>
</ul>
<hr />
<center>
<span class="red"><strong>Extras</strong></span>
</center>

<hr />
<p><a href="odds-and-ends.html">Odds and Ends</a></p>
<ul>
<li><a href="odds-and-ends.html#writable">disabling pushes</a> to take backups</li>
<li><a href="odds-and-ends.html#elsewhere">putting 'repositories' and '.gitolite' elsewhere</a></li>
<li><a href="odds-and-ends.html#keysonly">using pubkeys obtained from elsewhere</a></li>
<li><a href="odds-and-ends.html#gh">giving users their own repos</a></li>
<li><a href="odds-and-ends.html#server-side-admin">administering gitolite directly on the server</a></li>
</ul>
<p>Additional information/discussion</p>
<ul>
<li><a href="ssh.html">all about ssh and gitolite</a></li>
<li>Running the <a href="testing.html">test suite</a></li>
<li><a href="files.html">gitolite files and directories</a></li>
<li><a href="perf.html">gitolite performance</a></li>
<li><a href="migr.html">Migration</a></li>
<li><a href="http://sitaramc.github.com/gitolite/g2/master-toc.html">documentation for gitolite v2</a></li>
<li><a href="regex.html">regular expressions</a></li>
<li><a href="no-way.html">no way!</a></li>
</ul>
<hr />
<center>
<span class="red"><strong>Contributed docs</strong></span>
</center>

<hr />
<p>Contributed software, tools, and documentation</p>
<ul>
<li><a href="ssh-and-http.html">combining ssh and http mode</a></li>
<li><a href="putty.html">putty and msysgit</a></li>
<li><a href="sskm.html">changing keys -- self service key management</a></li>
<li><a href="ukm.html">user key management</a></li>
<li><a href="README-emacs.html">emacs</a> &quot;major mode&quot;</li>
</ul>
</div>

<blockquote>
<hr />
</blockquote>
<p><br /></p>
<blockquote>
<center>
<span class="red"><strong>&quot;Don't Panic!&quot;</strong></span>
</center>

</blockquote>
<p><br /></p>
<blockquote>
<hr />
</blockquote>
<h1 id="installsetup-issues"><span class="header-section-number">1</span> install/setup issues</h1>
<p>Most install/setup issues in ssh mode are caused by lack of ssh knowledge. Ssh is a complex beast, and can cause problems for people who are not familiar with its quirks.</p>
<p><strong>Be prepared to spend some time reading the <a href="ssh.html">ssh</a> documentation that comes with gitolite</strong>.</p>
<h1 id="lost-key"><span class="header-section-number">2</span> lost admin key/access</h1>
<p>If you lost your gitolite <strong>admin</strong> key or access, here's what you do. We'll assume your username is &quot;alice&quot; (i.e., alice has RW or RW+ permissions on the gitolite-admin repo).</p>
<ul>
<li><p>Make yourself a new keypair and copy the public key to the server as 'alice.pub'.</p></li>
<li><p>Log on to the server, and run <code>gitolite setup -pk alice.pub</code>.</p></li>
</ul>
<p>That's it; the new alice.pub file replaces whatever existed in the repo before.</p>
<h1 id="bypass"><span class="header-section-number">3</span> bypassing gitolite</h1>
<p>You may have lost access because of a conf file error, in which case the above trick (which merely changes a pubkey) won't help. What you want is to make changes to the gitolite-admin repo (or perhaps just rewind) and push that. Here's how to do that:</p>
<ul>
<li><p>Log on to the server.</p></li>
<li><p>Clone the admin repo using the full path: <code>git clone     $HOME/repositories/gitolite-admin.git temp</code>.</p></li>
<li><p>Make whatever changes you want -- add/replace a key, 'git revert' or 'git reset --hard' to an older commit, etc. Anything you need to fix the problem, really.</p></li>
<li><p>Run <code>gitolite push</code> (or possibly <code>gitolite push -f</code>). Note that's 'gitolite push', not 'git push'.</p></li>
</ul>
<p><font color="red"> <strong>NOTE</strong>: gitolite does <strong>no access checking</strong> when you do this! </font></p>
<h1 id="botch"><span class="header-section-number">4</span> botched something?</h1>
<h2 id="fixing-botched-repos"><span class="header-section-number">4.1</span> fixing botched repos</h2>
<p>If you copied some repos from somewhere else, or mucked with the hooks for some reason, or deleted any gitolite-specific files, or tried any other &quot;behind the scenes&quot; stunts, the quickest, sanest, way to fix everything up is:</p>
<ul>
<li>Make sure any new repos you copied in are mentioned in the gitolite.conf in some 'repo' line and the change pushed.</li>
<li>Then run <code>gitolite setup</code> on the server.</li>
</ul>
<p>If the repo you botched is a wild repo, there's a bit more to be done. Wild repos store the creator name in a file called gl-creator, and the data managed by the <a href="user.html#perms">perms</a> command in a file called &quot;gl-perms&quot;. If these files got deleted, you may have to manually recreate them. The format is very simple and guessable by looking at those files on any other wild repo.</p>
<h2 id="clean"><span class="header-section-number">4.2</span> cleaning out a botched install</h2>
<p>Here's a list of files and directories to deal with:</p>
<ul>
<li><p><strong>Gitolite sources</strong> -- can be found by running <code>which gitolite</code>. If it's a symlink, go to its target directory.</p></li>
<li><p><strong>Gitolite admin directory</strong> -- <code>$HOME/.gitolite</code>. Save the 'logs' directory if you want to preserve them for any reason.</p></li>
<li><p><strong>The rc file</strong> -- <code>$HOME/.gitolite.rc</code>. If you made any changes to it you can save it as some other name instead of deleting it.</p></li>
<li><p><strong>The gitolite-admin repo</strong> -- <code>$HOME/repositories/gitolite-admin.git</code>. You can clone it somewhere to save it before blowing it away if you wish.</p></li>
<li><p><strong>Git repositories</strong> -- <code>$HOME/repositories</code>. The install process will not touch any existing repos except 'gitolite-admin.git', so you do not have to blow away (or move) your work repos to fix a botched install.</p>
<p>Only when you update the conf to include those repos and push the changes will those repos be touched. And even then all that happens is that the update hook, if any, is replaced with gitolite's own hook.</p></li>
<li><p><strong>Ssh stuff</strong> -- exercise caution when doing this, but in general it should be safe to delete all lines between the &quot;gitolite start&quot; and &quot;gitolite end&quot; markers in <code>$HOME/.ssh/authorized_keys</code>.</p>
<p>Gitolite does not touch any other files in the ssh directory.</p></li>
</ul>
<h1 id="ce"><span class="header-section-number">5</span> common errors</h1>
<ul>
<li><p><code>WARNING: keydir/&lt;yourname&gt;.pub duplicates a non-gitolite key, sshd will ignore it</code></p>
<p>You used a key that is already set to give you shell access. You cannot use the same key to get shell access as well as access gitolite repos.</p>
<p>Solution: use a different keypair for gitolite. There's a wee bit more on this in the <a href="install.html#setup">setup</a> section of the install page. Also see <a href="sts.html#ybpfail">why bypassing causes a problem</a> and both the pages linked from <a href="ssh.html">ssh</a> for background.</p></li>
<li><p><code>Empty compile time value given to use lib at hooks/update line 6</code></p>
<p>(followed by <code>Can't locate Gitolite/Hooks/Update.pm in @INC</code> a couple of lines later).</p>
<p>You're bypassing gitolite. You cloned the repo using the full path (i.e., including the <code>repositories/</code> prefix), either directly on the server, or via ssh but with a key that gives you <strong>shell</strong> access.</p>
<p>Solution: same as for the previous bullet.</p>
<p>NOTE: If you really <em>must</em> do it, and this is a one-time thing, you can try <code>gitolite push</code> instead of <code>git push</code>. <strong>BUT</strong>... this defeats all gitolite access control, so if you're going to do this often, maybe you don't need gitolite!</p></li>
</ul>
<h1 id="ue"><span class="header-section-number">6</span> uncommon errors</h1>
<p>(This page intentionally left blank)</p>
<h1 id="nonstd"><span class="header-section-number">7</span> non-standard configs that'll trip you up</h1>
<ul>
<li><p>If your 'git' binary is in a non-PATH location, or you have more than one version and want a specific one to be picked up, you will have to add a line like this at the end of the rc file (outside the <code>%RC</code> hash, but before the <code>1;</code> line):</p>
<pre><code>$ENV{PATH} = &quot;/your/git/path:$ENV{PATH}&quot;;</code></pre></li>
<li><p>If you have your sshd configured to put the authorized_keys file somewhere other than the default (which is in .ssh in the <a href="concepts.html#hu">hosting user</a>'s home directory), you'll probably have to roll your own ssh handling, either disabling 'ssh-authkeys' in the rc file, or building on that somehow (maybe a post-processing step that copies the relevant auth keys lines from the default file to the other).</p></li>
<li><p>If you have sshd setup to not allow incoming ssh for the hosting user, gitolite won't work. Check things like 'Allowusers' setting in /etc/ssh/sshd_config etc. to make sure.</p></li>
<li><p>If you have the home directory in a partition that is mounted noexec, gitolite won't work. I believe it would be sufficient if the &quot;.gitolite&quot; directory were moved to a different mount and symlinked, but please test thoroughly. A failure to execute a hook does not throw up any errors or warnings for you to notice!</p></li>
<li><p>If the default shell is something like /bin/false, and/or not listed in /etc/shells, there might be problems.</p></li>
</ul>
<h1 id="ngp"><span class="header-section-number">8</span> things that are not gitolite problems</h1>
<p>There are several things that appear to be gitolite problems but are not. I cannot help with most of these (although the good folks on irc or the mailing list -- see <a href="index.html#contact">contact</a> -- might be able to; they certainly appear to have a lot more patience than I do, bless 'em!)</p>
<ul>
<li><p><strong>Client side software</strong></p>
<ul>
<li>putty/plink</li>
<li>jgit/Eclipse</li>
<li>Mac OS client <strong>or</strong> server</li>
<li>putty/plink</li>
<li>windows as a server</li>
<li>...probably some more I forgot; will update this list as I remember...</li>
<li>did I mention putty/plink?</li>
</ul></li>
<li><p><strong>Ssh</strong></p>
<p>The <em>superstar</em> of the &quot;not a gitolite problem&quot; category is actually ssh.</p>
<p>Surprised? It is so common that it has <a href="concepts.html#auth">its own page</a> to tell you why it is <em>not</em> a gitolite problem, while <a href="ssh.html">another one</a> tries to help you anyway!</p>
<p>Everything I know is in that latter link. Please email me about ssh ONLY if you find something wrong or missing in those pages.</p></li>
<li><p><strong>Git</strong></p>
<p>I wish I had a dollar for each time someone did a <em>first push</em> on a new repo, got an error because there were &quot;no refs in common (etc.)&quot;, and asked me why gitolite was not allowing the push.</p>
<p>Gitolite is designed to look like just another bare repo server to a client (except requiring public keys -- no passwords allowed). It is <em>completely transparent</em> when there is no authorisation failure (i.e., when the access is allowed, the remote client has no way of knowing gitolite was even installed!)</p>
<p>Even &quot;on disk&quot;, apart from reserving the <code>update</code> hook for itself, gitolite does nothing to your bare repos unless you tell it to (for example, adding 'gitweb.owner' and such to the config file).</p>
<p>BEFORE you think gitolite is the problem, try the same thing with a normal bare repo. In most cases you can play with it just by doing something like this:</p>
<pre><code>mkdir /tmp/throwaway
cd    /tmp/throwaway
git clone --mirror &lt;some repo you have a URL for&gt; bare.git
git clone bare.git worktree
cd worktree
&lt;...try stuff&gt;</code></pre></li>
</ul>
</body>
</html>
