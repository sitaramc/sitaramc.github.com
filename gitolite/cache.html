<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="img/favicon.ico">
        <title>gitolite and the (redis) cache - Gitolite</title>
        <link href="css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="css/font-awesome.min.css" rel="stylesheet">
        <link href="css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
        <link href="css/gitolite.css" rel="stylesheet">
        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
        <![endif]-->

        <script src="js/jquery-1.10.2.min.js" defer></script>
        <script src="js/bootstrap-3.0.3.min.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script> 
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
            <div class="container">

                <!-- Collapsed navigation -->
                <div class="navbar-header">
                    <!-- Expander button -->
                    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                        <span class="sr-only">Toggle navigation</span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                    <a class="navbar-brand" href="index.html">Gitolite</a>
                </div>

                <!-- Expanded navigation -->
                <div class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li >
                                <a href="index.html">home</a>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">what/why <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li >
    <a href="overview.html">overview</a>
</li>
                                    
<li >
    <a href="concepts.html">concepts, conventions, terminology</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">install and setup <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li >
    <a href="quick_install.html">(unix/ssh experts) quick install and setup</a>
</li>
                                    
<li >
    <a href="install.html">normal ssh mode install and setup</a>
</li>
                                    
<li >
    <a href="fool_proof_setup.html">(if all else fails) fool-proof, step-by-step, install and setup</a>
</li>
                                    
<li >
    <a href="http.html">HTTP mode install</a>
</li>
                                    
<li >
    <a href="migr.html">migrating from v2</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">use <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
  <li class="dropdown-submenu">
    <a href="#">basic</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="basic-admin.html">basic administration</a>
</li>
            
<li >
    <a href="conf.html">the "conf" file (part 1)</a>
</li>
            
<li >
    <a href="conf-2.html">the "conf" file (part 2)</a>
</li>
            
<li >
    <a href="rc.html">the "rc" file</a>
</li>
            
<li >
    <a href="user.html">your users' view</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#">advanced</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="git-config.html">setting git-config values</a>
</li>
            
<li >
    <a href="options.html">gitolite options</a>
</li>
            
<li >
    <a href="wild.html">ad hoc user-created ("wild") repos</a>
</li>
            
<li >
    <a href="templates.html">using templates</a>
</li>
            
<li >
    <a href="vref.html">virtual refs (part 1)</a>
</li>
            
<li >
    <a href="vref-2.html">virtual refs (part 2)</a>
</li>
            
<li >
    <a href="deleg.html">delegation of admin duties</a>
</li>
            
<li >
    <a href="gitweb-daemon.html">gitweb and git-daemon</a>
</li>
            
<li >
    <a href="mirroring.html">mirroring</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#">customise</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="non-core.html">core and "non-core" gitolite</a>
</li>
            
<li >
    <a href="dev-notes.html">writing your own non-core code</a>
</li>
            
<li >
    <a href="triggers.html">gitolite triggers</a>
</li>
            
<li >
    <a href="list-non-core.html">list of non-core programs shipped with gitolite</a>
</li>
    </ul>
  </li>
                                    
<li >
    <a href="cookbook.html">(quick! how do I...) the cookbook</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">HELP! <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li >
    <a href="emergencies.html">emergency!!</a>
</li>
                                    
  <li class="dropdown-submenu">
    <a href="#">ssh</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="ssh.html">ssh</a>
</li>
            
<li >
    <a href="glssh.html">how gitolite uses ssh</a>
</li>
            
<li >
    <a href="sts.html">ssh troubleshooting</a>
</li>
    </ul>
  </li>
                                    
<li >
    <a href="regex.html">regular expressions</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">other docs <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li >
    <a href="odds-and-ends.html">miscellaneous features</a>
</li>
                                    
<li >
    <a href="namespaces.html">using git namespaces</a>
</li>
                                    
<li >
    <a href="locking.html">locking binary files</a>
</li>
                                    
<li >
    <a href="testing.html">testing gitolite</a>
</li>
                                    
<li >
    <a href="package.html">packaging gitolite</a>
</li>
                                    
  <li class="dropdown-submenu">
    <a href="#">more about gitolite</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="files.html">gitolite files & directories</a>
</li>
            
<li >
    <a href="rc-33.html">the 3.3 format rc file</a>
</li>
            
<li >
    <a href="perf.html">performance</a>
</li>
            
<li >
    <a href="internals.html">internals</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#">contrib</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="contrib/ssh-and-http.html">Using both ssh and http</a>
</li>
            
<li >
    <a href="contrib/putty.html">Putty and Msysgit</a>
</li>
            
<li >
    <a href="contrib/sskm.html">Self-service key management</a>
</li>
            
<li >
    <a href="contrib/ukm.html">User key management</a>
</li>
            
<li >
    <a href="contrib/README-emacs.html">Emacs major mode</a>
</li>
    </ul>
  </li>
                                    
<li >
    <a href="no-way.html">no way!</a>
</li>
                                </ul>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav navbar-right">
                        <li>
                            <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
                <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
        <li class="main active"><a href="#gitolite-and-the-redis-cache">gitolite and the (redis) cache</a></li>
        <li class="main "><a href="#how-does-caching-work">how does caching work?</a></li>
        <li class="main "><a href="#troubleshooting-caching">troubleshooting caching</a></li>
        <li class="main "><a href="#caching-details">caching details</a></li>
            <li><a href="#what-is-cached">what is cached</a></li>
            <li><a href="#how-long-is-it-cached-timeout">how long is it cached {#timeout}</a></li>
    </ul>
</div></div>
                <div class="col-md-9" role="main">

<h1 id="gitolite-and-the-redis-cache">gitolite and the (redis) cache<a class="headerlink" href="#gitolite-and-the-redis-cache" title="Permanent link"></a></h1>
<hr />
<p>(requires v3.6.1)</p>
<p><strong>WARNING: this has not been tested in a while.  YMMV</strong></p>
<p>Gitolite can optionally use the Redis in-memory key-value database for a
little speed boost for really large sites.</p>
<p>If you look in the [gitolite performance][perf] page, you will see, right at
the bottom, that pretty much the only thing in gitolite that <em>may</em> be slow is
the [info][] command. The cache feature fixes that problem :-)</p>
<p>Using Redis as the backend database is actually a bit of overkill; technically
this could just as well have been done using a DBM file or SQlite or something
like that, but since this is only a <em>cache</em>, an in-memory database works out
better.  However, Redis does have one real advantage: cache [timeout][]s!</p>
<p>Support for this feature is limited to verifiable gitolite bugs, if you find
any; I can't help you with redis itself.</p>
<h1 id="how-does-caching-work">how does caching work?<a class="headerlink" href="#how-does-caching-work" title="Permanent link"></a></h1>
<p>To use this feature, just install Redis, then the perl driver "Redis.pm".
Install or upgrade Gitolite to the latest master, then uncomment (or add, if
it doesn't exist) the following line in the rc file:</p>
<pre><code>CACHE       =&gt;  'Redis',
</code></pre>
<p>If you're <em>adding</em> it, please add it within the \%RC hash, but outside the
ENABLE list.  (If in doubt, add it just after the UMASK entry).</p>
<p>Then perform some gitolite operation (anything that requires any form of
access checking).  Redis should start automatically and the right things
should happen; see below if it does not.</p>
<h1 id="troubleshooting-caching">troubleshooting caching<a class="headerlink" href="#troubleshooting-caching" title="Permanent link"></a></h1>
<p>If you ever kill the redis-server be sure to also remove the socket file
<code>~/.redis-gitolite.sock</code>.  Conversely if you ever remove the sock file be sure
to kill the process also.  Otherwise you get weird behaviour, including
possible hangs.  (If things don't seem to work, the first thing to do is to
kill all 'redis-server's on that userid and remove <code>~/.redis-gitolite.*</code>, then
try again.)</p>
<p><strong>Note</strong>: To the best of my knowledge, this cannot result in wrong data being
passed to gitolite, causing a security breach.  If anyone has time I'd
appreciate a review of the code.</p>
<h1 id="caching-details">caching details<a class="headerlink" href="#caching-details" title="Permanent link"></a></h1>
<h2 id="what-is-cached">what is cached<a class="headerlink" href="#what-is-cached" title="Permanent link"></a></h2>
<p>At present, gitolite caches only one specific function: the "access()"
function.  This is available from the shell as the 'gitolite access ...'
command, as well as from perl via the "Easy.pm" interface; see [dev-notes][]
for more.  It is easily the "workhorse" of gitolite.</p>
<p>The cache is flushed completely when the gitolite.conf file is "compiled". You
might see some things running a bit slower -- at least until things settle
down.</p>
<p>Finally, if you run 'perms', the cache entries <em>for that specific repo</em> are
also flushed.</p>
<h2 id="how-long-is-it-cached-timeout">how long is it cached {#timeout}<a class="headerlink" href="#how-long-is-it-cached-timeout" title="Permanent link"></a></h2>
<p>Redis has a timeout feature that can delete entries after a certain period of
time has elapsed since they were created or updated.  Gitolite sets a timeout
of 90000 seconds (just over a day) normally.  However, if you're using the
GROUPLIST_PGM feature (see [here][ldap] for details), then this timeout
becomes 900 seconds (only 15 minutes).  This is because a user's group
membership, and thus her access rights, can change without gitolite being
aware of the change.</p>
<p>If you're not using the GROUPLIST_PGM feature, you don't have to do anything.
But if you are using it, then a cache timeout of 15 minutes may be too much or
too little for you -- I cannot judge that.  You can tell gitolite what timeout
you want for your setup, by adding (or uncommenting) an RC variable called
CACHE_TTL; its value is the number of seconds for the timeout.</p></div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>
            var base_url = ".",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="js/base.js" defer></script>
        <script src="search/main.js" defer></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="exampleModalLabel">Search</h4>
            </div>
            <div class="modal-body">
                <p>
                    From here you can search these documents. Enter
                    your search terms below.
                </p>
                <form role="form">
                    <div class="form-group">
                        <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="Keyboard Shortcuts Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="exampleModalLabel">Keyboard Shortcuts</h4>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
